var Mw=Object.defineProperty;var Yx=i=>{throw TypeError(i)};var Uw=(i,e,t)=>e in i?Mw(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var js=(i,e,t)=>Uw(i,typeof e!="symbol"?e+"":e,t),cg=(i,e,t)=>e.has(i)||Yx("Cannot "+t);var q=(i,e,t)=>(cg(i,e,"read from private field"),t?t.call(i):e.get(i)),tt=(i,e,t)=>e.has(i)?Yx("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(i):e.set(i,t),He=(i,e,t,s)=>(cg(i,e,"write to private field"),s?s.call(i,t):e.set(i,t),t),Tt=(i,e,t)=>(cg(i,e,"access private method"),t);var Cd=(i,e,t,s)=>({set _(n){He(i,e,n,t)},get _(){return q(i,e,s)}});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function t(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(n){if(n.ep)return;n.ep=!0;const r=t(n);fetch(n.href,r)}})();var qx=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function i0(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var ug={exports:{}},Rc={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qx;function Fw(){if(Qx)return Rc;Qx=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(s,n,r){var o=null;if(r!==void 0&&(o=""+r),n.key!==void 0&&(o=""+n.key),"key"in n){r={};for(var c in n)c!=="key"&&(r[c]=n[c])}else r=n;return n=r.ref,{$$typeof:i,type:s,key:o,ref:n!==void 0?n:null,props:r}}return Rc.Fragment=e,Rc.jsx=t,Rc.jsxs=t,Rc}var Xx;function Bw(){return Xx||(Xx=1,ug.exports=Fw()),ug.exports}var T=Bw(),dg={exports:{}},dt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wx;function jw(){if(Wx)return dt;Wx=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),n=Symbol.for("react.profiler"),r=Symbol.for("react.consumer"),o=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),m=Symbol.iterator;function p(N){return N===null||typeof N!="object"?null:(N=m&&N[m]||N["@@iterator"],typeof N=="function"?N:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,y={};function E(N,K,le){this.props=N,this.context=K,this.refs=y,this.updater=le||v}E.prototype.isReactComponent={},E.prototype.setState=function(N,K){if(typeof N!="object"&&typeof N!="function"&&N!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,N,K,"setState")},E.prototype.forceUpdate=function(N){this.updater.enqueueForceUpdate(this,N,"forceUpdate")};function A(){}A.prototype=E.prototype;function R(N,K,le){this.props=N,this.context=K,this.refs=y,this.updater=le||v}var I=R.prototype=new A;I.constructor=R,S(I,E.prototype),I.isPureReactComponent=!0;var C=Array.isArray,L={H:null,A:null,T:null,S:null,V:null},D=Object.prototype.hasOwnProperty;function _(N,K,le,H,ue,xe){return le=xe.ref,{$$typeof:i,type:N,key:K,ref:le!==void 0?le:null,props:xe}}function M(N,K){return _(N.type,K,void 0,void 0,void 0,N.props)}function U(N){return typeof N=="object"&&N!==null&&N.$$typeof===i}function F(N){var K={"=":"=0",":":"=2"};return"$"+N.replace(/[=:]/g,function(le){return K[le]})}var z=/\/+/g;function V(N,K){return typeof N=="object"&&N!==null&&N.key!=null?F(""+N.key):K.toString(36)}function ae(){}function G(N){switch(N.status){case"fulfilled":return N.value;case"rejected":throw N.reason;default:switch(typeof N.status=="string"?N.then(ae,ae):(N.status="pending",N.then(function(K){N.status==="pending"&&(N.status="fulfilled",N.value=K)},function(K){N.status==="pending"&&(N.status="rejected",N.reason=K)})),N.status){case"fulfilled":return N.value;case"rejected":throw N.reason}}throw N}function Z(N,K,le,H,ue){var xe=typeof N;(xe==="undefined"||xe==="boolean")&&(N=null);var fe=!1;if(N===null)fe=!0;else switch(xe){case"bigint":case"string":case"number":fe=!0;break;case"object":switch(N.$$typeof){case i:case e:fe=!0;break;case f:return fe=N._init,Z(fe(N._payload),K,le,H,ue)}}if(fe)return ue=ue(N),fe=H===""?"."+V(N,0):H,C(ue)?(le="",fe!=null&&(le=fe.replace(z,"$&/")+"/"),Z(ue,K,le,"",function(Be){return Be})):ue!=null&&(U(ue)&&(ue=M(ue,le+(ue.key==null||N&&N.key===ue.key?"":(""+ue.key).replace(z,"$&/")+"/")+fe)),K.push(ue)),1;fe=0;var We=H===""?".":H+":";if(C(N))for(var de=0;de<N.length;de++)H=N[de],xe=We+V(H,de),fe+=Z(H,K,le,xe,ue);else if(de=p(N),typeof de=="function")for(N=de.call(N),de=0;!(H=N.next()).done;)H=H.value,xe=We+V(H,de++),fe+=Z(H,K,le,xe,ue);else if(xe==="object"){if(typeof N.then=="function")return Z(G(N),K,le,H,ue);throw K=String(N),Error("Objects are not valid as a React child (found: "+(K==="[object Object]"?"object with keys {"+Object.keys(N).join(", ")+"}":K)+"). If you meant to render a collection of children, use an array instead.")}return fe}function B(N,K,le){if(N==null)return N;var H=[],ue=0;return Z(N,H,"","",function(xe){return K.call(le,xe,ue++)}),H}function Q(N){if(N._status===-1){var K=N._result;K=K(),K.then(function(le){(N._status===0||N._status===-1)&&(N._status=1,N._result=le)},function(le){(N._status===0||N._status===-1)&&(N._status=2,N._result=le)}),N._status===-1&&(N._status=0,N._result=K)}if(N._status===1)return N._result.default;throw N._result}var re=typeof reportError=="function"?reportError:function(N){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var K=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof N=="object"&&N!==null&&typeof N.message=="string"?String(N.message):String(N),error:N});if(!window.dispatchEvent(K))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",N);return}console.error(N)};function J(){}return dt.Children={map:B,forEach:function(N,K,le){B(N,function(){K.apply(this,arguments)},le)},count:function(N){var K=0;return B(N,function(){K++}),K},toArray:function(N){return B(N,function(K){return K})||[]},only:function(N){if(!U(N))throw Error("React.Children.only expected to receive a single React element child.");return N}},dt.Component=E,dt.Fragment=t,dt.Profiler=n,dt.PureComponent=R,dt.StrictMode=s,dt.Suspense=d,dt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=L,dt.__COMPILER_RUNTIME={__proto__:null,c:function(N){return L.H.useMemoCache(N)}},dt.cache=function(N){return function(){return N.apply(null,arguments)}},dt.cloneElement=function(N,K,le){if(N==null)throw Error("The argument must be a React element, but you passed "+N+".");var H=S({},N.props),ue=N.key,xe=void 0;if(K!=null)for(fe in K.ref!==void 0&&(xe=void 0),K.key!==void 0&&(ue=""+K.key),K)!D.call(K,fe)||fe==="key"||fe==="__self"||fe==="__source"||fe==="ref"&&K.ref===void 0||(H[fe]=K[fe]);var fe=arguments.length-2;if(fe===1)H.children=le;else if(1<fe){for(var We=Array(fe),de=0;de<fe;de++)We[de]=arguments[de+2];H.children=We}return _(N.type,ue,void 0,void 0,xe,H)},dt.createContext=function(N){return N={$$typeof:o,_currentValue:N,_currentValue2:N,_threadCount:0,Provider:null,Consumer:null},N.Provider=N,N.Consumer={$$typeof:r,_context:N},N},dt.createElement=function(N,K,le){var H,ue={},xe=null;if(K!=null)for(H in K.key!==void 0&&(xe=""+K.key),K)D.call(K,H)&&H!=="key"&&H!=="__self"&&H!=="__source"&&(ue[H]=K[H]);var fe=arguments.length-2;if(fe===1)ue.children=le;else if(1<fe){for(var We=Array(fe),de=0;de<fe;de++)We[de]=arguments[de+2];ue.children=We}if(N&&N.defaultProps)for(H in fe=N.defaultProps,fe)ue[H]===void 0&&(ue[H]=fe[H]);return _(N,xe,void 0,void 0,null,ue)},dt.createRef=function(){return{current:null}},dt.forwardRef=function(N){return{$$typeof:c,render:N}},dt.isValidElement=U,dt.lazy=function(N){return{$$typeof:f,_payload:{_status:-1,_result:N},_init:Q}},dt.memo=function(N,K){return{$$typeof:u,type:N,compare:K===void 0?null:K}},dt.startTransition=function(N){var K=L.T,le={};L.T=le;try{var H=N(),ue=L.S;ue!==null&&ue(le,H),typeof H=="object"&&H!==null&&typeof H.then=="function"&&H.then(J,re)}catch(xe){re(xe)}finally{L.T=K}},dt.unstable_useCacheRefresh=function(){return L.H.useCacheRefresh()},dt.use=function(N){return L.H.use(N)},dt.useActionState=function(N,K,le){return L.H.useActionState(N,K,le)},dt.useCallback=function(N,K){return L.H.useCallback(N,K)},dt.useContext=function(N){return L.H.useContext(N)},dt.useDebugValue=function(){},dt.useDeferredValue=function(N,K){return L.H.useDeferredValue(N,K)},dt.useEffect=function(N,K,le){var H=L.H;if(typeof le=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return H.useEffect(N,K)},dt.useId=function(){return L.H.useId()},dt.useImperativeHandle=function(N,K,le){return L.H.useImperativeHandle(N,K,le)},dt.useInsertionEffect=function(N,K){return L.H.useInsertionEffect(N,K)},dt.useLayoutEffect=function(N,K){return L.H.useLayoutEffect(N,K)},dt.useMemo=function(N,K){return L.H.useMemo(N,K)},dt.useOptimistic=function(N,K){return L.H.useOptimistic(N,K)},dt.useReducer=function(N,K,le){return L.H.useReducer(N,K,le)},dt.useRef=function(N){return L.H.useRef(N)},dt.useState=function(N){return L.H.useState(N)},dt.useSyncExternalStore=function(N,K,le){return L.H.useSyncExternalStore(N,K,le)},dt.useTransition=function(){return L.H.useTransition()},dt.version="19.1.0",dt}var Zx;function n0(){return Zx||(Zx=1,dg.exports=jw()),dg.exports}var P=n0();const _e=i0(P);var hg={exports:{}},Lc={},fg={exports:{}},mg={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jx;function Vw(){return Jx||(Jx=1,function(i){function e(B,Q){var re=B.length;B.push(Q);e:for(;0<re;){var J=re-1>>>1,N=B[J];if(0<n(N,Q))B[J]=Q,B[re]=N,re=J;else break e}}function t(B){return B.length===0?null:B[0]}function s(B){if(B.length===0)return null;var Q=B[0],re=B.pop();if(re!==Q){B[0]=re;e:for(var J=0,N=B.length,K=N>>>1;J<K;){var le=2*(J+1)-1,H=B[le],ue=le+1,xe=B[ue];if(0>n(H,re))ue<N&&0>n(xe,H)?(B[J]=xe,B[ue]=re,J=ue):(B[J]=H,B[le]=re,J=le);else if(ue<N&&0>n(xe,re))B[J]=xe,B[ue]=re,J=ue;else break e}}return Q}function n(B,Q){var re=B.sortIndex-Q.sortIndex;return re!==0?re:B.id-Q.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var r=performance;i.unstable_now=function(){return r.now()}}else{var o=Date,c=o.now();i.unstable_now=function(){return o.now()-c}}var d=[],u=[],f=1,m=null,p=3,v=!1,S=!1,y=!1,E=!1,A=typeof setTimeout=="function"?setTimeout:null,R=typeof clearTimeout=="function"?clearTimeout:null,I=typeof setImmediate<"u"?setImmediate:null;function C(B){for(var Q=t(u);Q!==null;){if(Q.callback===null)s(u);else if(Q.startTime<=B)s(u),Q.sortIndex=Q.expirationTime,e(d,Q);else break;Q=t(u)}}function L(B){if(y=!1,C(B),!S)if(t(d)!==null)S=!0,D||(D=!0,V());else{var Q=t(u);Q!==null&&Z(L,Q.startTime-B)}}var D=!1,_=-1,M=5,U=-1;function F(){return E?!0:!(i.unstable_now()-U<M)}function z(){if(E=!1,D){var B=i.unstable_now();U=B;var Q=!0;try{e:{S=!1,y&&(y=!1,R(_),_=-1),v=!0;var re=p;try{t:{for(C(B),m=t(d);m!==null&&!(m.expirationTime>B&&F());){var J=m.callback;if(typeof J=="function"){m.callback=null,p=m.priorityLevel;var N=J(m.expirationTime<=B);if(B=i.unstable_now(),typeof N=="function"){m.callback=N,C(B),Q=!0;break t}m===t(d)&&s(d),C(B)}else s(d);m=t(d)}if(m!==null)Q=!0;else{var K=t(u);K!==null&&Z(L,K.startTime-B),Q=!1}}break e}finally{m=null,p=re,v=!1}Q=void 0}}finally{Q?V():D=!1}}}var V;if(typeof I=="function")V=function(){I(z)};else if(typeof MessageChannel<"u"){var ae=new MessageChannel,G=ae.port2;ae.port1.onmessage=z,V=function(){G.postMessage(null)}}else V=function(){A(z,0)};function Z(B,Q){_=A(function(){B(i.unstable_now())},Q)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(B){B.callback=null},i.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<B?Math.floor(1e3/B):5},i.unstable_getCurrentPriorityLevel=function(){return p},i.unstable_next=function(B){switch(p){case 1:case 2:case 3:var Q=3;break;default:Q=p}var re=p;p=Q;try{return B()}finally{p=re}},i.unstable_requestPaint=function(){E=!0},i.unstable_runWithPriority=function(B,Q){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var re=p;p=B;try{return Q()}finally{p=re}},i.unstable_scheduleCallback=function(B,Q,re){var J=i.unstable_now();switch(typeof re=="object"&&re!==null?(re=re.delay,re=typeof re=="number"&&0<re?J+re:J):re=J,B){case 1:var N=-1;break;case 2:N=250;break;case 5:N=1073741823;break;case 4:N=1e4;break;default:N=5e3}return N=re+N,B={id:f++,callback:Q,priorityLevel:B,startTime:re,expirationTime:N,sortIndex:-1},re>J?(B.sortIndex=re,e(u,B),t(d)===null&&B===t(u)&&(y?(R(_),_=-1):y=!0,Z(L,re-J))):(B.sortIndex=N,e(d,B),S||v||(S=!0,D||(D=!0,V()))),B},i.unstable_shouldYield=F,i.unstable_wrapCallback=function(B){var Q=p;return function(){var re=p;p=Q;try{return B.apply(this,arguments)}finally{p=re}}}}(mg)),mg}var eT;function $w(){return eT||(eT=1,fg.exports=Vw()),fg.exports}var gg={exports:{}},Vs={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tT;function Gw(){if(tT)return Vs;tT=1;var i=n0();function e(d){var u="https://react.dev/errors/"+d;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)u+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+d+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var s={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},n=Symbol.for("react.portal");function r(d,u,f){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:n,key:m==null?null:""+m,children:d,containerInfo:u,implementation:f}}var o=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(d,u){if(d==="font")return"";if(typeof u=="string")return u==="use-credentials"?u:""}return Vs.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,Vs.createPortal=function(d,u){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)throw Error(e(299));return r(d,u,null,f)},Vs.flushSync=function(d){var u=o.T,f=s.p;try{if(o.T=null,s.p=2,d)return d()}finally{o.T=u,s.p=f,s.d.f()}},Vs.preconnect=function(d,u){typeof d=="string"&&(u?(u=u.crossOrigin,u=typeof u=="string"?u==="use-credentials"?u:"":void 0):u=null,s.d.C(d,u))},Vs.prefetchDNS=function(d){typeof d=="string"&&s.d.D(d)},Vs.preinit=function(d,u){if(typeof d=="string"&&u&&typeof u.as=="string"){var f=u.as,m=c(f,u.crossOrigin),p=typeof u.integrity=="string"?u.integrity:void 0,v=typeof u.fetchPriority=="string"?u.fetchPriority:void 0;f==="style"?s.d.S(d,typeof u.precedence=="string"?u.precedence:void 0,{crossOrigin:m,integrity:p,fetchPriority:v}):f==="script"&&s.d.X(d,{crossOrigin:m,integrity:p,fetchPriority:v,nonce:typeof u.nonce=="string"?u.nonce:void 0})}},Vs.preinitModule=function(d,u){if(typeof d=="string")if(typeof u=="object"&&u!==null){if(u.as==null||u.as==="script"){var f=c(u.as,u.crossOrigin);s.d.M(d,{crossOrigin:f,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0})}}else u==null&&s.d.M(d)},Vs.preload=function(d,u){if(typeof d=="string"&&typeof u=="object"&&u!==null&&typeof u.as=="string"){var f=u.as,m=c(f,u.crossOrigin);s.d.L(d,f,{crossOrigin:m,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0,type:typeof u.type=="string"?u.type:void 0,fetchPriority:typeof u.fetchPriority=="string"?u.fetchPriority:void 0,referrerPolicy:typeof u.referrerPolicy=="string"?u.referrerPolicy:void 0,imageSrcSet:typeof u.imageSrcSet=="string"?u.imageSrcSet:void 0,imageSizes:typeof u.imageSizes=="string"?u.imageSizes:void 0,media:typeof u.media=="string"?u.media:void 0})}},Vs.preloadModule=function(d,u){if(typeof d=="string")if(u){var f=c(u.as,u.crossOrigin);s.d.m(d,{as:typeof u.as=="string"&&u.as!=="script"?u.as:void 0,crossOrigin:f,integrity:typeof u.integrity=="string"?u.integrity:void 0})}else s.d.m(d)},Vs.requestFormReset=function(d){s.d.r(d)},Vs.unstable_batchedUpdates=function(d,u){return d(u)},Vs.useFormState=function(d,u,f){return o.H.useFormState(d,u,f)},Vs.useFormStatus=function(){return o.H.useHostTransitionStatus()},Vs.version="19.1.0",Vs}var sT;function HE(){if(sT)return gg.exports;sT=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),gg.exports=Gw(),gg.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var iT;function Hw(){if(iT)return Lc;iT=1;var i=$w(),e=n0(),t=HE();function s(a){var l="https://react.dev/errors/"+a;if(1<arguments.length){l+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)l+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+a+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function r(a){var l=a,h=a;if(a.alternate)for(;l.return;)l=l.return;else{a=l;do l=a,(l.flags&4098)!==0&&(h=l.return),a=l.return;while(a)}return l.tag===3?h:null}function o(a){if(a.tag===13){var l=a.memoizedState;if(l===null&&(a=a.alternate,a!==null&&(l=a.memoizedState)),l!==null)return l.dehydrated}return null}function c(a){if(r(a)!==a)throw Error(s(188))}function d(a){var l=a.alternate;if(!l){if(l=r(a),l===null)throw Error(s(188));return l!==a?null:a}for(var h=a,g=l;;){var x=h.return;if(x===null)break;var b=x.alternate;if(b===null){if(g=x.return,g!==null){h=g;continue}break}if(x.child===b.child){for(b=x.child;b;){if(b===h)return c(x),a;if(b===g)return c(x),l;b=b.sibling}throw Error(s(188))}if(h.return!==g.return)h=x,g=b;else{for(var O=!1,k=x.child;k;){if(k===h){O=!0,h=x,g=b;break}if(k===g){O=!0,g=x,h=b;break}k=k.sibling}if(!O){for(k=b.child;k;){if(k===h){O=!0,h=b,g=x;break}if(k===g){O=!0,g=b,h=x;break}k=k.sibling}if(!O)throw Error(s(189))}}if(h.alternate!==g)throw Error(s(190))}if(h.tag!==3)throw Error(s(188));return h.stateNode.current===h?a:l}function u(a){var l=a.tag;if(l===5||l===26||l===27||l===6)return a;for(a=a.child;a!==null;){if(l=u(a),l!==null)return l;a=a.sibling}return null}var f=Object.assign,m=Symbol.for("react.element"),p=Symbol.for("react.transitional.element"),v=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),y=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),A=Symbol.for("react.provider"),R=Symbol.for("react.consumer"),I=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),L=Symbol.for("react.suspense"),D=Symbol.for("react.suspense_list"),_=Symbol.for("react.memo"),M=Symbol.for("react.lazy"),U=Symbol.for("react.activity"),F=Symbol.for("react.memo_cache_sentinel"),z=Symbol.iterator;function V(a){return a===null||typeof a!="object"?null:(a=z&&a[z]||a["@@iterator"],typeof a=="function"?a:null)}var ae=Symbol.for("react.client.reference");function G(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===ae?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case S:return"Fragment";case E:return"Profiler";case y:return"StrictMode";case L:return"Suspense";case D:return"SuspenseList";case U:return"Activity"}if(typeof a=="object")switch(a.$$typeof){case v:return"Portal";case I:return(a.displayName||"Context")+".Provider";case R:return(a._context.displayName||"Context")+".Consumer";case C:var l=a.render;return a=a.displayName,a||(a=l.displayName||l.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case _:return l=a.displayName||null,l!==null?l:G(a.type)||"Memo";case M:l=a._payload,a=a._init;try{return G(a(l))}catch{}}return null}var Z=Array.isArray,B=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Q=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,re={pending:!1,data:null,method:null,action:null},J=[],N=-1;function K(a){return{current:a}}function le(a){0>N||(a.current=J[N],J[N]=null,N--)}function H(a,l){N++,J[N]=a.current,a.current=l}var ue=K(null),xe=K(null),fe=K(null),We=K(null);function de(a,l){switch(H(fe,l),H(xe,a),H(ue,null),l.nodeType){case 9:case 11:a=(a=l.documentElement)&&(a=a.namespaceURI)?Tx(a):0;break;default:if(a=l.tagName,l=l.namespaceURI)l=Tx(l),a=Ex(l,a);else switch(a){case"svg":a=1;break;case"math":a=2;break;default:a=0}}le(ue),H(ue,a)}function Be(){le(ue),le(xe),le(fe)}function lt(a){a.memoizedState!==null&&H(We,a);var l=ue.current,h=Ex(l,a.type);l!==h&&(H(xe,a),H(ue,h))}function Ee(a){xe.current===a&&(le(ue),le(xe)),We.current===a&&(le(We),Tc._currentValue=re)}var Ne=Object.prototype.hasOwnProperty,Me=i.unstable_scheduleCallback,Qe=i.unstable_cancelCallback,st=i.unstable_shouldYield,W=i.unstable_requestPaint,j=i.unstable_now,ne=i.unstable_getCurrentPriorityLevel,ge=i.unstable_ImmediatePriority,Ie=i.unstable_UserBlockingPriority,Ue=i.unstable_NormalPriority,Ve=i.unstable_LowPriority,it=i.unstable_IdlePriority,xt=i.log,Rt=i.unstable_setDisableYieldValue,Dt=null,bt=null;function $t(a){if(typeof xt=="function"&&Rt(a),bt&&typeof bt.setStrictMode=="function")try{bt.setStrictMode(Dt,a)}catch{}}var St=Math.clz32?Math.clz32:Xt,_s=Math.log,hs=Math.LN2;function Xt(a){return a>>>=0,a===0?32:31-(_s(a)/hs|0)|0}var Ps=256,ps=4194304;function Ws(a){var l=a&42;if(l!==0)return l;switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return a&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return a}}function Bn(a,l,h){var g=a.pendingLanes;if(g===0)return 0;var x=0,b=a.suspendedLanes,O=a.pingedLanes;a=a.warmLanes;var k=g&134217727;return k!==0?(g=k&~b,g!==0?x=Ws(g):(O&=k,O!==0?x=Ws(O):h||(h=k&~a,h!==0&&(x=Ws(h))))):(k=g&~b,k!==0?x=Ws(k):O!==0?x=Ws(O):h||(h=g&~a,h!==0&&(x=Ws(h)))),x===0?0:l!==0&&l!==x&&(l&b)===0&&(b=x&-x,h=l&-l,b>=h||b===32&&(h&4194048)!==0)?l:x}function hn(a,l){return(a.pendingLanes&~(a.suspendedLanes&~a.pingedLanes)&l)===0}function ao(a,l){switch(a){case 1:case 2:case 4:case 8:case 64:return l+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function pa(){var a=Ps;return Ps<<=1,(Ps&4194048)===0&&(Ps=256),a}function ya(){var a=ps;return ps<<=1,(ps&62914560)===0&&(ps=4194304),a}function pr(a){for(var l=[],h=0;31>h;h++)l.push(a);return l}function fn(a,l){a.pendingLanes|=l,l!==268435456&&(a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0)}function oo(a,l,h,g,x,b){var O=a.pendingLanes;a.pendingLanes=h,a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0,a.expiredLanes&=h,a.entangledLanes&=h,a.errorRecoveryDisabledLanes&=h,a.shellSuspendCounter=0;var k=a.entanglements,$=a.expirationTimes,ie=a.hiddenUpdates;for(h=O&~h;0<h;){var me=31-St(h),ve=1<<me;k[me]=0,$[me]=-1;var oe=ie[me];if(oe!==null)for(ie[me]=null,me=0;me<oe.length;me++){var ce=oe[me];ce!==null&&(ce.lane&=-536870913)}h&=~ve}g!==0&&va(a,g,0),b!==0&&x===0&&a.tag!==0&&(a.suspendedLanes|=b&~(O&~l))}function va(a,l,h){a.pendingLanes|=l,a.suspendedLanes&=~l;var g=31-St(l);a.entangledLanes|=l,a.entanglements[g]=a.entanglements[g]|1073741824|h&4194090}function Sa(a,l){var h=a.entangledLanes|=l;for(a=a.entanglements;h;){var g=31-St(h),x=1<<g;x&l|a[g]&l&&(a[g]|=l),h&=~x}}function yr(a){switch(a){case 2:a=1;break;case 8:a=4;break;case 32:a=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:a=128;break;case 268435456:a=134217728;break;default:a=0}return a}function vr(a){return a&=-a,2<a?8<a?(a&134217727)!==0?32:268435456:8:2}function xa(){var a=Q.p;return a!==0?a:(a=window.event,a===void 0?32:Vx(a.type))}function lo(a,l){var h=Q.p;try{return Q.p=a,l()}finally{Q.p=h}}var gi=Math.random().toString(36).slice(2),ls="__reactFiber$"+gi,Is="__reactProps$"+gi,pi="__reactContainer$"+gi,yi="__reactEvents$"+gi,Sr="__reactListeners$"+gi,co="__reactHandles$"+gi,be="__reactResources$"+gi,jn="__reactMarker$"+gi;function _l(a){delete a[ls],delete a[Is],delete a[yi],delete a[Sr],delete a[co]}function xr(a){var l=a[ls];if(l)return l;for(var h=a.parentNode;h;){if(l=h[pi]||h[ls]){if(h=l.alternate,l.child!==null||h!==null&&h.child!==null)for(a=Rx(a);a!==null;){if(h=a[ls])return h;a=Rx(a)}return l}a=h,h=a.parentNode}return null}function uo(a){if(a=a[ls]||a[pi]){var l=a.tag;if(l===5||l===6||l===13||l===26||l===27||l===3)return a}return null}function Pl(a){var l=a.tag;if(l===5||l===26||l===27||l===6)return a.stateNode;throw Error(s(33))}function ho(a){var l=a[be];return l||(l=a[be]={hoistableStyles:new Map,hoistableScripts:new Map}),l}function Rs(a){a[jn]=!0}var uy=new Set,dy={};function Ta(a,l){fo(a,l),fo(a+"Capture",l)}function fo(a,l){for(dy[a]=l,a=0;a<l.length;a++)uy.add(l[a])}var wR=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),hy={},fy={};function CR(a){return Ne.call(fy,a)?!0:Ne.call(hy,a)?!1:wR.test(a)?fy[a]=!0:(hy[a]=!0,!1)}function Su(a,l,h){if(CR(l))if(h===null)a.removeAttribute(l);else{switch(typeof h){case"undefined":case"function":case"symbol":a.removeAttribute(l);return;case"boolean":var g=l.toLowerCase().slice(0,5);if(g!=="data-"&&g!=="aria-"){a.removeAttribute(l);return}}a.setAttribute(l,""+h)}}function xu(a,l,h){if(h===null)a.removeAttribute(l);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(l);return}a.setAttribute(l,""+h)}}function Vn(a,l,h,g){if(g===null)a.removeAttribute(h);else{switch(typeof g){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(h);return}a.setAttributeNS(l,h,""+g)}}var sf,my;function mo(a){if(sf===void 0)try{throw Error()}catch(h){var l=h.stack.trim().match(/\n( *(at )?)/);sf=l&&l[1]||"",my=-1<h.stack.indexOf(`
    at`)?" (<anonymous>)":-1<h.stack.indexOf("@")?"@unknown:0:0":""}return`
`+sf+a+my}var nf=!1;function rf(a,l){if(!a||nf)return"";nf=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var g={DetermineComponentFrameRoot:function(){try{if(l){var ve=function(){throw Error()};if(Object.defineProperty(ve.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ve,[])}catch(ce){var oe=ce}Reflect.construct(a,[],ve)}else{try{ve.call()}catch(ce){oe=ce}a.call(ve.prototype)}}else{try{throw Error()}catch(ce){oe=ce}(ve=a())&&typeof ve.catch=="function"&&ve.catch(function(){})}}catch(ce){if(ce&&oe&&typeof ce.stack=="string")return[ce.stack,oe.stack]}return[null,null]}};g.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var x=Object.getOwnPropertyDescriptor(g.DetermineComponentFrameRoot,"name");x&&x.configurable&&Object.defineProperty(g.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var b=g.DetermineComponentFrameRoot(),O=b[0],k=b[1];if(O&&k){var $=O.split(`
`),ie=k.split(`
`);for(x=g=0;g<$.length&&!$[g].includes("DetermineComponentFrameRoot");)g++;for(;x<ie.length&&!ie[x].includes("DetermineComponentFrameRoot");)x++;if(g===$.length||x===ie.length)for(g=$.length-1,x=ie.length-1;1<=g&&0<=x&&$[g]!==ie[x];)x--;for(;1<=g&&0<=x;g--,x--)if($[g]!==ie[x]){if(g!==1||x!==1)do if(g--,x--,0>x||$[g]!==ie[x]){var me=`
`+$[g].replace(" at new "," at ");return a.displayName&&me.includes("<anonymous>")&&(me=me.replace("<anonymous>",a.displayName)),me}while(1<=g&&0<=x);break}}}finally{nf=!1,Error.prepareStackTrace=h}return(h=a?a.displayName||a.name:"")?mo(h):""}function OR(a){switch(a.tag){case 26:case 27:case 5:return mo(a.type);case 16:return mo("Lazy");case 13:return mo("Suspense");case 19:return mo("SuspenseList");case 0:case 15:return rf(a.type,!1);case 11:return rf(a.type.render,!1);case 1:return rf(a.type,!0);case 31:return mo("Activity");default:return""}}function gy(a){try{var l="";do l+=OR(a),a=a.return;while(a);return l}catch(h){return`
Error generating stack: `+h.message+`
`+h.stack}}function _i(a){switch(typeof a){case"bigint":case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function py(a){var l=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function DR(a){var l=py(a)?"checked":"value",h=Object.getOwnPropertyDescriptor(a.constructor.prototype,l),g=""+a[l];if(!a.hasOwnProperty(l)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var x=h.get,b=h.set;return Object.defineProperty(a,l,{configurable:!0,get:function(){return x.call(this)},set:function(O){g=""+O,b.call(this,O)}}),Object.defineProperty(a,l,{enumerable:h.enumerable}),{getValue:function(){return g},setValue:function(O){g=""+O},stopTracking:function(){a._valueTracker=null,delete a[l]}}}}function Tu(a){a._valueTracker||(a._valueTracker=DR(a))}function yy(a){if(!a)return!1;var l=a._valueTracker;if(!l)return!0;var h=l.getValue(),g="";return a&&(g=py(a)?a.checked?"true":"false":a.value),a=g,a!==h?(l.setValue(a),!0):!1}function Eu(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}var _R=/[\n"\\]/g;function Pi(a){return a.replace(_R,function(l){return"\\"+l.charCodeAt(0).toString(16)+" "})}function af(a,l,h,g,x,b,O,k){a.name="",O!=null&&typeof O!="function"&&typeof O!="symbol"&&typeof O!="boolean"?a.type=O:a.removeAttribute("type"),l!=null?O==="number"?(l===0&&a.value===""||a.value!=l)&&(a.value=""+_i(l)):a.value!==""+_i(l)&&(a.value=""+_i(l)):O!=="submit"&&O!=="reset"||a.removeAttribute("value"),l!=null?of(a,O,_i(l)):h!=null?of(a,O,_i(h)):g!=null&&a.removeAttribute("value"),x==null&&b!=null&&(a.defaultChecked=!!b),x!=null&&(a.checked=x&&typeof x!="function"&&typeof x!="symbol"),k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"?a.name=""+_i(k):a.removeAttribute("name")}function vy(a,l,h,g,x,b,O,k){if(b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(a.type=b),l!=null||h!=null){if(!(b!=="submit"&&b!=="reset"||l!=null))return;h=h!=null?""+_i(h):"",l=l!=null?""+_i(l):h,k||l===a.value||(a.value=l),a.defaultValue=l}g=g??x,g=typeof g!="function"&&typeof g!="symbol"&&!!g,a.checked=k?a.checked:!!g,a.defaultChecked=!!g,O!=null&&typeof O!="function"&&typeof O!="symbol"&&typeof O!="boolean"&&(a.name=O)}function of(a,l,h){l==="number"&&Eu(a.ownerDocument)===a||a.defaultValue===""+h||(a.defaultValue=""+h)}function go(a,l,h,g){if(a=a.options,l){l={};for(var x=0;x<h.length;x++)l["$"+h[x]]=!0;for(h=0;h<a.length;h++)x=l.hasOwnProperty("$"+a[h].value),a[h].selected!==x&&(a[h].selected=x),x&&g&&(a[h].defaultSelected=!0)}else{for(h=""+_i(h),l=null,x=0;x<a.length;x++){if(a[x].value===h){a[x].selected=!0,g&&(a[x].defaultSelected=!0);return}l!==null||a[x].disabled||(l=a[x])}l!==null&&(l.selected=!0)}}function Sy(a,l,h){if(l!=null&&(l=""+_i(l),l!==a.value&&(a.value=l),h==null)){a.defaultValue!==l&&(a.defaultValue=l);return}a.defaultValue=h!=null?""+_i(h):""}function xy(a,l,h,g){if(l==null){if(g!=null){if(h!=null)throw Error(s(92));if(Z(g)){if(1<g.length)throw Error(s(93));g=g[0]}h=g}h==null&&(h=""),l=h}h=_i(l),a.defaultValue=h,g=a.textContent,g===h&&g!==""&&g!==null&&(a.value=g)}function po(a,l){if(l){var h=a.firstChild;if(h&&h===a.lastChild&&h.nodeType===3){h.nodeValue=l;return}}a.textContent=l}var PR=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ty(a,l,h){var g=l.indexOf("--")===0;h==null||typeof h=="boolean"||h===""?g?a.setProperty(l,""):l==="float"?a.cssFloat="":a[l]="":g?a.setProperty(l,h):typeof h!="number"||h===0||PR.has(l)?l==="float"?a.cssFloat=h:a[l]=(""+h).trim():a[l]=h+"px"}function Ey(a,l,h){if(l!=null&&typeof l!="object")throw Error(s(62));if(a=a.style,h!=null){for(var g in h)!h.hasOwnProperty(g)||l!=null&&l.hasOwnProperty(g)||(g.indexOf("--")===0?a.setProperty(g,""):g==="float"?a.cssFloat="":a[g]="");for(var x in l)g=l[x],l.hasOwnProperty(x)&&h[x]!==g&&Ty(a,x,g)}else for(var b in l)l.hasOwnProperty(b)&&Ty(a,b,l[b])}function lf(a){if(a.indexOf("-")===-1)return!1;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var kR=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),NR=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function bu(a){return NR.test(""+a)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":a}var cf=null;function uf(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var yo=null,vo=null;function by(a){var l=uo(a);if(l&&(a=l.stateNode)){var h=a[Is]||null;e:switch(a=l.stateNode,l.type){case"input":if(af(a,h.value,h.defaultValue,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name),l=h.name,h.type==="radio"&&l!=null){for(h=a;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll('input[name="'+Pi(""+l)+'"][type="radio"]'),l=0;l<h.length;l++){var g=h[l];if(g!==a&&g.form===a.form){var x=g[Is]||null;if(!x)throw Error(s(90));af(g,x.value,x.defaultValue,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name)}}for(l=0;l<h.length;l++)g=h[l],g.form===a.form&&yy(g)}break e;case"textarea":Sy(a,h.value,h.defaultValue);break e;case"select":l=h.value,l!=null&&go(a,!!h.multiple,l,!1)}}}var df=!1;function Ay(a,l,h){if(df)return a(l,h);df=!0;try{var g=a(l);return g}finally{if(df=!1,(yo!==null||vo!==null)&&(ld(),yo&&(l=yo,a=vo,vo=yo=null,by(l),a)))for(l=0;l<a.length;l++)by(a[l])}}function kl(a,l){var h=a.stateNode;if(h===null)return null;var g=h[Is]||null;if(g===null)return null;h=g[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(g=!g.disabled)||(a=a.type,g=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!g;break e;default:a=!1}if(a)return null;if(h&&typeof h!="function")throw Error(s(231,l,typeof h));return h}var $n=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),hf=!1;if($n)try{var Nl={};Object.defineProperty(Nl,"passive",{get:function(){hf=!0}}),window.addEventListener("test",Nl,Nl),window.removeEventListener("test",Nl,Nl)}catch{hf=!1}var Tr=null,ff=null,Au=null;function Iy(){if(Au)return Au;var a,l=ff,h=l.length,g,x="value"in Tr?Tr.value:Tr.textContent,b=x.length;for(a=0;a<h&&l[a]===x[a];a++);var O=h-a;for(g=1;g<=O&&l[h-g]===x[b-g];g++);return Au=x.slice(a,1<g?1-g:void 0)}function Iu(a){var l=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&l===13&&(a=13)):a=l,a===10&&(a=13),32<=a||a===13?a:0}function Ru(){return!0}function Ry(){return!1}function ni(a){function l(h,g,x,b,O){this._reactName=h,this._targetInst=x,this.type=g,this.nativeEvent=b,this.target=O,this.currentTarget=null;for(var k in a)a.hasOwnProperty(k)&&(h=a[k],this[k]=h?h(b):b[k]);return this.isDefaultPrevented=(b.defaultPrevented!=null?b.defaultPrevented:b.returnValue===!1)?Ru:Ry,this.isPropagationStopped=Ry,this}return f(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=Ru)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=Ru)},persist:function(){},isPersistent:Ru}),l}var Ea={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Lu=ni(Ea),Ml=f({},Ea,{view:0,detail:0}),MR=ni(Ml),mf,gf,Ul,wu=f({},Ml,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:yf,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==Ul&&(Ul&&a.type==="mousemove"?(mf=a.screenX-Ul.screenX,gf=a.screenY-Ul.screenY):gf=mf=0,Ul=a),mf)},movementY:function(a){return"movementY"in a?a.movementY:gf}}),Ly=ni(wu),UR=f({},wu,{dataTransfer:0}),FR=ni(UR),BR=f({},Ml,{relatedTarget:0}),pf=ni(BR),jR=f({},Ea,{animationName:0,elapsedTime:0,pseudoElement:0}),VR=ni(jR),$R=f({},Ea,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),GR=ni($R),HR=f({},Ea,{data:0}),wy=ni(HR),zR={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},KR={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},YR={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function qR(a){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(a):(a=YR[a])?!!l[a]:!1}function yf(){return qR}var QR=f({},Ml,{key:function(a){if(a.key){var l=zR[a.key]||a.key;if(l!=="Unidentified")return l}return a.type==="keypress"?(a=Iu(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?KR[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:yf,charCode:function(a){return a.type==="keypress"?Iu(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?Iu(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),XR=ni(QR),WR=f({},wu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Cy=ni(WR),ZR=f({},Ml,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:yf}),JR=ni(ZR),eL=f({},Ea,{propertyName:0,elapsedTime:0,pseudoElement:0}),tL=ni(eL),sL=f({},wu,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),iL=ni(sL),nL=f({},Ea,{newState:0,oldState:0}),rL=ni(nL),aL=[9,13,27,32],vf=$n&&"CompositionEvent"in window,Fl=null;$n&&"documentMode"in document&&(Fl=document.documentMode);var oL=$n&&"TextEvent"in window&&!Fl,Oy=$n&&(!vf||Fl&&8<Fl&&11>=Fl),Dy=" ",_y=!1;function Py(a,l){switch(a){case"keyup":return aL.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ky(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var So=!1;function lL(a,l){switch(a){case"compositionend":return ky(l);case"keypress":return l.which!==32?null:(_y=!0,Dy);case"textInput":return a=l.data,a===Dy&&_y?null:a;default:return null}}function cL(a,l){if(So)return a==="compositionend"||!vf&&Py(a,l)?(a=Iy(),Au=ff=Tr=null,So=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return Oy&&l.locale!=="ko"?null:l.data;default:return null}}var uL={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ny(a){var l=a&&a.nodeName&&a.nodeName.toLowerCase();return l==="input"?!!uL[a.type]:l==="textarea"}function My(a,l,h,g){yo?vo?vo.push(g):vo=[g]:yo=g,l=md(l,"onChange"),0<l.length&&(h=new Lu("onChange","change",null,h,g),a.push({event:h,listeners:l}))}var Bl=null,jl=null;function dL(a){px(a,0)}function Cu(a){var l=Pl(a);if(yy(l))return a}function Uy(a,l){if(a==="change")return l}var Fy=!1;if($n){var Sf;if($n){var xf="oninput"in document;if(!xf){var By=document.createElement("div");By.setAttribute("oninput","return;"),xf=typeof By.oninput=="function"}Sf=xf}else Sf=!1;Fy=Sf&&(!document.documentMode||9<document.documentMode)}function jy(){Bl&&(Bl.detachEvent("onpropertychange",Vy),jl=Bl=null)}function Vy(a){if(a.propertyName==="value"&&Cu(jl)){var l=[];My(l,jl,a,uf(a)),Ay(dL,l)}}function hL(a,l,h){a==="focusin"?(jy(),Bl=l,jl=h,Bl.attachEvent("onpropertychange",Vy)):a==="focusout"&&jy()}function fL(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return Cu(jl)}function mL(a,l){if(a==="click")return Cu(l)}function gL(a,l){if(a==="input"||a==="change")return Cu(l)}function pL(a,l){return a===l&&(a!==0||1/a===1/l)||a!==a&&l!==l}var vi=typeof Object.is=="function"?Object.is:pL;function Vl(a,l){if(vi(a,l))return!0;if(typeof a!="object"||a===null||typeof l!="object"||l===null)return!1;var h=Object.keys(a),g=Object.keys(l);if(h.length!==g.length)return!1;for(g=0;g<h.length;g++){var x=h[g];if(!Ne.call(l,x)||!vi(a[x],l[x]))return!1}return!0}function $y(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function Gy(a,l){var h=$y(a);a=0;for(var g;h;){if(h.nodeType===3){if(g=a+h.textContent.length,a<=l&&g>=l)return{node:h,offset:l-a};a=g}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=$y(h)}}function Hy(a,l){return a&&l?a===l?!0:a&&a.nodeType===3?!1:l&&l.nodeType===3?Hy(a,l.parentNode):"contains"in a?a.contains(l):a.compareDocumentPosition?!!(a.compareDocumentPosition(l)&16):!1:!1}function zy(a){a=a!=null&&a.ownerDocument!=null&&a.ownerDocument.defaultView!=null?a.ownerDocument.defaultView:window;for(var l=Eu(a.document);l instanceof a.HTMLIFrameElement;){try{var h=typeof l.contentWindow.location.href=="string"}catch{h=!1}if(h)a=l.contentWindow;else break;l=Eu(a.document)}return l}function Tf(a){var l=a&&a.nodeName&&a.nodeName.toLowerCase();return l&&(l==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||l==="textarea"||a.contentEditable==="true")}var yL=$n&&"documentMode"in document&&11>=document.documentMode,xo=null,Ef=null,$l=null,bf=!1;function Ky(a,l,h){var g=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;bf||xo==null||xo!==Eu(g)||(g=xo,"selectionStart"in g&&Tf(g)?g={start:g.selectionStart,end:g.selectionEnd}:(g=(g.ownerDocument&&g.ownerDocument.defaultView||window).getSelection(),g={anchorNode:g.anchorNode,anchorOffset:g.anchorOffset,focusNode:g.focusNode,focusOffset:g.focusOffset}),$l&&Vl($l,g)||($l=g,g=md(Ef,"onSelect"),0<g.length&&(l=new Lu("onSelect","select",null,l,h),a.push({event:l,listeners:g}),l.target=xo)))}function ba(a,l){var h={};return h[a.toLowerCase()]=l.toLowerCase(),h["Webkit"+a]="webkit"+l,h["Moz"+a]="moz"+l,h}var To={animationend:ba("Animation","AnimationEnd"),animationiteration:ba("Animation","AnimationIteration"),animationstart:ba("Animation","AnimationStart"),transitionrun:ba("Transition","TransitionRun"),transitionstart:ba("Transition","TransitionStart"),transitioncancel:ba("Transition","TransitionCancel"),transitionend:ba("Transition","TransitionEnd")},Af={},Yy={};$n&&(Yy=document.createElement("div").style,"AnimationEvent"in window||(delete To.animationend.animation,delete To.animationiteration.animation,delete To.animationstart.animation),"TransitionEvent"in window||delete To.transitionend.transition);function Aa(a){if(Af[a])return Af[a];if(!To[a])return a;var l=To[a],h;for(h in l)if(l.hasOwnProperty(h)&&h in Yy)return Af[a]=l[h];return a}var qy=Aa("animationend"),Qy=Aa("animationiteration"),Xy=Aa("animationstart"),vL=Aa("transitionrun"),SL=Aa("transitionstart"),xL=Aa("transitioncancel"),Wy=Aa("transitionend"),Zy=new Map,If="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");If.push("scrollEnd");function Wi(a,l){Zy.set(a,l),Ta(l,[a])}var Jy=new WeakMap;function ki(a,l){if(typeof a=="object"&&a!==null){var h=Jy.get(a);return h!==void 0?h:(l={value:a,source:l,stack:gy(l)},Jy.set(a,l),l)}return{value:a,source:l,stack:gy(l)}}var Ni=[],Eo=0,Rf=0;function Ou(){for(var a=Eo,l=Rf=Eo=0;l<a;){var h=Ni[l];Ni[l++]=null;var g=Ni[l];Ni[l++]=null;var x=Ni[l];Ni[l++]=null;var b=Ni[l];if(Ni[l++]=null,g!==null&&x!==null){var O=g.pending;O===null?x.next=x:(x.next=O.next,O.next=x),g.pending=x}b!==0&&ev(h,x,b)}}function Du(a,l,h,g){Ni[Eo++]=a,Ni[Eo++]=l,Ni[Eo++]=h,Ni[Eo++]=g,Rf|=g,a.lanes|=g,a=a.alternate,a!==null&&(a.lanes|=g)}function Lf(a,l,h,g){return Du(a,l,h,g),_u(a)}function bo(a,l){return Du(a,null,null,l),_u(a)}function ev(a,l,h){a.lanes|=h;var g=a.alternate;g!==null&&(g.lanes|=h);for(var x=!1,b=a.return;b!==null;)b.childLanes|=h,g=b.alternate,g!==null&&(g.childLanes|=h),b.tag===22&&(a=b.stateNode,a===null||a._visibility&1||(x=!0)),a=b,b=b.return;return a.tag===3?(b=a.stateNode,x&&l!==null&&(x=31-St(h),a=b.hiddenUpdates,g=a[x],g===null?a[x]=[l]:g.push(l),l.lane=h|536870912),b):null}function _u(a){if(50<fc)throw fc=0,Pm=null,Error(s(185));for(var l=a.return;l!==null;)a=l,l=a.return;return a.tag===3?a.stateNode:null}var Ao={};function TL(a,l,h,g){this.tag=a,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Si(a,l,h,g){return new TL(a,l,h,g)}function wf(a){return a=a.prototype,!(!a||!a.isReactComponent)}function Gn(a,l){var h=a.alternate;return h===null?(h=Si(a.tag,l,a.key,a.mode),h.elementType=a.elementType,h.type=a.type,h.stateNode=a.stateNode,h.alternate=a,a.alternate=h):(h.pendingProps=l,h.type=a.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=a.flags&65011712,h.childLanes=a.childLanes,h.lanes=a.lanes,h.child=a.child,h.memoizedProps=a.memoizedProps,h.memoizedState=a.memoizedState,h.updateQueue=a.updateQueue,l=a.dependencies,h.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},h.sibling=a.sibling,h.index=a.index,h.ref=a.ref,h.refCleanup=a.refCleanup,h}function tv(a,l){a.flags&=65011714;var h=a.alternate;return h===null?(a.childLanes=0,a.lanes=l,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=h.childLanes,a.lanes=h.lanes,a.child=h.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=h.memoizedProps,a.memoizedState=h.memoizedState,a.updateQueue=h.updateQueue,a.type=h.type,l=h.dependencies,a.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),a}function Pu(a,l,h,g,x,b){var O=0;if(g=a,typeof a=="function")wf(a)&&(O=1);else if(typeof a=="string")O=bw(a,h,ue.current)?26:a==="html"||a==="head"||a==="body"?27:5;else e:switch(a){case U:return a=Si(31,h,l,x),a.elementType=U,a.lanes=b,a;case S:return Ia(h.children,x,b,l);case y:O=8,x|=24;break;case E:return a=Si(12,h,l,x|2),a.elementType=E,a.lanes=b,a;case L:return a=Si(13,h,l,x),a.elementType=L,a.lanes=b,a;case D:return a=Si(19,h,l,x),a.elementType=D,a.lanes=b,a;default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case A:case I:O=10;break e;case R:O=9;break e;case C:O=11;break e;case _:O=14;break e;case M:O=16,g=null;break e}O=29,h=Error(s(130,a===null?"null":typeof a,"")),g=null}return l=Si(O,h,l,x),l.elementType=a,l.type=g,l.lanes=b,l}function Ia(a,l,h,g){return a=Si(7,a,g,l),a.lanes=h,a}function Cf(a,l,h){return a=Si(6,a,null,l),a.lanes=h,a}function Of(a,l,h){return l=Si(4,a.children!==null?a.children:[],a.key,l),l.lanes=h,l.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},l}var Io=[],Ro=0,ku=null,Nu=0,Mi=[],Ui=0,Ra=null,Hn=1,zn="";function La(a,l){Io[Ro++]=Nu,Io[Ro++]=ku,ku=a,Nu=l}function sv(a,l,h){Mi[Ui++]=Hn,Mi[Ui++]=zn,Mi[Ui++]=Ra,Ra=a;var g=Hn;a=zn;var x=32-St(g)-1;g&=~(1<<x),h+=1;var b=32-St(l)+x;if(30<b){var O=x-x%5;b=(g&(1<<O)-1).toString(32),g>>=O,x-=O,Hn=1<<32-St(l)+x|h<<x|g,zn=b+a}else Hn=1<<b|h<<x|g,zn=a}function Df(a){a.return!==null&&(La(a,1),sv(a,1,0))}function _f(a){for(;a===ku;)ku=Io[--Ro],Io[Ro]=null,Nu=Io[--Ro],Io[Ro]=null;for(;a===Ra;)Ra=Mi[--Ui],Mi[Ui]=null,zn=Mi[--Ui],Mi[Ui]=null,Hn=Mi[--Ui],Mi[Ui]=null}var Zs=null,rs=null,Ct=!1,wa=null,mn=!1,Pf=Error(s(519));function Ca(a){var l=Error(s(418,""));throw zl(ki(l,a)),Pf}function iv(a){var l=a.stateNode,h=a.type,g=a.memoizedProps;switch(l[ls]=a,l[Is]=g,h){case"dialog":vt("cancel",l),vt("close",l);break;case"iframe":case"object":case"embed":vt("load",l);break;case"video":case"audio":for(h=0;h<gc.length;h++)vt(gc[h],l);break;case"source":vt("error",l);break;case"img":case"image":case"link":vt("error",l),vt("load",l);break;case"details":vt("toggle",l);break;case"input":vt("invalid",l),vy(l,g.value,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name,!0),Tu(l);break;case"select":vt("invalid",l);break;case"textarea":vt("invalid",l),xy(l,g.value,g.defaultValue,g.children),Tu(l)}h=g.children,typeof h!="string"&&typeof h!="number"&&typeof h!="bigint"||l.textContent===""+h||g.suppressHydrationWarning===!0||xx(l.textContent,h)?(g.popover!=null&&(vt("beforetoggle",l),vt("toggle",l)),g.onScroll!=null&&vt("scroll",l),g.onScrollEnd!=null&&vt("scrollend",l),g.onClick!=null&&(l.onclick=gd),l=!0):l=!1,l||Ca(a)}function nv(a){for(Zs=a.return;Zs;)switch(Zs.tag){case 5:case 13:mn=!1;return;case 27:case 3:mn=!0;return;default:Zs=Zs.return}}function Gl(a){if(a!==Zs)return!1;if(!Ct)return nv(a),Ct=!0,!1;var l=a.tag,h;if((h=l!==3&&l!==27)&&((h=l===5)&&(h=a.type,h=!(h!=="form"&&h!=="button")||Qm(a.type,a.memoizedProps)),h=!h),h&&rs&&Ca(a),nv(a),l===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(s(317));e:{for(a=a.nextSibling,l=0;a;){if(a.nodeType===8)if(h=a.data,h==="/$"){if(l===0){rs=Ji(a.nextSibling);break e}l--}else h!=="$"&&h!=="$!"&&h!=="$?"||l++;a=a.nextSibling}rs=null}}else l===27?(l=rs,Ur(a.type)?(a=Jm,Jm=null,rs=a):rs=l):rs=Zs?Ji(a.stateNode.nextSibling):null;return!0}function Hl(){rs=Zs=null,Ct=!1}function rv(){var a=wa;return a!==null&&(oi===null?oi=a:oi.push.apply(oi,a),wa=null),a}function zl(a){wa===null?wa=[a]:wa.push(a)}var kf=K(null),Oa=null,Kn=null;function Er(a,l,h){H(kf,l._currentValue),l._currentValue=h}function Yn(a){a._currentValue=kf.current,le(kf)}function Nf(a,l,h){for(;a!==null;){var g=a.alternate;if((a.childLanes&l)!==l?(a.childLanes|=l,g!==null&&(g.childLanes|=l)):g!==null&&(g.childLanes&l)!==l&&(g.childLanes|=l),a===h)break;a=a.return}}function Mf(a,l,h,g){var x=a.child;for(x!==null&&(x.return=a);x!==null;){var b=x.dependencies;if(b!==null){var O=x.child;b=b.firstContext;e:for(;b!==null;){var k=b;b=x;for(var $=0;$<l.length;$++)if(k.context===l[$]){b.lanes|=h,k=b.alternate,k!==null&&(k.lanes|=h),Nf(b.return,h,a),g||(O=null);break e}b=k.next}}else if(x.tag===18){if(O=x.return,O===null)throw Error(s(341));O.lanes|=h,b=O.alternate,b!==null&&(b.lanes|=h),Nf(O,h,a),O=null}else O=x.child;if(O!==null)O.return=x;else for(O=x;O!==null;){if(O===a){O=null;break}if(x=O.sibling,x!==null){x.return=O.return,O=x;break}O=O.return}x=O}}function Kl(a,l,h,g){a=null;for(var x=l,b=!1;x!==null;){if(!b){if((x.flags&524288)!==0)b=!0;else if((x.flags&262144)!==0)break}if(x.tag===10){var O=x.alternate;if(O===null)throw Error(s(387));if(O=O.memoizedProps,O!==null){var k=x.type;vi(x.pendingProps.value,O.value)||(a!==null?a.push(k):a=[k])}}else if(x===We.current){if(O=x.alternate,O===null)throw Error(s(387));O.memoizedState.memoizedState!==x.memoizedState.memoizedState&&(a!==null?a.push(Tc):a=[Tc])}x=x.return}a!==null&&Mf(l,a,h,g),l.flags|=262144}function Mu(a){for(a=a.firstContext;a!==null;){if(!vi(a.context._currentValue,a.memoizedValue))return!0;a=a.next}return!1}function Da(a){Oa=a,Kn=null,a=a.dependencies,a!==null&&(a.firstContext=null)}function Bs(a){return av(Oa,a)}function Uu(a,l){return Oa===null&&Da(a),av(a,l)}function av(a,l){var h=l._currentValue;if(l={context:l,memoizedValue:h,next:null},Kn===null){if(a===null)throw Error(s(308));Kn=l,a.dependencies={lanes:0,firstContext:l},a.flags|=524288}else Kn=Kn.next=l;return h}var EL=typeof AbortController<"u"?AbortController:function(){var a=[],l=this.signal={aborted:!1,addEventListener:function(h,g){a.push(g)}};this.abort=function(){l.aborted=!0,a.forEach(function(h){return h()})}},bL=i.unstable_scheduleCallback,AL=i.unstable_NormalPriority,ys={$$typeof:I,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Uf(){return{controller:new EL,data:new Map,refCount:0}}function Yl(a){a.refCount--,a.refCount===0&&bL(AL,function(){a.controller.abort()})}var ql=null,Ff=0,Lo=0,wo=null;function IL(a,l){if(ql===null){var h=ql=[];Ff=0,Lo=jm(),wo={status:"pending",value:void 0,then:function(g){h.push(g)}}}return Ff++,l.then(ov,ov),l}function ov(){if(--Ff===0&&ql!==null){wo!==null&&(wo.status="fulfilled");var a=ql;ql=null,Lo=0,wo=null;for(var l=0;l<a.length;l++)(0,a[l])()}}function RL(a,l){var h=[],g={status:"pending",value:null,reason:null,then:function(x){h.push(x)}};return a.then(function(){g.status="fulfilled",g.value=l;for(var x=0;x<h.length;x++)(0,h[x])(l)},function(x){for(g.status="rejected",g.reason=x,x=0;x<h.length;x++)(0,h[x])(void 0)}),g}var lv=B.S;B.S=function(a,l){typeof l=="object"&&l!==null&&typeof l.then=="function"&&IL(a,l),lv!==null&&lv(a,l)};var _a=K(null);function Bf(){var a=_a.current;return a!==null?a:Yt.pooledCache}function Fu(a,l){l===null?H(_a,_a.current):H(_a,l.pool)}function cv(){var a=Bf();return a===null?null:{parent:ys._currentValue,pool:a}}var Ql=Error(s(460)),uv=Error(s(474)),Bu=Error(s(542)),jf={then:function(){}};function dv(a){return a=a.status,a==="fulfilled"||a==="rejected"}function ju(){}function hv(a,l,h){switch(h=a[h],h===void 0?a.push(l):h!==l&&(l.then(ju,ju),l=h),l.status){case"fulfilled":return l.value;case"rejected":throw a=l.reason,mv(a),a;default:if(typeof l.status=="string")l.then(ju,ju);else{if(a=Yt,a!==null&&100<a.shellSuspendCounter)throw Error(s(482));a=l,a.status="pending",a.then(function(g){if(l.status==="pending"){var x=l;x.status="fulfilled",x.value=g}},function(g){if(l.status==="pending"){var x=l;x.status="rejected",x.reason=g}})}switch(l.status){case"fulfilled":return l.value;case"rejected":throw a=l.reason,mv(a),a}throw Xl=l,Ql}}var Xl=null;function fv(){if(Xl===null)throw Error(s(459));var a=Xl;return Xl=null,a}function mv(a){if(a===Ql||a===Bu)throw Error(s(483))}var br=!1;function Vf(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function $f(a,l){a=a.updateQueue,l.updateQueue===a&&(l.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,callbacks:null})}function Ar(a){return{lane:a,tag:0,payload:null,callback:null,next:null}}function Ir(a,l,h){var g=a.updateQueue;if(g===null)return null;if(g=g.shared,(Nt&2)!==0){var x=g.pending;return x===null?l.next=l:(l.next=x.next,x.next=l),g.pending=l,l=_u(a),ev(a,null,h),l}return Du(a,g,l,h),_u(a)}function Wl(a,l,h){if(l=l.updateQueue,l!==null&&(l=l.shared,(h&4194048)!==0)){var g=l.lanes;g&=a.pendingLanes,h|=g,l.lanes=h,Sa(a,h)}}function Gf(a,l){var h=a.updateQueue,g=a.alternate;if(g!==null&&(g=g.updateQueue,h===g)){var x=null,b=null;if(h=h.firstBaseUpdate,h!==null){do{var O={lane:h.lane,tag:h.tag,payload:h.payload,callback:null,next:null};b===null?x=b=O:b=b.next=O,h=h.next}while(h!==null);b===null?x=b=l:b=b.next=l}else x=b=l;h={baseState:g.baseState,firstBaseUpdate:x,lastBaseUpdate:b,shared:g.shared,callbacks:g.callbacks},a.updateQueue=h;return}a=h.lastBaseUpdate,a===null?h.firstBaseUpdate=l:a.next=l,h.lastBaseUpdate=l}var Hf=!1;function Zl(){if(Hf){var a=wo;if(a!==null)throw a}}function Jl(a,l,h,g){Hf=!1;var x=a.updateQueue;br=!1;var b=x.firstBaseUpdate,O=x.lastBaseUpdate,k=x.shared.pending;if(k!==null){x.shared.pending=null;var $=k,ie=$.next;$.next=null,O===null?b=ie:O.next=ie,O=$;var me=a.alternate;me!==null&&(me=me.updateQueue,k=me.lastBaseUpdate,k!==O&&(k===null?me.firstBaseUpdate=ie:k.next=ie,me.lastBaseUpdate=$))}if(b!==null){var ve=x.baseState;O=0,me=ie=$=null,k=b;do{var oe=k.lane&-536870913,ce=oe!==k.lane;if(ce?(At&oe)===oe:(g&oe)===oe){oe!==0&&oe===Lo&&(Hf=!0),me!==null&&(me=me.next={lane:0,tag:k.tag,payload:k.payload,callback:null,next:null});e:{var et=a,Xe=k;oe=l;var Vt=h;switch(Xe.tag){case 1:if(et=Xe.payload,typeof et=="function"){ve=et.call(Vt,ve,oe);break e}ve=et;break e;case 3:et.flags=et.flags&-65537|128;case 0:if(et=Xe.payload,oe=typeof et=="function"?et.call(Vt,ve,oe):et,oe==null)break e;ve=f({},ve,oe);break e;case 2:br=!0}}oe=k.callback,oe!==null&&(a.flags|=64,ce&&(a.flags|=8192),ce=x.callbacks,ce===null?x.callbacks=[oe]:ce.push(oe))}else ce={lane:oe,tag:k.tag,payload:k.payload,callback:k.callback,next:null},me===null?(ie=me=ce,$=ve):me=me.next=ce,O|=oe;if(k=k.next,k===null){if(k=x.shared.pending,k===null)break;ce=k,k=ce.next,ce.next=null,x.lastBaseUpdate=ce,x.shared.pending=null}}while(!0);me===null&&($=ve),x.baseState=$,x.firstBaseUpdate=ie,x.lastBaseUpdate=me,b===null&&(x.shared.lanes=0),Pr|=O,a.lanes=O,a.memoizedState=ve}}function gv(a,l){if(typeof a!="function")throw Error(s(191,a));a.call(l)}function pv(a,l){var h=a.callbacks;if(h!==null)for(a.callbacks=null,a=0;a<h.length;a++)gv(h[a],l)}var Co=K(null),Vu=K(0);function yv(a,l){a=er,H(Vu,a),H(Co,l),er=a|l.baseLanes}function zf(){H(Vu,er),H(Co,Co.current)}function Kf(){er=Vu.current,le(Co),le(Vu)}var Rr=0,ht=null,Bt=null,fs=null,$u=!1,Oo=!1,Pa=!1,Gu=0,ec=0,Do=null,LL=0;function cs(){throw Error(s(321))}function Yf(a,l){if(l===null)return!1;for(var h=0;h<l.length&&h<a.length;h++)if(!vi(a[h],l[h]))return!1;return!0}function qf(a,l,h,g,x,b){return Rr=b,ht=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,B.H=a===null||a.memoizedState===null?eS:tS,Pa=!1,b=h(g,x),Pa=!1,Oo&&(b=Sv(l,h,g,x)),vv(a),b}function vv(a){B.H=Qu;var l=Bt!==null&&Bt.next!==null;if(Rr=0,fs=Bt=ht=null,$u=!1,ec=0,Do=null,l)throw Error(s(300));a===null||Ls||(a=a.dependencies,a!==null&&Mu(a)&&(Ls=!0))}function Sv(a,l,h,g){ht=a;var x=0;do{if(Oo&&(Do=null),ec=0,Oo=!1,25<=x)throw Error(s(301));if(x+=1,fs=Bt=null,a.updateQueue!=null){var b=a.updateQueue;b.lastEffect=null,b.events=null,b.stores=null,b.memoCache!=null&&(b.memoCache.index=0)}B.H=kL,b=l(h,g)}while(Oo);return b}function wL(){var a=B.H,l=a.useState()[0];return l=typeof l.then=="function"?tc(l):l,a=a.useState()[0],(Bt!==null?Bt.memoizedState:null)!==a&&(ht.flags|=1024),l}function Qf(){var a=Gu!==0;return Gu=0,a}function Xf(a,l,h){l.updateQueue=a.updateQueue,l.flags&=-2053,a.lanes&=~h}function Wf(a){if($u){for(a=a.memoizedState;a!==null;){var l=a.queue;l!==null&&(l.pending=null),a=a.next}$u=!1}Rr=0,fs=Bt=ht=null,Oo=!1,ec=Gu=0,Do=null}function ri(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return fs===null?ht.memoizedState=fs=a:fs=fs.next=a,fs}function ms(){if(Bt===null){var a=ht.alternate;a=a!==null?a.memoizedState:null}else a=Bt.next;var l=fs===null?ht.memoizedState:fs.next;if(l!==null)fs=l,Bt=a;else{if(a===null)throw ht.alternate===null?Error(s(467)):Error(s(310));Bt=a,a={memoizedState:Bt.memoizedState,baseState:Bt.baseState,baseQueue:Bt.baseQueue,queue:Bt.queue,next:null},fs===null?ht.memoizedState=fs=a:fs=fs.next=a}return fs}function Zf(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function tc(a){var l=ec;return ec+=1,Do===null&&(Do=[]),a=hv(Do,a,l),l=ht,(fs===null?l.memoizedState:fs.next)===null&&(l=l.alternate,B.H=l===null||l.memoizedState===null?eS:tS),a}function Hu(a){if(a!==null&&typeof a=="object"){if(typeof a.then=="function")return tc(a);if(a.$$typeof===I)return Bs(a)}throw Error(s(438,String(a)))}function Jf(a){var l=null,h=ht.updateQueue;if(h!==null&&(l=h.memoCache),l==null){var g=ht.alternate;g!==null&&(g=g.updateQueue,g!==null&&(g=g.memoCache,g!=null&&(l={data:g.data.map(function(x){return x.slice()}),index:0})))}if(l==null&&(l={data:[],index:0}),h===null&&(h=Zf(),ht.updateQueue=h),h.memoCache=l,h=l.data[l.index],h===void 0)for(h=l.data[l.index]=Array(a),g=0;g<a;g++)h[g]=F;return l.index++,h}function qn(a,l){return typeof l=="function"?l(a):l}function zu(a){var l=ms();return em(l,Bt,a)}function em(a,l,h){var g=a.queue;if(g===null)throw Error(s(311));g.lastRenderedReducer=h;var x=a.baseQueue,b=g.pending;if(b!==null){if(x!==null){var O=x.next;x.next=b.next,b.next=O}l.baseQueue=x=b,g.pending=null}if(b=a.baseState,x===null)a.memoizedState=b;else{l=x.next;var k=O=null,$=null,ie=l,me=!1;do{var ve=ie.lane&-536870913;if(ve!==ie.lane?(At&ve)===ve:(Rr&ve)===ve){var oe=ie.revertLane;if(oe===0)$!==null&&($=$.next={lane:0,revertLane:0,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null}),ve===Lo&&(me=!0);else if((Rr&oe)===oe){ie=ie.next,oe===Lo&&(me=!0);continue}else ve={lane:0,revertLane:ie.revertLane,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null},$===null?(k=$=ve,O=b):$=$.next=ve,ht.lanes|=oe,Pr|=oe;ve=ie.action,Pa&&h(b,ve),b=ie.hasEagerState?ie.eagerState:h(b,ve)}else oe={lane:ve,revertLane:ie.revertLane,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null},$===null?(k=$=oe,O=b):$=$.next=oe,ht.lanes|=ve,Pr|=ve;ie=ie.next}while(ie!==null&&ie!==l);if($===null?O=b:$.next=k,!vi(b,a.memoizedState)&&(Ls=!0,me&&(h=wo,h!==null)))throw h;a.memoizedState=b,a.baseState=O,a.baseQueue=$,g.lastRenderedState=b}return x===null&&(g.lanes=0),[a.memoizedState,g.dispatch]}function tm(a){var l=ms(),h=l.queue;if(h===null)throw Error(s(311));h.lastRenderedReducer=a;var g=h.dispatch,x=h.pending,b=l.memoizedState;if(x!==null){h.pending=null;var O=x=x.next;do b=a(b,O.action),O=O.next;while(O!==x);vi(b,l.memoizedState)||(Ls=!0),l.memoizedState=b,l.baseQueue===null&&(l.baseState=b),h.lastRenderedState=b}return[b,g]}function xv(a,l,h){var g=ht,x=ms(),b=Ct;if(b){if(h===void 0)throw Error(s(407));h=h()}else h=l();var O=!vi((Bt||x).memoizedState,h);O&&(x.memoizedState=h,Ls=!0),x=x.queue;var k=bv.bind(null,g,x,a);if(sc(2048,8,k,[a]),x.getSnapshot!==l||O||fs!==null&&fs.memoizedState.tag&1){if(g.flags|=2048,_o(9,Ku(),Ev.bind(null,g,x,h,l),null),Yt===null)throw Error(s(349));b||(Rr&124)!==0||Tv(g,l,h)}return h}function Tv(a,l,h){a.flags|=16384,a={getSnapshot:l,value:h},l=ht.updateQueue,l===null?(l=Zf(),ht.updateQueue=l,l.stores=[a]):(h=l.stores,h===null?l.stores=[a]:h.push(a))}function Ev(a,l,h,g){l.value=h,l.getSnapshot=g,Av(l)&&Iv(a)}function bv(a,l,h){return h(function(){Av(l)&&Iv(a)})}function Av(a){var l=a.getSnapshot;a=a.value;try{var h=l();return!vi(a,h)}catch{return!0}}function Iv(a){var l=bo(a,2);l!==null&&Ai(l,a,2)}function sm(a){var l=ri();if(typeof a=="function"){var h=a;if(a=h(),Pa){$t(!0);try{h()}finally{$t(!1)}}}return l.memoizedState=l.baseState=a,l.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:qn,lastRenderedState:a},l}function Rv(a,l,h,g){return a.baseState=h,em(a,Bt,typeof g=="function"?g:qn)}function CL(a,l,h,g,x){if(qu(a))throw Error(s(485));if(a=l.action,a!==null){var b={payload:x,action:a,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(O){b.listeners.push(O)}};B.T!==null?h(!0):b.isTransition=!1,g(b),h=l.pending,h===null?(b.next=l.pending=b,Lv(l,b)):(b.next=h.next,l.pending=h.next=b)}}function Lv(a,l){var h=l.action,g=l.payload,x=a.state;if(l.isTransition){var b=B.T,O={};B.T=O;try{var k=h(x,g),$=B.S;$!==null&&$(O,k),wv(a,l,k)}catch(ie){im(a,l,ie)}finally{B.T=b}}else try{b=h(x,g),wv(a,l,b)}catch(ie){im(a,l,ie)}}function wv(a,l,h){h!==null&&typeof h=="object"&&typeof h.then=="function"?h.then(function(g){Cv(a,l,g)},function(g){return im(a,l,g)}):Cv(a,l,h)}function Cv(a,l,h){l.status="fulfilled",l.value=h,Ov(l),a.state=h,l=a.pending,l!==null&&(h=l.next,h===l?a.pending=null:(h=h.next,l.next=h,Lv(a,h)))}function im(a,l,h){var g=a.pending;if(a.pending=null,g!==null){g=g.next;do l.status="rejected",l.reason=h,Ov(l),l=l.next;while(l!==g)}a.action=null}function Ov(a){a=a.listeners;for(var l=0;l<a.length;l++)(0,a[l])()}function Dv(a,l){return l}function _v(a,l){if(Ct){var h=Yt.formState;if(h!==null){e:{var g=ht;if(Ct){if(rs){t:{for(var x=rs,b=mn;x.nodeType!==8;){if(!b){x=null;break t}if(x=Ji(x.nextSibling),x===null){x=null;break t}}b=x.data,x=b==="F!"||b==="F"?x:null}if(x){rs=Ji(x.nextSibling),g=x.data==="F!";break e}}Ca(g)}g=!1}g&&(l=h[0])}}return h=ri(),h.memoizedState=h.baseState=l,g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Dv,lastRenderedState:l},h.queue=g,h=Wv.bind(null,ht,g),g.dispatch=h,g=sm(!1),b=lm.bind(null,ht,!1,g.queue),g=ri(),x={state:l,dispatch:null,action:a,pending:null},g.queue=x,h=CL.bind(null,ht,x,b,h),x.dispatch=h,g.memoizedState=a,[l,h,!1]}function Pv(a){var l=ms();return kv(l,Bt,a)}function kv(a,l,h){if(l=em(a,l,Dv)[0],a=zu(qn)[0],typeof l=="object"&&l!==null&&typeof l.then=="function")try{var g=tc(l)}catch(O){throw O===Ql?Bu:O}else g=l;l=ms();var x=l.queue,b=x.dispatch;return h!==l.memoizedState&&(ht.flags|=2048,_o(9,Ku(),OL.bind(null,x,h),null)),[g,b,a]}function OL(a,l){a.action=l}function Nv(a){var l=ms(),h=Bt;if(h!==null)return kv(l,h,a);ms(),l=l.memoizedState,h=ms();var g=h.queue.dispatch;return h.memoizedState=a,[l,g,!1]}function _o(a,l,h,g){return a={tag:a,create:h,deps:g,inst:l,next:null},l=ht.updateQueue,l===null&&(l=Zf(),ht.updateQueue=l),h=l.lastEffect,h===null?l.lastEffect=a.next=a:(g=h.next,h.next=a,a.next=g,l.lastEffect=a),a}function Ku(){return{destroy:void 0,resource:void 0}}function Mv(){return ms().memoizedState}function Yu(a,l,h,g){var x=ri();g=g===void 0?null:g,ht.flags|=a,x.memoizedState=_o(1|l,Ku(),h,g)}function sc(a,l,h,g){var x=ms();g=g===void 0?null:g;var b=x.memoizedState.inst;Bt!==null&&g!==null&&Yf(g,Bt.memoizedState.deps)?x.memoizedState=_o(l,b,h,g):(ht.flags|=a,x.memoizedState=_o(1|l,b,h,g))}function Uv(a,l){Yu(8390656,8,a,l)}function Fv(a,l){sc(2048,8,a,l)}function Bv(a,l){return sc(4,2,a,l)}function jv(a,l){return sc(4,4,a,l)}function Vv(a,l){if(typeof l=="function"){a=a();var h=l(a);return function(){typeof h=="function"?h():l(null)}}if(l!=null)return a=a(),l.current=a,function(){l.current=null}}function $v(a,l,h){h=h!=null?h.concat([a]):null,sc(4,4,Vv.bind(null,l,a),h)}function nm(){}function Gv(a,l){var h=ms();l=l===void 0?null:l;var g=h.memoizedState;return l!==null&&Yf(l,g[1])?g[0]:(h.memoizedState=[a,l],a)}function Hv(a,l){var h=ms();l=l===void 0?null:l;var g=h.memoizedState;if(l!==null&&Yf(l,g[1]))return g[0];if(g=a(),Pa){$t(!0);try{a()}finally{$t(!1)}}return h.memoizedState=[g,l],g}function rm(a,l,h){return h===void 0||(Rr&1073741824)!==0?a.memoizedState=l:(a.memoizedState=h,a=YS(),ht.lanes|=a,Pr|=a,h)}function zv(a,l,h,g){return vi(h,l)?h:Co.current!==null?(a=rm(a,h,g),vi(a,l)||(Ls=!0),a):(Rr&42)===0?(Ls=!0,a.memoizedState=h):(a=YS(),ht.lanes|=a,Pr|=a,l)}function Kv(a,l,h,g,x){var b=Q.p;Q.p=b!==0&&8>b?b:8;var O=B.T,k={};B.T=k,lm(a,!1,l,h);try{var $=x(),ie=B.S;if(ie!==null&&ie(k,$),$!==null&&typeof $=="object"&&typeof $.then=="function"){var me=RL($,g);ic(a,l,me,bi(a))}else ic(a,l,g,bi(a))}catch(ve){ic(a,l,{then:function(){},status:"rejected",reason:ve},bi())}finally{Q.p=b,B.T=O}}function DL(){}function am(a,l,h,g){if(a.tag!==5)throw Error(s(476));var x=Yv(a).queue;Kv(a,x,l,re,h===null?DL:function(){return qv(a),h(g)})}function Yv(a){var l=a.memoizedState;if(l!==null)return l;l={memoizedState:re,baseState:re,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:qn,lastRenderedState:re},next:null};var h={};return l.next={memoizedState:h,baseState:h,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:qn,lastRenderedState:h},next:null},a.memoizedState=l,a=a.alternate,a!==null&&(a.memoizedState=l),l}function qv(a){var l=Yv(a).next.queue;ic(a,l,{},bi())}function om(){return Bs(Tc)}function Qv(){return ms().memoizedState}function Xv(){return ms().memoizedState}function _L(a){for(var l=a.return;l!==null;){switch(l.tag){case 24:case 3:var h=bi();a=Ar(h);var g=Ir(l,a,h);g!==null&&(Ai(g,l,h),Wl(g,l,h)),l={cache:Uf()},a.payload=l;return}l=l.return}}function PL(a,l,h){var g=bi();h={lane:g,revertLane:0,action:h,hasEagerState:!1,eagerState:null,next:null},qu(a)?Zv(l,h):(h=Lf(a,l,h,g),h!==null&&(Ai(h,a,g),Jv(h,l,g)))}function Wv(a,l,h){var g=bi();ic(a,l,h,g)}function ic(a,l,h,g){var x={lane:g,revertLane:0,action:h,hasEagerState:!1,eagerState:null,next:null};if(qu(a))Zv(l,x);else{var b=a.alternate;if(a.lanes===0&&(b===null||b.lanes===0)&&(b=l.lastRenderedReducer,b!==null))try{var O=l.lastRenderedState,k=b(O,h);if(x.hasEagerState=!0,x.eagerState=k,vi(k,O))return Du(a,l,x,0),Yt===null&&Ou(),!1}catch{}finally{}if(h=Lf(a,l,x,g),h!==null)return Ai(h,a,g),Jv(h,l,g),!0}return!1}function lm(a,l,h,g){if(g={lane:2,revertLane:jm(),action:g,hasEagerState:!1,eagerState:null,next:null},qu(a)){if(l)throw Error(s(479))}else l=Lf(a,h,g,2),l!==null&&Ai(l,a,2)}function qu(a){var l=a.alternate;return a===ht||l!==null&&l===ht}function Zv(a,l){Oo=$u=!0;var h=a.pending;h===null?l.next=l:(l.next=h.next,h.next=l),a.pending=l}function Jv(a,l,h){if((h&4194048)!==0){var g=l.lanes;g&=a.pendingLanes,h|=g,l.lanes=h,Sa(a,h)}}var Qu={readContext:Bs,use:Hu,useCallback:cs,useContext:cs,useEffect:cs,useImperativeHandle:cs,useLayoutEffect:cs,useInsertionEffect:cs,useMemo:cs,useReducer:cs,useRef:cs,useState:cs,useDebugValue:cs,useDeferredValue:cs,useTransition:cs,useSyncExternalStore:cs,useId:cs,useHostTransitionStatus:cs,useFormState:cs,useActionState:cs,useOptimistic:cs,useMemoCache:cs,useCacheRefresh:cs},eS={readContext:Bs,use:Hu,useCallback:function(a,l){return ri().memoizedState=[a,l===void 0?null:l],a},useContext:Bs,useEffect:Uv,useImperativeHandle:function(a,l,h){h=h!=null?h.concat([a]):null,Yu(4194308,4,Vv.bind(null,l,a),h)},useLayoutEffect:function(a,l){return Yu(4194308,4,a,l)},useInsertionEffect:function(a,l){Yu(4,2,a,l)},useMemo:function(a,l){var h=ri();l=l===void 0?null:l;var g=a();if(Pa){$t(!0);try{a()}finally{$t(!1)}}return h.memoizedState=[g,l],g},useReducer:function(a,l,h){var g=ri();if(h!==void 0){var x=h(l);if(Pa){$t(!0);try{h(l)}finally{$t(!1)}}}else x=l;return g.memoizedState=g.baseState=x,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:x},g.queue=a,a=a.dispatch=PL.bind(null,ht,a),[g.memoizedState,a]},useRef:function(a){var l=ri();return a={current:a},l.memoizedState=a},useState:function(a){a=sm(a);var l=a.queue,h=Wv.bind(null,ht,l);return l.dispatch=h,[a.memoizedState,h]},useDebugValue:nm,useDeferredValue:function(a,l){var h=ri();return rm(h,a,l)},useTransition:function(){var a=sm(!1);return a=Kv.bind(null,ht,a.queue,!0,!1),ri().memoizedState=a,[!1,a]},useSyncExternalStore:function(a,l,h){var g=ht,x=ri();if(Ct){if(h===void 0)throw Error(s(407));h=h()}else{if(h=l(),Yt===null)throw Error(s(349));(At&124)!==0||Tv(g,l,h)}x.memoizedState=h;var b={value:h,getSnapshot:l};return x.queue=b,Uv(bv.bind(null,g,b,a),[a]),g.flags|=2048,_o(9,Ku(),Ev.bind(null,g,b,h,l),null),h},useId:function(){var a=ri(),l=Yt.identifierPrefix;if(Ct){var h=zn,g=Hn;h=(g&~(1<<32-St(g)-1)).toString(32)+h,l=""+l+"R"+h,h=Gu++,0<h&&(l+="H"+h.toString(32)),l+=""}else h=LL++,l=""+l+"r"+h.toString(32)+"";return a.memoizedState=l},useHostTransitionStatus:om,useFormState:_v,useActionState:_v,useOptimistic:function(a){var l=ri();l.memoizedState=l.baseState=a;var h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return l.queue=h,l=lm.bind(null,ht,!0,h),h.dispatch=l,[a,l]},useMemoCache:Jf,useCacheRefresh:function(){return ri().memoizedState=_L.bind(null,ht)}},tS={readContext:Bs,use:Hu,useCallback:Gv,useContext:Bs,useEffect:Fv,useImperativeHandle:$v,useInsertionEffect:Bv,useLayoutEffect:jv,useMemo:Hv,useReducer:zu,useRef:Mv,useState:function(){return zu(qn)},useDebugValue:nm,useDeferredValue:function(a,l){var h=ms();return zv(h,Bt.memoizedState,a,l)},useTransition:function(){var a=zu(qn)[0],l=ms().memoizedState;return[typeof a=="boolean"?a:tc(a),l]},useSyncExternalStore:xv,useId:Qv,useHostTransitionStatus:om,useFormState:Pv,useActionState:Pv,useOptimistic:function(a,l){var h=ms();return Rv(h,Bt,a,l)},useMemoCache:Jf,useCacheRefresh:Xv},kL={readContext:Bs,use:Hu,useCallback:Gv,useContext:Bs,useEffect:Fv,useImperativeHandle:$v,useInsertionEffect:Bv,useLayoutEffect:jv,useMemo:Hv,useReducer:tm,useRef:Mv,useState:function(){return tm(qn)},useDebugValue:nm,useDeferredValue:function(a,l){var h=ms();return Bt===null?rm(h,a,l):zv(h,Bt.memoizedState,a,l)},useTransition:function(){var a=tm(qn)[0],l=ms().memoizedState;return[typeof a=="boolean"?a:tc(a),l]},useSyncExternalStore:xv,useId:Qv,useHostTransitionStatus:om,useFormState:Nv,useActionState:Nv,useOptimistic:function(a,l){var h=ms();return Bt!==null?Rv(h,Bt,a,l):(h.baseState=a,[a,h.queue.dispatch])},useMemoCache:Jf,useCacheRefresh:Xv},Po=null,nc=0;function Xu(a){var l=nc;return nc+=1,Po===null&&(Po=[]),hv(Po,a,l)}function rc(a,l){l=l.props.ref,a.ref=l!==void 0?l:null}function Wu(a,l){throw l.$$typeof===m?Error(s(525)):(a=Object.prototype.toString.call(l),Error(s(31,a==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":a)))}function sS(a){var l=a._init;return l(a._payload)}function iS(a){function l(X,Y){if(a){var te=X.deletions;te===null?(X.deletions=[Y],X.flags|=16):te.push(Y)}}function h(X,Y){if(!a)return null;for(;Y!==null;)l(X,Y),Y=Y.sibling;return null}function g(X){for(var Y=new Map;X!==null;)X.key!==null?Y.set(X.key,X):Y.set(X.index,X),X=X.sibling;return Y}function x(X,Y){return X=Gn(X,Y),X.index=0,X.sibling=null,X}function b(X,Y,te){return X.index=te,a?(te=X.alternate,te!==null?(te=te.index,te<Y?(X.flags|=67108866,Y):te):(X.flags|=67108866,Y)):(X.flags|=1048576,Y)}function O(X){return a&&X.alternate===null&&(X.flags|=67108866),X}function k(X,Y,te,ye){return Y===null||Y.tag!==6?(Y=Cf(te,X.mode,ye),Y.return=X,Y):(Y=x(Y,te),Y.return=X,Y)}function $(X,Y,te,ye){var Ge=te.type;return Ge===S?me(X,Y,te.props.children,ye,te.key):Y!==null&&(Y.elementType===Ge||typeof Ge=="object"&&Ge!==null&&Ge.$$typeof===M&&sS(Ge)===Y.type)?(Y=x(Y,te.props),rc(Y,te),Y.return=X,Y):(Y=Pu(te.type,te.key,te.props,null,X.mode,ye),rc(Y,te),Y.return=X,Y)}function ie(X,Y,te,ye){return Y===null||Y.tag!==4||Y.stateNode.containerInfo!==te.containerInfo||Y.stateNode.implementation!==te.implementation?(Y=Of(te,X.mode,ye),Y.return=X,Y):(Y=x(Y,te.children||[]),Y.return=X,Y)}function me(X,Y,te,ye,Ge){return Y===null||Y.tag!==7?(Y=Ia(te,X.mode,ye,Ge),Y.return=X,Y):(Y=x(Y,te),Y.return=X,Y)}function ve(X,Y,te){if(typeof Y=="string"&&Y!==""||typeof Y=="number"||typeof Y=="bigint")return Y=Cf(""+Y,X.mode,te),Y.return=X,Y;if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case p:return te=Pu(Y.type,Y.key,Y.props,null,X.mode,te),rc(te,Y),te.return=X,te;case v:return Y=Of(Y,X.mode,te),Y.return=X,Y;case M:var ye=Y._init;return Y=ye(Y._payload),ve(X,Y,te)}if(Z(Y)||V(Y))return Y=Ia(Y,X.mode,te,null),Y.return=X,Y;if(typeof Y.then=="function")return ve(X,Xu(Y),te);if(Y.$$typeof===I)return ve(X,Uu(X,Y),te);Wu(X,Y)}return null}function oe(X,Y,te,ye){var Ge=Y!==null?Y.key:null;if(typeof te=="string"&&te!==""||typeof te=="number"||typeof te=="bigint")return Ge!==null?null:k(X,Y,""+te,ye);if(typeof te=="object"&&te!==null){switch(te.$$typeof){case p:return te.key===Ge?$(X,Y,te,ye):null;case v:return te.key===Ge?ie(X,Y,te,ye):null;case M:return Ge=te._init,te=Ge(te._payload),oe(X,Y,te,ye)}if(Z(te)||V(te))return Ge!==null?null:me(X,Y,te,ye,null);if(typeof te.then=="function")return oe(X,Y,Xu(te),ye);if(te.$$typeof===I)return oe(X,Y,Uu(X,te),ye);Wu(X,te)}return null}function ce(X,Y,te,ye,Ge){if(typeof ye=="string"&&ye!==""||typeof ye=="number"||typeof ye=="bigint")return X=X.get(te)||null,k(Y,X,""+ye,Ge);if(typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case p:return X=X.get(ye.key===null?te:ye.key)||null,$(Y,X,ye,Ge);case v:return X=X.get(ye.key===null?te:ye.key)||null,ie(Y,X,ye,Ge);case M:var mt=ye._init;return ye=mt(ye._payload),ce(X,Y,te,ye,Ge)}if(Z(ye)||V(ye))return X=X.get(te)||null,me(Y,X,ye,Ge,null);if(typeof ye.then=="function")return ce(X,Y,te,Xu(ye),Ge);if(ye.$$typeof===I)return ce(X,Y,te,Uu(Y,ye),Ge);Wu(Y,ye)}return null}function et(X,Y,te,ye){for(var Ge=null,mt=null,Ye=Y,Ze=Y=0,Cs=null;Ye!==null&&Ze<te.length;Ze++){Ye.index>Ze?(Cs=Ye,Ye=null):Cs=Ye.sibling;var Lt=oe(X,Ye,te[Ze],ye);if(Lt===null){Ye===null&&(Ye=Cs);break}a&&Ye&&Lt.alternate===null&&l(X,Ye),Y=b(Lt,Y,Ze),mt===null?Ge=Lt:mt.sibling=Lt,mt=Lt,Ye=Cs}if(Ze===te.length)return h(X,Ye),Ct&&La(X,Ze),Ge;if(Ye===null){for(;Ze<te.length;Ze++)Ye=ve(X,te[Ze],ye),Ye!==null&&(Y=b(Ye,Y,Ze),mt===null?Ge=Ye:mt.sibling=Ye,mt=Ye);return Ct&&La(X,Ze),Ge}for(Ye=g(Ye);Ze<te.length;Ze++)Cs=ce(Ye,X,Ze,te[Ze],ye),Cs!==null&&(a&&Cs.alternate!==null&&Ye.delete(Cs.key===null?Ze:Cs.key),Y=b(Cs,Y,Ze),mt===null?Ge=Cs:mt.sibling=Cs,mt=Cs);return a&&Ye.forEach(function($r){return l(X,$r)}),Ct&&La(X,Ze),Ge}function Xe(X,Y,te,ye){if(te==null)throw Error(s(151));for(var Ge=null,mt=null,Ye=Y,Ze=Y=0,Cs=null,Lt=te.next();Ye!==null&&!Lt.done;Ze++,Lt=te.next()){Ye.index>Ze?(Cs=Ye,Ye=null):Cs=Ye.sibling;var $r=oe(X,Ye,Lt.value,ye);if($r===null){Ye===null&&(Ye=Cs);break}a&&Ye&&$r.alternate===null&&l(X,Ye),Y=b($r,Y,Ze),mt===null?Ge=$r:mt.sibling=$r,mt=$r,Ye=Cs}if(Lt.done)return h(X,Ye),Ct&&La(X,Ze),Ge;if(Ye===null){for(;!Lt.done;Ze++,Lt=te.next())Lt=ve(X,Lt.value,ye),Lt!==null&&(Y=b(Lt,Y,Ze),mt===null?Ge=Lt:mt.sibling=Lt,mt=Lt);return Ct&&La(X,Ze),Ge}for(Ye=g(Ye);!Lt.done;Ze++,Lt=te.next())Lt=ce(Ye,X,Ze,Lt.value,ye),Lt!==null&&(a&&Lt.alternate!==null&&Ye.delete(Lt.key===null?Ze:Lt.key),Y=b(Lt,Y,Ze),mt===null?Ge=Lt:mt.sibling=Lt,mt=Lt);return a&&Ye.forEach(function(Nw){return l(X,Nw)}),Ct&&La(X,Ze),Ge}function Vt(X,Y,te,ye){if(typeof te=="object"&&te!==null&&te.type===S&&te.key===null&&(te=te.props.children),typeof te=="object"&&te!==null){switch(te.$$typeof){case p:e:{for(var Ge=te.key;Y!==null;){if(Y.key===Ge){if(Ge=te.type,Ge===S){if(Y.tag===7){h(X,Y.sibling),ye=x(Y,te.props.children),ye.return=X,X=ye;break e}}else if(Y.elementType===Ge||typeof Ge=="object"&&Ge!==null&&Ge.$$typeof===M&&sS(Ge)===Y.type){h(X,Y.sibling),ye=x(Y,te.props),rc(ye,te),ye.return=X,X=ye;break e}h(X,Y);break}else l(X,Y);Y=Y.sibling}te.type===S?(ye=Ia(te.props.children,X.mode,ye,te.key),ye.return=X,X=ye):(ye=Pu(te.type,te.key,te.props,null,X.mode,ye),rc(ye,te),ye.return=X,X=ye)}return O(X);case v:e:{for(Ge=te.key;Y!==null;){if(Y.key===Ge)if(Y.tag===4&&Y.stateNode.containerInfo===te.containerInfo&&Y.stateNode.implementation===te.implementation){h(X,Y.sibling),ye=x(Y,te.children||[]),ye.return=X,X=ye;break e}else{h(X,Y);break}else l(X,Y);Y=Y.sibling}ye=Of(te,X.mode,ye),ye.return=X,X=ye}return O(X);case M:return Ge=te._init,te=Ge(te._payload),Vt(X,Y,te,ye)}if(Z(te))return et(X,Y,te,ye);if(V(te)){if(Ge=V(te),typeof Ge!="function")throw Error(s(150));return te=Ge.call(te),Xe(X,Y,te,ye)}if(typeof te.then=="function")return Vt(X,Y,Xu(te),ye);if(te.$$typeof===I)return Vt(X,Y,Uu(X,te),ye);Wu(X,te)}return typeof te=="string"&&te!==""||typeof te=="number"||typeof te=="bigint"?(te=""+te,Y!==null&&Y.tag===6?(h(X,Y.sibling),ye=x(Y,te),ye.return=X,X=ye):(h(X,Y),ye=Cf(te,X.mode,ye),ye.return=X,X=ye),O(X)):h(X,Y)}return function(X,Y,te,ye){try{nc=0;var Ge=Vt(X,Y,te,ye);return Po=null,Ge}catch(Ye){if(Ye===Ql||Ye===Bu)throw Ye;var mt=Si(29,Ye,null,X.mode);return mt.lanes=ye,mt.return=X,mt}finally{}}}var ko=iS(!0),nS=iS(!1),Fi=K(null),gn=null;function Lr(a){var l=a.alternate;H(vs,vs.current&1),H(Fi,a),gn===null&&(l===null||Co.current!==null||l.memoizedState!==null)&&(gn=a)}function rS(a){if(a.tag===22){if(H(vs,vs.current),H(Fi,a),gn===null){var l=a.alternate;l!==null&&l.memoizedState!==null&&(gn=a)}}else wr()}function wr(){H(vs,vs.current),H(Fi,Fi.current)}function Qn(a){le(Fi),gn===a&&(gn=null),le(vs)}var vs=K(0);function Zu(a){for(var l=a;l!==null;){if(l.tag===13){var h=l.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||h.data==="$?"||Zm(h)))return l}else if(l.tag===19&&l.memoizedProps.revealOrder!==void 0){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===a)break;for(;l.sibling===null;){if(l.return===null||l.return===a)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}function cm(a,l,h,g){l=a.memoizedState,h=h(g,l),h=h==null?l:f({},l,h),a.memoizedState=h,a.lanes===0&&(a.updateQueue.baseState=h)}var um={enqueueSetState:function(a,l,h){a=a._reactInternals;var g=bi(),x=Ar(g);x.payload=l,h!=null&&(x.callback=h),l=Ir(a,x,g),l!==null&&(Ai(l,a,g),Wl(l,a,g))},enqueueReplaceState:function(a,l,h){a=a._reactInternals;var g=bi(),x=Ar(g);x.tag=1,x.payload=l,h!=null&&(x.callback=h),l=Ir(a,x,g),l!==null&&(Ai(l,a,g),Wl(l,a,g))},enqueueForceUpdate:function(a,l){a=a._reactInternals;var h=bi(),g=Ar(h);g.tag=2,l!=null&&(g.callback=l),l=Ir(a,g,h),l!==null&&(Ai(l,a,h),Wl(l,a,h))}};function aS(a,l,h,g,x,b,O){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(g,b,O):l.prototype&&l.prototype.isPureReactComponent?!Vl(h,g)||!Vl(x,b):!0}function oS(a,l,h,g){a=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(h,g),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(h,g),l.state!==a&&um.enqueueReplaceState(l,l.state,null)}function ka(a,l){var h=l;if("ref"in l){h={};for(var g in l)g!=="ref"&&(h[g]=l[g])}if(a=a.defaultProps){h===l&&(h=f({},h));for(var x in a)h[x]===void 0&&(h[x]=a[x])}return h}var Ju=typeof reportError=="function"?reportError:function(a){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var l=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof a=="object"&&a!==null&&typeof a.message=="string"?String(a.message):String(a),error:a});if(!window.dispatchEvent(l))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",a);return}console.error(a)};function lS(a){Ju(a)}function cS(a){console.error(a)}function uS(a){Ju(a)}function ed(a,l){try{var h=a.onUncaughtError;h(l.value,{componentStack:l.stack})}catch(g){setTimeout(function(){throw g})}}function dS(a,l,h){try{var g=a.onCaughtError;g(h.value,{componentStack:h.stack,errorBoundary:l.tag===1?l.stateNode:null})}catch(x){setTimeout(function(){throw x})}}function dm(a,l,h){return h=Ar(h),h.tag=3,h.payload={element:null},h.callback=function(){ed(a,l)},h}function hS(a){return a=Ar(a),a.tag=3,a}function fS(a,l,h,g){var x=h.type.getDerivedStateFromError;if(typeof x=="function"){var b=g.value;a.payload=function(){return x(b)},a.callback=function(){dS(l,h,g)}}var O=h.stateNode;O!==null&&typeof O.componentDidCatch=="function"&&(a.callback=function(){dS(l,h,g),typeof x!="function"&&(kr===null?kr=new Set([this]):kr.add(this));var k=g.stack;this.componentDidCatch(g.value,{componentStack:k!==null?k:""})})}function NL(a,l,h,g,x){if(h.flags|=32768,g!==null&&typeof g=="object"&&typeof g.then=="function"){if(l=h.alternate,l!==null&&Kl(l,h,x,!0),h=Fi.current,h!==null){switch(h.tag){case 13:return gn===null?Nm():h.alternate===null&&as===0&&(as=3),h.flags&=-257,h.flags|=65536,h.lanes=x,g===jf?h.flags|=16384:(l=h.updateQueue,l===null?h.updateQueue=new Set([g]):l.add(g),Um(a,g,x)),!1;case 22:return h.flags|=65536,g===jf?h.flags|=16384:(l=h.updateQueue,l===null?(l={transitions:null,markerInstances:null,retryQueue:new Set([g])},h.updateQueue=l):(h=l.retryQueue,h===null?l.retryQueue=new Set([g]):h.add(g)),Um(a,g,x)),!1}throw Error(s(435,h.tag))}return Um(a,g,x),Nm(),!1}if(Ct)return l=Fi.current,l!==null?((l.flags&65536)===0&&(l.flags|=256),l.flags|=65536,l.lanes=x,g!==Pf&&(a=Error(s(422),{cause:g}),zl(ki(a,h)))):(g!==Pf&&(l=Error(s(423),{cause:g}),zl(ki(l,h))),a=a.current.alternate,a.flags|=65536,x&=-x,a.lanes|=x,g=ki(g,h),x=dm(a.stateNode,g,x),Gf(a,x),as!==4&&(as=2)),!1;var b=Error(s(520),{cause:g});if(b=ki(b,h),hc===null?hc=[b]:hc.push(b),as!==4&&(as=2),l===null)return!0;g=ki(g,h),h=l;do{switch(h.tag){case 3:return h.flags|=65536,a=x&-x,h.lanes|=a,a=dm(h.stateNode,g,a),Gf(h,a),!1;case 1:if(l=h.type,b=h.stateNode,(h.flags&128)===0&&(typeof l.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(kr===null||!kr.has(b))))return h.flags|=65536,x&=-x,h.lanes|=x,x=hS(x),fS(x,a,h,g),Gf(h,x),!1}h=h.return}while(h!==null);return!1}var mS=Error(s(461)),Ls=!1;function ks(a,l,h,g){l.child=a===null?nS(l,null,h,g):ko(l,a.child,h,g)}function gS(a,l,h,g,x){h=h.render;var b=l.ref;if("ref"in g){var O={};for(var k in g)k!=="ref"&&(O[k]=g[k])}else O=g;return Da(l),g=qf(a,l,h,O,b,x),k=Qf(),a!==null&&!Ls?(Xf(a,l,x),Xn(a,l,x)):(Ct&&k&&Df(l),l.flags|=1,ks(a,l,g,x),l.child)}function pS(a,l,h,g,x){if(a===null){var b=h.type;return typeof b=="function"&&!wf(b)&&b.defaultProps===void 0&&h.compare===null?(l.tag=15,l.type=b,yS(a,l,b,g,x)):(a=Pu(h.type,null,g,l,l.mode,x),a.ref=l.ref,a.return=l,l.child=a)}if(b=a.child,!Sm(a,x)){var O=b.memoizedProps;if(h=h.compare,h=h!==null?h:Vl,h(O,g)&&a.ref===l.ref)return Xn(a,l,x)}return l.flags|=1,a=Gn(b,g),a.ref=l.ref,a.return=l,l.child=a}function yS(a,l,h,g,x){if(a!==null){var b=a.memoizedProps;if(Vl(b,g)&&a.ref===l.ref)if(Ls=!1,l.pendingProps=g=b,Sm(a,x))(a.flags&131072)!==0&&(Ls=!0);else return l.lanes=a.lanes,Xn(a,l,x)}return hm(a,l,h,g,x)}function vS(a,l,h){var g=l.pendingProps,x=g.children,b=a!==null?a.memoizedState:null;if(g.mode==="hidden"){if((l.flags&128)!==0){if(g=b!==null?b.baseLanes|h:h,a!==null){for(x=l.child=a.child,b=0;x!==null;)b=b|x.lanes|x.childLanes,x=x.sibling;l.childLanes=b&~g}else l.childLanes=0,l.child=null;return SS(a,l,g,h)}if((h&536870912)!==0)l.memoizedState={baseLanes:0,cachePool:null},a!==null&&Fu(l,b!==null?b.cachePool:null),b!==null?yv(l,b):zf(),rS(l);else return l.lanes=l.childLanes=536870912,SS(a,l,b!==null?b.baseLanes|h:h,h)}else b!==null?(Fu(l,b.cachePool),yv(l,b),wr(),l.memoizedState=null):(a!==null&&Fu(l,null),zf(),wr());return ks(a,l,x,h),l.child}function SS(a,l,h,g){var x=Bf();return x=x===null?null:{parent:ys._currentValue,pool:x},l.memoizedState={baseLanes:h,cachePool:x},a!==null&&Fu(l,null),zf(),rS(l),a!==null&&Kl(a,l,g,!0),null}function td(a,l){var h=l.ref;if(h===null)a!==null&&a.ref!==null&&(l.flags|=4194816);else{if(typeof h!="function"&&typeof h!="object")throw Error(s(284));(a===null||a.ref!==h)&&(l.flags|=4194816)}}function hm(a,l,h,g,x){return Da(l),h=qf(a,l,h,g,void 0,x),g=Qf(),a!==null&&!Ls?(Xf(a,l,x),Xn(a,l,x)):(Ct&&g&&Df(l),l.flags|=1,ks(a,l,h,x),l.child)}function xS(a,l,h,g,x,b){return Da(l),l.updateQueue=null,h=Sv(l,g,h,x),vv(a),g=Qf(),a!==null&&!Ls?(Xf(a,l,b),Xn(a,l,b)):(Ct&&g&&Df(l),l.flags|=1,ks(a,l,h,b),l.child)}function TS(a,l,h,g,x){if(Da(l),l.stateNode===null){var b=Ao,O=h.contextType;typeof O=="object"&&O!==null&&(b=Bs(O)),b=new h(g,b),l.memoizedState=b.state!==null&&b.state!==void 0?b.state:null,b.updater=um,l.stateNode=b,b._reactInternals=l,b=l.stateNode,b.props=g,b.state=l.memoizedState,b.refs={},Vf(l),O=h.contextType,b.context=typeof O=="object"&&O!==null?Bs(O):Ao,b.state=l.memoizedState,O=h.getDerivedStateFromProps,typeof O=="function"&&(cm(l,h,O,g),b.state=l.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof b.getSnapshotBeforeUpdate=="function"||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(O=b.state,typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount(),O!==b.state&&um.enqueueReplaceState(b,b.state,null),Jl(l,g,b,x),Zl(),b.state=l.memoizedState),typeof b.componentDidMount=="function"&&(l.flags|=4194308),g=!0}else if(a===null){b=l.stateNode;var k=l.memoizedProps,$=ka(h,k);b.props=$;var ie=b.context,me=h.contextType;O=Ao,typeof me=="object"&&me!==null&&(O=Bs(me));var ve=h.getDerivedStateFromProps;me=typeof ve=="function"||typeof b.getSnapshotBeforeUpdate=="function",k=l.pendingProps!==k,me||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(k||ie!==O)&&oS(l,b,g,O),br=!1;var oe=l.memoizedState;b.state=oe,Jl(l,g,b,x),Zl(),ie=l.memoizedState,k||oe!==ie||br?(typeof ve=="function"&&(cm(l,h,ve,g),ie=l.memoizedState),($=br||aS(l,h,$,g,oe,ie,O))?(me||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount()),typeof b.componentDidMount=="function"&&(l.flags|=4194308)):(typeof b.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=g,l.memoizedState=ie),b.props=g,b.state=ie,b.context=O,g=$):(typeof b.componentDidMount=="function"&&(l.flags|=4194308),g=!1)}else{b=l.stateNode,$f(a,l),O=l.memoizedProps,me=ka(h,O),b.props=me,ve=l.pendingProps,oe=b.context,ie=h.contextType,$=Ao,typeof ie=="object"&&ie!==null&&($=Bs(ie)),k=h.getDerivedStateFromProps,(ie=typeof k=="function"||typeof b.getSnapshotBeforeUpdate=="function")||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(O!==ve||oe!==$)&&oS(l,b,g,$),br=!1,oe=l.memoizedState,b.state=oe,Jl(l,g,b,x),Zl();var ce=l.memoizedState;O!==ve||oe!==ce||br||a!==null&&a.dependencies!==null&&Mu(a.dependencies)?(typeof k=="function"&&(cm(l,h,k,g),ce=l.memoizedState),(me=br||aS(l,h,me,g,oe,ce,$)||a!==null&&a.dependencies!==null&&Mu(a.dependencies))?(ie||typeof b.UNSAFE_componentWillUpdate!="function"&&typeof b.componentWillUpdate!="function"||(typeof b.componentWillUpdate=="function"&&b.componentWillUpdate(g,ce,$),typeof b.UNSAFE_componentWillUpdate=="function"&&b.UNSAFE_componentWillUpdate(g,ce,$)),typeof b.componentDidUpdate=="function"&&(l.flags|=4),typeof b.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof b.componentDidUpdate!="function"||O===a.memoizedProps&&oe===a.memoizedState||(l.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||O===a.memoizedProps&&oe===a.memoizedState||(l.flags|=1024),l.memoizedProps=g,l.memoizedState=ce),b.props=g,b.state=ce,b.context=$,g=me):(typeof b.componentDidUpdate!="function"||O===a.memoizedProps&&oe===a.memoizedState||(l.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||O===a.memoizedProps&&oe===a.memoizedState||(l.flags|=1024),g=!1)}return b=g,td(a,l),g=(l.flags&128)!==0,b||g?(b=l.stateNode,h=g&&typeof h.getDerivedStateFromError!="function"?null:b.render(),l.flags|=1,a!==null&&g?(l.child=ko(l,a.child,null,x),l.child=ko(l,null,h,x)):ks(a,l,h,x),l.memoizedState=b.state,a=l.child):a=Xn(a,l,x),a}function ES(a,l,h,g){return Hl(),l.flags|=256,ks(a,l,h,g),l.child}var fm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function mm(a){return{baseLanes:a,cachePool:cv()}}function gm(a,l,h){return a=a!==null?a.childLanes&~h:0,l&&(a|=Bi),a}function bS(a,l,h){var g=l.pendingProps,x=!1,b=(l.flags&128)!==0,O;if((O=b)||(O=a!==null&&a.memoizedState===null?!1:(vs.current&2)!==0),O&&(x=!0,l.flags&=-129),O=(l.flags&32)!==0,l.flags&=-33,a===null){if(Ct){if(x?Lr(l):wr(),Ct){var k=rs,$;if($=k){e:{for($=k,k=mn;$.nodeType!==8;){if(!k){k=null;break e}if($=Ji($.nextSibling),$===null){k=null;break e}}k=$}k!==null?(l.memoizedState={dehydrated:k,treeContext:Ra!==null?{id:Hn,overflow:zn}:null,retryLane:536870912,hydrationErrors:null},$=Si(18,null,null,0),$.stateNode=k,$.return=l,l.child=$,Zs=l,rs=null,$=!0):$=!1}$||Ca(l)}if(k=l.memoizedState,k!==null&&(k=k.dehydrated,k!==null))return Zm(k)?l.lanes=32:l.lanes=536870912,null;Qn(l)}return k=g.children,g=g.fallback,x?(wr(),x=l.mode,k=sd({mode:"hidden",children:k},x),g=Ia(g,x,h,null),k.return=l,g.return=l,k.sibling=g,l.child=k,x=l.child,x.memoizedState=mm(h),x.childLanes=gm(a,O,h),l.memoizedState=fm,g):(Lr(l),pm(l,k))}if($=a.memoizedState,$!==null&&(k=$.dehydrated,k!==null)){if(b)l.flags&256?(Lr(l),l.flags&=-257,l=ym(a,l,h)):l.memoizedState!==null?(wr(),l.child=a.child,l.flags|=128,l=null):(wr(),x=g.fallback,k=l.mode,g=sd({mode:"visible",children:g.children},k),x=Ia(x,k,h,null),x.flags|=2,g.return=l,x.return=l,g.sibling=x,l.child=g,ko(l,a.child,null,h),g=l.child,g.memoizedState=mm(h),g.childLanes=gm(a,O,h),l.memoizedState=fm,l=x);else if(Lr(l),Zm(k)){if(O=k.nextSibling&&k.nextSibling.dataset,O)var ie=O.dgst;O=ie,g=Error(s(419)),g.stack="",g.digest=O,zl({value:g,source:null,stack:null}),l=ym(a,l,h)}else if(Ls||Kl(a,l,h,!1),O=(h&a.childLanes)!==0,Ls||O){if(O=Yt,O!==null&&(g=h&-h,g=(g&42)!==0?1:yr(g),g=(g&(O.suspendedLanes|h))!==0?0:g,g!==0&&g!==$.retryLane))throw $.retryLane=g,bo(a,g),Ai(O,a,g),mS;k.data==="$?"||Nm(),l=ym(a,l,h)}else k.data==="$?"?(l.flags|=192,l.child=a.child,l=null):(a=$.treeContext,rs=Ji(k.nextSibling),Zs=l,Ct=!0,wa=null,mn=!1,a!==null&&(Mi[Ui++]=Hn,Mi[Ui++]=zn,Mi[Ui++]=Ra,Hn=a.id,zn=a.overflow,Ra=l),l=pm(l,g.children),l.flags|=4096);return l}return x?(wr(),x=g.fallback,k=l.mode,$=a.child,ie=$.sibling,g=Gn($,{mode:"hidden",children:g.children}),g.subtreeFlags=$.subtreeFlags&65011712,ie!==null?x=Gn(ie,x):(x=Ia(x,k,h,null),x.flags|=2),x.return=l,g.return=l,g.sibling=x,l.child=g,g=x,x=l.child,k=a.child.memoizedState,k===null?k=mm(h):($=k.cachePool,$!==null?(ie=ys._currentValue,$=$.parent!==ie?{parent:ie,pool:ie}:$):$=cv(),k={baseLanes:k.baseLanes|h,cachePool:$}),x.memoizedState=k,x.childLanes=gm(a,O,h),l.memoizedState=fm,g):(Lr(l),h=a.child,a=h.sibling,h=Gn(h,{mode:"visible",children:g.children}),h.return=l,h.sibling=null,a!==null&&(O=l.deletions,O===null?(l.deletions=[a],l.flags|=16):O.push(a)),l.child=h,l.memoizedState=null,h)}function pm(a,l){return l=sd({mode:"visible",children:l},a.mode),l.return=a,a.child=l}function sd(a,l){return a=Si(22,a,null,l),a.lanes=0,a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},a}function ym(a,l,h){return ko(l,a.child,null,h),a=pm(l,l.pendingProps.children),a.flags|=2,l.memoizedState=null,a}function AS(a,l,h){a.lanes|=l;var g=a.alternate;g!==null&&(g.lanes|=l),Nf(a.return,l,h)}function vm(a,l,h,g,x){var b=a.memoizedState;b===null?a.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:g,tail:h,tailMode:x}:(b.isBackwards=l,b.rendering=null,b.renderingStartTime=0,b.last=g,b.tail=h,b.tailMode=x)}function IS(a,l,h){var g=l.pendingProps,x=g.revealOrder,b=g.tail;if(ks(a,l,g.children,h),g=vs.current,(g&2)!==0)g=g&1|2,l.flags|=128;else{if(a!==null&&(a.flags&128)!==0)e:for(a=l.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&AS(a,h,l);else if(a.tag===19)AS(a,h,l);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===l)break e;for(;a.sibling===null;){if(a.return===null||a.return===l)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}g&=1}switch(H(vs,g),x){case"forwards":for(h=l.child,x=null;h!==null;)a=h.alternate,a!==null&&Zu(a)===null&&(x=h),h=h.sibling;h=x,h===null?(x=l.child,l.child=null):(x=h.sibling,h.sibling=null),vm(l,!1,x,h,b);break;case"backwards":for(h=null,x=l.child,l.child=null;x!==null;){if(a=x.alternate,a!==null&&Zu(a)===null){l.child=x;break}a=x.sibling,x.sibling=h,h=x,x=a}vm(l,!0,h,null,b);break;case"together":vm(l,!1,null,null,void 0);break;default:l.memoizedState=null}return l.child}function Xn(a,l,h){if(a!==null&&(l.dependencies=a.dependencies),Pr|=l.lanes,(h&l.childLanes)===0)if(a!==null){if(Kl(a,l,h,!1),(h&l.childLanes)===0)return null}else return null;if(a!==null&&l.child!==a.child)throw Error(s(153));if(l.child!==null){for(a=l.child,h=Gn(a,a.pendingProps),l.child=h,h.return=l;a.sibling!==null;)a=a.sibling,h=h.sibling=Gn(a,a.pendingProps),h.return=l;h.sibling=null}return l.child}function Sm(a,l){return(a.lanes&l)!==0?!0:(a=a.dependencies,!!(a!==null&&Mu(a)))}function ML(a,l,h){switch(l.tag){case 3:de(l,l.stateNode.containerInfo),Er(l,ys,a.memoizedState.cache),Hl();break;case 27:case 5:lt(l);break;case 4:de(l,l.stateNode.containerInfo);break;case 10:Er(l,l.type,l.memoizedProps.value);break;case 13:var g=l.memoizedState;if(g!==null)return g.dehydrated!==null?(Lr(l),l.flags|=128,null):(h&l.child.childLanes)!==0?bS(a,l,h):(Lr(l),a=Xn(a,l,h),a!==null?a.sibling:null);Lr(l);break;case 19:var x=(a.flags&128)!==0;if(g=(h&l.childLanes)!==0,g||(Kl(a,l,h,!1),g=(h&l.childLanes)!==0),x){if(g)return IS(a,l,h);l.flags|=128}if(x=l.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),H(vs,vs.current),g)break;return null;case 22:case 23:return l.lanes=0,vS(a,l,h);case 24:Er(l,ys,a.memoizedState.cache)}return Xn(a,l,h)}function RS(a,l,h){if(a!==null)if(a.memoizedProps!==l.pendingProps)Ls=!0;else{if(!Sm(a,h)&&(l.flags&128)===0)return Ls=!1,ML(a,l,h);Ls=(a.flags&131072)!==0}else Ls=!1,Ct&&(l.flags&1048576)!==0&&sv(l,Nu,l.index);switch(l.lanes=0,l.tag){case 16:e:{a=l.pendingProps;var g=l.elementType,x=g._init;if(g=x(g._payload),l.type=g,typeof g=="function")wf(g)?(a=ka(g,a),l.tag=1,l=TS(null,l,g,a,h)):(l.tag=0,l=hm(null,l,g,a,h));else{if(g!=null){if(x=g.$$typeof,x===C){l.tag=11,l=gS(null,l,g,a,h);break e}else if(x===_){l.tag=14,l=pS(null,l,g,a,h);break e}}throw l=G(g)||g,Error(s(306,l,""))}}return l;case 0:return hm(a,l,l.type,l.pendingProps,h);case 1:return g=l.type,x=ka(g,l.pendingProps),TS(a,l,g,x,h);case 3:e:{if(de(l,l.stateNode.containerInfo),a===null)throw Error(s(387));g=l.pendingProps;var b=l.memoizedState;x=b.element,$f(a,l),Jl(l,g,null,h);var O=l.memoizedState;if(g=O.cache,Er(l,ys,g),g!==b.cache&&Mf(l,[ys],h,!0),Zl(),g=O.element,b.isDehydrated)if(b={element:g,isDehydrated:!1,cache:O.cache},l.updateQueue.baseState=b,l.memoizedState=b,l.flags&256){l=ES(a,l,g,h);break e}else if(g!==x){x=ki(Error(s(424)),l),zl(x),l=ES(a,l,g,h);break e}else{switch(a=l.stateNode.containerInfo,a.nodeType){case 9:a=a.body;break;default:a=a.nodeName==="HTML"?a.ownerDocument.body:a}for(rs=Ji(a.firstChild),Zs=l,Ct=!0,wa=null,mn=!0,h=nS(l,null,g,h),l.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling}else{if(Hl(),g===x){l=Xn(a,l,h);break e}ks(a,l,g,h)}l=l.child}return l;case 26:return td(a,l),a===null?(h=Ox(l.type,null,l.pendingProps,null))?l.memoizedState=h:Ct||(h=l.type,a=l.pendingProps,g=pd(fe.current).createElement(h),g[ls]=l,g[Is]=a,Ms(g,h,a),Rs(g),l.stateNode=g):l.memoizedState=Ox(l.type,a.memoizedProps,l.pendingProps,a.memoizedState),null;case 27:return lt(l),a===null&&Ct&&(g=l.stateNode=Lx(l.type,l.pendingProps,fe.current),Zs=l,mn=!0,x=rs,Ur(l.type)?(Jm=x,rs=Ji(g.firstChild)):rs=x),ks(a,l,l.pendingProps.children,h),td(a,l),a===null&&(l.flags|=4194304),l.child;case 5:return a===null&&Ct&&((x=g=rs)&&(g=uw(g,l.type,l.pendingProps,mn),g!==null?(l.stateNode=g,Zs=l,rs=Ji(g.firstChild),mn=!1,x=!0):x=!1),x||Ca(l)),lt(l),x=l.type,b=l.pendingProps,O=a!==null?a.memoizedProps:null,g=b.children,Qm(x,b)?g=null:O!==null&&Qm(x,O)&&(l.flags|=32),l.memoizedState!==null&&(x=qf(a,l,wL,null,null,h),Tc._currentValue=x),td(a,l),ks(a,l,g,h),l.child;case 6:return a===null&&Ct&&((a=h=rs)&&(h=dw(h,l.pendingProps,mn),h!==null?(l.stateNode=h,Zs=l,rs=null,a=!0):a=!1),a||Ca(l)),null;case 13:return bS(a,l,h);case 4:return de(l,l.stateNode.containerInfo),g=l.pendingProps,a===null?l.child=ko(l,null,g,h):ks(a,l,g,h),l.child;case 11:return gS(a,l,l.type,l.pendingProps,h);case 7:return ks(a,l,l.pendingProps,h),l.child;case 8:return ks(a,l,l.pendingProps.children,h),l.child;case 12:return ks(a,l,l.pendingProps.children,h),l.child;case 10:return g=l.pendingProps,Er(l,l.type,g.value),ks(a,l,g.children,h),l.child;case 9:return x=l.type._context,g=l.pendingProps.children,Da(l),x=Bs(x),g=g(x),l.flags|=1,ks(a,l,g,h),l.child;case 14:return pS(a,l,l.type,l.pendingProps,h);case 15:return yS(a,l,l.type,l.pendingProps,h);case 19:return IS(a,l,h);case 31:return g=l.pendingProps,h=l.mode,g={mode:g.mode,children:g.children},a===null?(h=sd(g,h),h.ref=l.ref,l.child=h,h.return=l,l=h):(h=Gn(a.child,g),h.ref=l.ref,l.child=h,h.return=l,l=h),l;case 22:return vS(a,l,h);case 24:return Da(l),g=Bs(ys),a===null?(x=Bf(),x===null&&(x=Yt,b=Uf(),x.pooledCache=b,b.refCount++,b!==null&&(x.pooledCacheLanes|=h),x=b),l.memoizedState={parent:g,cache:x},Vf(l),Er(l,ys,x)):((a.lanes&h)!==0&&($f(a,l),Jl(l,null,null,h),Zl()),x=a.memoizedState,b=l.memoizedState,x.parent!==g?(x={parent:g,cache:g},l.memoizedState=x,l.lanes===0&&(l.memoizedState=l.updateQueue.baseState=x),Er(l,ys,g)):(g=b.cache,Er(l,ys,g),g!==x.cache&&Mf(l,[ys],h,!0))),ks(a,l,l.pendingProps.children,h),l.child;case 29:throw l.pendingProps}throw Error(s(156,l.tag))}function Wn(a){a.flags|=4}function LS(a,l){if(l.type!=="stylesheet"||(l.state.loading&4)!==0)a.flags&=-16777217;else if(a.flags|=16777216,!Nx(l)){if(l=Fi.current,l!==null&&((At&4194048)===At?gn!==null:(At&62914560)!==At&&(At&536870912)===0||l!==gn))throw Xl=jf,uv;a.flags|=8192}}function id(a,l){l!==null&&(a.flags|=4),a.flags&16384&&(l=a.tag!==22?ya():536870912,a.lanes|=l,Fo|=l)}function ac(a,l){if(!Ct)switch(a.tailMode){case"hidden":l=a.tail;for(var h=null;l!==null;)l.alternate!==null&&(h=l),l=l.sibling;h===null?a.tail=null:h.sibling=null;break;case"collapsed":h=a.tail;for(var g=null;h!==null;)h.alternate!==null&&(g=h),h=h.sibling;g===null?l||a.tail===null?a.tail=null:a.tail.sibling=null:g.sibling=null}}function ss(a){var l=a.alternate!==null&&a.alternate.child===a.child,h=0,g=0;if(l)for(var x=a.child;x!==null;)h|=x.lanes|x.childLanes,g|=x.subtreeFlags&65011712,g|=x.flags&65011712,x.return=a,x=x.sibling;else for(x=a.child;x!==null;)h|=x.lanes|x.childLanes,g|=x.subtreeFlags,g|=x.flags,x.return=a,x=x.sibling;return a.subtreeFlags|=g,a.childLanes=h,l}function UL(a,l,h){var g=l.pendingProps;switch(_f(l),l.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ss(l),null;case 1:return ss(l),null;case 3:return h=l.stateNode,g=null,a!==null&&(g=a.memoizedState.cache),l.memoizedState.cache!==g&&(l.flags|=2048),Yn(ys),Be(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(a===null||a.child===null)&&(Gl(l)?Wn(l):a===null||a.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,rv())),ss(l),null;case 26:return h=l.memoizedState,a===null?(Wn(l),h!==null?(ss(l),LS(l,h)):(ss(l),l.flags&=-16777217)):h?h!==a.memoizedState?(Wn(l),ss(l),LS(l,h)):(ss(l),l.flags&=-16777217):(a.memoizedProps!==g&&Wn(l),ss(l),l.flags&=-16777217),null;case 27:Ee(l),h=fe.current;var x=l.type;if(a!==null&&l.stateNode!=null)a.memoizedProps!==g&&Wn(l);else{if(!g){if(l.stateNode===null)throw Error(s(166));return ss(l),null}a=ue.current,Gl(l)?iv(l):(a=Lx(x,g,h),l.stateNode=a,Wn(l))}return ss(l),null;case 5:if(Ee(l),h=l.type,a!==null&&l.stateNode!=null)a.memoizedProps!==g&&Wn(l);else{if(!g){if(l.stateNode===null)throw Error(s(166));return ss(l),null}if(a=ue.current,Gl(l))iv(l);else{switch(x=pd(fe.current),a){case 1:a=x.createElementNS("http://www.w3.org/2000/svg",h);break;case 2:a=x.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;default:switch(h){case"svg":a=x.createElementNS("http://www.w3.org/2000/svg",h);break;case"math":a=x.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;case"script":a=x.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild);break;case"select":a=typeof g.is=="string"?x.createElement("select",{is:g.is}):x.createElement("select"),g.multiple?a.multiple=!0:g.size&&(a.size=g.size);break;default:a=typeof g.is=="string"?x.createElement(h,{is:g.is}):x.createElement(h)}}a[ls]=l,a[Is]=g;e:for(x=l.child;x!==null;){if(x.tag===5||x.tag===6)a.appendChild(x.stateNode);else if(x.tag!==4&&x.tag!==27&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===l)break e;for(;x.sibling===null;){if(x.return===null||x.return===l)break e;x=x.return}x.sibling.return=x.return,x=x.sibling}l.stateNode=a;e:switch(Ms(a,h,g),h){case"button":case"input":case"select":case"textarea":a=!!g.autoFocus;break e;case"img":a=!0;break e;default:a=!1}a&&Wn(l)}}return ss(l),l.flags&=-16777217,null;case 6:if(a&&l.stateNode!=null)a.memoizedProps!==g&&Wn(l);else{if(typeof g!="string"&&l.stateNode===null)throw Error(s(166));if(a=fe.current,Gl(l)){if(a=l.stateNode,h=l.memoizedProps,g=null,x=Zs,x!==null)switch(x.tag){case 27:case 5:g=x.memoizedProps}a[ls]=l,a=!!(a.nodeValue===h||g!==null&&g.suppressHydrationWarning===!0||xx(a.nodeValue,h)),a||Ca(l)}else a=pd(a).createTextNode(g),a[ls]=l,l.stateNode=a}return ss(l),null;case 13:if(g=l.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(x=Gl(l),g!==null&&g.dehydrated!==null){if(a===null){if(!x)throw Error(s(318));if(x=l.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(s(317));x[ls]=l}else Hl(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;ss(l),x=!1}else x=rv(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=x),x=!0;if(!x)return l.flags&256?(Qn(l),l):(Qn(l),null)}if(Qn(l),(l.flags&128)!==0)return l.lanes=h,l;if(h=g!==null,a=a!==null&&a.memoizedState!==null,h){g=l.child,x=null,g.alternate!==null&&g.alternate.memoizedState!==null&&g.alternate.memoizedState.cachePool!==null&&(x=g.alternate.memoizedState.cachePool.pool);var b=null;g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(b=g.memoizedState.cachePool.pool),b!==x&&(g.flags|=2048)}return h!==a&&h&&(l.child.flags|=8192),id(l,l.updateQueue),ss(l),null;case 4:return Be(),a===null&&Hm(l.stateNode.containerInfo),ss(l),null;case 10:return Yn(l.type),ss(l),null;case 19:if(le(vs),x=l.memoizedState,x===null)return ss(l),null;if(g=(l.flags&128)!==0,b=x.rendering,b===null)if(g)ac(x,!1);else{if(as!==0||a!==null&&(a.flags&128)!==0)for(a=l.child;a!==null;){if(b=Zu(a),b!==null){for(l.flags|=128,ac(x,!1),a=b.updateQueue,l.updateQueue=a,id(l,a),l.subtreeFlags=0,a=h,h=l.child;h!==null;)tv(h,a),h=h.sibling;return H(vs,vs.current&1|2),l.child}a=a.sibling}x.tail!==null&&j()>ad&&(l.flags|=128,g=!0,ac(x,!1),l.lanes=4194304)}else{if(!g)if(a=Zu(b),a!==null){if(l.flags|=128,g=!0,a=a.updateQueue,l.updateQueue=a,id(l,a),ac(x,!0),x.tail===null&&x.tailMode==="hidden"&&!b.alternate&&!Ct)return ss(l),null}else 2*j()-x.renderingStartTime>ad&&h!==536870912&&(l.flags|=128,g=!0,ac(x,!1),l.lanes=4194304);x.isBackwards?(b.sibling=l.child,l.child=b):(a=x.last,a!==null?a.sibling=b:l.child=b,x.last=b)}return x.tail!==null?(l=x.tail,x.rendering=l,x.tail=l.sibling,x.renderingStartTime=j(),l.sibling=null,a=vs.current,H(vs,g?a&1|2:a&1),l):(ss(l),null);case 22:case 23:return Qn(l),Kf(),g=l.memoizedState!==null,a!==null?a.memoizedState!==null!==g&&(l.flags|=8192):g&&(l.flags|=8192),g?(h&536870912)!==0&&(l.flags&128)===0&&(ss(l),l.subtreeFlags&6&&(l.flags|=8192)):ss(l),h=l.updateQueue,h!==null&&id(l,h.retryQueue),h=null,a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(h=a.memoizedState.cachePool.pool),g=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(g=l.memoizedState.cachePool.pool),g!==h&&(l.flags|=2048),a!==null&&le(_a),null;case 24:return h=null,a!==null&&(h=a.memoizedState.cache),l.memoizedState.cache!==h&&(l.flags|=2048),Yn(ys),ss(l),null;case 25:return null;case 30:return null}throw Error(s(156,l.tag))}function FL(a,l){switch(_f(l),l.tag){case 1:return a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 3:return Yn(ys),Be(),a=l.flags,(a&65536)!==0&&(a&128)===0?(l.flags=a&-65537|128,l):null;case 26:case 27:case 5:return Ee(l),null;case 13:if(Qn(l),a=l.memoizedState,a!==null&&a.dehydrated!==null){if(l.alternate===null)throw Error(s(340));Hl()}return a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 19:return le(vs),null;case 4:return Be(),null;case 10:return Yn(l.type),null;case 22:case 23:return Qn(l),Kf(),a!==null&&le(_a),a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 24:return Yn(ys),null;case 25:return null;default:return null}}function wS(a,l){switch(_f(l),l.tag){case 3:Yn(ys),Be();break;case 26:case 27:case 5:Ee(l);break;case 4:Be();break;case 13:Qn(l);break;case 19:le(vs);break;case 10:Yn(l.type);break;case 22:case 23:Qn(l),Kf(),a!==null&&le(_a);break;case 24:Yn(ys)}}function oc(a,l){try{var h=l.updateQueue,g=h!==null?h.lastEffect:null;if(g!==null){var x=g.next;h=x;do{if((h.tag&a)===a){g=void 0;var b=h.create,O=h.inst;g=b(),O.destroy=g}h=h.next}while(h!==x)}}catch(k){Gt(l,l.return,k)}}function Cr(a,l,h){try{var g=l.updateQueue,x=g!==null?g.lastEffect:null;if(x!==null){var b=x.next;g=b;do{if((g.tag&a)===a){var O=g.inst,k=O.destroy;if(k!==void 0){O.destroy=void 0,x=l;var $=h,ie=k;try{ie()}catch(me){Gt(x,$,me)}}}g=g.next}while(g!==b)}}catch(me){Gt(l,l.return,me)}}function CS(a){var l=a.updateQueue;if(l!==null){var h=a.stateNode;try{pv(l,h)}catch(g){Gt(a,a.return,g)}}}function OS(a,l,h){h.props=ka(a.type,a.memoizedProps),h.state=a.memoizedState;try{h.componentWillUnmount()}catch(g){Gt(a,l,g)}}function lc(a,l){try{var h=a.ref;if(h!==null){switch(a.tag){case 26:case 27:case 5:var g=a.stateNode;break;case 30:g=a.stateNode;break;default:g=a.stateNode}typeof h=="function"?a.refCleanup=h(g):h.current=g}}catch(x){Gt(a,l,x)}}function pn(a,l){var h=a.ref,g=a.refCleanup;if(h!==null)if(typeof g=="function")try{g()}catch(x){Gt(a,l,x)}finally{a.refCleanup=null,a=a.alternate,a!=null&&(a.refCleanup=null)}else if(typeof h=="function")try{h(null)}catch(x){Gt(a,l,x)}else h.current=null}function DS(a){var l=a.type,h=a.memoizedProps,g=a.stateNode;try{e:switch(l){case"button":case"input":case"select":case"textarea":h.autoFocus&&g.focus();break e;case"img":h.src?g.src=h.src:h.srcSet&&(g.srcset=h.srcSet)}}catch(x){Gt(a,a.return,x)}}function xm(a,l,h){try{var g=a.stateNode;rw(g,a.type,h,l),g[Is]=l}catch(x){Gt(a,a.return,x)}}function _S(a){return a.tag===5||a.tag===3||a.tag===26||a.tag===27&&Ur(a.type)||a.tag===4}function Tm(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||_S(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.tag===27&&Ur(a.type)||a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function Em(a,l,h){var g=a.tag;if(g===5||g===6)a=a.stateNode,l?(h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h).insertBefore(a,l):(l=h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h,l.appendChild(a),h=h._reactRootContainer,h!=null||l.onclick!==null||(l.onclick=gd));else if(g!==4&&(g===27&&Ur(a.type)&&(h=a.stateNode,l=null),a=a.child,a!==null))for(Em(a,l,h),a=a.sibling;a!==null;)Em(a,l,h),a=a.sibling}function nd(a,l,h){var g=a.tag;if(g===5||g===6)a=a.stateNode,l?h.insertBefore(a,l):h.appendChild(a);else if(g!==4&&(g===27&&Ur(a.type)&&(h=a.stateNode),a=a.child,a!==null))for(nd(a,l,h),a=a.sibling;a!==null;)nd(a,l,h),a=a.sibling}function PS(a){var l=a.stateNode,h=a.memoizedProps;try{for(var g=a.type,x=l.attributes;x.length;)l.removeAttributeNode(x[0]);Ms(l,g,h),l[ls]=a,l[Is]=h}catch(b){Gt(a,a.return,b)}}var Zn=!1,us=!1,bm=!1,kS=typeof WeakSet=="function"?WeakSet:Set,ws=null;function BL(a,l){if(a=a.containerInfo,Ym=Ed,a=zy(a),Tf(a)){if("selectionStart"in a)var h={start:a.selectionStart,end:a.selectionEnd};else e:{h=(h=a.ownerDocument)&&h.defaultView||window;var g=h.getSelection&&h.getSelection();if(g&&g.rangeCount!==0){h=g.anchorNode;var x=g.anchorOffset,b=g.focusNode;g=g.focusOffset;try{h.nodeType,b.nodeType}catch{h=null;break e}var O=0,k=-1,$=-1,ie=0,me=0,ve=a,oe=null;t:for(;;){for(var ce;ve!==h||x!==0&&ve.nodeType!==3||(k=O+x),ve!==b||g!==0&&ve.nodeType!==3||($=O+g),ve.nodeType===3&&(O+=ve.nodeValue.length),(ce=ve.firstChild)!==null;)oe=ve,ve=ce;for(;;){if(ve===a)break t;if(oe===h&&++ie===x&&(k=O),oe===b&&++me===g&&($=O),(ce=ve.nextSibling)!==null)break;ve=oe,oe=ve.parentNode}ve=ce}h=k===-1||$===-1?null:{start:k,end:$}}else h=null}h=h||{start:0,end:0}}else h=null;for(qm={focusedElem:a,selectionRange:h},Ed=!1,ws=l;ws!==null;)if(l=ws,a=l.child,(l.subtreeFlags&1024)!==0&&a!==null)a.return=l,ws=a;else for(;ws!==null;){switch(l=ws,b=l.alternate,a=l.flags,l.tag){case 0:break;case 11:case 15:break;case 1:if((a&1024)!==0&&b!==null){a=void 0,h=l,x=b.memoizedProps,b=b.memoizedState,g=h.stateNode;try{var et=ka(h.type,x,h.elementType===h.type);a=g.getSnapshotBeforeUpdate(et,b),g.__reactInternalSnapshotBeforeUpdate=a}catch(Xe){Gt(h,h.return,Xe)}}break;case 3:if((a&1024)!==0){if(a=l.stateNode.containerInfo,h=a.nodeType,h===9)Wm(a);else if(h===1)switch(a.nodeName){case"HEAD":case"HTML":case"BODY":Wm(a);break;default:a.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((a&1024)!==0)throw Error(s(163))}if(a=l.sibling,a!==null){a.return=l.return,ws=a;break}ws=l.return}}function NS(a,l,h){var g=h.flags;switch(h.tag){case 0:case 11:case 15:Or(a,h),g&4&&oc(5,h);break;case 1:if(Or(a,h),g&4)if(a=h.stateNode,l===null)try{a.componentDidMount()}catch(O){Gt(h,h.return,O)}else{var x=ka(h.type,l.memoizedProps);l=l.memoizedState;try{a.componentDidUpdate(x,l,a.__reactInternalSnapshotBeforeUpdate)}catch(O){Gt(h,h.return,O)}}g&64&&CS(h),g&512&&lc(h,h.return);break;case 3:if(Or(a,h),g&64&&(a=h.updateQueue,a!==null)){if(l=null,h.child!==null)switch(h.child.tag){case 27:case 5:l=h.child.stateNode;break;case 1:l=h.child.stateNode}try{pv(a,l)}catch(O){Gt(h,h.return,O)}}break;case 27:l===null&&g&4&&PS(h);case 26:case 5:Or(a,h),l===null&&g&4&&DS(h),g&512&&lc(h,h.return);break;case 12:Or(a,h);break;case 13:Or(a,h),g&4&&FS(a,h),g&64&&(a=h.memoizedState,a!==null&&(a=a.dehydrated,a!==null&&(h=qL.bind(null,h),hw(a,h))));break;case 22:if(g=h.memoizedState!==null||Zn,!g){l=l!==null&&l.memoizedState!==null||us,x=Zn;var b=us;Zn=g,(us=l)&&!b?Dr(a,h,(h.subtreeFlags&8772)!==0):Or(a,h),Zn=x,us=b}break;case 30:break;default:Or(a,h)}}function MS(a){var l=a.alternate;l!==null&&(a.alternate=null,MS(l)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(l=a.stateNode,l!==null&&_l(l)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}var Wt=null,ai=!1;function Jn(a,l,h){for(h=h.child;h!==null;)US(a,l,h),h=h.sibling}function US(a,l,h){if(bt&&typeof bt.onCommitFiberUnmount=="function")try{bt.onCommitFiberUnmount(Dt,h)}catch{}switch(h.tag){case 26:us||pn(h,l),Jn(a,l,h),h.memoizedState?h.memoizedState.count--:h.stateNode&&(h=h.stateNode,h.parentNode.removeChild(h));break;case 27:us||pn(h,l);var g=Wt,x=ai;Ur(h.type)&&(Wt=h.stateNode,ai=!1),Jn(a,l,h),yc(h.stateNode),Wt=g,ai=x;break;case 5:us||pn(h,l);case 6:if(g=Wt,x=ai,Wt=null,Jn(a,l,h),Wt=g,ai=x,Wt!==null)if(ai)try{(Wt.nodeType===9?Wt.body:Wt.nodeName==="HTML"?Wt.ownerDocument.body:Wt).removeChild(h.stateNode)}catch(b){Gt(h,l,b)}else try{Wt.removeChild(h.stateNode)}catch(b){Gt(h,l,b)}break;case 18:Wt!==null&&(ai?(a=Wt,Ix(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,h.stateNode),Ic(a)):Ix(Wt,h.stateNode));break;case 4:g=Wt,x=ai,Wt=h.stateNode.containerInfo,ai=!0,Jn(a,l,h),Wt=g,ai=x;break;case 0:case 11:case 14:case 15:us||Cr(2,h,l),us||Cr(4,h,l),Jn(a,l,h);break;case 1:us||(pn(h,l),g=h.stateNode,typeof g.componentWillUnmount=="function"&&OS(h,l,g)),Jn(a,l,h);break;case 21:Jn(a,l,h);break;case 22:us=(g=us)||h.memoizedState!==null,Jn(a,l,h),us=g;break;default:Jn(a,l,h)}}function FS(a,l){if(l.memoizedState===null&&(a=l.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null))))try{Ic(a)}catch(h){Gt(l,l.return,h)}}function jL(a){switch(a.tag){case 13:case 19:var l=a.stateNode;return l===null&&(l=a.stateNode=new kS),l;case 22:return a=a.stateNode,l=a._retryCache,l===null&&(l=a._retryCache=new kS),l;default:throw Error(s(435,a.tag))}}function Am(a,l){var h=jL(a);l.forEach(function(g){var x=QL.bind(null,a,g);h.has(g)||(h.add(g),g.then(x,x))})}function xi(a,l){var h=l.deletions;if(h!==null)for(var g=0;g<h.length;g++){var x=h[g],b=a,O=l,k=O;e:for(;k!==null;){switch(k.tag){case 27:if(Ur(k.type)){Wt=k.stateNode,ai=!1;break e}break;case 5:Wt=k.stateNode,ai=!1;break e;case 3:case 4:Wt=k.stateNode.containerInfo,ai=!0;break e}k=k.return}if(Wt===null)throw Error(s(160));US(b,O,x),Wt=null,ai=!1,b=x.alternate,b!==null&&(b.return=null),x.return=null}if(l.subtreeFlags&13878)for(l=l.child;l!==null;)BS(l,a),l=l.sibling}var Zi=null;function BS(a,l){var h=a.alternate,g=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:xi(l,a),Ti(a),g&4&&(Cr(3,a,a.return),oc(3,a),Cr(5,a,a.return));break;case 1:xi(l,a),Ti(a),g&512&&(us||h===null||pn(h,h.return)),g&64&&Zn&&(a=a.updateQueue,a!==null&&(g=a.callbacks,g!==null&&(h=a.shared.hiddenCallbacks,a.shared.hiddenCallbacks=h===null?g:h.concat(g))));break;case 26:var x=Zi;if(xi(l,a),Ti(a),g&512&&(us||h===null||pn(h,h.return)),g&4){var b=h!==null?h.memoizedState:null;if(g=a.memoizedState,h===null)if(g===null)if(a.stateNode===null){e:{g=a.type,h=a.memoizedProps,x=x.ownerDocument||x;t:switch(g){case"title":b=x.getElementsByTagName("title")[0],(!b||b[jn]||b[ls]||b.namespaceURI==="http://www.w3.org/2000/svg"||b.hasAttribute("itemprop"))&&(b=x.createElement(g),x.head.insertBefore(b,x.querySelector("head > title"))),Ms(b,g,h),b[ls]=a,Rs(b),g=b;break e;case"link":var O=Px("link","href",x).get(g+(h.href||""));if(O){for(var k=0;k<O.length;k++)if(b=O[k],b.getAttribute("href")===(h.href==null||h.href===""?null:h.href)&&b.getAttribute("rel")===(h.rel==null?null:h.rel)&&b.getAttribute("title")===(h.title==null?null:h.title)&&b.getAttribute("crossorigin")===(h.crossOrigin==null?null:h.crossOrigin)){O.splice(k,1);break t}}b=x.createElement(g),Ms(b,g,h),x.head.appendChild(b);break;case"meta":if(O=Px("meta","content",x).get(g+(h.content||""))){for(k=0;k<O.length;k++)if(b=O[k],b.getAttribute("content")===(h.content==null?null:""+h.content)&&b.getAttribute("name")===(h.name==null?null:h.name)&&b.getAttribute("property")===(h.property==null?null:h.property)&&b.getAttribute("http-equiv")===(h.httpEquiv==null?null:h.httpEquiv)&&b.getAttribute("charset")===(h.charSet==null?null:h.charSet)){O.splice(k,1);break t}}b=x.createElement(g),Ms(b,g,h),x.head.appendChild(b);break;default:throw Error(s(468,g))}b[ls]=a,Rs(b),g=b}a.stateNode=g}else kx(x,a.type,a.stateNode);else a.stateNode=_x(x,g,a.memoizedProps);else b!==g?(b===null?h.stateNode!==null&&(h=h.stateNode,h.parentNode.removeChild(h)):b.count--,g===null?kx(x,a.type,a.stateNode):_x(x,g,a.memoizedProps)):g===null&&a.stateNode!==null&&xm(a,a.memoizedProps,h.memoizedProps)}break;case 27:xi(l,a),Ti(a),g&512&&(us||h===null||pn(h,h.return)),h!==null&&g&4&&xm(a,a.memoizedProps,h.memoizedProps);break;case 5:if(xi(l,a),Ti(a),g&512&&(us||h===null||pn(h,h.return)),a.flags&32){x=a.stateNode;try{po(x,"")}catch(ce){Gt(a,a.return,ce)}}g&4&&a.stateNode!=null&&(x=a.memoizedProps,xm(a,x,h!==null?h.memoizedProps:x)),g&1024&&(bm=!0);break;case 6:if(xi(l,a),Ti(a),g&4){if(a.stateNode===null)throw Error(s(162));g=a.memoizedProps,h=a.stateNode;try{h.nodeValue=g}catch(ce){Gt(a,a.return,ce)}}break;case 3:if(Sd=null,x=Zi,Zi=yd(l.containerInfo),xi(l,a),Zi=x,Ti(a),g&4&&h!==null&&h.memoizedState.isDehydrated)try{Ic(l.containerInfo)}catch(ce){Gt(a,a.return,ce)}bm&&(bm=!1,jS(a));break;case 4:g=Zi,Zi=yd(a.stateNode.containerInfo),xi(l,a),Ti(a),Zi=g;break;case 12:xi(l,a),Ti(a);break;case 13:xi(l,a),Ti(a),a.child.flags&8192&&a.memoizedState!==null!=(h!==null&&h.memoizedState!==null)&&(Om=j()),g&4&&(g=a.updateQueue,g!==null&&(a.updateQueue=null,Am(a,g)));break;case 22:x=a.memoizedState!==null;var $=h!==null&&h.memoizedState!==null,ie=Zn,me=us;if(Zn=ie||x,us=me||$,xi(l,a),us=me,Zn=ie,Ti(a),g&8192)e:for(l=a.stateNode,l._visibility=x?l._visibility&-2:l._visibility|1,x&&(h===null||$||Zn||us||Na(a)),h=null,l=a;;){if(l.tag===5||l.tag===26){if(h===null){$=h=l;try{if(b=$.stateNode,x)O=b.style,typeof O.setProperty=="function"?O.setProperty("display","none","important"):O.display="none";else{k=$.stateNode;var ve=$.memoizedProps.style,oe=ve!=null&&ve.hasOwnProperty("display")?ve.display:null;k.style.display=oe==null||typeof oe=="boolean"?"":(""+oe).trim()}}catch(ce){Gt($,$.return,ce)}}}else if(l.tag===6){if(h===null){$=l;try{$.stateNode.nodeValue=x?"":$.memoizedProps}catch(ce){Gt($,$.return,ce)}}}else if((l.tag!==22&&l.tag!==23||l.memoizedState===null||l===a)&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===a)break e;for(;l.sibling===null;){if(l.return===null||l.return===a)break e;h===l&&(h=null),l=l.return}h===l&&(h=null),l.sibling.return=l.return,l=l.sibling}g&4&&(g=a.updateQueue,g!==null&&(h=g.retryQueue,h!==null&&(g.retryQueue=null,Am(a,h))));break;case 19:xi(l,a),Ti(a),g&4&&(g=a.updateQueue,g!==null&&(a.updateQueue=null,Am(a,g)));break;case 30:break;case 21:break;default:xi(l,a),Ti(a)}}function Ti(a){var l=a.flags;if(l&2){try{for(var h,g=a.return;g!==null;){if(_S(g)){h=g;break}g=g.return}if(h==null)throw Error(s(160));switch(h.tag){case 27:var x=h.stateNode,b=Tm(a);nd(a,b,x);break;case 5:var O=h.stateNode;h.flags&32&&(po(O,""),h.flags&=-33);var k=Tm(a);nd(a,k,O);break;case 3:case 4:var $=h.stateNode.containerInfo,ie=Tm(a);Em(a,ie,$);break;default:throw Error(s(161))}}catch(me){Gt(a,a.return,me)}a.flags&=-3}l&4096&&(a.flags&=-4097)}function jS(a){if(a.subtreeFlags&1024)for(a=a.child;a!==null;){var l=a;jS(l),l.tag===5&&l.flags&1024&&l.stateNode.reset(),a=a.sibling}}function Or(a,l){if(l.subtreeFlags&8772)for(l=l.child;l!==null;)NS(a,l.alternate,l),l=l.sibling}function Na(a){for(a=a.child;a!==null;){var l=a;switch(l.tag){case 0:case 11:case 14:case 15:Cr(4,l,l.return),Na(l);break;case 1:pn(l,l.return);var h=l.stateNode;typeof h.componentWillUnmount=="function"&&OS(l,l.return,h),Na(l);break;case 27:yc(l.stateNode);case 26:case 5:pn(l,l.return),Na(l);break;case 22:l.memoizedState===null&&Na(l);break;case 30:Na(l);break;default:Na(l)}a=a.sibling}}function Dr(a,l,h){for(h=h&&(l.subtreeFlags&8772)!==0,l=l.child;l!==null;){var g=l.alternate,x=a,b=l,O=b.flags;switch(b.tag){case 0:case 11:case 15:Dr(x,b,h),oc(4,b);break;case 1:if(Dr(x,b,h),g=b,x=g.stateNode,typeof x.componentDidMount=="function")try{x.componentDidMount()}catch(ie){Gt(g,g.return,ie)}if(g=b,x=g.updateQueue,x!==null){var k=g.stateNode;try{var $=x.shared.hiddenCallbacks;if($!==null)for(x.shared.hiddenCallbacks=null,x=0;x<$.length;x++)gv($[x],k)}catch(ie){Gt(g,g.return,ie)}}h&&O&64&&CS(b),lc(b,b.return);break;case 27:PS(b);case 26:case 5:Dr(x,b,h),h&&g===null&&O&4&&DS(b),lc(b,b.return);break;case 12:Dr(x,b,h);break;case 13:Dr(x,b,h),h&&O&4&&FS(x,b);break;case 22:b.memoizedState===null&&Dr(x,b,h),lc(b,b.return);break;case 30:break;default:Dr(x,b,h)}l=l.sibling}}function Im(a,l){var h=null;a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(h=a.memoizedState.cachePool.pool),a=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(a=l.memoizedState.cachePool.pool),a!==h&&(a!=null&&a.refCount++,h!=null&&Yl(h))}function Rm(a,l){a=null,l.alternate!==null&&(a=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==a&&(l.refCount++,a!=null&&Yl(a))}function yn(a,l,h,g){if(l.subtreeFlags&10256)for(l=l.child;l!==null;)VS(a,l,h,g),l=l.sibling}function VS(a,l,h,g){var x=l.flags;switch(l.tag){case 0:case 11:case 15:yn(a,l,h,g),x&2048&&oc(9,l);break;case 1:yn(a,l,h,g);break;case 3:yn(a,l,h,g),x&2048&&(a=null,l.alternate!==null&&(a=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==a&&(l.refCount++,a!=null&&Yl(a)));break;case 12:if(x&2048){yn(a,l,h,g),a=l.stateNode;try{var b=l.memoizedProps,O=b.id,k=b.onPostCommit;typeof k=="function"&&k(O,l.alternate===null?"mount":"update",a.passiveEffectDuration,-0)}catch($){Gt(l,l.return,$)}}else yn(a,l,h,g);break;case 13:yn(a,l,h,g);break;case 23:break;case 22:b=l.stateNode,O=l.alternate,l.memoizedState!==null?b._visibility&2?yn(a,l,h,g):cc(a,l):b._visibility&2?yn(a,l,h,g):(b._visibility|=2,No(a,l,h,g,(l.subtreeFlags&10256)!==0)),x&2048&&Im(O,l);break;case 24:yn(a,l,h,g),x&2048&&Rm(l.alternate,l);break;default:yn(a,l,h,g)}}function No(a,l,h,g,x){for(x=x&&(l.subtreeFlags&10256)!==0,l=l.child;l!==null;){var b=a,O=l,k=h,$=g,ie=O.flags;switch(O.tag){case 0:case 11:case 15:No(b,O,k,$,x),oc(8,O);break;case 23:break;case 22:var me=O.stateNode;O.memoizedState!==null?me._visibility&2?No(b,O,k,$,x):cc(b,O):(me._visibility|=2,No(b,O,k,$,x)),x&&ie&2048&&Im(O.alternate,O);break;case 24:No(b,O,k,$,x),x&&ie&2048&&Rm(O.alternate,O);break;default:No(b,O,k,$,x)}l=l.sibling}}function cc(a,l){if(l.subtreeFlags&10256)for(l=l.child;l!==null;){var h=a,g=l,x=g.flags;switch(g.tag){case 22:cc(h,g),x&2048&&Im(g.alternate,g);break;case 24:cc(h,g),x&2048&&Rm(g.alternate,g);break;default:cc(h,g)}l=l.sibling}}var uc=8192;function Mo(a){if(a.subtreeFlags&uc)for(a=a.child;a!==null;)$S(a),a=a.sibling}function $S(a){switch(a.tag){case 26:Mo(a),a.flags&uc&&a.memoizedState!==null&&Iw(Zi,a.memoizedState,a.memoizedProps);break;case 5:Mo(a);break;case 3:case 4:var l=Zi;Zi=yd(a.stateNode.containerInfo),Mo(a),Zi=l;break;case 22:a.memoizedState===null&&(l=a.alternate,l!==null&&l.memoizedState!==null?(l=uc,uc=16777216,Mo(a),uc=l):Mo(a));break;default:Mo(a)}}function GS(a){var l=a.alternate;if(l!==null&&(a=l.child,a!==null)){l.child=null;do l=a.sibling,a.sibling=null,a=l;while(a!==null)}}function dc(a){var l=a.deletions;if((a.flags&16)!==0){if(l!==null)for(var h=0;h<l.length;h++){var g=l[h];ws=g,zS(g,a)}GS(a)}if(a.subtreeFlags&10256)for(a=a.child;a!==null;)HS(a),a=a.sibling}function HS(a){switch(a.tag){case 0:case 11:case 15:dc(a),a.flags&2048&&Cr(9,a,a.return);break;case 3:dc(a);break;case 12:dc(a);break;case 22:var l=a.stateNode;a.memoizedState!==null&&l._visibility&2&&(a.return===null||a.return.tag!==13)?(l._visibility&=-3,rd(a)):dc(a);break;default:dc(a)}}function rd(a){var l=a.deletions;if((a.flags&16)!==0){if(l!==null)for(var h=0;h<l.length;h++){var g=l[h];ws=g,zS(g,a)}GS(a)}for(a=a.child;a!==null;){switch(l=a,l.tag){case 0:case 11:case 15:Cr(8,l,l.return),rd(l);break;case 22:h=l.stateNode,h._visibility&2&&(h._visibility&=-3,rd(l));break;default:rd(l)}a=a.sibling}}function zS(a,l){for(;ws!==null;){var h=ws;switch(h.tag){case 0:case 11:case 15:Cr(8,h,l);break;case 23:case 22:if(h.memoizedState!==null&&h.memoizedState.cachePool!==null){var g=h.memoizedState.cachePool.pool;g!=null&&g.refCount++}break;case 24:Yl(h.memoizedState.cache)}if(g=h.child,g!==null)g.return=h,ws=g;else e:for(h=a;ws!==null;){g=ws;var x=g.sibling,b=g.return;if(MS(g),g===h){ws=null;break e}if(x!==null){x.return=b,ws=x;break e}ws=b}}}var VL={getCacheForType:function(a){var l=Bs(ys),h=l.data.get(a);return h===void 0&&(h=a(),l.data.set(a,h)),h}},$L=typeof WeakMap=="function"?WeakMap:Map,Nt=0,Yt=null,yt=null,At=0,Mt=0,Ei=null,_r=!1,Uo=!1,Lm=!1,er=0,as=0,Pr=0,Ma=0,wm=0,Bi=0,Fo=0,hc=null,oi=null,Cm=!1,Om=0,ad=1/0,od=null,kr=null,Ns=0,Nr=null,Bo=null,jo=0,Dm=0,_m=null,KS=null,fc=0,Pm=null;function bi(){if((Nt&2)!==0&&At!==0)return At&-At;if(B.T!==null){var a=Lo;return a!==0?a:jm()}return xa()}function YS(){Bi===0&&(Bi=(At&536870912)===0||Ct?pa():536870912);var a=Fi.current;return a!==null&&(a.flags|=32),Bi}function Ai(a,l,h){(a===Yt&&(Mt===2||Mt===9)||a.cancelPendingCommit!==null)&&(Vo(a,0),Mr(a,At,Bi,!1)),fn(a,h),((Nt&2)===0||a!==Yt)&&(a===Yt&&((Nt&2)===0&&(Ma|=h),as===4&&Mr(a,At,Bi,!1)),vn(a))}function qS(a,l,h){if((Nt&6)!==0)throw Error(s(327));var g=!h&&(l&124)===0&&(l&a.expiredLanes)===0||hn(a,l),x=g?zL(a,l):Mm(a,l,!0),b=g;do{if(x===0){Uo&&!g&&Mr(a,l,0,!1);break}else{if(h=a.current.alternate,b&&!GL(h)){x=Mm(a,l,!1),b=!1;continue}if(x===2){if(b=l,a.errorRecoveryDisabledLanes&b)var O=0;else O=a.pendingLanes&-536870913,O=O!==0?O:O&536870912?536870912:0;if(O!==0){l=O;e:{var k=a;x=hc;var $=k.current.memoizedState.isDehydrated;if($&&(Vo(k,O).flags|=256),O=Mm(k,O,!1),O!==2){if(Lm&&!$){k.errorRecoveryDisabledLanes|=b,Ma|=b,x=4;break e}b=oi,oi=x,b!==null&&(oi===null?oi=b:oi.push.apply(oi,b))}x=O}if(b=!1,x!==2)continue}}if(x===1){Vo(a,0),Mr(a,l,0,!0);break}e:{switch(g=a,b=x,b){case 0:case 1:throw Error(s(345));case 4:if((l&4194048)!==l)break;case 6:Mr(g,l,Bi,!_r);break e;case 2:oi=null;break;case 3:case 5:break;default:throw Error(s(329))}if((l&62914560)===l&&(x=Om+300-j(),10<x)){if(Mr(g,l,Bi,!_r),Bn(g,0,!0)!==0)break e;g.timeoutHandle=bx(QS.bind(null,g,h,oi,od,Cm,l,Bi,Ma,Fo,_r,b,2,-0,0),x);break e}QS(g,h,oi,od,Cm,l,Bi,Ma,Fo,_r,b,0,-0,0)}}break}while(!0);vn(a)}function QS(a,l,h,g,x,b,O,k,$,ie,me,ve,oe,ce){if(a.timeoutHandle=-1,ve=l.subtreeFlags,(ve&8192||(ve&16785408)===16785408)&&(xc={stylesheets:null,count:0,unsuspend:Aw},$S(l),ve=Rw(),ve!==null)){a.cancelPendingCommit=ve(sx.bind(null,a,l,b,h,g,x,O,k,$,me,1,oe,ce)),Mr(a,b,O,!ie);return}sx(a,l,b,h,g,x,O,k,$)}function GL(a){for(var l=a;;){var h=l.tag;if((h===0||h===11||h===15)&&l.flags&16384&&(h=l.updateQueue,h!==null&&(h=h.stores,h!==null)))for(var g=0;g<h.length;g++){var x=h[g],b=x.getSnapshot;x=x.value;try{if(!vi(b(),x))return!1}catch{return!1}}if(h=l.child,l.subtreeFlags&16384&&h!==null)h.return=l,l=h;else{if(l===a)break;for(;l.sibling===null;){if(l.return===null||l.return===a)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function Mr(a,l,h,g){l&=~wm,l&=~Ma,a.suspendedLanes|=l,a.pingedLanes&=~l,g&&(a.warmLanes|=l),g=a.expirationTimes;for(var x=l;0<x;){var b=31-St(x),O=1<<b;g[b]=-1,x&=~O}h!==0&&va(a,h,l)}function ld(){return(Nt&6)===0?(mc(0),!1):!0}function km(){if(yt!==null){if(Mt===0)var a=yt.return;else a=yt,Kn=Oa=null,Wf(a),Po=null,nc=0,a=yt;for(;a!==null;)wS(a.alternate,a),a=a.return;yt=null}}function Vo(a,l){var h=a.timeoutHandle;h!==-1&&(a.timeoutHandle=-1,ow(h)),h=a.cancelPendingCommit,h!==null&&(a.cancelPendingCommit=null,h()),km(),Yt=a,yt=h=Gn(a.current,null),At=l,Mt=0,Ei=null,_r=!1,Uo=hn(a,l),Lm=!1,Fo=Bi=wm=Ma=Pr=as=0,oi=hc=null,Cm=!1,(l&8)!==0&&(l|=l&32);var g=a.entangledLanes;if(g!==0)for(a=a.entanglements,g&=l;0<g;){var x=31-St(g),b=1<<x;l|=a[x],g&=~b}return er=l,Ou(),h}function XS(a,l){ht=null,B.H=Qu,l===Ql||l===Bu?(l=fv(),Mt=3):l===uv?(l=fv(),Mt=4):Mt=l===mS?8:l!==null&&typeof l=="object"&&typeof l.then=="function"?6:1,Ei=l,yt===null&&(as=1,ed(a,ki(l,a.current)))}function WS(){var a=B.H;return B.H=Qu,a===null?Qu:a}function ZS(){var a=B.A;return B.A=VL,a}function Nm(){as=4,_r||(At&4194048)!==At&&Fi.current!==null||(Uo=!0),(Pr&134217727)===0&&(Ma&134217727)===0||Yt===null||Mr(Yt,At,Bi,!1)}function Mm(a,l,h){var g=Nt;Nt|=2;var x=WS(),b=ZS();(Yt!==a||At!==l)&&(od=null,Vo(a,l)),l=!1;var O=as;e:do try{if(Mt!==0&&yt!==null){var k=yt,$=Ei;switch(Mt){case 8:km(),O=6;break e;case 3:case 2:case 9:case 6:Fi.current===null&&(l=!0);var ie=Mt;if(Mt=0,Ei=null,$o(a,k,$,ie),h&&Uo){O=0;break e}break;default:ie=Mt,Mt=0,Ei=null,$o(a,k,$,ie)}}HL(),O=as;break}catch(me){XS(a,me)}while(!0);return l&&a.shellSuspendCounter++,Kn=Oa=null,Nt=g,B.H=x,B.A=b,yt===null&&(Yt=null,At=0,Ou()),O}function HL(){for(;yt!==null;)JS(yt)}function zL(a,l){var h=Nt;Nt|=2;var g=WS(),x=ZS();Yt!==a||At!==l?(od=null,ad=j()+500,Vo(a,l)):Uo=hn(a,l);e:do try{if(Mt!==0&&yt!==null){l=yt;var b=Ei;t:switch(Mt){case 1:Mt=0,Ei=null,$o(a,l,b,1);break;case 2:case 9:if(dv(b)){Mt=0,Ei=null,ex(l);break}l=function(){Mt!==2&&Mt!==9||Yt!==a||(Mt=7),vn(a)},b.then(l,l);break e;case 3:Mt=7;break e;case 4:Mt=5;break e;case 7:dv(b)?(Mt=0,Ei=null,ex(l)):(Mt=0,Ei=null,$o(a,l,b,7));break;case 5:var O=null;switch(yt.tag){case 26:O=yt.memoizedState;case 5:case 27:var k=yt;if(!O||Nx(O)){Mt=0,Ei=null;var $=k.sibling;if($!==null)yt=$;else{var ie=k.return;ie!==null?(yt=ie,cd(ie)):yt=null}break t}}Mt=0,Ei=null,$o(a,l,b,5);break;case 6:Mt=0,Ei=null,$o(a,l,b,6);break;case 8:km(),as=6;break e;default:throw Error(s(462))}}KL();break}catch(me){XS(a,me)}while(!0);return Kn=Oa=null,B.H=g,B.A=x,Nt=h,yt!==null?0:(Yt=null,At=0,Ou(),as)}function KL(){for(;yt!==null&&!st();)JS(yt)}function JS(a){var l=RS(a.alternate,a,er);a.memoizedProps=a.pendingProps,l===null?cd(a):yt=l}function ex(a){var l=a,h=l.alternate;switch(l.tag){case 15:case 0:l=xS(h,l,l.pendingProps,l.type,void 0,At);break;case 11:l=xS(h,l,l.pendingProps,l.type.render,l.ref,At);break;case 5:Wf(l);default:wS(h,l),l=yt=tv(l,er),l=RS(h,l,er)}a.memoizedProps=a.pendingProps,l===null?cd(a):yt=l}function $o(a,l,h,g){Kn=Oa=null,Wf(l),Po=null,nc=0;var x=l.return;try{if(NL(a,x,l,h,At)){as=1,ed(a,ki(h,a.current)),yt=null;return}}catch(b){if(x!==null)throw yt=x,b;as=1,ed(a,ki(h,a.current)),yt=null;return}l.flags&32768?(Ct||g===1?a=!0:Uo||(At&536870912)!==0?a=!1:(_r=a=!0,(g===2||g===9||g===3||g===6)&&(g=Fi.current,g!==null&&g.tag===13&&(g.flags|=16384))),tx(l,a)):cd(l)}function cd(a){var l=a;do{if((l.flags&32768)!==0){tx(l,_r);return}a=l.return;var h=UL(l.alternate,l,er);if(h!==null){yt=h;return}if(l=l.sibling,l!==null){yt=l;return}yt=l=a}while(l!==null);as===0&&(as=5)}function tx(a,l){do{var h=FL(a.alternate,a);if(h!==null){h.flags&=32767,yt=h;return}if(h=a.return,h!==null&&(h.flags|=32768,h.subtreeFlags=0,h.deletions=null),!l&&(a=a.sibling,a!==null)){yt=a;return}yt=a=h}while(a!==null);as=6,yt=null}function sx(a,l,h,g,x,b,O,k,$){a.cancelPendingCommit=null;do ud();while(Ns!==0);if((Nt&6)!==0)throw Error(s(327));if(l!==null){if(l===a.current)throw Error(s(177));if(b=l.lanes|l.childLanes,b|=Rf,oo(a,h,b,O,k,$),a===Yt&&(yt=Yt=null,At=0),Bo=l,Nr=a,jo=h,Dm=b,_m=x,KS=g,(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?(a.callbackNode=null,a.callbackPriority=0,XL(Ue,function(){return ox(),null})):(a.callbackNode=null,a.callbackPriority=0),g=(l.flags&13878)!==0,(l.subtreeFlags&13878)!==0||g){g=B.T,B.T=null,x=Q.p,Q.p=2,O=Nt,Nt|=4;try{BL(a,l,h)}finally{Nt=O,Q.p=x,B.T=g}}Ns=1,ix(),nx(),rx()}}function ix(){if(Ns===1){Ns=0;var a=Nr,l=Bo,h=(l.flags&13878)!==0;if((l.subtreeFlags&13878)!==0||h){h=B.T,B.T=null;var g=Q.p;Q.p=2;var x=Nt;Nt|=4;try{BS(l,a);var b=qm,O=zy(a.containerInfo),k=b.focusedElem,$=b.selectionRange;if(O!==k&&k&&k.ownerDocument&&Hy(k.ownerDocument.documentElement,k)){if($!==null&&Tf(k)){var ie=$.start,me=$.end;if(me===void 0&&(me=ie),"selectionStart"in k)k.selectionStart=ie,k.selectionEnd=Math.min(me,k.value.length);else{var ve=k.ownerDocument||document,oe=ve&&ve.defaultView||window;if(oe.getSelection){var ce=oe.getSelection(),et=k.textContent.length,Xe=Math.min($.start,et),Vt=$.end===void 0?Xe:Math.min($.end,et);!ce.extend&&Xe>Vt&&(O=Vt,Vt=Xe,Xe=O);var X=Gy(k,Xe),Y=Gy(k,Vt);if(X&&Y&&(ce.rangeCount!==1||ce.anchorNode!==X.node||ce.anchorOffset!==X.offset||ce.focusNode!==Y.node||ce.focusOffset!==Y.offset)){var te=ve.createRange();te.setStart(X.node,X.offset),ce.removeAllRanges(),Xe>Vt?(ce.addRange(te),ce.extend(Y.node,Y.offset)):(te.setEnd(Y.node,Y.offset),ce.addRange(te))}}}}for(ve=[],ce=k;ce=ce.parentNode;)ce.nodeType===1&&ve.push({element:ce,left:ce.scrollLeft,top:ce.scrollTop});for(typeof k.focus=="function"&&k.focus(),k=0;k<ve.length;k++){var ye=ve[k];ye.element.scrollLeft=ye.left,ye.element.scrollTop=ye.top}}Ed=!!Ym,qm=Ym=null}finally{Nt=x,Q.p=g,B.T=h}}a.current=l,Ns=2}}function nx(){if(Ns===2){Ns=0;var a=Nr,l=Bo,h=(l.flags&8772)!==0;if((l.subtreeFlags&8772)!==0||h){h=B.T,B.T=null;var g=Q.p;Q.p=2;var x=Nt;Nt|=4;try{NS(a,l.alternate,l)}finally{Nt=x,Q.p=g,B.T=h}}Ns=3}}function rx(){if(Ns===4||Ns===3){Ns=0,W();var a=Nr,l=Bo,h=jo,g=KS;(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?Ns=5:(Ns=0,Bo=Nr=null,ax(a,a.pendingLanes));var x=a.pendingLanes;if(x===0&&(kr=null),vr(h),l=l.stateNode,bt&&typeof bt.onCommitFiberRoot=="function")try{bt.onCommitFiberRoot(Dt,l,void 0,(l.current.flags&128)===128)}catch{}if(g!==null){l=B.T,x=Q.p,Q.p=2,B.T=null;try{for(var b=a.onRecoverableError,O=0;O<g.length;O++){var k=g[O];b(k.value,{componentStack:k.stack})}}finally{B.T=l,Q.p=x}}(jo&3)!==0&&ud(),vn(a),x=a.pendingLanes,(h&4194090)!==0&&(x&42)!==0?a===Pm?fc++:(fc=0,Pm=a):fc=0,mc(0)}}function ax(a,l){(a.pooledCacheLanes&=l)===0&&(l=a.pooledCache,l!=null&&(a.pooledCache=null,Yl(l)))}function ud(a){return ix(),nx(),rx(),ox()}function ox(){if(Ns!==5)return!1;var a=Nr,l=Dm;Dm=0;var h=vr(jo),g=B.T,x=Q.p;try{Q.p=32>h?32:h,B.T=null,h=_m,_m=null;var b=Nr,O=jo;if(Ns=0,Bo=Nr=null,jo=0,(Nt&6)!==0)throw Error(s(331));var k=Nt;if(Nt|=4,HS(b.current),VS(b,b.current,O,h),Nt=k,mc(0,!1),bt&&typeof bt.onPostCommitFiberRoot=="function")try{bt.onPostCommitFiberRoot(Dt,b)}catch{}return!0}finally{Q.p=x,B.T=g,ax(a,l)}}function lx(a,l,h){l=ki(h,l),l=dm(a.stateNode,l,2),a=Ir(a,l,2),a!==null&&(fn(a,2),vn(a))}function Gt(a,l,h){if(a.tag===3)lx(a,a,h);else for(;l!==null;){if(l.tag===3){lx(l,a,h);break}else if(l.tag===1){var g=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(kr===null||!kr.has(g))){a=ki(h,a),h=hS(2),g=Ir(l,h,2),g!==null&&(fS(h,g,l,a),fn(g,2),vn(g));break}}l=l.return}}function Um(a,l,h){var g=a.pingCache;if(g===null){g=a.pingCache=new $L;var x=new Set;g.set(l,x)}else x=g.get(l),x===void 0&&(x=new Set,g.set(l,x));x.has(h)||(Lm=!0,x.add(h),a=YL.bind(null,a,l,h),l.then(a,a))}function YL(a,l,h){var g=a.pingCache;g!==null&&g.delete(l),a.pingedLanes|=a.suspendedLanes&h,a.warmLanes&=~h,Yt===a&&(At&h)===h&&(as===4||as===3&&(At&62914560)===At&&300>j()-Om?(Nt&2)===0&&Vo(a,0):wm|=h,Fo===At&&(Fo=0)),vn(a)}function cx(a,l){l===0&&(l=ya()),a=bo(a,l),a!==null&&(fn(a,l),vn(a))}function qL(a){var l=a.memoizedState,h=0;l!==null&&(h=l.retryLane),cx(a,h)}function QL(a,l){var h=0;switch(a.tag){case 13:var g=a.stateNode,x=a.memoizedState;x!==null&&(h=x.retryLane);break;case 19:g=a.stateNode;break;case 22:g=a.stateNode._retryCache;break;default:throw Error(s(314))}g!==null&&g.delete(l),cx(a,h)}function XL(a,l){return Me(a,l)}var dd=null,Go=null,Fm=!1,hd=!1,Bm=!1,Ua=0;function vn(a){a!==Go&&a.next===null&&(Go===null?dd=Go=a:Go=Go.next=a),hd=!0,Fm||(Fm=!0,ZL())}function mc(a,l){if(!Bm&&hd){Bm=!0;do for(var h=!1,g=dd;g!==null;){if(a!==0){var x=g.pendingLanes;if(x===0)var b=0;else{var O=g.suspendedLanes,k=g.pingedLanes;b=(1<<31-St(42|a)+1)-1,b&=x&~(O&~k),b=b&201326741?b&201326741|1:b?b|2:0}b!==0&&(h=!0,fx(g,b))}else b=At,b=Bn(g,g===Yt?b:0,g.cancelPendingCommit!==null||g.timeoutHandle!==-1),(b&3)===0||hn(g,b)||(h=!0,fx(g,b));g=g.next}while(h);Bm=!1}}function WL(){ux()}function ux(){hd=Fm=!1;var a=0;Ua!==0&&(aw()&&(a=Ua),Ua=0);for(var l=j(),h=null,g=dd;g!==null;){var x=g.next,b=dx(g,l);b===0?(g.next=null,h===null?dd=x:h.next=x,x===null&&(Go=h)):(h=g,(a!==0||(b&3)!==0)&&(hd=!0)),g=x}mc(a)}function dx(a,l){for(var h=a.suspendedLanes,g=a.pingedLanes,x=a.expirationTimes,b=a.pendingLanes&-62914561;0<b;){var O=31-St(b),k=1<<O,$=x[O];$===-1?((k&h)===0||(k&g)!==0)&&(x[O]=ao(k,l)):$<=l&&(a.expiredLanes|=k),b&=~k}if(l=Yt,h=At,h=Bn(a,a===l?h:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),g=a.callbackNode,h===0||a===l&&(Mt===2||Mt===9)||a.cancelPendingCommit!==null)return g!==null&&g!==null&&Qe(g),a.callbackNode=null,a.callbackPriority=0;if((h&3)===0||hn(a,h)){if(l=h&-h,l===a.callbackPriority)return l;switch(g!==null&&Qe(g),vr(h)){case 2:case 8:h=Ie;break;case 32:h=Ue;break;case 268435456:h=it;break;default:h=Ue}return g=hx.bind(null,a),h=Me(h,g),a.callbackPriority=l,a.callbackNode=h,l}return g!==null&&g!==null&&Qe(g),a.callbackPriority=2,a.callbackNode=null,2}function hx(a,l){if(Ns!==0&&Ns!==5)return a.callbackNode=null,a.callbackPriority=0,null;var h=a.callbackNode;if(ud()&&a.callbackNode!==h)return null;var g=At;return g=Bn(a,a===Yt?g:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),g===0?null:(qS(a,g,l),dx(a,j()),a.callbackNode!=null&&a.callbackNode===h?hx.bind(null,a):null)}function fx(a,l){if(ud())return null;qS(a,l,!0)}function ZL(){lw(function(){(Nt&6)!==0?Me(ge,WL):ux()})}function jm(){return Ua===0&&(Ua=pa()),Ua}function mx(a){return a==null||typeof a=="symbol"||typeof a=="boolean"?null:typeof a=="function"?a:bu(""+a)}function gx(a,l){var h=l.ownerDocument.createElement("input");return h.name=l.name,h.value=l.value,a.id&&h.setAttribute("form",a.id),l.parentNode.insertBefore(h,l),a=new FormData(a),h.parentNode.removeChild(h),a}function JL(a,l,h,g,x){if(l==="submit"&&h&&h.stateNode===x){var b=mx((x[Is]||null).action),O=g.submitter;O&&(l=(l=O[Is]||null)?mx(l.formAction):O.getAttribute("formAction"),l!==null&&(b=l,O=null));var k=new Lu("action","action",null,g,x);a.push({event:k,listeners:[{instance:null,listener:function(){if(g.defaultPrevented){if(Ua!==0){var $=O?gx(x,O):new FormData(x);am(h,{pending:!0,data:$,method:x.method,action:b},null,$)}}else typeof b=="function"&&(k.preventDefault(),$=O?gx(x,O):new FormData(x),am(h,{pending:!0,data:$,method:x.method,action:b},b,$))},currentTarget:x}]})}}for(var Vm=0;Vm<If.length;Vm++){var $m=If[Vm],ew=$m.toLowerCase(),tw=$m[0].toUpperCase()+$m.slice(1);Wi(ew,"on"+tw)}Wi(qy,"onAnimationEnd"),Wi(Qy,"onAnimationIteration"),Wi(Xy,"onAnimationStart"),Wi("dblclick","onDoubleClick"),Wi("focusin","onFocus"),Wi("focusout","onBlur"),Wi(vL,"onTransitionRun"),Wi(SL,"onTransitionStart"),Wi(xL,"onTransitionCancel"),Wi(Wy,"onTransitionEnd"),fo("onMouseEnter",["mouseout","mouseover"]),fo("onMouseLeave",["mouseout","mouseover"]),fo("onPointerEnter",["pointerout","pointerover"]),fo("onPointerLeave",["pointerout","pointerover"]),Ta("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ta("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ta("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ta("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ta("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ta("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var gc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),sw=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(gc));function px(a,l){l=(l&4)!==0;for(var h=0;h<a.length;h++){var g=a[h],x=g.event;g=g.listeners;e:{var b=void 0;if(l)for(var O=g.length-1;0<=O;O--){var k=g[O],$=k.instance,ie=k.currentTarget;if(k=k.listener,$!==b&&x.isPropagationStopped())break e;b=k,x.currentTarget=ie;try{b(x)}catch(me){Ju(me)}x.currentTarget=null,b=$}else for(O=0;O<g.length;O++){if(k=g[O],$=k.instance,ie=k.currentTarget,k=k.listener,$!==b&&x.isPropagationStopped())break e;b=k,x.currentTarget=ie;try{b(x)}catch(me){Ju(me)}x.currentTarget=null,b=$}}}}function vt(a,l){var h=l[yi];h===void 0&&(h=l[yi]=new Set);var g=a+"__bubble";h.has(g)||(yx(l,a,2,!1),h.add(g))}function Gm(a,l,h){var g=0;l&&(g|=4),yx(h,a,g,l)}var fd="_reactListening"+Math.random().toString(36).slice(2);function Hm(a){if(!a[fd]){a[fd]=!0,uy.forEach(function(h){h!=="selectionchange"&&(sw.has(h)||Gm(h,!1,a),Gm(h,!0,a))});var l=a.nodeType===9?a:a.ownerDocument;l===null||l[fd]||(l[fd]=!0,Gm("selectionchange",!1,l))}}function yx(a,l,h,g){switch(Vx(l)){case 2:var x=Cw;break;case 8:x=Ow;break;default:x=ng}h=x.bind(null,l,h,a),x=void 0,!hf||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(x=!0),g?x!==void 0?a.addEventListener(l,h,{capture:!0,passive:x}):a.addEventListener(l,h,!0):x!==void 0?a.addEventListener(l,h,{passive:x}):a.addEventListener(l,h,!1)}function zm(a,l,h,g,x){var b=g;if((l&1)===0&&(l&2)===0&&g!==null)e:for(;;){if(g===null)return;var O=g.tag;if(O===3||O===4){var k=g.stateNode.containerInfo;if(k===x)break;if(O===4)for(O=g.return;O!==null;){var $=O.tag;if(($===3||$===4)&&O.stateNode.containerInfo===x)return;O=O.return}for(;k!==null;){if(O=xr(k),O===null)return;if($=O.tag,$===5||$===6||$===26||$===27){g=b=O;continue e}k=k.parentNode}}g=g.return}Ay(function(){var ie=b,me=uf(h),ve=[];e:{var oe=Zy.get(a);if(oe!==void 0){var ce=Lu,et=a;switch(a){case"keypress":if(Iu(h)===0)break e;case"keydown":case"keyup":ce=XR;break;case"focusin":et="focus",ce=pf;break;case"focusout":et="blur",ce=pf;break;case"beforeblur":case"afterblur":ce=pf;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ce=Ly;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ce=FR;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ce=JR;break;case qy:case Qy:case Xy:ce=VR;break;case Wy:ce=tL;break;case"scroll":case"scrollend":ce=MR;break;case"wheel":ce=iL;break;case"copy":case"cut":case"paste":ce=GR;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ce=Cy;break;case"toggle":case"beforetoggle":ce=rL}var Xe=(l&4)!==0,Vt=!Xe&&(a==="scroll"||a==="scrollend"),X=Xe?oe!==null?oe+"Capture":null:oe;Xe=[];for(var Y=ie,te;Y!==null;){var ye=Y;if(te=ye.stateNode,ye=ye.tag,ye!==5&&ye!==26&&ye!==27||te===null||X===null||(ye=kl(Y,X),ye!=null&&Xe.push(pc(Y,ye,te))),Vt)break;Y=Y.return}0<Xe.length&&(oe=new ce(oe,et,null,h,me),ve.push({event:oe,listeners:Xe}))}}if((l&7)===0){e:{if(oe=a==="mouseover"||a==="pointerover",ce=a==="mouseout"||a==="pointerout",oe&&h!==cf&&(et=h.relatedTarget||h.fromElement)&&(xr(et)||et[pi]))break e;if((ce||oe)&&(oe=me.window===me?me:(oe=me.ownerDocument)?oe.defaultView||oe.parentWindow:window,ce?(et=h.relatedTarget||h.toElement,ce=ie,et=et?xr(et):null,et!==null&&(Vt=r(et),Xe=et.tag,et!==Vt||Xe!==5&&Xe!==27&&Xe!==6)&&(et=null)):(ce=null,et=ie),ce!==et)){if(Xe=Ly,ye="onMouseLeave",X="onMouseEnter",Y="mouse",(a==="pointerout"||a==="pointerover")&&(Xe=Cy,ye="onPointerLeave",X="onPointerEnter",Y="pointer"),Vt=ce==null?oe:Pl(ce),te=et==null?oe:Pl(et),oe=new Xe(ye,Y+"leave",ce,h,me),oe.target=Vt,oe.relatedTarget=te,ye=null,xr(me)===ie&&(Xe=new Xe(X,Y+"enter",et,h,me),Xe.target=te,Xe.relatedTarget=Vt,ye=Xe),Vt=ye,ce&&et)t:{for(Xe=ce,X=et,Y=0,te=Xe;te;te=Ho(te))Y++;for(te=0,ye=X;ye;ye=Ho(ye))te++;for(;0<Y-te;)Xe=Ho(Xe),Y--;for(;0<te-Y;)X=Ho(X),te--;for(;Y--;){if(Xe===X||X!==null&&Xe===X.alternate)break t;Xe=Ho(Xe),X=Ho(X)}Xe=null}else Xe=null;ce!==null&&vx(ve,oe,ce,Xe,!1),et!==null&&Vt!==null&&vx(ve,Vt,et,Xe,!0)}}e:{if(oe=ie?Pl(ie):window,ce=oe.nodeName&&oe.nodeName.toLowerCase(),ce==="select"||ce==="input"&&oe.type==="file")var Ge=Uy;else if(Ny(oe))if(Fy)Ge=gL;else{Ge=fL;var mt=hL}else ce=oe.nodeName,!ce||ce.toLowerCase()!=="input"||oe.type!=="checkbox"&&oe.type!=="radio"?ie&&lf(ie.elementType)&&(Ge=Uy):Ge=mL;if(Ge&&(Ge=Ge(a,ie))){My(ve,Ge,h,me);break e}mt&&mt(a,oe,ie),a==="focusout"&&ie&&oe.type==="number"&&ie.memoizedProps.value!=null&&of(oe,"number",oe.value)}switch(mt=ie?Pl(ie):window,a){case"focusin":(Ny(mt)||mt.contentEditable==="true")&&(xo=mt,Ef=ie,$l=null);break;case"focusout":$l=Ef=xo=null;break;case"mousedown":bf=!0;break;case"contextmenu":case"mouseup":case"dragend":bf=!1,Ky(ve,h,me);break;case"selectionchange":if(yL)break;case"keydown":case"keyup":Ky(ve,h,me)}var Ye;if(vf)e:{switch(a){case"compositionstart":var Ze="onCompositionStart";break e;case"compositionend":Ze="onCompositionEnd";break e;case"compositionupdate":Ze="onCompositionUpdate";break e}Ze=void 0}else So?Py(a,h)&&(Ze="onCompositionEnd"):a==="keydown"&&h.keyCode===229&&(Ze="onCompositionStart");Ze&&(Oy&&h.locale!=="ko"&&(So||Ze!=="onCompositionStart"?Ze==="onCompositionEnd"&&So&&(Ye=Iy()):(Tr=me,ff="value"in Tr?Tr.value:Tr.textContent,So=!0)),mt=md(ie,Ze),0<mt.length&&(Ze=new wy(Ze,a,null,h,me),ve.push({event:Ze,listeners:mt}),Ye?Ze.data=Ye:(Ye=ky(h),Ye!==null&&(Ze.data=Ye)))),(Ye=oL?lL(a,h):cL(a,h))&&(Ze=md(ie,"onBeforeInput"),0<Ze.length&&(mt=new wy("onBeforeInput","beforeinput",null,h,me),ve.push({event:mt,listeners:Ze}),mt.data=Ye)),JL(ve,a,ie,h,me)}px(ve,l)})}function pc(a,l,h){return{instance:a,listener:l,currentTarget:h}}function md(a,l){for(var h=l+"Capture",g=[];a!==null;){var x=a,b=x.stateNode;if(x=x.tag,x!==5&&x!==26&&x!==27||b===null||(x=kl(a,h),x!=null&&g.unshift(pc(a,x,b)),x=kl(a,l),x!=null&&g.push(pc(a,x,b))),a.tag===3)return g;a=a.return}return[]}function Ho(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5&&a.tag!==27);return a||null}function vx(a,l,h,g,x){for(var b=l._reactName,O=[];h!==null&&h!==g;){var k=h,$=k.alternate,ie=k.stateNode;if(k=k.tag,$!==null&&$===g)break;k!==5&&k!==26&&k!==27||ie===null||($=ie,x?(ie=kl(h,b),ie!=null&&O.unshift(pc(h,ie,$))):x||(ie=kl(h,b),ie!=null&&O.push(pc(h,ie,$)))),h=h.return}O.length!==0&&a.push({event:l,listeners:O})}var iw=/\r\n?/g,nw=/\u0000|\uFFFD/g;function Sx(a){return(typeof a=="string"?a:""+a).replace(iw,`
`).replace(nw,"")}function xx(a,l){return l=Sx(l),Sx(a)===l}function gd(){}function jt(a,l,h,g,x,b){switch(h){case"children":typeof g=="string"?l==="body"||l==="textarea"&&g===""||po(a,g):(typeof g=="number"||typeof g=="bigint")&&l!=="body"&&po(a,""+g);break;case"className":xu(a,"class",g);break;case"tabIndex":xu(a,"tabindex",g);break;case"dir":case"role":case"viewBox":case"width":case"height":xu(a,h,g);break;case"style":Ey(a,g,b);break;case"data":if(l!=="object"){xu(a,"data",g);break}case"src":case"href":if(g===""&&(l!=="a"||h!=="href")){a.removeAttribute(h);break}if(g==null||typeof g=="function"||typeof g=="symbol"||typeof g=="boolean"){a.removeAttribute(h);break}g=bu(""+g),a.setAttribute(h,g);break;case"action":case"formAction":if(typeof g=="function"){a.setAttribute(h,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof b=="function"&&(h==="formAction"?(l!=="input"&&jt(a,l,"name",x.name,x,null),jt(a,l,"formEncType",x.formEncType,x,null),jt(a,l,"formMethod",x.formMethod,x,null),jt(a,l,"formTarget",x.formTarget,x,null)):(jt(a,l,"encType",x.encType,x,null),jt(a,l,"method",x.method,x,null),jt(a,l,"target",x.target,x,null)));if(g==null||typeof g=="symbol"||typeof g=="boolean"){a.removeAttribute(h);break}g=bu(""+g),a.setAttribute(h,g);break;case"onClick":g!=null&&(a.onclick=gd);break;case"onScroll":g!=null&&vt("scroll",a);break;case"onScrollEnd":g!=null&&vt("scrollend",a);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(s(61));if(h=g.__html,h!=null){if(x.children!=null)throw Error(s(60));a.innerHTML=h}}break;case"multiple":a.multiple=g&&typeof g!="function"&&typeof g!="symbol";break;case"muted":a.muted=g&&typeof g!="function"&&typeof g!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(g==null||typeof g=="function"||typeof g=="boolean"||typeof g=="symbol"){a.removeAttribute("xlink:href");break}h=bu(""+g),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",h);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":g!=null&&typeof g!="function"&&typeof g!="symbol"?a.setAttribute(h,""+g):a.removeAttribute(h);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":g&&typeof g!="function"&&typeof g!="symbol"?a.setAttribute(h,""):a.removeAttribute(h);break;case"capture":case"download":g===!0?a.setAttribute(h,""):g!==!1&&g!=null&&typeof g!="function"&&typeof g!="symbol"?a.setAttribute(h,g):a.removeAttribute(h);break;case"cols":case"rows":case"size":case"span":g!=null&&typeof g!="function"&&typeof g!="symbol"&&!isNaN(g)&&1<=g?a.setAttribute(h,g):a.removeAttribute(h);break;case"rowSpan":case"start":g==null||typeof g=="function"||typeof g=="symbol"||isNaN(g)?a.removeAttribute(h):a.setAttribute(h,g);break;case"popover":vt("beforetoggle",a),vt("toggle",a),Su(a,"popover",g);break;case"xlinkActuate":Vn(a,"http://www.w3.org/1999/xlink","xlink:actuate",g);break;case"xlinkArcrole":Vn(a,"http://www.w3.org/1999/xlink","xlink:arcrole",g);break;case"xlinkRole":Vn(a,"http://www.w3.org/1999/xlink","xlink:role",g);break;case"xlinkShow":Vn(a,"http://www.w3.org/1999/xlink","xlink:show",g);break;case"xlinkTitle":Vn(a,"http://www.w3.org/1999/xlink","xlink:title",g);break;case"xlinkType":Vn(a,"http://www.w3.org/1999/xlink","xlink:type",g);break;case"xmlBase":Vn(a,"http://www.w3.org/XML/1998/namespace","xml:base",g);break;case"xmlLang":Vn(a,"http://www.w3.org/XML/1998/namespace","xml:lang",g);break;case"xmlSpace":Vn(a,"http://www.w3.org/XML/1998/namespace","xml:space",g);break;case"is":Su(a,"is",g);break;case"innerText":case"textContent":break;default:(!(2<h.length)||h[0]!=="o"&&h[0]!=="O"||h[1]!=="n"&&h[1]!=="N")&&(h=kR.get(h)||h,Su(a,h,g))}}function Km(a,l,h,g,x,b){switch(h){case"style":Ey(a,g,b);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(s(61));if(h=g.__html,h!=null){if(x.children!=null)throw Error(s(60));a.innerHTML=h}}break;case"children":typeof g=="string"?po(a,g):(typeof g=="number"||typeof g=="bigint")&&po(a,""+g);break;case"onScroll":g!=null&&vt("scroll",a);break;case"onScrollEnd":g!=null&&vt("scrollend",a);break;case"onClick":g!=null&&(a.onclick=gd);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!dy.hasOwnProperty(h))e:{if(h[0]==="o"&&h[1]==="n"&&(x=h.endsWith("Capture"),l=h.slice(2,x?h.length-7:void 0),b=a[Is]||null,b=b!=null?b[h]:null,typeof b=="function"&&a.removeEventListener(l,b,x),typeof g=="function")){typeof b!="function"&&b!==null&&(h in a?a[h]=null:a.hasAttribute(h)&&a.removeAttribute(h)),a.addEventListener(l,g,x);break e}h in a?a[h]=g:g===!0?a.setAttribute(h,""):Su(a,h,g)}}}function Ms(a,l,h){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":vt("error",a),vt("load",a);var g=!1,x=!1,b;for(b in h)if(h.hasOwnProperty(b)){var O=h[b];if(O!=null)switch(b){case"src":g=!0;break;case"srcSet":x=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,l));default:jt(a,l,b,O,h,null)}}x&&jt(a,l,"srcSet",h.srcSet,h,null),g&&jt(a,l,"src",h.src,h,null);return;case"input":vt("invalid",a);var k=b=O=x=null,$=null,ie=null;for(g in h)if(h.hasOwnProperty(g)){var me=h[g];if(me!=null)switch(g){case"name":x=me;break;case"type":O=me;break;case"checked":$=me;break;case"defaultChecked":ie=me;break;case"value":b=me;break;case"defaultValue":k=me;break;case"children":case"dangerouslySetInnerHTML":if(me!=null)throw Error(s(137,l));break;default:jt(a,l,g,me,h,null)}}vy(a,b,k,$,ie,O,x,!1),Tu(a);return;case"select":vt("invalid",a),g=O=b=null;for(x in h)if(h.hasOwnProperty(x)&&(k=h[x],k!=null))switch(x){case"value":b=k;break;case"defaultValue":O=k;break;case"multiple":g=k;default:jt(a,l,x,k,h,null)}l=b,h=O,a.multiple=!!g,l!=null?go(a,!!g,l,!1):h!=null&&go(a,!!g,h,!0);return;case"textarea":vt("invalid",a),b=x=g=null;for(O in h)if(h.hasOwnProperty(O)&&(k=h[O],k!=null))switch(O){case"value":g=k;break;case"defaultValue":x=k;break;case"children":b=k;break;case"dangerouslySetInnerHTML":if(k!=null)throw Error(s(91));break;default:jt(a,l,O,k,h,null)}xy(a,g,x,b),Tu(a);return;case"option":for($ in h)if(h.hasOwnProperty($)&&(g=h[$],g!=null))switch($){case"selected":a.selected=g&&typeof g!="function"&&typeof g!="symbol";break;default:jt(a,l,$,g,h,null)}return;case"dialog":vt("beforetoggle",a),vt("toggle",a),vt("cancel",a),vt("close",a);break;case"iframe":case"object":vt("load",a);break;case"video":case"audio":for(g=0;g<gc.length;g++)vt(gc[g],a);break;case"image":vt("error",a),vt("load",a);break;case"details":vt("toggle",a);break;case"embed":case"source":case"link":vt("error",a),vt("load",a);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ie in h)if(h.hasOwnProperty(ie)&&(g=h[ie],g!=null))switch(ie){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,l));default:jt(a,l,ie,g,h,null)}return;default:if(lf(l)){for(me in h)h.hasOwnProperty(me)&&(g=h[me],g!==void 0&&Km(a,l,me,g,h,void 0));return}}for(k in h)h.hasOwnProperty(k)&&(g=h[k],g!=null&&jt(a,l,k,g,h,null))}function rw(a,l,h,g){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var x=null,b=null,O=null,k=null,$=null,ie=null,me=null;for(ce in h){var ve=h[ce];if(h.hasOwnProperty(ce)&&ve!=null)switch(ce){case"checked":break;case"value":break;case"defaultValue":$=ve;default:g.hasOwnProperty(ce)||jt(a,l,ce,null,g,ve)}}for(var oe in g){var ce=g[oe];if(ve=h[oe],g.hasOwnProperty(oe)&&(ce!=null||ve!=null))switch(oe){case"type":b=ce;break;case"name":x=ce;break;case"checked":ie=ce;break;case"defaultChecked":me=ce;break;case"value":O=ce;break;case"defaultValue":k=ce;break;case"children":case"dangerouslySetInnerHTML":if(ce!=null)throw Error(s(137,l));break;default:ce!==ve&&jt(a,l,oe,ce,g,ve)}}af(a,O,k,$,ie,me,b,x);return;case"select":ce=O=k=oe=null;for(b in h)if($=h[b],h.hasOwnProperty(b)&&$!=null)switch(b){case"value":break;case"multiple":ce=$;default:g.hasOwnProperty(b)||jt(a,l,b,null,g,$)}for(x in g)if(b=g[x],$=h[x],g.hasOwnProperty(x)&&(b!=null||$!=null))switch(x){case"value":oe=b;break;case"defaultValue":k=b;break;case"multiple":O=b;default:b!==$&&jt(a,l,x,b,g,$)}l=k,h=O,g=ce,oe!=null?go(a,!!h,oe,!1):!!g!=!!h&&(l!=null?go(a,!!h,l,!0):go(a,!!h,h?[]:"",!1));return;case"textarea":ce=oe=null;for(k in h)if(x=h[k],h.hasOwnProperty(k)&&x!=null&&!g.hasOwnProperty(k))switch(k){case"value":break;case"children":break;default:jt(a,l,k,null,g,x)}for(O in g)if(x=g[O],b=h[O],g.hasOwnProperty(O)&&(x!=null||b!=null))switch(O){case"value":oe=x;break;case"defaultValue":ce=x;break;case"children":break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(s(91));break;default:x!==b&&jt(a,l,O,x,g,b)}Sy(a,oe,ce);return;case"option":for(var et in h)if(oe=h[et],h.hasOwnProperty(et)&&oe!=null&&!g.hasOwnProperty(et))switch(et){case"selected":a.selected=!1;break;default:jt(a,l,et,null,g,oe)}for($ in g)if(oe=g[$],ce=h[$],g.hasOwnProperty($)&&oe!==ce&&(oe!=null||ce!=null))switch($){case"selected":a.selected=oe&&typeof oe!="function"&&typeof oe!="symbol";break;default:jt(a,l,$,oe,g,ce)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Xe in h)oe=h[Xe],h.hasOwnProperty(Xe)&&oe!=null&&!g.hasOwnProperty(Xe)&&jt(a,l,Xe,null,g,oe);for(ie in g)if(oe=g[ie],ce=h[ie],g.hasOwnProperty(ie)&&oe!==ce&&(oe!=null||ce!=null))switch(ie){case"children":case"dangerouslySetInnerHTML":if(oe!=null)throw Error(s(137,l));break;default:jt(a,l,ie,oe,g,ce)}return;default:if(lf(l)){for(var Vt in h)oe=h[Vt],h.hasOwnProperty(Vt)&&oe!==void 0&&!g.hasOwnProperty(Vt)&&Km(a,l,Vt,void 0,g,oe);for(me in g)oe=g[me],ce=h[me],!g.hasOwnProperty(me)||oe===ce||oe===void 0&&ce===void 0||Km(a,l,me,oe,g,ce);return}}for(var X in h)oe=h[X],h.hasOwnProperty(X)&&oe!=null&&!g.hasOwnProperty(X)&&jt(a,l,X,null,g,oe);for(ve in g)oe=g[ve],ce=h[ve],!g.hasOwnProperty(ve)||oe===ce||oe==null&&ce==null||jt(a,l,ve,oe,g,ce)}var Ym=null,qm=null;function pd(a){return a.nodeType===9?a:a.ownerDocument}function Tx(a){switch(a){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Ex(a,l){if(a===0)switch(l){case"svg":return 1;case"math":return 2;default:return 0}return a===1&&l==="foreignObject"?0:a}function Qm(a,l){return a==="textarea"||a==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.children=="bigint"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var Xm=null;function aw(){var a=window.event;return a&&a.type==="popstate"?a===Xm?!1:(Xm=a,!0):(Xm=null,!1)}var bx=typeof setTimeout=="function"?setTimeout:void 0,ow=typeof clearTimeout=="function"?clearTimeout:void 0,Ax=typeof Promise=="function"?Promise:void 0,lw=typeof queueMicrotask=="function"?queueMicrotask:typeof Ax<"u"?function(a){return Ax.resolve(null).then(a).catch(cw)}:bx;function cw(a){setTimeout(function(){throw a})}function Ur(a){return a==="head"}function Ix(a,l){var h=l,g=0,x=0;do{var b=h.nextSibling;if(a.removeChild(h),b&&b.nodeType===8)if(h=b.data,h==="/$"){if(0<g&&8>g){h=g;var O=a.ownerDocument;if(h&1&&yc(O.documentElement),h&2&&yc(O.body),h&4)for(h=O.head,yc(h),O=h.firstChild;O;){var k=O.nextSibling,$=O.nodeName;O[jn]||$==="SCRIPT"||$==="STYLE"||$==="LINK"&&O.rel.toLowerCase()==="stylesheet"||h.removeChild(O),O=k}}if(x===0){a.removeChild(b),Ic(l);return}x--}else h==="$"||h==="$?"||h==="$!"?x++:g=h.charCodeAt(0)-48;else g=0;h=b}while(h);Ic(l)}function Wm(a){var l=a.firstChild;for(l&&l.nodeType===10&&(l=l.nextSibling);l;){var h=l;switch(l=l.nextSibling,h.nodeName){case"HTML":case"HEAD":case"BODY":Wm(h),_l(h);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(h.rel.toLowerCase()==="stylesheet")continue}a.removeChild(h)}}function uw(a,l,h,g){for(;a.nodeType===1;){var x=h;if(a.nodeName.toLowerCase()!==l.toLowerCase()){if(!g&&(a.nodeName!=="INPUT"||a.type!=="hidden"))break}else if(g){if(!a[jn])switch(l){case"meta":if(!a.hasAttribute("itemprop"))break;return a;case"link":if(b=a.getAttribute("rel"),b==="stylesheet"&&a.hasAttribute("data-precedence"))break;if(b!==x.rel||a.getAttribute("href")!==(x.href==null||x.href===""?null:x.href)||a.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin)||a.getAttribute("title")!==(x.title==null?null:x.title))break;return a;case"style":if(a.hasAttribute("data-precedence"))break;return a;case"script":if(b=a.getAttribute("src"),(b!==(x.src==null?null:x.src)||a.getAttribute("type")!==(x.type==null?null:x.type)||a.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin))&&b&&a.hasAttribute("async")&&!a.hasAttribute("itemprop"))break;return a;default:return a}}else if(l==="input"&&a.type==="hidden"){var b=x.name==null?null:""+x.name;if(x.type==="hidden"&&a.getAttribute("name")===b)return a}else return a;if(a=Ji(a.nextSibling),a===null)break}return null}function dw(a,l,h){if(l==="")return null;for(;a.nodeType!==3;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!h||(a=Ji(a.nextSibling),a===null))return null;return a}function Zm(a){return a.data==="$!"||a.data==="$?"&&a.ownerDocument.readyState==="complete"}function hw(a,l){var h=a.ownerDocument;if(a.data!=="$?"||h.readyState==="complete")l();else{var g=function(){l(),h.removeEventListener("DOMContentLoaded",g)};h.addEventListener("DOMContentLoaded",g),a._reactRetry=g}}function Ji(a){for(;a!=null;a=a.nextSibling){var l=a.nodeType;if(l===1||l===3)break;if(l===8){if(l=a.data,l==="$"||l==="$!"||l==="$?"||l==="F!"||l==="F")break;if(l==="/$")return null}}return a}var Jm=null;function Rx(a){a=a.previousSibling;for(var l=0;a;){if(a.nodeType===8){var h=a.data;if(h==="$"||h==="$!"||h==="$?"){if(l===0)return a;l--}else h==="/$"&&l++}a=a.previousSibling}return null}function Lx(a,l,h){switch(l=pd(h),a){case"html":if(a=l.documentElement,!a)throw Error(s(452));return a;case"head":if(a=l.head,!a)throw Error(s(453));return a;case"body":if(a=l.body,!a)throw Error(s(454));return a;default:throw Error(s(451))}}function yc(a){for(var l=a.attributes;l.length;)a.removeAttributeNode(l[0]);_l(a)}var ji=new Map,wx=new Set;function yd(a){return typeof a.getRootNode=="function"?a.getRootNode():a.nodeType===9?a:a.ownerDocument}var tr=Q.d;Q.d={f:fw,r:mw,D:gw,C:pw,L:yw,m:vw,X:xw,S:Sw,M:Tw};function fw(){var a=tr.f(),l=ld();return a||l}function mw(a){var l=uo(a);l!==null&&l.tag===5&&l.type==="form"?qv(l):tr.r(a)}var zo=typeof document>"u"?null:document;function Cx(a,l,h){var g=zo;if(g&&typeof l=="string"&&l){var x=Pi(l);x='link[rel="'+a+'"][href="'+x+'"]',typeof h=="string"&&(x+='[crossorigin="'+h+'"]'),wx.has(x)||(wx.add(x),a={rel:a,crossOrigin:h,href:l},g.querySelector(x)===null&&(l=g.createElement("link"),Ms(l,"link",a),Rs(l),g.head.appendChild(l)))}}function gw(a){tr.D(a),Cx("dns-prefetch",a,null)}function pw(a,l){tr.C(a,l),Cx("preconnect",a,l)}function yw(a,l,h){tr.L(a,l,h);var g=zo;if(g&&a&&l){var x='link[rel="preload"][as="'+Pi(l)+'"]';l==="image"&&h&&h.imageSrcSet?(x+='[imagesrcset="'+Pi(h.imageSrcSet)+'"]',typeof h.imageSizes=="string"&&(x+='[imagesizes="'+Pi(h.imageSizes)+'"]')):x+='[href="'+Pi(a)+'"]';var b=x;switch(l){case"style":b=Ko(a);break;case"script":b=Yo(a)}ji.has(b)||(a=f({rel:"preload",href:l==="image"&&h&&h.imageSrcSet?void 0:a,as:l},h),ji.set(b,a),g.querySelector(x)!==null||l==="style"&&g.querySelector(vc(b))||l==="script"&&g.querySelector(Sc(b))||(l=g.createElement("link"),Ms(l,"link",a),Rs(l),g.head.appendChild(l)))}}function vw(a,l){tr.m(a,l);var h=zo;if(h&&a){var g=l&&typeof l.as=="string"?l.as:"script",x='link[rel="modulepreload"][as="'+Pi(g)+'"][href="'+Pi(a)+'"]',b=x;switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":b=Yo(a)}if(!ji.has(b)&&(a=f({rel:"modulepreload",href:a},l),ji.set(b,a),h.querySelector(x)===null)){switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(h.querySelector(Sc(b)))return}g=h.createElement("link"),Ms(g,"link",a),Rs(g),h.head.appendChild(g)}}}function Sw(a,l,h){tr.S(a,l,h);var g=zo;if(g&&a){var x=ho(g).hoistableStyles,b=Ko(a);l=l||"default";var O=x.get(b);if(!O){var k={loading:0,preload:null};if(O=g.querySelector(vc(b)))k.loading=5;else{a=f({rel:"stylesheet",href:a,"data-precedence":l},h),(h=ji.get(b))&&eg(a,h);var $=O=g.createElement("link");Rs($),Ms($,"link",a),$._p=new Promise(function(ie,me){$.onload=ie,$.onerror=me}),$.addEventListener("load",function(){k.loading|=1}),$.addEventListener("error",function(){k.loading|=2}),k.loading|=4,vd(O,l,g)}O={type:"stylesheet",instance:O,count:1,state:k},x.set(b,O)}}}function xw(a,l){tr.X(a,l);var h=zo;if(h&&a){var g=ho(h).hoistableScripts,x=Yo(a),b=g.get(x);b||(b=h.querySelector(Sc(x)),b||(a=f({src:a,async:!0},l),(l=ji.get(x))&&tg(a,l),b=h.createElement("script"),Rs(b),Ms(b,"link",a),h.head.appendChild(b)),b={type:"script",instance:b,count:1,state:null},g.set(x,b))}}function Tw(a,l){tr.M(a,l);var h=zo;if(h&&a){var g=ho(h).hoistableScripts,x=Yo(a),b=g.get(x);b||(b=h.querySelector(Sc(x)),b||(a=f({src:a,async:!0,type:"module"},l),(l=ji.get(x))&&tg(a,l),b=h.createElement("script"),Rs(b),Ms(b,"link",a),h.head.appendChild(b)),b={type:"script",instance:b,count:1,state:null},g.set(x,b))}}function Ox(a,l,h,g){var x=(x=fe.current)?yd(x):null;if(!x)throw Error(s(446));switch(a){case"meta":case"title":return null;case"style":return typeof h.precedence=="string"&&typeof h.href=="string"?(l=Ko(h.href),h=ho(x).hoistableStyles,g=h.get(l),g||(g={type:"style",instance:null,count:0,state:null},h.set(l,g)),g):{type:"void",instance:null,count:0,state:null};case"link":if(h.rel==="stylesheet"&&typeof h.href=="string"&&typeof h.precedence=="string"){a=Ko(h.href);var b=ho(x).hoistableStyles,O=b.get(a);if(O||(x=x.ownerDocument||x,O={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},b.set(a,O),(b=x.querySelector(vc(a)))&&!b._p&&(O.instance=b,O.state.loading=5),ji.has(a)||(h={rel:"preload",as:"style",href:h.href,crossOrigin:h.crossOrigin,integrity:h.integrity,media:h.media,hrefLang:h.hrefLang,referrerPolicy:h.referrerPolicy},ji.set(a,h),b||Ew(x,a,h,O.state))),l&&g===null)throw Error(s(528,""));return O}if(l&&g!==null)throw Error(s(529,""));return null;case"script":return l=h.async,h=h.src,typeof h=="string"&&l&&typeof l!="function"&&typeof l!="symbol"?(l=Yo(h),h=ho(x).hoistableScripts,g=h.get(l),g||(g={type:"script",instance:null,count:0,state:null},h.set(l,g)),g):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,a))}}function Ko(a){return'href="'+Pi(a)+'"'}function vc(a){return'link[rel="stylesheet"]['+a+"]"}function Dx(a){return f({},a,{"data-precedence":a.precedence,precedence:null})}function Ew(a,l,h,g){a.querySelector('link[rel="preload"][as="style"]['+l+"]")?g.loading=1:(l=a.createElement("link"),g.preload=l,l.addEventListener("load",function(){return g.loading|=1}),l.addEventListener("error",function(){return g.loading|=2}),Ms(l,"link",h),Rs(l),a.head.appendChild(l))}function Yo(a){return'[src="'+Pi(a)+'"]'}function Sc(a){return"script[async]"+a}function _x(a,l,h){if(l.count++,l.instance===null)switch(l.type){case"style":var g=a.querySelector('style[data-href~="'+Pi(h.href)+'"]');if(g)return l.instance=g,Rs(g),g;var x=f({},h,{"data-href":h.href,"data-precedence":h.precedence,href:null,precedence:null});return g=(a.ownerDocument||a).createElement("style"),Rs(g),Ms(g,"style",x),vd(g,h.precedence,a),l.instance=g;case"stylesheet":x=Ko(h.href);var b=a.querySelector(vc(x));if(b)return l.state.loading|=4,l.instance=b,Rs(b),b;g=Dx(h),(x=ji.get(x))&&eg(g,x),b=(a.ownerDocument||a).createElement("link"),Rs(b);var O=b;return O._p=new Promise(function(k,$){O.onload=k,O.onerror=$}),Ms(b,"link",g),l.state.loading|=4,vd(b,h.precedence,a),l.instance=b;case"script":return b=Yo(h.src),(x=a.querySelector(Sc(b)))?(l.instance=x,Rs(x),x):(g=h,(x=ji.get(b))&&(g=f({},h),tg(g,x)),a=a.ownerDocument||a,x=a.createElement("script"),Rs(x),Ms(x,"link",g),a.head.appendChild(x),l.instance=x);case"void":return null;default:throw Error(s(443,l.type))}else l.type==="stylesheet"&&(l.state.loading&4)===0&&(g=l.instance,l.state.loading|=4,vd(g,h.precedence,a));return l.instance}function vd(a,l,h){for(var g=h.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),x=g.length?g[g.length-1]:null,b=x,O=0;O<g.length;O++){var k=g[O];if(k.dataset.precedence===l)b=k;else if(b!==x)break}b?b.parentNode.insertBefore(a,b.nextSibling):(l=h.nodeType===9?h.head:h,l.insertBefore(a,l.firstChild))}function eg(a,l){a.crossOrigin==null&&(a.crossOrigin=l.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=l.referrerPolicy),a.title==null&&(a.title=l.title)}function tg(a,l){a.crossOrigin==null&&(a.crossOrigin=l.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=l.referrerPolicy),a.integrity==null&&(a.integrity=l.integrity)}var Sd=null;function Px(a,l,h){if(Sd===null){var g=new Map,x=Sd=new Map;x.set(h,g)}else x=Sd,g=x.get(h),g||(g=new Map,x.set(h,g));if(g.has(a))return g;for(g.set(a,null),h=h.getElementsByTagName(a),x=0;x<h.length;x++){var b=h[x];if(!(b[jn]||b[ls]||a==="link"&&b.getAttribute("rel")==="stylesheet")&&b.namespaceURI!=="http://www.w3.org/2000/svg"){var O=b.getAttribute(l)||"";O=a+O;var k=g.get(O);k?k.push(b):g.set(O,[b])}}return g}function kx(a,l,h){a=a.ownerDocument||a,a.head.insertBefore(h,l==="title"?a.querySelector("head > title"):null)}function bw(a,l,h){if(h===1||l.itemProp!=null)return!1;switch(a){case"meta":case"title":return!0;case"style":if(typeof l.precedence!="string"||typeof l.href!="string"||l.href==="")break;return!0;case"link":if(typeof l.rel!="string"||typeof l.href!="string"||l.href===""||l.onLoad||l.onError)break;switch(l.rel){case"stylesheet":return a=l.disabled,typeof l.precedence=="string"&&a==null;default:return!0}case"script":if(l.async&&typeof l.async!="function"&&typeof l.async!="symbol"&&!l.onLoad&&!l.onError&&l.src&&typeof l.src=="string")return!0}return!1}function Nx(a){return!(a.type==="stylesheet"&&(a.state.loading&3)===0)}var xc=null;function Aw(){}function Iw(a,l,h){if(xc===null)throw Error(s(475));var g=xc;if(l.type==="stylesheet"&&(typeof h.media!="string"||matchMedia(h.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var x=Ko(h.href),b=a.querySelector(vc(x));if(b){a=b._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(g.count++,g=xd.bind(g),a.then(g,g)),l.state.loading|=4,l.instance=b,Rs(b);return}b=a.ownerDocument||a,h=Dx(h),(x=ji.get(x))&&eg(h,x),b=b.createElement("link"),Rs(b);var O=b;O._p=new Promise(function(k,$){O.onload=k,O.onerror=$}),Ms(b,"link",h),l.instance=b}g.stylesheets===null&&(g.stylesheets=new Map),g.stylesheets.set(l,a),(a=l.state.preload)&&(l.state.loading&3)===0&&(g.count++,l=xd.bind(g),a.addEventListener("load",l),a.addEventListener("error",l))}}function Rw(){if(xc===null)throw Error(s(475));var a=xc;return a.stylesheets&&a.count===0&&sg(a,a.stylesheets),0<a.count?function(l){var h=setTimeout(function(){if(a.stylesheets&&sg(a,a.stylesheets),a.unsuspend){var g=a.unsuspend;a.unsuspend=null,g()}},6e4);return a.unsuspend=l,function(){a.unsuspend=null,clearTimeout(h)}}:null}function xd(){if(this.count--,this.count===0){if(this.stylesheets)sg(this,this.stylesheets);else if(this.unsuspend){var a=this.unsuspend;this.unsuspend=null,a()}}}var Td=null;function sg(a,l){a.stylesheets=null,a.unsuspend!==null&&(a.count++,Td=new Map,l.forEach(Lw,a),Td=null,xd.call(a))}function Lw(a,l){if(!(l.state.loading&4)){var h=Td.get(a);if(h)var g=h.get(null);else{h=new Map,Td.set(a,h);for(var x=a.querySelectorAll("link[data-precedence],style[data-precedence]"),b=0;b<x.length;b++){var O=x[b];(O.nodeName==="LINK"||O.getAttribute("media")!=="not all")&&(h.set(O.dataset.precedence,O),g=O)}g&&h.set(null,g)}x=l.instance,O=x.getAttribute("data-precedence"),b=h.get(O)||g,b===g&&h.set(null,x),h.set(O,x),this.count++,g=xd.bind(this),x.addEventListener("load",g),x.addEventListener("error",g),b?b.parentNode.insertBefore(x,b.nextSibling):(a=a.nodeType===9?a.head:a,a.insertBefore(x,a.firstChild)),l.state.loading|=4}}var Tc={$$typeof:I,Provider:null,Consumer:null,_currentValue:re,_currentValue2:re,_threadCount:0};function ww(a,l,h,g,x,b,O,k){this.tag=1,this.containerInfo=a,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=pr(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=pr(0),this.hiddenUpdates=pr(null),this.identifierPrefix=g,this.onUncaughtError=x,this.onCaughtError=b,this.onRecoverableError=O,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=k,this.incompleteTransitions=new Map}function Mx(a,l,h,g,x,b,O,k,$,ie,me,ve){return a=new ww(a,l,h,O,k,$,ie,ve),l=1,b===!0&&(l|=24),b=Si(3,null,null,l),a.current=b,b.stateNode=a,l=Uf(),l.refCount++,a.pooledCache=l,l.refCount++,b.memoizedState={element:g,isDehydrated:h,cache:l},Vf(b),a}function Ux(a){return a?(a=Ao,a):Ao}function Fx(a,l,h,g,x,b){x=Ux(x),g.context===null?g.context=x:g.pendingContext=x,g=Ar(l),g.payload={element:h},b=b===void 0?null:b,b!==null&&(g.callback=b),h=Ir(a,g,l),h!==null&&(Ai(h,a,l),Wl(h,a,l))}function Bx(a,l){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var h=a.retryLane;a.retryLane=h!==0&&h<l?h:l}}function ig(a,l){Bx(a,l),(a=a.alternate)&&Bx(a,l)}function jx(a){if(a.tag===13){var l=bo(a,67108864);l!==null&&Ai(l,a,67108864),ig(a,67108864)}}var Ed=!0;function Cw(a,l,h,g){var x=B.T;B.T=null;var b=Q.p;try{Q.p=2,ng(a,l,h,g)}finally{Q.p=b,B.T=x}}function Ow(a,l,h,g){var x=B.T;B.T=null;var b=Q.p;try{Q.p=8,ng(a,l,h,g)}finally{Q.p=b,B.T=x}}function ng(a,l,h,g){if(Ed){var x=rg(g);if(x===null)zm(a,l,g,bd,h),$x(a,g);else if(_w(x,a,l,h,g))g.stopPropagation();else if($x(a,g),l&4&&-1<Dw.indexOf(a)){for(;x!==null;){var b=uo(x);if(b!==null)switch(b.tag){case 3:if(b=b.stateNode,b.current.memoizedState.isDehydrated){var O=Ws(b.pendingLanes);if(O!==0){var k=b;for(k.pendingLanes|=2,k.entangledLanes|=2;O;){var $=1<<31-St(O);k.entanglements[1]|=$,O&=~$}vn(b),(Nt&6)===0&&(ad=j()+500,mc(0))}}break;case 13:k=bo(b,2),k!==null&&Ai(k,b,2),ld(),ig(b,2)}if(b=rg(g),b===null&&zm(a,l,g,bd,h),b===x)break;x=b}x!==null&&g.stopPropagation()}else zm(a,l,g,null,h)}}function rg(a){return a=uf(a),ag(a)}var bd=null;function ag(a){if(bd=null,a=xr(a),a!==null){var l=r(a);if(l===null)a=null;else{var h=l.tag;if(h===13){if(a=o(l),a!==null)return a;a=null}else if(h===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;a=null}else l!==a&&(a=null)}}return bd=a,null}function Vx(a){switch(a){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ne()){case ge:return 2;case Ie:return 8;case Ue:case Ve:return 32;case it:return 268435456;default:return 32}default:return 32}}var og=!1,Fr=null,Br=null,jr=null,Ec=new Map,bc=new Map,Vr=[],Dw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function $x(a,l){switch(a){case"focusin":case"focusout":Fr=null;break;case"dragenter":case"dragleave":Br=null;break;case"mouseover":case"mouseout":jr=null;break;case"pointerover":case"pointerout":Ec.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":bc.delete(l.pointerId)}}function Ac(a,l,h,g,x,b){return a===null||a.nativeEvent!==b?(a={blockedOn:l,domEventName:h,eventSystemFlags:g,nativeEvent:b,targetContainers:[x]},l!==null&&(l=uo(l),l!==null&&jx(l)),a):(a.eventSystemFlags|=g,l=a.targetContainers,x!==null&&l.indexOf(x)===-1&&l.push(x),a)}function _w(a,l,h,g,x){switch(l){case"focusin":return Fr=Ac(Fr,a,l,h,g,x),!0;case"dragenter":return Br=Ac(Br,a,l,h,g,x),!0;case"mouseover":return jr=Ac(jr,a,l,h,g,x),!0;case"pointerover":var b=x.pointerId;return Ec.set(b,Ac(Ec.get(b)||null,a,l,h,g,x)),!0;case"gotpointercapture":return b=x.pointerId,bc.set(b,Ac(bc.get(b)||null,a,l,h,g,x)),!0}return!1}function Gx(a){var l=xr(a.target);if(l!==null){var h=r(l);if(h!==null){if(l=h.tag,l===13){if(l=o(h),l!==null){a.blockedOn=l,lo(a.priority,function(){if(h.tag===13){var g=bi();g=yr(g);var x=bo(h,g);x!==null&&Ai(x,h,g),ig(h,g)}});return}}else if(l===3&&h.stateNode.current.memoizedState.isDehydrated){a.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}a.blockedOn=null}function Ad(a){if(a.blockedOn!==null)return!1;for(var l=a.targetContainers;0<l.length;){var h=rg(a.nativeEvent);if(h===null){h=a.nativeEvent;var g=new h.constructor(h.type,h);cf=g,h.target.dispatchEvent(g),cf=null}else return l=uo(h),l!==null&&jx(l),a.blockedOn=h,!1;l.shift()}return!0}function Hx(a,l,h){Ad(a)&&h.delete(l)}function Pw(){og=!1,Fr!==null&&Ad(Fr)&&(Fr=null),Br!==null&&Ad(Br)&&(Br=null),jr!==null&&Ad(jr)&&(jr=null),Ec.forEach(Hx),bc.forEach(Hx)}function Id(a,l){a.blockedOn===l&&(a.blockedOn=null,og||(og=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Pw)))}var Rd=null;function zx(a){Rd!==a&&(Rd=a,i.unstable_scheduleCallback(i.unstable_NormalPriority,function(){Rd===a&&(Rd=null);for(var l=0;l<a.length;l+=3){var h=a[l],g=a[l+1],x=a[l+2];if(typeof g!="function"){if(ag(g||h)===null)continue;break}var b=uo(h);b!==null&&(a.splice(l,3),l-=3,am(b,{pending:!0,data:x,method:h.method,action:g},g,x))}}))}function Ic(a){function l($){return Id($,a)}Fr!==null&&Id(Fr,a),Br!==null&&Id(Br,a),jr!==null&&Id(jr,a),Ec.forEach(l),bc.forEach(l);for(var h=0;h<Vr.length;h++){var g=Vr[h];g.blockedOn===a&&(g.blockedOn=null)}for(;0<Vr.length&&(h=Vr[0],h.blockedOn===null);)Gx(h),h.blockedOn===null&&Vr.shift();if(h=(a.ownerDocument||a).$$reactFormReplay,h!=null)for(g=0;g<h.length;g+=3){var x=h[g],b=h[g+1],O=x[Is]||null;if(typeof b=="function")O||zx(h);else if(O){var k=null;if(b&&b.hasAttribute("formAction")){if(x=b,O=b[Is]||null)k=O.formAction;else if(ag(x)!==null)continue}else k=O.action;typeof k=="function"?h[g+1]=k:(h.splice(g,3),g-=3),zx(h)}}}function lg(a){this._internalRoot=a}Ld.prototype.render=lg.prototype.render=function(a){var l=this._internalRoot;if(l===null)throw Error(s(409));var h=l.current,g=bi();Fx(h,g,a,l,null,null)},Ld.prototype.unmount=lg.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var l=a.containerInfo;Fx(a.current,2,null,a,null,null),ld(),l[pi]=null}};function Ld(a){this._internalRoot=a}Ld.prototype.unstable_scheduleHydration=function(a){if(a){var l=xa();a={blockedOn:null,target:a,priority:l};for(var h=0;h<Vr.length&&l!==0&&l<Vr[h].priority;h++);Vr.splice(h,0,a),h===0&&Gx(a)}};var Kx=e.version;if(Kx!=="19.1.0")throw Error(s(527,Kx,"19.1.0"));Q.findDOMNode=function(a){var l=a._reactInternals;if(l===void 0)throw typeof a.render=="function"?Error(s(188)):(a=Object.keys(a).join(","),Error(s(268,a)));return a=d(l),a=a!==null?u(a):null,a=a===null?null:a.stateNode,a};var kw={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:B,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var wd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wd.isDisabled&&wd.supportsFiber)try{Dt=wd.inject(kw),bt=wd}catch{}}return Lc.createRoot=function(a,l){if(!n(a))throw Error(s(299));var h=!1,g="",x=lS,b=cS,O=uS,k=null;return l!=null&&(l.unstable_strictMode===!0&&(h=!0),l.identifierPrefix!==void 0&&(g=l.identifierPrefix),l.onUncaughtError!==void 0&&(x=l.onUncaughtError),l.onCaughtError!==void 0&&(b=l.onCaughtError),l.onRecoverableError!==void 0&&(O=l.onRecoverableError),l.unstable_transitionCallbacks!==void 0&&(k=l.unstable_transitionCallbacks)),l=Mx(a,1,!1,null,null,h,g,x,b,O,k,null),a[pi]=l.current,Hm(a),new lg(l)},Lc.hydrateRoot=function(a,l,h){if(!n(a))throw Error(s(299));var g=!1,x="",b=lS,O=cS,k=uS,$=null,ie=null;return h!=null&&(h.unstable_strictMode===!0&&(g=!0),h.identifierPrefix!==void 0&&(x=h.identifierPrefix),h.onUncaughtError!==void 0&&(b=h.onUncaughtError),h.onCaughtError!==void 0&&(O=h.onCaughtError),h.onRecoverableError!==void 0&&(k=h.onRecoverableError),h.unstable_transitionCallbacks!==void 0&&($=h.unstable_transitionCallbacks),h.formState!==void 0&&(ie=h.formState)),l=Mx(a,1,!0,l,h??null,g,x,b,O,k,$,ie),l.context=Ux(null),h=l.current,g=bi(),g=yr(g),x=Ar(g),x.callback=null,Ir(h,x,g),h=g,l.current.lanes=h,fn(l,h),vn(l),a[pi]=l.current,Hm(a),new Ld(l)},Lc.version="19.1.0",Lc}var nT;function zw(){if(nT)return hg.exports;nT=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),hg.exports=Hw(),hg.exports}var Kw=zw();function pg(){}function Yw({storage:i,key:e="REACT_QUERY_OFFLINE_CACHE",throttleTime:t=1e3,serialize:s=JSON.stringify,deserialize:n=JSON.parse,retry:r}){if(i){const o=c=>{try{i.setItem(e,s(c));return}catch(d){return d}};return{persistClient:qw(c=>{let d=c,u=o(d),f=0;for(;u&&d;)f++,d=r==null?void 0:r({persistedClient:d,error:u,errorCount:f}),d&&(u=o(d))},t),restoreClient:()=>{const c=i.getItem(e);if(c)return n(c)},removeClient:()=>{i.removeItem(e)}}}return{persistClient:pg,restoreClient:pg,removeClient:pg}}function qw(i,e=100){let t=null,s;return function(...n){s=n,t===null&&(t=setTimeout(()=>{i(...s),t=null},e))}}var uu=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(i){return this.listeners.add(i),this.onSubscribe(),()=>{this.listeners.delete(i),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},eo=typeof window>"u"||"Deno"in globalThis;function si(){}function Qw(i,e){return typeof i=="function"?i(e):i}function np(i){return typeof i=="number"&&i>=0&&i!==1/0}function zE(i,e){return Math.max(i+(e||0)-Date.now(),0)}function oa(i,e){return typeof i=="function"?i(e):i}function an(i,e){return typeof i=="function"?i(e):i}function rT(i,e){const{type:t="all",exact:s,fetchStatus:n,predicate:r,queryKey:o,stale:c}=i;if(o){if(s){if(e.queryHash!==r0(o,e.options))return!1}else if(!Hc(e.queryKey,o))return!1}if(t!=="all"){const d=e.isActive();if(t==="active"&&!d||t==="inactive"&&d)return!1}return!(typeof c=="boolean"&&e.isStale()!==c||n&&n!==e.state.fetchStatus||r&&!r(e))}function aT(i,e){const{exact:t,status:s,predicate:n,mutationKey:r}=i;if(r){if(!e.options.mutationKey)return!1;if(t){if(Gc(e.options.mutationKey)!==Gc(r))return!1}else if(!Hc(e.options.mutationKey,r))return!1}return!(s&&e.state.status!==s||n&&!n(e))}function r0(i,e){return((e==null?void 0:e.queryKeyHashFn)||Gc)(i)}function Gc(i){return JSON.stringify(i,(e,t)=>ap(t)?Object.keys(t).sort().reduce((s,n)=>(s[n]=t[n],s),{}):t)}function Hc(i,e){return i===e?!0:typeof i!=typeof e?!1:i&&e&&typeof i=="object"&&typeof e=="object"?Object.keys(e).every(t=>Hc(i[t],e[t])):!1}function KE(i,e){if(i===e)return i;const t=oT(i)&&oT(e);if(t||ap(i)&&ap(e)){const s=t?i:Object.keys(i),n=s.length,r=t?e:Object.keys(e),o=r.length,c=t?[]:{};let d=0;for(let u=0;u<o;u++){const f=t?u:r[u];(!t&&s.includes(f)||t)&&i[f]===void 0&&e[f]===void 0?(c[f]=void 0,d++):(c[f]=KE(i[f],e[f]),c[f]===i[f]&&i[f]!==void 0&&d++)}return n===o&&d===n?i:c}return e}function rp(i,e){if(!e||Object.keys(i).length!==Object.keys(e).length)return!1;for(const t in i)if(i[t]!==e[t])return!1;return!0}function oT(i){return Array.isArray(i)&&i.length===Object.keys(i).length}function ap(i){if(!lT(i))return!1;const e=i.constructor;if(e===void 0)return!0;const t=e.prototype;return!(!lT(t)||!t.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(i)!==Object.prototype)}function lT(i){return Object.prototype.toString.call(i)==="[object Object]"}function Xw(i){return new Promise(e=>{setTimeout(e,i)})}function op(i,e,t){return typeof t.structuralSharing=="function"?t.structuralSharing(i,e):t.structuralSharing!==!1?KE(i,e):e}function Ww(i,e,t=0){const s=[...i,e];return t&&s.length>t?s.slice(1):s}function Zw(i,e,t=0){const s=[e,...i];return t&&s.length>t?s.slice(0,-1):s}var a0=Symbol();function YE(i,e){return!i.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!i.queryFn||i.queryFn===a0?()=>Promise.reject(new Error(`Missing queryFn: '${i.queryHash}'`)):i.queryFn}function Jw(i,e){return typeof i=="function"?i(...e):!!i}var Ha,Xr,rl,NE,eC=(NE=class extends uu{constructor(){super();tt(this,Ha);tt(this,Xr);tt(this,rl);He(this,rl,e=>{if(!eo&&window.addEventListener){const t=()=>e();return window.addEventListener("visibilitychange",t,!1),()=>{window.removeEventListener("visibilitychange",t)}}})}onSubscribe(){q(this,Xr)||this.setEventListener(q(this,rl))}onUnsubscribe(){var e;this.hasListeners()||((e=q(this,Xr))==null||e.call(this),He(this,Xr,void 0))}setEventListener(e){var t;He(this,rl,e),(t=q(this,Xr))==null||t.call(this),He(this,Xr,e(s=>{typeof s=="boolean"?this.setFocused(s):this.onFocus()}))}setFocused(e){q(this,Ha)!==e&&(He(this,Ha,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(t=>{t(e)})}isFocused(){var e;return typeof q(this,Ha)=="boolean"?q(this,Ha):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},Ha=new WeakMap,Xr=new WeakMap,rl=new WeakMap,NE),o0=new eC,al,Wr,ol,ME,tC=(ME=class extends uu{constructor(){super();tt(this,al,!0);tt(this,Wr);tt(this,ol);He(this,ol,e=>{if(!eo&&window.addEventListener){const t=()=>e(!0),s=()=>e(!1);return window.addEventListener("online",t,!1),window.addEventListener("offline",s,!1),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",s)}}})}onSubscribe(){q(this,Wr)||this.setEventListener(q(this,ol))}onUnsubscribe(){var e;this.hasListeners()||((e=q(this,Wr))==null||e.call(this),He(this,Wr,void 0))}setEventListener(e){var t;He(this,ol,e),(t=q(this,Wr))==null||t.call(this),He(this,Wr,e(this.setOnline.bind(this)))}setOnline(e){q(this,al)!==e&&(He(this,al,e),this.listeners.forEach(s=>{s(e)}))}isOnline(){return q(this,al)}},al=new WeakMap,Wr=new WeakMap,ol=new WeakMap,ME),mh=new tC;function lp(){let i,e;const t=new Promise((n,r)=>{i=n,e=r});t.status="pending",t.catch(()=>{});function s(n){Object.assign(t,n),delete t.resolve,delete t.reject}return t.resolve=n=>{s({status:"fulfilled",value:n}),i(n)},t.reject=n=>{s({status:"rejected",reason:n}),e(n)},t}function sC(i){var t;let e;if((t=i.then(s=>(e=s,s)))==null||t.catch(si),e!==void 0)return{data:e}}function iC(i){return Math.min(1e3*2**i,3e4)}function qE(i){return(i??"online")==="online"?mh.isOnline():!0}var QE=class extends Error{constructor(i){super("CancelledError"),this.revert=i==null?void 0:i.revert,this.silent=i==null?void 0:i.silent}};function yg(i){return i instanceof QE}function XE(i){let e=!1,t=0,s=!1,n;const r=lp(),o=y=>{var E;s||(p(new QE(y)),(E=i.abort)==null||E.call(i))},c=()=>{e=!0},d=()=>{e=!1},u=()=>o0.isFocused()&&(i.networkMode==="always"||mh.isOnline())&&i.canRun(),f=()=>qE(i.networkMode)&&i.canRun(),m=y=>{var E;s||(s=!0,(E=i.onSuccess)==null||E.call(i,y),n==null||n(),r.resolve(y))},p=y=>{var E;s||(s=!0,(E=i.onError)==null||E.call(i,y),n==null||n(),r.reject(y))},v=()=>new Promise(y=>{var E;n=A=>{(s||u())&&y(A)},(E=i.onPause)==null||E.call(i)}).then(()=>{var y;n=void 0,s||(y=i.onContinue)==null||y.call(i)}),S=()=>{if(s)return;let y;const E=t===0?i.initialPromise:void 0;try{y=E??i.fn()}catch(A){y=Promise.reject(A)}Promise.resolve(y).then(m).catch(A=>{var D;if(s)return;const R=i.retry??(eo?0:3),I=i.retryDelay??iC,C=typeof I=="function"?I(t,A):I,L=R===!0||typeof R=="number"&&t<R||typeof R=="function"&&R(t,A);if(e||!L){p(A);return}t++,(D=i.onFail)==null||D.call(i,t,A),Xw(C).then(()=>u()?void 0:v()).then(()=>{e?p(A):S()})})};return{promise:r,cancel:o,continue:()=>(n==null||n(),r),cancelRetry:c,continueRetry:d,canStart:f,start:()=>(f()?S():v().then(S),r)}}var nC=i=>setTimeout(i,0);function rC(){let i=[],e=0,t=c=>{c()},s=c=>{c()},n=nC;const r=c=>{e?i.push(c):n(()=>{t(c)})},o=()=>{const c=i;i=[],c.length&&n(()=>{s(()=>{c.forEach(d=>{t(d)})})})};return{batch:c=>{let d;e++;try{d=c()}finally{e--,e||o()}return d},batchCalls:c=>(...d)=>{r(()=>{c(...d)})},schedule:r,setNotifyFunction:c=>{t=c},setBatchNotifyFunction:c=>{s=c},setScheduler:c=>{n=c}}}var Us=rC(),za,UE,WE=(UE=class{constructor(){tt(this,za)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),np(this.gcTime)&&He(this,za,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(i){this.gcTime=Math.max(this.gcTime||0,i??(eo?1/0:5*60*1e3))}clearGcTimeout(){q(this,za)&&(clearTimeout(q(this,za)),He(this,za,void 0))}},za=new WeakMap,UE),ll,cl,Gi,Ka,Hs,au,Ya,nn,rr,FE,aC=(FE=class extends WE{constructor(e){super();tt(this,nn);tt(this,ll);tt(this,cl);tt(this,Gi);tt(this,Ka);tt(this,Hs);tt(this,au);tt(this,Ya);He(this,Ya,!1),He(this,au,e.defaultOptions),this.setOptions(e.options),this.observers=[],He(this,Ka,e.client),He(this,Gi,q(this,Ka).getQueryCache()),this.queryKey=e.queryKey,this.queryHash=e.queryHash,He(this,ll,oC(this.options)),this.state=e.state??q(this,ll),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var e;return(e=q(this,Hs))==null?void 0:e.promise}setOptions(e){this.options={...q(this,au),...e},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&q(this,Gi).remove(this)}setData(e,t){const s=op(this.state.data,e,this.options);return Tt(this,nn,rr).call(this,{data:s,type:"success",dataUpdatedAt:t==null?void 0:t.updatedAt,manual:t==null?void 0:t.manual}),s}setState(e,t){Tt(this,nn,rr).call(this,{type:"setState",state:e,setStateOptions:t})}cancel(e){var s,n;const t=(s=q(this,Hs))==null?void 0:s.promise;return(n=q(this,Hs))==null||n.cancel(e),t?t.then(si).catch(si):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(q(this,ll))}isActive(){return this.observers.some(e=>an(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===a0||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>oa(e.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e==="static"?!1:this.state.isInvalidated?!0:!zE(this.state.dataUpdatedAt,e)}onFocus(){var t;const e=this.observers.find(s=>s.shouldFetchOnWindowFocus());e==null||e.refetch({cancelRefetch:!1}),(t=q(this,Hs))==null||t.continue()}onOnline(){var t;const e=this.observers.find(s=>s.shouldFetchOnReconnect());e==null||e.refetch({cancelRefetch:!1}),(t=q(this,Hs))==null||t.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),q(this,Gi).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(t=>t!==e),this.observers.length||(q(this,Hs)&&(q(this,Ya)?q(this,Hs).cancel({revert:!0}):q(this,Hs).cancelRetry()),this.scheduleGc()),q(this,Gi).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Tt(this,nn,rr).call(this,{type:"invalidate"})}fetch(e,t){var d,u,f;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(t!=null&&t.cancelRefetch))this.cancel({silent:!0});else if(q(this,Hs))return q(this,Hs).continueRetry(),q(this,Hs).promise}if(e&&this.setOptions(e),!this.options.queryFn){const m=this.observers.find(p=>p.options.queryFn);m&&this.setOptions(m.options)}const s=new AbortController,n=m=>{Object.defineProperty(m,"signal",{enumerable:!0,get:()=>(He(this,Ya,!0),s.signal)})},r=()=>{const m=YE(this.options,t),p={client:q(this,Ka),queryKey:this.queryKey,meta:this.meta};return n(p),He(this,Ya,!1),this.options.persister?this.options.persister(m,p,this):m(p)},o={fetchOptions:t,options:this.options,queryKey:this.queryKey,client:q(this,Ka),state:this.state,fetchFn:r};n(o),(d=this.options.behavior)==null||d.onFetch(o,this),He(this,cl,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((u=o.fetchOptions)==null?void 0:u.meta))&&Tt(this,nn,rr).call(this,{type:"fetch",meta:(f=o.fetchOptions)==null?void 0:f.meta});const c=m=>{var p,v,S,y;yg(m)&&m.silent||Tt(this,nn,rr).call(this,{type:"error",error:m}),yg(m)||((v=(p=q(this,Gi).config).onError)==null||v.call(p,m,this),(y=(S=q(this,Gi).config).onSettled)==null||y.call(S,this.state.data,m,this)),this.scheduleGc()};return He(this,Hs,XE({initialPromise:t==null?void 0:t.initialPromise,fn:o.fetchFn,abort:s.abort.bind(s),onSuccess:m=>{var p,v,S,y;if(m===void 0){c(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(m)}catch(E){c(E);return}(v=(p=q(this,Gi).config).onSuccess)==null||v.call(p,m,this),(y=(S=q(this,Gi).config).onSettled)==null||y.call(S,m,this.state.error,this),this.scheduleGc()},onError:c,onFail:(m,p)=>{Tt(this,nn,rr).call(this,{type:"failed",failureCount:m,error:p})},onPause:()=>{Tt(this,nn,rr).call(this,{type:"pause"})},onContinue:()=>{Tt(this,nn,rr).call(this,{type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0})),q(this,Hs).start()}},ll=new WeakMap,cl=new WeakMap,Gi=new WeakMap,Ka=new WeakMap,Hs=new WeakMap,au=new WeakMap,Ya=new WeakMap,nn=new WeakSet,rr=function(e){const t=s=>{switch(e.type){case"failed":return{...s,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...s,fetchStatus:"paused"};case"continue":return{...s,fetchStatus:"fetching"};case"fetch":return{...s,...ZE(s.data,this.options),fetchMeta:e.meta??null};case"success":return{...s,data:e.data,dataUpdateCount:s.dataUpdateCount+1,dataUpdatedAt:e.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const n=e.error;return yg(n)&&n.revert&&q(this,cl)?{...q(this,cl),fetchStatus:"idle"}:{...s,error:n,errorUpdateCount:s.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:s.fetchFailureCount+1,fetchFailureReason:n,fetchStatus:"idle",status:"error"};case"invalidate":return{...s,isInvalidated:!0};case"setState":return{...s,...e.state}}};this.state=t(this.state),Us.batch(()=>{this.observers.forEach(s=>{s.onQueryUpdate()}),q(this,Gi).notify({query:this,type:"updated",action:e})})},FE);function ZE(i,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:qE(e.networkMode)?"fetching":"paused",...i===void 0&&{error:null,status:"pending"}}}function oC(i){const e=typeof i.initialData=="function"?i.initialData():i.initialData,t=e!==void 0,s=t?typeof i.initialDataUpdatedAt=="function"?i.initialDataUpdatedAt():i.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:t?s??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:t?"success":"pending",fetchStatus:"idle"}}var In,BE,lC=(BE=class extends uu{constructor(e={}){super();tt(this,In);this.config=e,He(this,In,new Map)}build(e,t,s){const n=t.queryKey,r=t.queryHash??r0(n,t);let o=this.get(r);return o||(o=new aC({client:e,queryKey:n,queryHash:r,options:e.defaultQueryOptions(t),state:s,defaultOptions:e.getQueryDefaults(n)}),this.add(o)),o}add(e){q(this,In).has(e.queryHash)||(q(this,In).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const t=q(this,In).get(e.queryHash);t&&(e.destroy(),t===e&&q(this,In).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){Us.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return q(this,In).get(e)}getAll(){return[...q(this,In).values()]}find(e){const t={exact:!0,...e};return this.getAll().find(s=>rT(t,s))}findAll(e={}){const t=this.getAll();return Object.keys(e).length>0?t.filter(s=>rT(e,s)):t}notify(e){Us.batch(()=>{this.listeners.forEach(t=>{t(e)})})}onFocus(){Us.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){Us.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},In=new WeakMap,BE),Rn,ei,qa,Ln,Yr,jE,cC=(jE=class extends WE{constructor(e){super();tt(this,Ln);tt(this,Rn);tt(this,ei);tt(this,qa);this.mutationId=e.mutationId,He(this,ei,e.mutationCache),He(this,Rn,[]),this.state=e.state||uC(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){q(this,Rn).includes(e)||(q(this,Rn).push(e),this.clearGcTimeout(),q(this,ei).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){He(this,Rn,q(this,Rn).filter(t=>t!==e)),this.scheduleGc(),q(this,ei).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){q(this,Rn).length||(this.state.status==="pending"?this.scheduleGc():q(this,ei).remove(this))}continue(){var e;return((e=q(this,qa))==null?void 0:e.continue())??this.execute(this.state.variables)}async execute(e){var r,o,c,d,u,f,m,p,v,S,y,E,A,R,I,C,L,D,_,M;const t=()=>{Tt(this,Ln,Yr).call(this,{type:"continue"})};He(this,qa,XE({fn:()=>this.options.mutationFn?this.options.mutationFn(e):Promise.reject(new Error("No mutationFn found")),onFail:(U,F)=>{Tt(this,Ln,Yr).call(this,{type:"failed",failureCount:U,error:F})},onPause:()=>{Tt(this,Ln,Yr).call(this,{type:"pause"})},onContinue:t,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>q(this,ei).canRun(this)}));const s=this.state.status==="pending",n=!q(this,qa).canStart();try{if(s)t();else{Tt(this,Ln,Yr).call(this,{type:"pending",variables:e,isPaused:n}),await((o=(r=q(this,ei).config).onMutate)==null?void 0:o.call(r,e,this));const F=await((d=(c=this.options).onMutate)==null?void 0:d.call(c,e));F!==this.state.context&&Tt(this,Ln,Yr).call(this,{type:"pending",context:F,variables:e,isPaused:n})}const U=await q(this,qa).start();return await((f=(u=q(this,ei).config).onSuccess)==null?void 0:f.call(u,U,e,this.state.context,this)),await((p=(m=this.options).onSuccess)==null?void 0:p.call(m,U,e,this.state.context)),await((S=(v=q(this,ei).config).onSettled)==null?void 0:S.call(v,U,null,this.state.variables,this.state.context,this)),await((E=(y=this.options).onSettled)==null?void 0:E.call(y,U,null,e,this.state.context)),Tt(this,Ln,Yr).call(this,{type:"success",data:U}),U}catch(U){try{throw await((R=(A=q(this,ei).config).onError)==null?void 0:R.call(A,U,e,this.state.context,this)),await((C=(I=this.options).onError)==null?void 0:C.call(I,U,e,this.state.context)),await((D=(L=q(this,ei).config).onSettled)==null?void 0:D.call(L,void 0,U,this.state.variables,this.state.context,this)),await((M=(_=this.options).onSettled)==null?void 0:M.call(_,void 0,U,e,this.state.context)),U}finally{Tt(this,Ln,Yr).call(this,{type:"error",error:U})}}finally{q(this,ei).runNext(this)}}},Rn=new WeakMap,ei=new WeakMap,qa=new WeakMap,Ln=new WeakSet,Yr=function(e){const t=s=>{switch(e.type){case"failed":return{...s,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...s,isPaused:!0};case"continue":return{...s,isPaused:!1};case"pending":return{...s,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...s,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...s,data:void 0,error:e.error,failureCount:s.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=t(this.state),Us.batch(()=>{q(this,Rn).forEach(s=>{s.onMutationUpdate(e)}),q(this,ei).notify({mutation:this,type:"updated",action:e})})},jE);function uC(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var lr,rn,ou,VE,dC=(VE=class extends uu{constructor(e={}){super();tt(this,lr);tt(this,rn);tt(this,ou);this.config=e,He(this,lr,new Set),He(this,rn,new Map),He(this,ou,0)}build(e,t,s){const n=new cC({mutationCache:this,mutationId:++Cd(this,ou)._,options:e.defaultMutationOptions(t),state:s});return this.add(n),n}add(e){q(this,lr).add(e);const t=Od(e);if(typeof t=="string"){const s=q(this,rn).get(t);s?s.push(e):q(this,rn).set(t,[e])}this.notify({type:"added",mutation:e})}remove(e){if(q(this,lr).delete(e)){const t=Od(e);if(typeof t=="string"){const s=q(this,rn).get(t);if(s)if(s.length>1){const n=s.indexOf(e);n!==-1&&s.splice(n,1)}else s[0]===e&&q(this,rn).delete(t)}}this.notify({type:"removed",mutation:e})}canRun(e){const t=Od(e);if(typeof t=="string"){const s=q(this,rn).get(t),n=s==null?void 0:s.find(r=>r.state.status==="pending");return!n||n===e}else return!0}runNext(e){var s;const t=Od(e);if(typeof t=="string"){const n=(s=q(this,rn).get(t))==null?void 0:s.find(r=>r!==e&&r.state.isPaused);return(n==null?void 0:n.continue())??Promise.resolve()}else return Promise.resolve()}clear(){Us.batch(()=>{q(this,lr).forEach(e=>{this.notify({type:"removed",mutation:e})}),q(this,lr).clear(),q(this,rn).clear()})}getAll(){return Array.from(q(this,lr))}find(e){const t={exact:!0,...e};return this.getAll().find(s=>aT(t,s))}findAll(e={}){return this.getAll().filter(t=>aT(e,t))}notify(e){Us.batch(()=>{this.listeners.forEach(t=>{t(e)})})}resumePausedMutations(){const e=this.getAll().filter(t=>t.state.isPaused);return Us.batch(()=>Promise.all(e.map(t=>t.continue().catch(si))))}},lr=new WeakMap,rn=new WeakMap,ou=new WeakMap,VE);function Od(i){var e;return(e=i.options.scope)==null?void 0:e.id}function gh(i){return{onFetch:(e,t)=>{var f,m,p,v,S;const s=e.options,n=(p=(m=(f=e.fetchOptions)==null?void 0:f.meta)==null?void 0:m.fetchMore)==null?void 0:p.direction,r=((v=e.state.data)==null?void 0:v.pages)||[],o=((S=e.state.data)==null?void 0:S.pageParams)||[];let c={pages:[],pageParams:[]},d=0;const u=async()=>{let y=!1;const E=I=>{Object.defineProperty(I,"signal",{enumerable:!0,get:()=>(e.signal.aborted?y=!0:e.signal.addEventListener("abort",()=>{y=!0}),e.signal)})},A=YE(e.options,e.fetchOptions),R=async(I,C,L)=>{if(y)return Promise.reject();if(C==null&&I.pages.length)return Promise.resolve(I);const D={client:e.client,queryKey:e.queryKey,pageParam:C,direction:L?"backward":"forward",meta:e.options.meta};E(D);const _=await A(D),{maxPages:M}=e.options,U=L?Zw:Ww;return{pages:U(I.pages,_,M),pageParams:U(I.pageParams,C,M)}};if(n&&r.length){const I=n==="backward",C=I?JE:cp,L={pages:r,pageParams:o},D=C(s,L);c=await R(L,D,I)}else{const I=i??r.length;do{const C=d===0?o[0]??s.initialPageParam:cp(s,c);if(d>0&&C==null)break;c=await R(c,C),d++}while(d<I)}return c};e.options.persister?e.fetchFn=()=>{var y,E;return(E=(y=e.options).persister)==null?void 0:E.call(y,u,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},t)}:e.fetchFn=u}}}function cp(i,{pages:e,pageParams:t}){const s=e.length-1;return e.length>0?i.getNextPageParam(e[s],e,t[s],t):void 0}function JE(i,{pages:e,pageParams:t}){var s;return e.length>0?(s=i.getPreviousPageParam)==null?void 0:s.call(i,e[0],e,t[0],t):void 0}function hC(i,e){return e?cp(i,e)!=null:!1}function fC(i,e){return!e||!i.getPreviousPageParam?!1:JE(i,e)!=null}var os,Zr,Jr,ul,dl,ea,hl,fl,$E,mC=($E=class{constructor(i={}){tt(this,os);tt(this,Zr);tt(this,Jr);tt(this,ul);tt(this,dl);tt(this,ea);tt(this,hl);tt(this,fl);He(this,os,i.queryCache||new lC),He(this,Zr,i.mutationCache||new dC),He(this,Jr,i.defaultOptions||{}),He(this,ul,new Map),He(this,dl,new Map),He(this,ea,0)}mount(){Cd(this,ea)._++,q(this,ea)===1&&(He(this,hl,o0.subscribe(async i=>{i&&(await this.resumePausedMutations(),q(this,os).onFocus())})),He(this,fl,mh.subscribe(async i=>{i&&(await this.resumePausedMutations(),q(this,os).onOnline())})))}unmount(){var i,e;Cd(this,ea)._--,q(this,ea)===0&&((i=q(this,hl))==null||i.call(this),He(this,hl,void 0),(e=q(this,fl))==null||e.call(this),He(this,fl,void 0))}isFetching(i){return q(this,os).findAll({...i,fetchStatus:"fetching"}).length}isMutating(i){return q(this,Zr).findAll({...i,status:"pending"}).length}getQueryData(i){var t;const e=this.defaultQueryOptions({queryKey:i});return(t=q(this,os).get(e.queryHash))==null?void 0:t.state.data}ensureQueryData(i){const e=this.defaultQueryOptions(i),t=q(this,os).build(this,e),s=t.state.data;return s===void 0?this.fetchQuery(i):(i.revalidateIfStale&&t.isStaleByTime(oa(e.staleTime,t))&&this.prefetchQuery(e),Promise.resolve(s))}getQueriesData(i){return q(this,os).findAll(i).map(({queryKey:e,state:t})=>{const s=t.data;return[e,s]})}setQueryData(i,e,t){const s=this.defaultQueryOptions({queryKey:i}),n=q(this,os).get(s.queryHash),r=n==null?void 0:n.state.data,o=Qw(e,r);if(o!==void 0)return q(this,os).build(this,s).setData(o,{...t,manual:!0})}setQueriesData(i,e,t){return Us.batch(()=>q(this,os).findAll(i).map(({queryKey:s})=>[s,this.setQueryData(s,e,t)]))}getQueryState(i){var t;const e=this.defaultQueryOptions({queryKey:i});return(t=q(this,os).get(e.queryHash))==null?void 0:t.state}removeQueries(i){const e=q(this,os);Us.batch(()=>{e.findAll(i).forEach(t=>{e.remove(t)})})}resetQueries(i,e){const t=q(this,os);return Us.batch(()=>(t.findAll(i).forEach(s=>{s.reset()}),this.refetchQueries({type:"active",...i},e)))}cancelQueries(i,e={}){const t={revert:!0,...e},s=Us.batch(()=>q(this,os).findAll(i).map(n=>n.cancel(t)));return Promise.all(s).then(si).catch(si)}invalidateQueries(i,e={}){return Us.batch(()=>(q(this,os).findAll(i).forEach(t=>{t.invalidate()}),(i==null?void 0:i.refetchType)==="none"?Promise.resolve():this.refetchQueries({...i,type:(i==null?void 0:i.refetchType)??(i==null?void 0:i.type)??"active"},e)))}refetchQueries(i,e={}){const t={...e,cancelRefetch:e.cancelRefetch??!0},s=Us.batch(()=>q(this,os).findAll(i).filter(n=>!n.isDisabled()&&!n.isStatic()).map(n=>{let r=n.fetch(void 0,t);return t.throwOnError||(r=r.catch(si)),n.state.fetchStatus==="paused"?Promise.resolve():r}));return Promise.all(s).then(si)}fetchQuery(i){const e=this.defaultQueryOptions(i);e.retry===void 0&&(e.retry=!1);const t=q(this,os).build(this,e);return t.isStaleByTime(oa(e.staleTime,t))?t.fetch(e):Promise.resolve(t.state.data)}prefetchQuery(i){return this.fetchQuery(i).then(si).catch(si)}fetchInfiniteQuery(i){return i.behavior=gh(i.pages),this.fetchQuery(i)}prefetchInfiniteQuery(i){return this.fetchInfiniteQuery(i).then(si).catch(si)}ensureInfiniteQueryData(i){return i.behavior=gh(i.pages),this.ensureQueryData(i)}resumePausedMutations(){return mh.isOnline()?q(this,Zr).resumePausedMutations():Promise.resolve()}getQueryCache(){return q(this,os)}getMutationCache(){return q(this,Zr)}getDefaultOptions(){return q(this,Jr)}setDefaultOptions(i){He(this,Jr,i)}setQueryDefaults(i,e){q(this,ul).set(Gc(i),{queryKey:i,defaultOptions:e})}getQueryDefaults(i){const e=[...q(this,ul).values()],t={};return e.forEach(s=>{Hc(i,s.queryKey)&&Object.assign(t,s.defaultOptions)}),t}setMutationDefaults(i,e){q(this,dl).set(Gc(i),{mutationKey:i,defaultOptions:e})}getMutationDefaults(i){const e=[...q(this,dl).values()],t={};return e.forEach(s=>{Hc(i,s.mutationKey)&&Object.assign(t,s.defaultOptions)}),t}defaultQueryOptions(i){if(i._defaulted)return i;const e={...q(this,Jr).queries,...this.getQueryDefaults(i.queryKey),...i,_defaulted:!0};return e.queryHash||(e.queryHash=r0(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===a0&&(e.enabled=!1),e}defaultMutationOptions(i){return i!=null&&i._defaulted?i:{...q(this,Jr).mutations,...(i==null?void 0:i.mutationKey)&&this.getMutationDefaults(i.mutationKey),...i,_defaulted:!0}}clear(){q(this,os).clear(),q(this,Zr).clear()}},os=new WeakMap,Zr=new WeakMap,Jr=new WeakMap,ul=new WeakMap,dl=new WeakMap,ea=new WeakMap,hl=new WeakMap,fl=new WeakMap,$E),ui,Et,lu,ti,Qa,ml,ta,sa,cu,gl,pl,Xa,Wa,ia,yl,kt,kc,up,dp,hp,fp,mp,gp,pp,tb,GE,eb=(GE=class extends uu{constructor(e,t){super();tt(this,kt);tt(this,ui);tt(this,Et);tt(this,lu);tt(this,ti);tt(this,Qa);tt(this,ml);tt(this,ta);tt(this,sa);tt(this,cu);tt(this,gl);tt(this,pl);tt(this,Xa);tt(this,Wa);tt(this,ia);tt(this,yl,new Set);this.options=t,He(this,ui,e),He(this,sa,null),He(this,ta,lp()),this.options.experimental_prefetchInRender||q(this,ta).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(t)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(q(this,Et).addObserver(this),cT(q(this,Et),this.options)?Tt(this,kt,kc).call(this):this.updateResult(),Tt(this,kt,fp).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return yp(q(this,Et),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return yp(q(this,Et),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,Tt(this,kt,mp).call(this),Tt(this,kt,gp).call(this),q(this,Et).removeObserver(this)}setOptions(e){const t=this.options,s=q(this,Et);if(this.options=q(this,ui).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof an(this.options.enabled,q(this,Et))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");Tt(this,kt,pp).call(this),q(this,Et).setOptions(this.options),t._defaulted&&!rp(this.options,t)&&q(this,ui).getQueryCache().notify({type:"observerOptionsUpdated",query:q(this,Et),observer:this});const n=this.hasListeners();n&&uT(q(this,Et),s,this.options,t)&&Tt(this,kt,kc).call(this),this.updateResult(),n&&(q(this,Et)!==s||an(this.options.enabled,q(this,Et))!==an(t.enabled,q(this,Et))||oa(this.options.staleTime,q(this,Et))!==oa(t.staleTime,q(this,Et)))&&Tt(this,kt,up).call(this);const r=Tt(this,kt,dp).call(this);n&&(q(this,Et)!==s||an(this.options.enabled,q(this,Et))!==an(t.enabled,q(this,Et))||r!==q(this,ia))&&Tt(this,kt,hp).call(this,r)}getOptimisticResult(e){const t=q(this,ui).getQueryCache().build(q(this,ui),e),s=this.createResult(t,e);return pC(this,s)&&(He(this,ti,s),He(this,ml,this.options),He(this,Qa,q(this,Et).state)),s}getCurrentResult(){return q(this,ti)}trackResult(e,t){return new Proxy(e,{get:(s,n)=>(this.trackProp(n),t==null||t(n),Reflect.get(s,n))})}trackProp(e){q(this,yl).add(e)}getCurrentQuery(){return q(this,Et)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const t=q(this,ui).defaultQueryOptions(e),s=q(this,ui).getQueryCache().build(q(this,ui),t);return s.fetch().then(()=>this.createResult(s,t))}fetch(e){return Tt(this,kt,kc).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),q(this,ti)))}createResult(e,t){var U;const s=q(this,Et),n=this.options,r=q(this,ti),o=q(this,Qa),c=q(this,ml),u=e!==s?e.state:q(this,lu),{state:f}=e;let m={...f},p=!1,v;if(t._optimisticResults){const F=this.hasListeners(),z=!F&&cT(e,t),V=F&&uT(e,s,t,n);(z||V)&&(m={...m,...ZE(f.data,e.options)}),t._optimisticResults==="isRestoring"&&(m.fetchStatus="idle")}let{error:S,errorUpdatedAt:y,status:E}=m;v=m.data;let A=!1;if(t.placeholderData!==void 0&&v===void 0&&E==="pending"){let F;r!=null&&r.isPlaceholderData&&t.placeholderData===(c==null?void 0:c.placeholderData)?(F=r.data,A=!0):F=typeof t.placeholderData=="function"?t.placeholderData((U=q(this,pl))==null?void 0:U.state.data,q(this,pl)):t.placeholderData,F!==void 0&&(E="success",v=op(r==null?void 0:r.data,F,t),p=!0)}if(t.select&&v!==void 0&&!A)if(r&&v===(o==null?void 0:o.data)&&t.select===q(this,cu))v=q(this,gl);else try{He(this,cu,t.select),v=t.select(v),v=op(r==null?void 0:r.data,v,t),He(this,gl,v),He(this,sa,null)}catch(F){He(this,sa,F)}q(this,sa)&&(S=q(this,sa),v=q(this,gl),y=Date.now(),E="error");const R=m.fetchStatus==="fetching",I=E==="pending",C=E==="error",L=I&&R,D=v!==void 0,M={status:E,fetchStatus:m.fetchStatus,isPending:I,isSuccess:E==="success",isError:C,isInitialLoading:L,isLoading:L,data:v,dataUpdatedAt:m.dataUpdatedAt,error:S,errorUpdatedAt:y,failureCount:m.fetchFailureCount,failureReason:m.fetchFailureReason,errorUpdateCount:m.errorUpdateCount,isFetched:m.dataUpdateCount>0||m.errorUpdateCount>0,isFetchedAfterMount:m.dataUpdateCount>u.dataUpdateCount||m.errorUpdateCount>u.errorUpdateCount,isFetching:R,isRefetching:R&&!I,isLoadingError:C&&!D,isPaused:m.fetchStatus==="paused",isPlaceholderData:p,isRefetchError:C&&D,isStale:l0(e,t),refetch:this.refetch,promise:q(this,ta)};if(this.options.experimental_prefetchInRender){const F=ae=>{M.status==="error"?ae.reject(M.error):M.data!==void 0&&ae.resolve(M.data)},z=()=>{const ae=He(this,ta,M.promise=lp());F(ae)},V=q(this,ta);switch(V.status){case"pending":e.queryHash===s.queryHash&&F(V);break;case"fulfilled":(M.status==="error"||M.data!==V.value)&&z();break;case"rejected":(M.status!=="error"||M.error!==V.reason)&&z();break}}return M}updateResult(){const e=q(this,ti),t=this.createResult(q(this,Et),this.options);if(He(this,Qa,q(this,Et).state),He(this,ml,this.options),q(this,Qa).data!==void 0&&He(this,pl,q(this,Et)),rp(t,e))return;He(this,ti,t);const s=()=>{if(!e)return!0;const{notifyOnChangeProps:n}=this.options,r=typeof n=="function"?n():n;if(r==="all"||!r&&!q(this,yl).size)return!0;const o=new Set(r??q(this,yl));return this.options.throwOnError&&o.add("error"),Object.keys(q(this,ti)).some(c=>{const d=c;return q(this,ti)[d]!==e[d]&&o.has(d)})};Tt(this,kt,tb).call(this,{listeners:s()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&Tt(this,kt,fp).call(this)}},ui=new WeakMap,Et=new WeakMap,lu=new WeakMap,ti=new WeakMap,Qa=new WeakMap,ml=new WeakMap,ta=new WeakMap,sa=new WeakMap,cu=new WeakMap,gl=new WeakMap,pl=new WeakMap,Xa=new WeakMap,Wa=new WeakMap,ia=new WeakMap,yl=new WeakMap,kt=new WeakSet,kc=function(e){Tt(this,kt,pp).call(this);let t=q(this,Et).fetch(this.options,e);return e!=null&&e.throwOnError||(t=t.catch(si)),t},up=function(){Tt(this,kt,mp).call(this);const e=oa(this.options.staleTime,q(this,Et));if(eo||q(this,ti).isStale||!np(e))return;const s=zE(q(this,ti).dataUpdatedAt,e)+1;He(this,Xa,setTimeout(()=>{q(this,ti).isStale||this.updateResult()},s))},dp=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(q(this,Et)):this.options.refetchInterval)??!1},hp=function(e){Tt(this,kt,gp).call(this),He(this,ia,e),!(eo||an(this.options.enabled,q(this,Et))===!1||!np(q(this,ia))||q(this,ia)===0)&&He(this,Wa,setInterval(()=>{(this.options.refetchIntervalInBackground||o0.isFocused())&&Tt(this,kt,kc).call(this)},q(this,ia)))},fp=function(){Tt(this,kt,up).call(this),Tt(this,kt,hp).call(this,Tt(this,kt,dp).call(this))},mp=function(){q(this,Xa)&&(clearTimeout(q(this,Xa)),He(this,Xa,void 0))},gp=function(){q(this,Wa)&&(clearInterval(q(this,Wa)),He(this,Wa,void 0))},pp=function(){const e=q(this,ui).getQueryCache().build(q(this,ui),this.options);if(e===q(this,Et))return;const t=q(this,Et);He(this,Et,e),He(this,lu,e.state),this.hasListeners()&&(t==null||t.removeObserver(this),e.addObserver(this))},tb=function(e){Us.batch(()=>{e.listeners&&this.listeners.forEach(t=>{t(q(this,ti))}),q(this,ui).getQueryCache().notify({query:q(this,Et),type:"observerResultsUpdated"})})},GE);function gC(i,e){return an(e.enabled,i)!==!1&&i.state.data===void 0&&!(i.state.status==="error"&&e.retryOnMount===!1)}function cT(i,e){return gC(i,e)||i.state.data!==void 0&&yp(i,e,e.refetchOnMount)}function yp(i,e,t){if(an(e.enabled,i)!==!1&&oa(e.staleTime,i)!=="static"){const s=typeof t=="function"?t(i):t;return s==="always"||s!==!1&&l0(i,e)}return!1}function uT(i,e,t,s){return(i!==e||an(s.enabled,i)===!1)&&(!t.suspense||i.state.status!=="error")&&l0(i,t)}function l0(i,e){return an(e.enabled,i)!==!1&&i.isStaleByTime(oa(e.staleTime,i))}function pC(i,e){return!rp(i.getCurrentResult(),e)}var yC=class extends eb{constructor(i,e){super(i,e)}bindMethods(){super.bindMethods(),this.fetchNextPage=this.fetchNextPage.bind(this),this.fetchPreviousPage=this.fetchPreviousPage.bind(this)}setOptions(i){super.setOptions({...i,behavior:gh()})}getOptimisticResult(i){return i.behavior=gh(),super.getOptimisticResult(i)}fetchNextPage(i){return this.fetch({...i,meta:{fetchMore:{direction:"forward"}}})}fetchPreviousPage(i){return this.fetch({...i,meta:{fetchMore:{direction:"backward"}}})}createResult(i,e){var S,y;const{state:t}=i,s=super.createResult(i,e),{isFetching:n,isRefetching:r,isError:o,isRefetchError:c}=s,d=(y=(S=t.fetchMeta)==null?void 0:S.fetchMore)==null?void 0:y.direction,u=o&&d==="forward",f=n&&d==="forward",m=o&&d==="backward",p=n&&d==="backward";return{...s,fetchNextPage:this.fetchNextPage,fetchPreviousPage:this.fetchPreviousPage,hasNextPage:hC(e,t.data),hasPreviousPage:fC(e,t.data),isFetchNextPageError:u,isFetchingNextPage:f,isFetchPreviousPageError:m,isFetchingPreviousPage:p,isRefetchError:c&&!u&&!m,isRefetching:r&&!f&&!p}}};function sb(i){return i}function vC(i){return{mutationKey:i.options.mutationKey,state:i.state,...i.options.scope&&{scope:i.options.scope},...i.meta&&{meta:i.meta}}}function SC(i,e,t){var s;return{dehydratedAt:Date.now(),state:{...i.state,...i.state.data!==void 0&&{data:e(i.state.data)}},queryKey:i.queryKey,queryHash:i.queryHash,...i.state.status==="pending"&&{promise:(s=i.promise)==null?void 0:s.then(e).catch(n=>t(n)?Promise.reject(new Error("redacted")):Promise.reject(n))},...i.meta&&{meta:i.meta}}}function xC(i){return i.state.isPaused}function TC(i){return i.state.status==="success"}function EC(i){return!0}function bC(i,e={}){var d,u,f,m;const t=e.shouldDehydrateMutation??((d=i.getDefaultOptions().dehydrate)==null?void 0:d.shouldDehydrateMutation)??xC,s=i.getMutationCache().getAll().flatMap(p=>t(p)?[vC(p)]:[]),n=e.shouldDehydrateQuery??((u=i.getDefaultOptions().dehydrate)==null?void 0:u.shouldDehydrateQuery)??TC,r=e.shouldRedactErrors??((f=i.getDefaultOptions().dehydrate)==null?void 0:f.shouldRedactErrors)??EC,o=e.serializeData??((m=i.getDefaultOptions().dehydrate)==null?void 0:m.serializeData)??sb,c=i.getQueryCache().getAll().flatMap(p=>n(p)?[SC(p,o,r)]:[]);return{mutations:s,queries:c}}function AC(i,e,t){var d,u;if(typeof e!="object"||e===null)return;const s=i.getMutationCache(),n=i.getQueryCache(),r=((d=t==null?void 0:t.defaultOptions)==null?void 0:d.deserializeData)??((u=i.getDefaultOptions().hydrate)==null?void 0:u.deserializeData)??sb,o=e.mutations||[],c=e.queries||[];o.forEach(({state:f,...m})=>{var p,v;s.build(i,{...(p=i.getDefaultOptions().hydrate)==null?void 0:p.mutations,...(v=t==null?void 0:t.defaultOptions)==null?void 0:v.mutations,...m},f)}),c.forEach(({queryKey:f,state:m,queryHash:p,meta:v,promise:S,dehydratedAt:y})=>{var D,_;const E=S?sC(S):void 0,A=m.data===void 0?E==null?void 0:E.data:m.data,R=A===void 0?A:r(A);let I=n.get(p);const C=(I==null?void 0:I.state.status)==="pending",L=(I==null?void 0:I.state.fetchStatus)==="fetching";if(I){const M=E&&y!==void 0&&y>I.state.dataUpdatedAt;if(m.dataUpdatedAt>I.state.dataUpdatedAt||M){const{fetchStatus:U,...F}=m;I.setState({...F,data:R})}}else I=n.build(i,{...(D=i.getDefaultOptions().hydrate)==null?void 0:D.queries,...(_=t==null?void 0:t.defaultOptions)==null?void 0:_.queries,queryKey:f,queryHash:p,meta:v},{...m,data:R,fetchStatus:"idle",status:R!==void 0?"success":m.status});S&&!C&&!L&&(y===void 0||y>I.state.dataUpdatedAt)&&I.fetch(void 0,{initialPromise:Promise.resolve(S).then(r)})})}var ib=P.createContext(void 0),El=i=>{const e=P.useContext(ib);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},nb=({client:i,children:e})=>(P.useEffect(()=>(i.mount(),()=>{i.unmount()}),[i]),T.jsx(ib.Provider,{value:i,children:e})),rb=P.createContext(!1),IC=()=>P.useContext(rb),RC=rb.Provider;function LC(){let i=!1;return{clearReset:()=>{i=!1},reset:()=>{i=!0},isReset:()=>i}}var wC=P.createContext(LC()),CC=()=>P.useContext(wC),OC=(i,e)=>{(i.suspense||i.throwOnError||i.experimental_prefetchInRender)&&(e.isReset()||(i.retryOnMount=!1))},DC=i=>{P.useEffect(()=>{i.clearReset()},[i])},_C=({result:i,errorResetBoundary:e,throwOnError:t,query:s,suspense:n})=>i.isError&&!e.isReset()&&!i.isFetching&&s&&(n&&i.data===void 0||Jw(t,[i.error,s])),PC=i=>{if(i.suspense){const e=s=>s==="static"?s:Math.max(s??1e3,1e3),t=i.staleTime;i.staleTime=typeof t=="function"?(...s)=>e(t(...s)):e(t),typeof i.gcTime=="number"&&(i.gcTime=Math.max(i.gcTime,1e3))}},kC=(i,e)=>i.isLoading&&i.isFetching&&!e,NC=(i,e)=>(i==null?void 0:i.suspense)&&e.isPending,dT=(i,e,t)=>e.fetchOptimistic(i).catch(()=>{t.clearReset()});function ab(i,e,t){var m,p,v,S,y;const s=El(),n=IC(),r=CC(),o=s.defaultQueryOptions(i);(p=(m=s.getDefaultOptions().queries)==null?void 0:m._experimental_beforeQuery)==null||p.call(m,o),o._optimisticResults=n?"isRestoring":"optimistic",PC(o),OC(o,r),DC(r);const c=!s.getQueryCache().get(o.queryHash),[d]=P.useState(()=>new e(s,o)),u=d.getOptimisticResult(o),f=!n&&i.subscribed!==!1;if(P.useSyncExternalStore(P.useCallback(E=>{const A=f?d.subscribe(Us.batchCalls(E)):si;return d.updateResult(),A},[d,f]),()=>d.getCurrentResult(),()=>d.getCurrentResult()),P.useEffect(()=>{d.setOptions(o)},[o,d]),NC(o,u))throw dT(o,d,r);if(_C({result:u,errorResetBoundary:r,throwOnError:o.throwOnError,query:s.getQueryCache().get(o.queryHash),suspense:o.suspense}))throw u.error;if((S=(v=s.getDefaultOptions().queries)==null?void 0:v._experimental_afterQuery)==null||S.call(v,o,u),o.experimental_prefetchInRender&&!eo&&kC(u,n)){const E=c?dT(o,d,r):(y=s.getQueryCache().get(o.queryHash))==null?void 0:y.promise;E==null||E.catch(si).finally(()=>{d.updateResult()})}return o.notifyOnChangeProps?u:d.trackResult(u)}function la(i,e){return ab(i,eb)}function ob(i,e){return ab(i,yC)}var MC=["added","removed","updated"];function hT(i){return MC.includes(i)}async function UC({queryClient:i,persister:e,maxAge:t=1e3*60*60*24,buster:s="",hydrateOptions:n}){try{const r=await e.restoreClient();if(r)if(r.timestamp){const o=Date.now()-r.timestamp>t,c=r.buster!==s;if(o||c)return e.removeClient();AC(i,r.clientState,n)}else return e.removeClient()}catch(r){throw await e.removeClient(),r}}async function fT({queryClient:i,persister:e,buster:t="",dehydrateOptions:s}){const n={buster:t,timestamp:Date.now(),clientState:bC(i,s)};await e.persistClient(n)}function FC(i){const e=i.queryClient.getQueryCache().subscribe(s=>{hT(s.type)&&fT(i)}),t=i.queryClient.getMutationCache().subscribe(s=>{hT(s.type)&&fT(i)});return()=>{e(),t()}}var BC=({children:i,persistOptions:e,onSuccess:t,onError:s,...n})=>{const[r,o]=P.useState(!0),c=P.useRef({persistOptions:e,onSuccess:t,onError:s}),d=P.useRef(!1);return P.useEffect(()=>{c.current={persistOptions:e,onSuccess:t,onError:s}}),P.useEffect(()=>{const u={...c.current.persistOptions,queryClient:n.client};return d.current||(d.current=!0,UC(u).then(()=>{var f,m;return(m=(f=c.current).onSuccess)==null?void 0:m.call(f)}).catch(()=>{var f,m;return(m=(f=c.current).onError)==null?void 0:m.call(f)}).finally(()=>{o(!1)})),r?void 0:FC(u)},[n.client,r]),T.jsx(nb,{...n,children:T.jsx(RC,{value:r,children:i})})},wc={},mT;function jC(){if(mT)return wc;mT=1,Object.defineProperty(wc,"__esModule",{value:!0}),wc.parse=o,wc.serialize=u;const i=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,e=/^[\u0021-\u003A\u003C-\u007E]*$/,t=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,s=/^[\u0020-\u003A\u003D-\u007E]*$/,n=Object.prototype.toString,r=(()=>{const p=function(){};return p.prototype=Object.create(null),p})();function o(p,v){const S=new r,y=p.length;if(y<2)return S;const E=(v==null?void 0:v.decode)||f;let A=0;do{const R=p.indexOf("=",A);if(R===-1)break;const I=p.indexOf(";",A),C=I===-1?y:I;if(R>C){A=p.lastIndexOf(";",R-1)+1;continue}const L=c(p,A,R),D=d(p,R,L),_=p.slice(L,D);if(S[_]===void 0){let M=c(p,R+1,C),U=d(p,C,M);const F=E(p.slice(M,U));S[_]=F}A=C+1}while(A<y);return S}function c(p,v,S){do{const y=p.charCodeAt(v);if(y!==32&&y!==9)return v}while(++v<S);return S}function d(p,v,S){for(;v>S;){const y=p.charCodeAt(--v);if(y!==32&&y!==9)return v+1}return S}function u(p,v,S){const y=(S==null?void 0:S.encode)||encodeURIComponent;if(!i.test(p))throw new TypeError(`argument name is invalid: ${p}`);const E=y(v);if(!e.test(E))throw new TypeError(`argument val is invalid: ${v}`);let A=p+"="+E;if(!S)return A;if(S.maxAge!==void 0){if(!Number.isInteger(S.maxAge))throw new TypeError(`option maxAge is invalid: ${S.maxAge}`);A+="; Max-Age="+S.maxAge}if(S.domain){if(!t.test(S.domain))throw new TypeError(`option domain is invalid: ${S.domain}`);A+="; Domain="+S.domain}if(S.path){if(!s.test(S.path))throw new TypeError(`option path is invalid: ${S.path}`);A+="; Path="+S.path}if(S.expires){if(!m(S.expires)||!Number.isFinite(S.expires.valueOf()))throw new TypeError(`option expires is invalid: ${S.expires}`);A+="; Expires="+S.expires.toUTCString()}if(S.httpOnly&&(A+="; HttpOnly"),S.secure&&(A+="; Secure"),S.partitioned&&(A+="; Partitioned"),S.priority)switch(typeof S.priority=="string"?S.priority.toLowerCase():void 0){case"low":A+="; Priority=Low";break;case"medium":A+="; Priority=Medium";break;case"high":A+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${S.priority}`)}if(S.sameSite)switch(typeof S.sameSite=="string"?S.sameSite.toLowerCase():S.sameSite){case!0:case"strict":A+="; SameSite=Strict";break;case"lax":A+="; SameSite=Lax";break;case"none":A+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${S.sameSite}`)}return A}function f(p){if(p.indexOf("%")===-1)return p;try{return decodeURIComponent(p)}catch{return p}}function m(p){return n.call(p)==="[object Date]"}return wc}jC();var gT="popstate";function VC(i={}){function e(s,n){let{pathname:r,search:o,hash:c}=s.location;return vp("",{pathname:r,search:o,hash:c},n.state&&n.state.usr||null,n.state&&n.state.key||"default")}function t(s,n){return typeof n=="string"?n:zc(n)}return GC(e,t,null,i)}function ts(i,e){if(i===!1||i===null||typeof i>"u")throw new Error(e)}function Qi(i,e){if(!i){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function $C(){return Math.random().toString(36).substring(2,10)}function pT(i,e){return{usr:i.state,key:i.key,idx:e}}function vp(i,e,t=null,s){return{pathname:typeof i=="string"?i:i.pathname,search:"",hash:"",...typeof e=="string"?bl(e):e,state:t,key:e&&e.key||s||$C()}}function zc({pathname:i="/",search:e="",hash:t=""}){return e&&e!=="?"&&(i+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(i+=t.charAt(0)==="#"?t:"#"+t),i}function bl(i){let e={};if(i){let t=i.indexOf("#");t>=0&&(e.hash=i.substring(t),i=i.substring(0,t));let s=i.indexOf("?");s>=0&&(e.search=i.substring(s),i=i.substring(0,s)),i&&(e.pathname=i)}return e}function GC(i,e,t,s={}){let{window:n=document.defaultView,v5Compat:r=!1}=s,o=n.history,c="POP",d=null,u=f();u==null&&(u=0,o.replaceState({...o.state,idx:u},""));function f(){return(o.state||{idx:null}).idx}function m(){c="POP";let E=f(),A=E==null?null:E-u;u=E,d&&d({action:c,location:y.location,delta:A})}function p(E,A){c="PUSH";let R=vp(y.location,E,A);u=f()+1;let I=pT(R,u),C=y.createHref(R);try{o.pushState(I,"",C)}catch(L){if(L instanceof DOMException&&L.name==="DataCloneError")throw L;n.location.assign(C)}r&&d&&d({action:c,location:y.location,delta:1})}function v(E,A){c="REPLACE";let R=vp(y.location,E,A);u=f();let I=pT(R,u),C=y.createHref(R);o.replaceState(I,"",C),r&&d&&d({action:c,location:y.location,delta:0})}function S(E){return HC(E)}let y={get action(){return c},get location(){return i(n,o)},listen(E){if(d)throw new Error("A history only accepts one active listener");return n.addEventListener(gT,m),d=E,()=>{n.removeEventListener(gT,m),d=null}},createHref(E){return e(n,E)},createURL:S,encodeLocation(E){let A=S(E);return{pathname:A.pathname,search:A.search,hash:A.hash}},push:p,replace:v,go(E){return o.go(E)}};return y}function HC(i,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),ts(t,"No window.location.(origin|href) available to create URL");let s=typeof i=="string"?i:zc(i);return s=s.replace(/ $/,"%20"),!e&&s.startsWith("//")&&(s=t+s),new URL(s,t)}function lb(i,e,t="/"){return zC(i,e,t,!1)}function zC(i,e,t,s){let n=typeof e=="string"?bl(e):e,r=ur(n.pathname||"/",t);if(r==null)return null;let o=cb(i);KC(o);let c=null;for(let d=0;c==null&&d<o.length;++d){let u=iO(r);c=tO(o[d],u,s)}return c}function cb(i,e=[],t=[],s=""){let n=(r,o,c)=>{let d={relativePath:c===void 0?r.path||"":c,caseSensitive:r.caseSensitive===!0,childrenIndex:o,route:r};d.relativePath.startsWith("/")&&(ts(d.relativePath.startsWith(s),`Absolute route path "${d.relativePath}" nested under path "${s}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),d.relativePath=d.relativePath.slice(s.length));let u=cr([s,d.relativePath]),f=t.concat(d);r.children&&r.children.length>0&&(ts(r.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${u}".`),cb(r.children,e,f,u)),!(r.path==null&&!r.index)&&e.push({path:u,score:JC(u,r.index),routesMeta:f})};return i.forEach((r,o)=>{var c;if(r.path===""||!((c=r.path)!=null&&c.includes("?")))n(r,o);else for(let d of ub(r.path))n(r,o,d)}),e}function ub(i){let e=i.split("/");if(e.length===0)return[];let[t,...s]=e,n=t.endsWith("?"),r=t.replace(/\?$/,"");if(s.length===0)return n?[r,""]:[r];let o=ub(s.join("/")),c=[];return c.push(...o.map(d=>d===""?r:[r,d].join("/"))),n&&c.push(...o),c.map(d=>i.startsWith("/")&&d===""?"/":d)}function KC(i){i.sort((e,t)=>e.score!==t.score?t.score-e.score:eO(e.routesMeta.map(s=>s.childrenIndex),t.routesMeta.map(s=>s.childrenIndex)))}var YC=/^:[\w-]+$/,qC=3,QC=2,XC=1,WC=10,ZC=-2,yT=i=>i==="*";function JC(i,e){let t=i.split("/"),s=t.length;return t.some(yT)&&(s+=ZC),e&&(s+=QC),t.filter(n=>!yT(n)).reduce((n,r)=>n+(YC.test(r)?qC:r===""?XC:WC),s)}function eO(i,e){return i.length===e.length&&i.slice(0,-1).every((s,n)=>s===e[n])?i[i.length-1]-e[e.length-1]:0}function tO(i,e,t=!1){let{routesMeta:s}=i,n={},r="/",o=[];for(let c=0;c<s.length;++c){let d=s[c],u=c===s.length-1,f=r==="/"?e:e.slice(r.length)||"/",m=ph({path:d.relativePath,caseSensitive:d.caseSensitive,end:u},f),p=d.route;if(!m&&u&&t&&!s[s.length-1].route.index&&(m=ph({path:d.relativePath,caseSensitive:d.caseSensitive,end:!1},f)),!m)return null;Object.assign(n,m.params),o.push({params:n,pathname:cr([r,m.pathname]),pathnameBase:oO(cr([r,m.pathnameBase])),route:p}),m.pathnameBase!=="/"&&(r=cr([r,m.pathnameBase]))}return o}function ph(i,e){typeof i=="string"&&(i={path:i,caseSensitive:!1,end:!0});let[t,s]=sO(i.path,i.caseSensitive,i.end),n=e.match(t);if(!n)return null;let r=n[0],o=r.replace(/(.)\/+$/,"$1"),c=n.slice(1);return{params:s.reduce((u,{paramName:f,isOptional:m},p)=>{if(f==="*"){let S=c[p]||"";o=r.slice(0,r.length-S.length).replace(/(.)\/+$/,"$1")}const v=c[p];return m&&!v?u[f]=void 0:u[f]=(v||"").replace(/%2F/g,"/"),u},{}),pathname:r,pathnameBase:o,pattern:i}}function sO(i,e=!1,t=!0){Qi(i==="*"||!i.endsWith("*")||i.endsWith("/*"),`Route path "${i}" will be treated as if it were "${i.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${i.replace(/\*$/,"/*")}".`);let s=[],n="^"+i.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,c,d)=>(s.push({paramName:c,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)"));return i.endsWith("*")?(s.push({paramName:"*"}),n+=i==="*"||i==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?n+="\\/*$":i!==""&&i!=="/"&&(n+="(?:(?=\\/|$))"),[new RegExp(n,e?void 0:"i"),s]}function iO(i){try{return i.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Qi(!1,`The URL path "${i}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),i}}function ur(i,e){if(e==="/")return i;if(!i.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,s=i.charAt(t);return s&&s!=="/"?null:i.slice(t)||"/"}function nO(i,e="/"){let{pathname:t,search:s="",hash:n=""}=typeof i=="string"?bl(i):i;return{pathname:t?t.startsWith("/")?t:rO(t,e):e,search:lO(s),hash:cO(n)}}function rO(i,e){let t=e.replace(/\/+$/,"").split("/");return i.split("/").forEach(n=>{n===".."?t.length>1&&t.pop():n!=="."&&t.push(n)}),t.length>1?t.join("/"):"/"}function vg(i,e,t,s){return`Cannot include a '${i}' character in a manually specified \`to.${e}\` field [${JSON.stringify(s)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function aO(i){return i.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function c0(i){let e=aO(i);return e.map((t,s)=>s===e.length-1?t.pathname:t.pathnameBase)}function u0(i,e,t,s=!1){let n;typeof i=="string"?n=bl(i):(n={...i},ts(!n.pathname||!n.pathname.includes("?"),vg("?","pathname","search",n)),ts(!n.pathname||!n.pathname.includes("#"),vg("#","pathname","hash",n)),ts(!n.search||!n.search.includes("#"),vg("#","search","hash",n)));let r=i===""||n.pathname==="",o=r?"/":n.pathname,c;if(o==null)c=t;else{let m=e.length-1;if(!s&&o.startsWith("..")){let p=o.split("/");for(;p[0]==="..";)p.shift(),m-=1;n.pathname=p.join("/")}c=m>=0?e[m]:"/"}let d=nO(n,c),u=o&&o!=="/"&&o.endsWith("/"),f=(r||o===".")&&t.endsWith("/");return!d.pathname.endsWith("/")&&(u||f)&&(d.pathname+="/"),d}var cr=i=>i.join("/").replace(/\/\/+/g,"/"),oO=i=>i.replace(/\/+$/,"").replace(/^\/*/,"/"),lO=i=>!i||i==="?"?"":i.startsWith("?")?i:"?"+i,cO=i=>!i||i==="#"?"":i.startsWith("#")?i:"#"+i;function uO(i){return i!=null&&typeof i.status=="number"&&typeof i.statusText=="string"&&typeof i.internal=="boolean"&&"data"in i}var db=["POST","PUT","PATCH","DELETE"];new Set(db);var dO=["GET",...db];new Set(dO);var Al=P.createContext(null);Al.displayName="DataRouter";var Uh=P.createContext(null);Uh.displayName="DataRouterState";var hb=P.createContext({isTransitioning:!1});hb.displayName="ViewTransition";var hO=P.createContext(new Map);hO.displayName="Fetchers";var fO=P.createContext(null);fO.displayName="Await";var cn=P.createContext(null);cn.displayName="Navigation";var du=P.createContext(null);du.displayName="Location";var un=P.createContext({outlet:null,matches:[],isDataRoute:!1});un.displayName="Route";var d0=P.createContext(null);d0.displayName="RouteError";function mO(i,{relative:e}={}){ts(Il(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:s}=P.useContext(cn),{hash:n,pathname:r,search:o}=hu(i,{relative:e}),c=r;return t!=="/"&&(c=r==="/"?t:cr([t,r])),s.createHref({pathname:c,search:o,hash:n})}function Il(){return P.useContext(du)!=null}function Xs(){return ts(Il(),"useLocation() may be used only in the context of a <Router> component."),P.useContext(du).location}var fb="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function mb(i){P.useContext(cn).static||P.useLayoutEffect(i)}function io(){let{isDataRoute:i}=P.useContext(un);return i?LO():gO()}function gO(){ts(Il(),"useNavigate() may be used only in the context of a <Router> component.");let i=P.useContext(Al),{basename:e,navigator:t}=P.useContext(cn),{matches:s}=P.useContext(un),{pathname:n}=Xs(),r=JSON.stringify(c0(s)),o=P.useRef(!1);return mb(()=>{o.current=!0}),P.useCallback((d,u={})=>{if(Qi(o.current,fb),!o.current)return;if(typeof d=="number"){t.go(d);return}let f=u0(d,JSON.parse(r),n,u.relative==="path");i==null&&e!=="/"&&(f.pathname=f.pathname==="/"?e:cr([e,f.pathname])),(u.replace?t.replace:t.push)(f,u.state,u)},[e,t,r,n,i])}P.createContext(null);function Rl(){let{matches:i}=P.useContext(un),e=i[i.length-1];return e?e.params:{}}function hu(i,{relative:e}={}){let{matches:t}=P.useContext(un),{pathname:s}=Xs(),n=JSON.stringify(c0(t));return P.useMemo(()=>u0(i,JSON.parse(n),s,e==="path"),[i,n,s,e])}function pO(i,e){return gb(i,e)}function gb(i,e,t,s){var A;ts(Il(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:n}=P.useContext(cn),{matches:r}=P.useContext(un),o=r[r.length-1],c=o?o.params:{},d=o?o.pathname:"/",u=o?o.pathnameBase:"/",f=o&&o.route;{let R=f&&f.path||"";pb(d,!f||R.endsWith("*")||R.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${R}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${R}"> to <Route path="${R==="/"?"*":`${R}/*`}">.`)}let m=Xs(),p;if(e){let R=typeof e=="string"?bl(e):e;ts(u==="/"||((A=R.pathname)==null?void 0:A.startsWith(u)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${u}" but pathname "${R.pathname}" was given in the \`location\` prop.`),p=R}else p=m;let v=p.pathname||"/",S=v;if(u!=="/"){let R=u.replace(/^\//,"").split("/");S="/"+v.replace(/^\//,"").split("/").slice(R.length).join("/")}let y=lb(i,{pathname:S});Qi(f||y!=null,`No routes matched location "${p.pathname}${p.search}${p.hash}" `),Qi(y==null||y[y.length-1].route.element!==void 0||y[y.length-1].route.Component!==void 0||y[y.length-1].route.lazy!==void 0,`Matched leaf route at location "${p.pathname}${p.search}${p.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let E=TO(y&&y.map(R=>Object.assign({},R,{params:Object.assign({},c,R.params),pathname:cr([u,n.encodeLocation?n.encodeLocation(R.pathname).pathname:R.pathname]),pathnameBase:R.pathnameBase==="/"?u:cr([u,n.encodeLocation?n.encodeLocation(R.pathnameBase).pathname:R.pathnameBase])})),r,t,s);return e&&E?P.createElement(du.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...p},navigationType:"POP"}},E):E}function yO(){let i=RO(),e=uO(i)?`${i.status} ${i.statusText}`:i instanceof Error?i.message:JSON.stringify(i),t=i instanceof Error?i.stack:null,s="rgba(200,200,200, 0.5)",n={padding:"0.5rem",backgroundColor:s},r={padding:"2px 4px",backgroundColor:s},o=null;return console.error("Error handled by React Router default ErrorBoundary:",i),o=P.createElement(P.Fragment,null,P.createElement("p",null," Hey developer "),P.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",P.createElement("code",{style:r},"ErrorBoundary")," or"," ",P.createElement("code",{style:r},"errorElement")," prop on your route.")),P.createElement(P.Fragment,null,P.createElement("h2",null,"Unexpected Application Error!"),P.createElement("h3",{style:{fontStyle:"italic"}},e),t?P.createElement("pre",{style:n},t):null,o)}var vO=P.createElement(yO,null),SO=class extends P.Component{constructor(i){super(i),this.state={location:i.location,revalidation:i.revalidation,error:i.error}}static getDerivedStateFromError(i){return{error:i}}static getDerivedStateFromProps(i,e){return e.location!==i.location||e.revalidation!=="idle"&&i.revalidation==="idle"?{error:i.error,location:i.location,revalidation:i.revalidation}:{error:i.error!==void 0?i.error:e.error,location:e.location,revalidation:i.revalidation||e.revalidation}}componentDidCatch(i,e){console.error("React Router caught the following error during render",i,e)}render(){return this.state.error!==void 0?P.createElement(un.Provider,{value:this.props.routeContext},P.createElement(d0.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function xO({routeContext:i,match:e,children:t}){let s=P.useContext(Al);return s&&s.static&&s.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=e.route.id),P.createElement(un.Provider,{value:i},t)}function TO(i,e=[],t=null,s=null){if(i==null){if(!t)return null;if(t.errors)i=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)i=t.matches;else return null}let n=i,r=t==null?void 0:t.errors;if(r!=null){let d=n.findIndex(u=>u.route.id&&(r==null?void 0:r[u.route.id])!==void 0);ts(d>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(r).join(",")}`),n=n.slice(0,Math.min(n.length,d+1))}let o=!1,c=-1;if(t)for(let d=0;d<n.length;d++){let u=n[d];if((u.route.HydrateFallback||u.route.hydrateFallbackElement)&&(c=d),u.route.id){let{loaderData:f,errors:m}=t,p=u.route.loader&&!f.hasOwnProperty(u.route.id)&&(!m||m[u.route.id]===void 0);if(u.route.lazy||p){o=!0,c>=0?n=n.slice(0,c+1):n=[n[0]];break}}}return n.reduceRight((d,u,f)=>{let m,p=!1,v=null,S=null;t&&(m=r&&u.route.id?r[u.route.id]:void 0,v=u.route.errorElement||vO,o&&(c<0&&f===0?(pb("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),p=!0,S=null):c===f&&(p=!0,S=u.route.hydrateFallbackElement||null)));let y=e.concat(n.slice(0,f+1)),E=()=>{let A;return m?A=v:p?A=S:u.route.Component?A=P.createElement(u.route.Component,null):u.route.element?A=u.route.element:A=d,P.createElement(xO,{match:u,routeContext:{outlet:d,matches:y,isDataRoute:t!=null},children:A})};return t&&(u.route.ErrorBoundary||u.route.errorElement||f===0)?P.createElement(SO,{location:t.location,revalidation:t.revalidation,component:v,error:m,children:E(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):E()},null)}function h0(i){return`${i} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function EO(i){let e=P.useContext(Al);return ts(e,h0(i)),e}function bO(i){let e=P.useContext(Uh);return ts(e,h0(i)),e}function AO(i){let e=P.useContext(un);return ts(e,h0(i)),e}function f0(i){let e=AO(i),t=e.matches[e.matches.length-1];return ts(t.route.id,`${i} can only be used on routes that contain a unique "id"`),t.route.id}function IO(){return f0("useRouteId")}function RO(){var s;let i=P.useContext(d0),e=bO("useRouteError"),t=f0("useRouteError");return i!==void 0?i:(s=e.errors)==null?void 0:s[t]}function LO(){let{router:i}=EO("useNavigate"),e=f0("useNavigate"),t=P.useRef(!1);return mb(()=>{t.current=!0}),P.useCallback(async(n,r={})=>{Qi(t.current,fb),t.current&&(typeof n=="number"?i.navigate(n):await i.navigate(n,{fromRouteId:e,...r}))},[i,e])}var vT={};function pb(i,e,t){!e&&!vT[i]&&(vT[i]=!0,Qi(!1,t))}P.memo(wO);function wO({routes:i,future:e,state:t}){return gb(i,void 0,t,e)}function Sp({to:i,replace:e,state:t,relative:s}){ts(Il(),"<Navigate> may be used only in the context of a <Router> component.");let{static:n}=P.useContext(cn);Qi(!n,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:r}=P.useContext(un),{pathname:o}=Xs(),c=io(),d=u0(i,c0(r),o,s==="path"),u=JSON.stringify(d);return P.useEffect(()=>{c(JSON.parse(u),{replace:e,state:t,relative:s})},[c,u,s,e,t]),null}function gs(i){ts(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function CO({basename:i="/",children:e=null,location:t,navigationType:s="POP",navigator:n,static:r=!1}){ts(!Il(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=i.replace(/^\/*/,"/"),c=P.useMemo(()=>({basename:o,navigator:n,static:r,future:{}}),[o,n,r]);typeof t=="string"&&(t=bl(t));let{pathname:d="/",search:u="",hash:f="",state:m=null,key:p="default"}=t,v=P.useMemo(()=>{let S=ur(d,o);return S==null?null:{location:{pathname:S,search:u,hash:f,state:m,key:p},navigationType:s}},[o,d,u,f,m,p,s]);return Qi(v!=null,`<Router basename="${o}"> is not able to match the URL "${d}${u}${f}" because it does not start with the basename, so the <Router> won't render anything.`),v==null?null:P.createElement(cn.Provider,{value:c},P.createElement(du.Provider,{children:e,value:v}))}function yb({children:i,location:e}){return pO(xp(i),e)}function xp(i,e=[]){let t=[];return P.Children.forEach(i,(s,n)=>{if(!P.isValidElement(s))return;let r=[...e,n];if(s.type===P.Fragment){t.push.apply(t,xp(s.props.children,r));return}ts(s.type===gs,`[${typeof s.type=="string"?s.type:s.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),ts(!s.props.index||!s.props.children,"An index route cannot have child routes.");let o={id:s.props.id||r.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,hydrateFallbackElement:s.props.hydrateFallbackElement,HydrateFallback:s.props.HydrateFallback,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.hasErrorBoundary===!0||s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(o.children=xp(s.props.children,r)),t.push(o)}),t}var Zd="get",Jd="application/x-www-form-urlencoded";function Fh(i){return i!=null&&typeof i.tagName=="string"}function OO(i){return Fh(i)&&i.tagName.toLowerCase()==="button"}function DO(i){return Fh(i)&&i.tagName.toLowerCase()==="form"}function _O(i){return Fh(i)&&i.tagName.toLowerCase()==="input"}function PO(i){return!!(i.metaKey||i.altKey||i.ctrlKey||i.shiftKey)}function kO(i,e){return i.button===0&&(!e||e==="_self")&&!PO(i)}function Tp(i=""){return new URLSearchParams(typeof i=="string"||Array.isArray(i)||i instanceof URLSearchParams?i:Object.keys(i).reduce((e,t)=>{let s=i[t];return e.concat(Array.isArray(s)?s.map(n=>[t,n]):[[t,s]])},[]))}function NO(i,e){let t=Tp(i);return e&&e.forEach((s,n)=>{t.has(n)||e.getAll(n).forEach(r=>{t.append(n,r)})}),t}var Dd=null;function MO(){if(Dd===null)try{new FormData(document.createElement("form"),0),Dd=!1}catch{Dd=!0}return Dd}var UO=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Sg(i){return i!=null&&!UO.has(i)?(Qi(!1,`"${i}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Jd}"`),null):i}function FO(i,e){let t,s,n,r,o;if(DO(i)){let c=i.getAttribute("action");s=c?ur(c,e):null,t=i.getAttribute("method")||Zd,n=Sg(i.getAttribute("enctype"))||Jd,r=new FormData(i)}else if(OO(i)||_O(i)&&(i.type==="submit"||i.type==="image")){let c=i.form;if(c==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let d=i.getAttribute("formaction")||c.getAttribute("action");if(s=d?ur(d,e):null,t=i.getAttribute("formmethod")||c.getAttribute("method")||Zd,n=Sg(i.getAttribute("formenctype"))||Sg(c.getAttribute("enctype"))||Jd,r=new FormData(c,i),!MO()){let{name:u,type:f,value:m}=i;if(f==="image"){let p=u?`${u}.`:"";r.append(`${p}x`,"0"),r.append(`${p}y`,"0")}else u&&r.append(u,m)}}else{if(Fh(i))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Zd,s=null,n=Jd,o=i}return r&&n==="text/plain"&&(o=r,r=void 0),{action:s,method:t.toLowerCase(),encType:n,formData:r,body:o}}function m0(i,e){if(i===!1||i===null||typeof i>"u")throw new Error(e)}async function BO(i,e){if(i.id in e)return e[i.id];try{let t=await import(i.module);return e[i.id]=t,t}catch(t){return console.error(`Error loading route module \`${i.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function jO(i){return i==null?!1:i.href==null?i.rel==="preload"&&typeof i.imageSrcSet=="string"&&typeof i.imageSizes=="string":typeof i.rel=="string"&&typeof i.href=="string"}async function VO(i,e,t){let s=await Promise.all(i.map(async n=>{let r=e.routes[n.route.id];if(r){let o=await BO(r,t);return o.links?o.links():[]}return[]}));return zO(s.flat(1).filter(jO).filter(n=>n.rel==="stylesheet"||n.rel==="preload").map(n=>n.rel==="stylesheet"?{...n,rel:"prefetch",as:"style"}:{...n,rel:"prefetch"}))}function ST(i,e,t,s,n,r){let o=(d,u)=>t[u]?d.route.id!==t[u].route.id:!0,c=(d,u)=>{var f;return t[u].pathname!==d.pathname||((f=t[u].route.path)==null?void 0:f.endsWith("*"))&&t[u].params["*"]!==d.params["*"]};return r==="assets"?e.filter((d,u)=>o(d,u)||c(d,u)):r==="data"?e.filter((d,u)=>{var m;let f=s.routes[d.route.id];if(!f||!f.hasLoader)return!1;if(o(d,u)||c(d,u))return!0;if(d.route.shouldRevalidate){let p=d.route.shouldRevalidate({currentUrl:new URL(n.pathname+n.search+n.hash,window.origin),currentParams:((m=t[0])==null?void 0:m.params)||{},nextUrl:new URL(i,window.origin),nextParams:d.params,defaultShouldRevalidate:!0});if(typeof p=="boolean")return p}return!0}):[]}function $O(i,e,{includeHydrateFallback:t}={}){return GO(i.map(s=>{let n=e.routes[s.route.id];if(!n)return[];let r=[n.module];return n.clientActionModule&&(r=r.concat(n.clientActionModule)),n.clientLoaderModule&&(r=r.concat(n.clientLoaderModule)),t&&n.hydrateFallbackModule&&(r=r.concat(n.hydrateFallbackModule)),n.imports&&(r=r.concat(n.imports)),r}).flat(1))}function GO(i){return[...new Set(i)]}function HO(i){let e={},t=Object.keys(i).sort();for(let s of t)e[s]=i[s];return e}function zO(i,e){let t=new Set;return new Set(e),i.reduce((s,n)=>{let r=JSON.stringify(HO(n));return t.has(r)||(t.add(r),s.push({key:r,link:n})),s},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var KO=new Set([100,101,204,205]);function YO(i,e){let t=typeof i=="string"?new URL(i,typeof window>"u"?"server://singlefetch/":window.location.origin):i;return t.pathname==="/"?t.pathname="_root.data":e&&ur(t.pathname,e)==="/"?t.pathname=`${e.replace(/\/$/,"")}/_root.data`:t.pathname=`${t.pathname.replace(/\/$/,"")}.data`,t}function vb(){let i=P.useContext(Al);return m0(i,"You must render this element inside a <DataRouterContext.Provider> element"),i}function qO(){let i=P.useContext(Uh);return m0(i,"You must render this element inside a <DataRouterStateContext.Provider> element"),i}var g0=P.createContext(void 0);g0.displayName="FrameworkContext";function Sb(){let i=P.useContext(g0);return m0(i,"You must render this element inside a <HydratedRouter> element"),i}function QO(i,e){let t=P.useContext(g0),[s,n]=P.useState(!1),[r,o]=P.useState(!1),{onFocus:c,onBlur:d,onMouseEnter:u,onMouseLeave:f,onTouchStart:m}=e,p=P.useRef(null);P.useEffect(()=>{if(i==="render"&&o(!0),i==="viewport"){let y=A=>{A.forEach(R=>{o(R.isIntersecting)})},E=new IntersectionObserver(y,{threshold:.5});return p.current&&E.observe(p.current),()=>{E.disconnect()}}},[i]),P.useEffect(()=>{if(s){let y=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(y)}}},[s]);let v=()=>{n(!0)},S=()=>{n(!1),o(!1)};return t?i!=="intent"?[r,p,{}]:[r,p,{onFocus:Cc(c,v),onBlur:Cc(d,S),onMouseEnter:Cc(u,v),onMouseLeave:Cc(f,S),onTouchStart:Cc(m,v)}]:[!1,p,{}]}function Cc(i,e){return t=>{i&&i(t),t.defaultPrevented||e(t)}}function XO({page:i,...e}){let{router:t}=vb(),s=P.useMemo(()=>lb(t.routes,i,t.basename),[t.routes,i,t.basename]);return s?P.createElement(ZO,{page:i,matches:s,...e}):null}function WO(i){let{manifest:e,routeModules:t}=Sb(),[s,n]=P.useState([]);return P.useEffect(()=>{let r=!1;return VO(i,e,t).then(o=>{r||n(o)}),()=>{r=!0}},[i,e,t]),s}function ZO({page:i,matches:e,...t}){let s=Xs(),{manifest:n,routeModules:r}=Sb(),{basename:o}=vb(),{loaderData:c,matches:d}=qO(),u=P.useMemo(()=>ST(i,e,d,n,s,"data"),[i,e,d,n,s]),f=P.useMemo(()=>ST(i,e,d,n,s,"assets"),[i,e,d,n,s]),m=P.useMemo(()=>{if(i===s.pathname+s.search+s.hash)return[];let S=new Set,y=!1;if(e.forEach(A=>{var I;let R=n.routes[A.route.id];!R||!R.hasLoader||(!u.some(C=>C.route.id===A.route.id)&&A.route.id in c&&((I=r[A.route.id])!=null&&I.shouldRevalidate)||R.hasClientLoader?y=!0:S.add(A.route.id))}),S.size===0)return[];let E=YO(i,o);return y&&S.size>0&&E.searchParams.set("_routes",e.filter(A=>S.has(A.route.id)).map(A=>A.route.id).join(",")),[E.pathname+E.search]},[o,c,s,n,u,e,i,r]),p=P.useMemo(()=>$O(f,n),[f,n]),v=WO(f);return P.createElement(P.Fragment,null,m.map(S=>P.createElement("link",{key:S,rel:"prefetch",as:"fetch",href:S,...t})),p.map(S=>P.createElement("link",{key:S,rel:"modulepreload",href:S,...t})),v.map(({key:S,link:y})=>P.createElement("link",{key:S,...y})))}function JO(...i){return e=>{i.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var xb=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{xb&&(window.__reactRouterVersion="7.6.1")}catch{}function eD({basename:i,children:e,window:t}){let s=P.useRef();s.current==null&&(s.current=VC({window:t,v5Compat:!0}));let n=s.current,[r,o]=P.useState({action:n.action,location:n.location}),c=P.useCallback(d=>{P.startTransition(()=>o(d))},[o]);return P.useLayoutEffect(()=>n.listen(c),[n,c]),P.createElement(CO,{basename:i,children:e,location:r.location,navigationType:r.action,navigator:n})}var Tb=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,qi=P.forwardRef(function({onClick:e,discover:t="render",prefetch:s="none",relative:n,reloadDocument:r,replace:o,state:c,target:d,to:u,preventScrollReset:f,viewTransition:m,...p},v){let{basename:S}=P.useContext(cn),y=typeof u=="string"&&Tb.test(u),E,A=!1;if(typeof u=="string"&&y&&(E=u,xb))try{let U=new URL(window.location.href),F=u.startsWith("//")?new URL(U.protocol+u):new URL(u),z=ur(F.pathname,S);F.origin===U.origin&&z!=null?u=z+F.search+F.hash:A=!0}catch{Qi(!1,`<Link to="${u}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let R=mO(u,{relative:n}),[I,C,L]=QO(s,p),D=iD(u,{replace:o,state:c,target:d,preventScrollReset:f,relative:n,viewTransition:m});function _(U){e&&e(U),U.defaultPrevented||D(U)}let M=P.createElement("a",{...p,...L,href:E||R,onClick:A||r?e:_,ref:JO(v,C),target:d,"data-discover":!y&&t==="render"?"true":void 0});return I&&!y?P.createElement(P.Fragment,null,M,P.createElement(XO,{page:R})):M});qi.displayName="Link";var $i=P.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:s="",end:n=!1,style:r,to:o,viewTransition:c,children:d,...u},f){let m=hu(o,{relative:u.relative}),p=Xs(),v=P.useContext(Uh),{navigator:S,basename:y}=P.useContext(cn),E=v!=null&&cD(m)&&c===!0,A=S.encodeLocation?S.encodeLocation(m).pathname:m.pathname,R=p.pathname,I=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;t||(R=R.toLowerCase(),I=I?I.toLowerCase():null,A=A.toLowerCase()),I&&y&&(I=ur(I,y)||I);const C=A!=="/"&&A.endsWith("/")?A.length-1:A.length;let L=R===A||!n&&R.startsWith(A)&&R.charAt(C)==="/",D=I!=null&&(I===A||!n&&I.startsWith(A)&&I.charAt(A.length)==="/"),_={isActive:L,isPending:D,isTransitioning:E},M=L?e:void 0,U;typeof s=="function"?U=s(_):U=[s,L?"active":null,D?"pending":null,E?"transitioning":null].filter(Boolean).join(" ");let F=typeof r=="function"?r(_):r;return P.createElement(qi,{...u,"aria-current":M,className:U,ref:f,style:F,to:o,viewTransition:c},typeof d=="function"?d(_):d)});$i.displayName="NavLink";var tD=P.forwardRef(({discover:i="render",fetcherKey:e,navigate:t,reloadDocument:s,replace:n,state:r,method:o=Zd,action:c,onSubmit:d,relative:u,preventScrollReset:f,viewTransition:m,...p},v)=>{let S=oD(),y=lD(c,{relative:u}),E=o.toLowerCase()==="get"?"get":"post",A=typeof c=="string"&&Tb.test(c),R=I=>{if(d&&d(I),I.defaultPrevented)return;I.preventDefault();let C=I.nativeEvent.submitter,L=(C==null?void 0:C.getAttribute("formmethod"))||o;S(C||I.currentTarget,{fetcherKey:e,method:L,navigate:t,replace:n,state:r,relative:u,preventScrollReset:f,viewTransition:m})};return P.createElement("form",{ref:v,method:E,action:y,onSubmit:s?d:R,...p,"data-discover":!A&&i==="render"?"true":void 0})});tD.displayName="Form";function sD(i){return`${i} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Eb(i){let e=P.useContext(Al);return ts(e,sD(i)),e}function iD(i,{target:e,replace:t,state:s,preventScrollReset:n,relative:r,viewTransition:o}={}){let c=io(),d=Xs(),u=hu(i,{relative:r});return P.useCallback(f=>{if(kO(f,e)){f.preventDefault();let m=t!==void 0?t:zc(d)===zc(u);c(i,{replace:m,state:s,preventScrollReset:n,relative:r,viewTransition:o})}},[d,c,u,t,s,e,i,n,r,o])}function nD(i){Qi(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=P.useRef(Tp(i)),t=P.useRef(!1),s=Xs(),n=P.useMemo(()=>NO(s.search,t.current?null:e.current),[s.search]),r=io(),o=P.useCallback((c,d)=>{const u=Tp(typeof c=="function"?c(n):c);t.current=!0,r("?"+u,d)},[r,n]);return[n,o]}var rD=0,aD=()=>`__${String(++rD)}__`;function oD(){let{router:i}=Eb("useSubmit"),{basename:e}=P.useContext(cn),t=IO();return P.useCallback(async(s,n={})=>{let{action:r,method:o,encType:c,formData:d,body:u}=FO(s,e);if(n.navigate===!1){let f=n.fetcherKey||aD();await i.fetch(f,t,n.action||r,{preventScrollReset:n.preventScrollReset,formData:d,body:u,formMethod:n.method||o,formEncType:n.encType||c,flushSync:n.flushSync})}else await i.navigate(n.action||r,{preventScrollReset:n.preventScrollReset,formData:d,body:u,formMethod:n.method||o,formEncType:n.encType||c,replace:n.replace,state:n.state,fromRouteId:t,flushSync:n.flushSync,viewTransition:n.viewTransition})},[i,e,t])}function lD(i,{relative:e}={}){let{basename:t}=P.useContext(cn),s=P.useContext(un);ts(s,"useFormAction must be used inside a RouteContext");let[n]=s.matches.slice(-1),r={...hu(i||".",{relative:e})},o=Xs();if(i==null){r.search=o.search;let c=new URLSearchParams(r.search),d=c.getAll("index");if(d.some(f=>f==="")){c.delete("index"),d.filter(m=>m).forEach(m=>c.append("index",m));let f=c.toString();r.search=f?`?${f}`:""}}return(!i||i===".")&&n.route.index&&(r.search=r.search?r.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(r.pathname=r.pathname==="/"?t:cr([t,r.pathname])),zc(r)}function cD(i,e={}){let t=P.useContext(hb);ts(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:s}=Eb("useViewTransitionState"),n=hu(i,{relative:e.relative});if(!t.isTransitioning)return!1;let r=ur(t.currentLocation.pathname,s)||t.currentLocation.pathname,o=ur(t.nextLocation.pathname,s)||t.nextLocation.pathname;return ph(n.pathname,o)!=null||ph(n.pathname,r)!=null}[...KO];var uD=HE();const dD=i0(uD),bb=P.createContext({}),hr=()=>P.useContext(bb),hD=()=>hr().dropdownNode;function xT(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);e&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(i,n).enumerable})),t.push.apply(t,s)}return t}function fD(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?xT(Object(t),!0).forEach(function(s){mD(i,s,t[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):xT(Object(t)).forEach(function(s){Object.defineProperty(i,s,Object.getOwnPropertyDescriptor(t,s))})}return i}function mD(i,e,t){return e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Ep(){return Ep=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(i[s]=t[s])}return i},Ep.apply(this,arguments)}function gD(i,e){if(i==null)return{};var t={},s=Object.keys(i),n,r;for(r=0;r<s.length;r++)n=s[r],!(e.indexOf(n)>=0)&&(t[n]=i[n]);return t}function pD(i,e){if(i==null)return{};var t=gD(i,e),s,n;if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(i);for(n=0;n<r.length;n++)s=r[n],!(e.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(i,s)&&(t[s]=i[s])}return t}var yD=["aria-label","aria-labelledby","tabIndex","className","fill","size","verticalAlign","id","title","style"],vD={small:16,medium:32,large:64};function ha(i,e,t){var s=t(),n=Object.keys(s),r=_e.forwardRef(function(o,c){var d=o["aria-label"],u=o["aria-labelledby"],f=o.tabIndex,m=o.className,p=m===void 0?"":m,v=o.fill,S=v===void 0?"currentColor":v,y=o.size,E=y===void 0?16:y,A=o.verticalAlign,R=A===void 0?"text-bottom":A,I=o.id,C=o.title,L=o.style,D=pD(o,yD),_=vD[E]||E,M=SD(n,_),U=s[M].width,F=_*(U/M),z=s[M].path,V=d||u,ae=V?"img":void 0;return _e.createElement("svg",Ep({ref:c},D,{"aria-hidden":V?void 0:"true",tabIndex:f,focusable:f>=0?"true":"false","aria-label":d,"aria-labelledby":u,className:"".concat(e," ").concat(p).trim(),role:ae,viewBox:"0 0 ".concat(U," ").concat(M),width:F,height:_,fill:S,id:I,display:"inline-block",overflow:"visible",style:fD({verticalAlign:R},L)}),C?_e.createElement("title",null,C):null,z)});return r.displayName=i,r}function SD(i,e){return i.map(function(t){return parseInt(t,10)}).reduce(function(t,s){return s<=e?s:t},i[0])}var Ab=ha("ArrowLeftIcon","octicon octicon-arrow-left",function(){return{16:{width:16,path:_e.createElement("path",{d:"M7.78 12.53a.75.75 0 0 1-1.06 0L2.47 8.28a.75.75 0 0 1 0-1.06l4.25-4.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042L4.81 7h7.44a.75.75 0 0 1 0 1.5H4.81l2.97 2.97a.75.75 0 0 1 0 1.06Z"})},24:{width:24,path:_e.createElement("path",{d:"M10.78 19.03a.75.75 0 0 1-1.06 0l-6.25-6.25a.75.75 0 0 1 0-1.06l6.25-6.25a.749.749 0 0 1 1.275.326.749.749 0 0 1-.215.734L5.81 11.5h14.44a.75.75 0 0 1 0 1.5H5.81l4.97 4.97a.75.75 0 0 1 0 1.06Z"})}}}),p0=ha("BookmarkFillIcon","octicon octicon-bookmark-fill",function(){return{24:{width:24,path:_e.createElement("path",{d:"M6.69 2h10.56c.966 0 1.75.784 1.75 1.75v17.5a.75.75 0 0 1-1.218.585L12 17.21l-5.781 4.626A.75.75 0 0 1 5 21.253L4.94 3.756A1.748 1.748 0 0 1 6.69 2Z"})}}}),Oc=ha("CheckCircleFillIcon","octicon octicon-check-circle-fill",function(){return{12:{width:12,path:_e.createElement("path",{d:"M6 0a6 6 0 1 1 0 12A6 6 0 0 1 6 0Zm-.705 8.737L9.63 4.403 8.392 3.166 5.295 6.263l-1.7-1.702L2.356 5.8l2.938 2.938Z"})},16:{width:16,path:_e.createElement("path",{d:"M8 16A8 8 0 1 1 8 0a8 8 0 0 1 0 16Zm3.78-9.72a.751.751 0 0 0-.018-1.042.751.751 0 0 0-1.042-.018L6.75 9.19 5.28 7.72a.751.751 0 0 0-1.042.018.751.751 0 0 0-.018 1.042l2 2a.75.75 0 0 0 1.06 0Z"})},24:{width:24,path:_e.createElement("path",{d:"M1 12C1 5.925 5.925 1 12 1s11 4.925 11 11-4.925 11-11 11S1 18.075 1 12Zm16.28-2.72a.751.751 0 0 0-.018-1.042.751.751 0 0 0-1.042-.018l-5.97 5.97-2.47-2.47a.751.751 0 0 0-1.042.018.751.751 0 0 0-.018 1.042l3 3a.75.75 0 0 0 1.06 0Z"})}}}),TT=ha("ChevronDownIcon","octicon octicon-chevron-down",function(){return{12:{width:12,path:_e.createElement("path",{d:"M6 8.825c-.2 0-.4-.1-.5-.2l-3.3-3.3c-.3-.3-.3-.8 0-1.1.3-.3.8-.3 1.1 0l2.7 2.7 2.7-2.7c.3-.3.8-.3 1.1 0 .3.3.3.8 0 1.1l-3.2 3.2c-.2.2-.4.3-.6.3Z"})},16:{width:16,path:_e.createElement("path",{d:"M12.78 5.22a.749.749 0 0 1 0 1.06l-4.25 4.25a.749.749 0 0 1-1.06 0L3.22 6.28a.749.749 0 1 1 1.06-1.06L8 8.939l3.72-3.719a.749.749 0 0 1 1.06 0Z"})},24:{width:24,path:_e.createElement("path",{d:"M5.22 8.22a.749.749 0 0 0 0 1.06l6.25 6.25a.749.749 0 0 0 1.06 0l6.25-6.25a.749.749 0 1 0-1.06-1.06L12 13.939 6.28 8.22a.749.749 0 0 0-1.06 0Z"})}}}),ET=ha("ChevronRightIcon","octicon octicon-chevron-right",function(){return{12:{width:12,path:_e.createElement("path",{d:"M4.7 10c-.2 0-.4-.1-.5-.2-.3-.3-.3-.8 0-1.1L6.9 6 4.2 3.3c-.3-.3-.3-.8 0-1.1.3-.3.8-.3 1.1 0l3.3 3.2c.3.3.3.8 0 1.1L5.3 9.7c-.2.2-.4.3-.6.3Z"})},16:{width:16,path:_e.createElement("path",{d:"M6.22 3.22a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L9.94 8 6.22 4.28a.75.75 0 0 1 0-1.06Z"})},24:{width:24,path:_e.createElement("path",{d:"M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"})}}}),xD=ha("GearIcon","octicon octicon-gear",function(){return{16:{width:16,path:_e.createElement("path",{d:"M8 0a8.2 8.2 0 0 1 .701.031C9.444.095 9.99.645 10.16 1.29l.288 1.107c.018.066.079.158.212.224.231.114.454.243.668.386.123.082.233.09.299.071l1.103-.303c.644-.176 1.392.021 1.82.63.27.385.506.792.704 1.218.315.675.111 1.422-.364 1.891l-.814.806c-.049.048-.098.147-.088.294.016.257.016.515 0 .772-.01.147.038.246.088.294l.814.806c.475.469.679 1.216.364 1.891a7.977 7.977 0 0 1-.704 1.217c-.428.61-1.176.807-1.82.63l-1.102-.302c-.067-.019-.177-.011-.3.071a5.909 5.909 0 0 1-.668.386c-.133.066-.194.158-.211.224l-.29 1.106c-.168.646-.715 1.196-1.458 1.26a8.006 8.006 0 0 1-1.402 0c-.743-.064-1.289-.614-1.458-1.26l-.289-1.106c-.018-.066-.079-.158-.212-.224a5.738 5.738 0 0 1-.668-.386c-.123-.082-.233-.09-.299-.071l-1.103.303c-.644.176-1.392-.021-1.82-.63a8.12 8.12 0 0 1-.704-1.218c-.315-.675-.111-1.422.363-1.891l.815-.806c.05-.048.098-.147.088-.294a6.214 6.214 0 0 1 0-.772c.01-.147-.038-.246-.088-.294l-.815-.806C.635 6.045.431 5.298.746 4.623a7.92 7.92 0 0 1 .704-1.217c.428-.61 1.176-.807 1.82-.63l1.102.302c.067.019.177.011.3-.071.214-.143.437-.272.668-.386.133-.066.194-.158.211-.224l.29-1.106C6.009.645 6.556.095 7.299.03 7.53.01 7.764 0 8 0Zm-.571 1.525c-.036.003-.108.036-.137.146l-.289 1.105c-.147.561-.549.967-.998 1.189-.173.086-.34.183-.5.29-.417.278-.97.423-1.529.27l-1.103-.303c-.109-.03-.175.016-.195.045-.22.312-.412.644-.573.99-.014.031-.021.11.059.19l.815.806c.411.406.562.957.53 1.456a4.709 4.709 0 0 0 0 .582c.032.499-.119 1.05-.53 1.456l-.815.806c-.081.08-.073.159-.059.19.162.346.353.677.573.989.02.03.085.076.195.046l1.102-.303c.56-.153 1.113-.008 1.53.27.161.107.328.204.501.29.447.222.85.629.997 1.189l.289 1.105c.029.109.101.143.137.146a6.6 6.6 0 0 0 1.142 0c.036-.003.108-.036.137-.146l.289-1.105c.147-.561.549-.967.998-1.189.173-.086.34-.183.5-.29.417-.278.97-.423 1.529-.27l1.103.303c.109.029.175-.016.195-.045.22-.313.411-.644.573-.99.014-.031.021-.11-.059-.19l-.815-.806c-.411-.406-.562-.957-.53-1.456a4.709 4.709 0 0 0 0-.582c-.032-.499.119-1.05.53-1.456l.815-.806c.081-.08.073-.159.059-.19a6.464 6.464 0 0 0-.573-.989c-.02-.03-.085-.076-.195-.046l-1.102.303c-.56.153-1.113.008-1.53-.27a4.44 4.44 0 0 0-.501-.29c-.447-.222-.85-.629-.997-1.189l-.289-1.105c-.029-.11-.101-.143-.137-.146a6.6 6.6 0 0 0-1.142 0ZM11 8a3 3 0 1 1-6 0 3 3 0 0 1 6 0ZM9.5 8a1.5 1.5 0 1 0-3.001.001A1.5 1.5 0 0 0 9.5 8Z"})},24:{width:24,path:_e.createElement(_e.Fragment,null,_e.createElement("path",{d:"M16 12a4 4 0 1 1-8 0 4 4 0 0 1 8 0Zm-1.5 0a2.5 2.5 0 1 0-5 0 2.5 2.5 0 0 0 5 0Z"}),_e.createElement("path",{d:"M12 1c.266 0 .532.009.797.028.763.055 1.345.617 1.512 1.304l.352 1.45c.019.078.09.171.225.221.247.089.49.19.728.302.13.061.246.044.315.002l1.275-.776c.603-.368 1.411-.353 1.99.147.402.349.78.726 1.128 1.129.501.578.515 1.386.147 1.99l-.776 1.274c-.042.069-.058.185.002.315.112.238.213.481.303.728.048.135.142.205.22.225l1.45.352c.687.167 1.249.749 1.303 1.512.038.531.038 1.063 0 1.594-.054.763-.616 1.345-1.303 1.512l-1.45.352c-.078.019-.171.09-.221.225-.089.248-.19.491-.302.728-.061.13-.044.246-.002.315l.776 1.275c.368.603.353 1.411-.147 1.99-.349.402-.726.78-1.129 1.128-.578.501-1.386.515-1.99.147l-1.274-.776c-.069-.042-.185-.058-.314.002a8.606 8.606 0 0 1-.729.303c-.135.048-.205.142-.225.22l-.352 1.45c-.167.687-.749 1.249-1.512 1.303-.531.038-1.063.038-1.594 0-.763-.054-1.345-.616-1.512-1.303l-.352-1.45c-.019-.078-.09-.171-.225-.221a8.138 8.138 0 0 1-.728-.302c-.13-.061-.246-.044-.315-.002l-1.275.776c-.603.368-1.411.353-1.99-.147-.402-.349-.78-.726-1.128-1.129-.501-.578-.515-1.386-.147-1.99l.776-1.274c.042-.069.058-.185-.002-.314a8.606 8.606 0 0 1-.303-.729c-.048-.135-.142-.205-.22-.225l-1.45-.352c-.687-.167-1.249-.749-1.304-1.512a11.158 11.158 0 0 1 0-1.594c.055-.763.617-1.345 1.304-1.512l1.45-.352c.078-.019.171-.09.221-.225.089-.248.19-.491.302-.728.061-.13.044-.246.002-.315l-.776-1.275c-.368-.603-.353-1.411.147-1.99.349-.402.726-.78 1.129-1.128.578-.501 1.386-.515 1.99-.147l1.274.776c.069.042.185.058.315-.002.238-.112.481-.213.728-.303.135-.048.205-.142.225-.22l.352-1.45c.167-.687.749-1.249 1.512-1.304C11.466 1.01 11.732 1 12 1Zm-.69 1.525c-.055.004-.135.05-.161.161l-.353 1.45a1.832 1.832 0 0 1-1.172 1.277 7.147 7.147 0 0 0-.6.249 1.833 1.833 0 0 1-1.734-.074l-1.274-.776c-.098-.06-.186-.036-.228 0a9.774 9.774 0 0 0-.976.976c-.036.042-.06.131 0 .228l.776 1.274c.314.529.342 1.18.074 1.734a7.147 7.147 0 0 0-.249.6 1.831 1.831 0 0 1-1.278 1.173l-1.45.351c-.11.027-.156.107-.16.162a9.63 9.63 0 0 0 0 1.38c.004.055.05.135.161.161l1.45.353a1.832 1.832 0 0 1 1.277 1.172c.074.204.157.404.249.6.268.553.24 1.204-.074 1.733l-.776 1.275c-.06.098-.036.186 0 .228.301.348.628.675.976.976.042.036.131.06.228 0l1.274-.776a1.83 1.83 0 0 1 1.734-.075c.196.093.396.176.6.25a1.831 1.831 0 0 1 1.173 1.278l.351 1.45c.027.11.107.156.162.16a9.63 9.63 0 0 0 1.38 0c.055-.004.135-.05.161-.161l.353-1.45a1.834 1.834 0 0 1 1.172-1.278 6.82 6.82 0 0 0 .6-.248 1.831 1.831 0 0 1 1.733.074l1.275.776c.098.06.186.036.228 0 .348-.301.675-.628.976-.976.036-.042.06-.131 0-.228l-.776-1.275a1.834 1.834 0 0 1-.075-1.733c.093-.196.176-.396.25-.6a1.831 1.831 0 0 1 1.278-1.173l1.45-.351c.11-.027.156-.107.16-.162a9.63 9.63 0 0 0 0-1.38c-.004-.055-.05-.135-.161-.161l-1.45-.353c-.626-.152-1.08-.625-1.278-1.172a6.576 6.576 0 0 0-.248-.6 1.833 1.833 0 0 1 .074-1.734l.776-1.274c.06-.098.036-.186 0-.228a9.774 9.774 0 0 0-.976-.976c-.042-.036-.131-.06-.228 0l-1.275.776a1.831 1.831 0 0 1-1.733.074 6.88 6.88 0 0 0-.6-.249 1.835 1.835 0 0 1-1.173-1.278l-.351-1.45c-.027-.11-.107-.156-.162-.16a9.63 9.63 0 0 0-1.38 0Z"}))}}}),y0=ha("HeartIcon","octicon octicon-heart",function(){return{16:{width:16,path:_e.createElement("path",{d:"m8 14.25.345.666a.75.75 0 0 1-.69 0l-.008-.004-.018-.01a7.152 7.152 0 0 1-.31-.17 22.055 22.055 0 0 1-3.434-2.414C2.045 10.731 0 8.35 0 5.5 0 2.836 2.086 1 4.25 1 5.797 1 7.153 1.802 8 3.02 8.847 1.802 10.203 1 11.75 1 13.914 1 16 2.836 16 5.5c0 2.85-2.045 5.231-3.885 6.818a22.066 22.066 0 0 1-3.744 2.584l-.018.01-.006.003h-.002ZM4.25 2.5c-1.336 0-2.75 1.164-2.75 3 0 2.15 1.58 4.144 3.365 5.682A20.58 20.58 0 0 0 8 13.393a20.58 20.58 0 0 0 3.135-2.211C12.92 9.644 14.5 7.65 14.5 5.5c0-1.836-1.414-3-2.75-3-1.373 0-2.609.986-3.029 2.456a.749.749 0 0 1-1.442 0C6.859 3.486 5.623 2.5 4.25 2.5Z"})},24:{width:24,path:_e.createElement("path",{d:"m12 20.703.343.667a.748.748 0 0 1-.686 0l-.003-.002-.007-.003-.025-.013a31.138 31.138 0 0 1-5.233-3.576C3.8 15.573 1 12.332 1 8.514v-.001C1 5.053 3.829 2.5 6.736 2.5 9.03 2.5 10.881 3.726 12 5.605 13.12 3.726 14.97 2.5 17.264 2.5 20.17 2.5 23 5.052 23 8.514c0 3.818-2.801 7.06-5.389 9.262a31.148 31.148 0 0 1-5.233 3.576l-.025.013-.007.003-.002.001ZM6.736 4C4.657 4 2.5 5.88 2.5 8.514c0 3.107 2.324 5.96 4.861 8.12a29.655 29.655 0 0 0 4.566 3.175l.073.041.073-.04c.271-.153.661-.38 1.13-.674.94-.588 2.19-1.441 3.436-2.502 2.537-2.16 4.861-5.013 4.861-8.12C21.5 5.88 19.343 4 17.264 4c-2.106 0-3.801 1.389-4.553 3.643a.751.751 0 0 1-1.422 0C10.537 5.389 8.841 4 6.736 4Z"})}}}),on=ha("HeartFillIcon","octicon octicon-heart-fill",function(){return{16:{width:16,path:_e.createElement("path",{d:"M7.655 14.916v-.001h-.002l-.006-.003-.018-.01a22.066 22.066 0 0 1-3.744-2.584C2.045 10.731 0 8.35 0 5.5 0 2.836 2.086 1 4.25 1 5.797 1 7.153 1.802 8 3.02 8.847 1.802 10.203 1 11.75 1 13.914 1 16 2.836 16 5.5c0 2.85-2.044 5.231-3.886 6.818a22.094 22.094 0 0 1-3.433 2.414 7.152 7.152 0 0 1-.31.17l-.018.01-.008.004a.75.75 0 0 1-.69 0Z"})},24:{width:24,path:_e.createElement("path",{d:"M14 20.408c-.492.308-.903.546-1.192.709-.153.086-.308.17-.463.252h-.002a.75.75 0 0 1-.686 0 16.709 16.709 0 0 1-.465-.252 31.147 31.147 0 0 1-4.803-3.34C3.8 15.572 1 12.331 1 8.513 1 5.052 3.829 2.5 6.736 2.5 9.03 2.5 10.881 3.726 12 5.605 13.12 3.726 14.97 2.5 17.264 2.5 20.17 2.5 23 5.052 23 8.514c0 3.818-2.801 7.06-5.389 9.262A31.146 31.146 0 0 1 14 20.408Z"})}}});const Ib=P.createContext({}),fr=()=>P.useContext(Ib);function Rb(i,e){return function(){return i.apply(e,arguments)}}const{toString:TD}=Object.prototype,{getPrototypeOf:v0}=Object,{iterator:Bh,toStringTag:Lb}=Symbol,jh=(i=>e=>{const t=TD.call(e);return i[t]||(i[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),dn=i=>(i=i.toLowerCase(),e=>jh(e)===i),Vh=i=>e=>typeof e===i,{isArray:Ll}=Array,Kc=Vh("undefined");function ED(i){return i!==null&&!Kc(i)&&i.constructor!==null&&!Kc(i.constructor)&&fi(i.constructor.isBuffer)&&i.constructor.isBuffer(i)}const wb=dn("ArrayBuffer");function bD(i){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(i):e=i&&i.buffer&&wb(i.buffer),e}const AD=Vh("string"),fi=Vh("function"),Cb=Vh("number"),$h=i=>i!==null&&typeof i=="object",ID=i=>i===!0||i===!1,eh=i=>{if(jh(i)!=="object")return!1;const e=v0(i);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Lb in i)&&!(Bh in i)},RD=dn("Date"),LD=dn("File"),wD=dn("Blob"),CD=dn("FileList"),OD=i=>$h(i)&&fi(i.pipe),DD=i=>{let e;return i&&(typeof FormData=="function"&&i instanceof FormData||fi(i.append)&&((e=jh(i))==="formdata"||e==="object"&&fi(i.toString)&&i.toString()==="[object FormData]"))},_D=dn("URLSearchParams"),[PD,kD,ND,MD]=["ReadableStream","Request","Response","Headers"].map(dn),UD=i=>i.trim?i.trim():i.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function fu(i,e,{allOwnKeys:t=!1}={}){if(i===null||typeof i>"u")return;let s,n;if(typeof i!="object"&&(i=[i]),Ll(i))for(s=0,n=i.length;s<n;s++)e.call(null,i[s],s,i);else{const r=t?Object.getOwnPropertyNames(i):Object.keys(i),o=r.length;let c;for(s=0;s<o;s++)c=r[s],e.call(null,i[c],c,i)}}function Ob(i,e){e=e.toLowerCase();const t=Object.keys(i);let s=t.length,n;for(;s-- >0;)if(n=t[s],e===n.toLowerCase())return n;return null}const ja=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Db=i=>!Kc(i)&&i!==ja;function bp(){const{caseless:i}=Db(this)&&this||{},e={},t=(s,n)=>{const r=i&&Ob(e,n)||n;eh(e[r])&&eh(s)?e[r]=bp(e[r],s):eh(s)?e[r]=bp({},s):Ll(s)?e[r]=s.slice():e[r]=s};for(let s=0,n=arguments.length;s<n;s++)arguments[s]&&fu(arguments[s],t);return e}const FD=(i,e,t,{allOwnKeys:s}={})=>(fu(e,(n,r)=>{t&&fi(n)?i[r]=Rb(n,t):i[r]=n},{allOwnKeys:s}),i),BD=i=>(i.charCodeAt(0)===65279&&(i=i.slice(1)),i),jD=(i,e,t,s)=>{i.prototype=Object.create(e.prototype,s),i.prototype.constructor=i,Object.defineProperty(i,"super",{value:e.prototype}),t&&Object.assign(i.prototype,t)},VD=(i,e,t,s)=>{let n,r,o;const c={};if(e=e||{},i==null)return e;do{for(n=Object.getOwnPropertyNames(i),r=n.length;r-- >0;)o=n[r],(!s||s(o,i,e))&&!c[o]&&(e[o]=i[o],c[o]=!0);i=t!==!1&&v0(i)}while(i&&(!t||t(i,e))&&i!==Object.prototype);return e},$D=(i,e,t)=>{i=String(i),(t===void 0||t>i.length)&&(t=i.length),t-=e.length;const s=i.indexOf(e,t);return s!==-1&&s===t},GD=i=>{if(!i)return null;if(Ll(i))return i;let e=i.length;if(!Cb(e))return null;const t=new Array(e);for(;e-- >0;)t[e]=i[e];return t},HD=(i=>e=>i&&e instanceof i)(typeof Uint8Array<"u"&&v0(Uint8Array)),zD=(i,e)=>{const s=(i&&i[Bh]).call(i);let n;for(;(n=s.next())&&!n.done;){const r=n.value;e.call(i,r[0],r[1])}},KD=(i,e)=>{let t;const s=[];for(;(t=i.exec(e))!==null;)s.push(t);return s},YD=dn("HTMLFormElement"),qD=i=>i.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,s,n){return s.toUpperCase()+n}),bT=(({hasOwnProperty:i})=>(e,t)=>i.call(e,t))(Object.prototype),QD=dn("RegExp"),_b=(i,e)=>{const t=Object.getOwnPropertyDescriptors(i),s={};fu(t,(n,r)=>{let o;(o=e(n,r,i))!==!1&&(s[r]=o||n)}),Object.defineProperties(i,s)},XD=i=>{_b(i,(e,t)=>{if(fi(i)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const s=i[t];if(fi(s)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},WD=(i,e)=>{const t={},s=n=>{n.forEach(r=>{t[r]=!0})};return Ll(i)?s(i):s(String(i).split(e)),t},ZD=()=>{},JD=(i,e)=>i!=null&&Number.isFinite(i=+i)?i:e;function e_(i){return!!(i&&fi(i.append)&&i[Lb]==="FormData"&&i[Bh])}const t_=i=>{const e=new Array(10),t=(s,n)=>{if($h(s)){if(e.indexOf(s)>=0)return;if(!("toJSON"in s)){e[n]=s;const r=Ll(s)?[]:{};return fu(s,(o,c)=>{const d=t(o,n+1);!Kc(d)&&(r[c]=d)}),e[n]=void 0,r}}return s};return t(i,0)},s_=dn("AsyncFunction"),i_=i=>i&&($h(i)||fi(i))&&fi(i.then)&&fi(i.catch),Pb=((i,e)=>i?setImmediate:e?((t,s)=>(ja.addEventListener("message",({source:n,data:r})=>{n===ja&&r===t&&s.length&&s.shift()()},!1),n=>{s.push(n),ja.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",fi(ja.postMessage)),n_=typeof queueMicrotask<"u"?queueMicrotask.bind(ja):typeof process<"u"&&process.nextTick||Pb,r_=i=>i!=null&&fi(i[Bh]),he={isArray:Ll,isArrayBuffer:wb,isBuffer:ED,isFormData:DD,isArrayBufferView:bD,isString:AD,isNumber:Cb,isBoolean:ID,isObject:$h,isPlainObject:eh,isReadableStream:PD,isRequest:kD,isResponse:ND,isHeaders:MD,isUndefined:Kc,isDate:RD,isFile:LD,isBlob:wD,isRegExp:QD,isFunction:fi,isStream:OD,isURLSearchParams:_D,isTypedArray:HD,isFileList:CD,forEach:fu,merge:bp,extend:FD,trim:UD,stripBOM:BD,inherits:jD,toFlatObject:VD,kindOf:jh,kindOfTest:dn,endsWith:$D,toArray:GD,forEachEntry:zD,matchAll:KD,isHTMLForm:YD,hasOwnProperty:bT,hasOwnProp:bT,reduceDescriptors:_b,freezeMethods:XD,toObjectSet:WD,toCamelCase:qD,noop:ZD,toFiniteNumber:JD,findKey:Ob,global:ja,isContextDefined:Db,isSpecCompliantForm:e_,toJSONObject:t_,isAsyncFn:s_,isThenable:i_,setImmediate:Pb,asap:n_,isIterable:r_};function ut(i,e,t,s,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=i,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),s&&(this.request=s),n&&(this.response=n,this.status=n.status?n.status:null)}he.inherits(ut,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:he.toJSONObject(this.config),code:this.code,status:this.status}}});const kb=ut.prototype,Nb={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(i=>{Nb[i]={value:i}});Object.defineProperties(ut,Nb);Object.defineProperty(kb,"isAxiosError",{value:!0});ut.from=(i,e,t,s,n,r)=>{const o=Object.create(kb);return he.toFlatObject(i,o,function(d){return d!==Error.prototype},c=>c!=="isAxiosError"),ut.call(o,i.message,e,t,s,n),o.cause=i,o.name=i.name,r&&Object.assign(o,r),o};const a_=null;function Ap(i){return he.isPlainObject(i)||he.isArray(i)}function Mb(i){return he.endsWith(i,"[]")?i.slice(0,-2):i}function AT(i,e,t){return i?i.concat(e).map(function(n,r){return n=Mb(n),!t&&r?"["+n+"]":n}).join(t?".":""):e}function o_(i){return he.isArray(i)&&!i.some(Ap)}const l_=he.toFlatObject(he,{},null,function(e){return/^is[A-Z]/.test(e)});function Gh(i,e,t){if(!he.isObject(i))throw new TypeError("target must be an object");e=e||new FormData,t=he.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(y,E){return!he.isUndefined(E[y])});const s=t.metaTokens,n=t.visitor||f,r=t.dots,o=t.indexes,d=(t.Blob||typeof Blob<"u"&&Blob)&&he.isSpecCompliantForm(e);if(!he.isFunction(n))throw new TypeError("visitor must be a function");function u(S){if(S===null)return"";if(he.isDate(S))return S.toISOString();if(!d&&he.isBlob(S))throw new ut("Blob is not supported. Use a Buffer instead.");return he.isArrayBuffer(S)||he.isTypedArray(S)?d&&typeof Blob=="function"?new Blob([S]):Buffer.from(S):S}function f(S,y,E){let A=S;if(S&&!E&&typeof S=="object"){if(he.endsWith(y,"{}"))y=s?y:y.slice(0,-2),S=JSON.stringify(S);else if(he.isArray(S)&&o_(S)||(he.isFileList(S)||he.endsWith(y,"[]"))&&(A=he.toArray(S)))return y=Mb(y),A.forEach(function(I,C){!(he.isUndefined(I)||I===null)&&e.append(o===!0?AT([y],C,r):o===null?y:y+"[]",u(I))}),!1}return Ap(S)?!0:(e.append(AT(E,y,r),u(S)),!1)}const m=[],p=Object.assign(l_,{defaultVisitor:f,convertValue:u,isVisitable:Ap});function v(S,y){if(!he.isUndefined(S)){if(m.indexOf(S)!==-1)throw Error("Circular reference detected in "+y.join("."));m.push(S),he.forEach(S,function(A,R){(!(he.isUndefined(A)||A===null)&&n.call(e,A,he.isString(R)?R.trim():R,y,p))===!0&&v(A,y?y.concat(R):[R])}),m.pop()}}if(!he.isObject(i))throw new TypeError("data must be an object");return v(i),e}function IT(i){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(i).replace(/[!'()~]|%20|%00/g,function(s){return e[s]})}function S0(i,e){this._pairs=[],i&&Gh(i,this,e)}const Ub=S0.prototype;Ub.append=function(e,t){this._pairs.push([e,t])};Ub.toString=function(e){const t=e?function(s){return e.call(this,s,IT)}:IT;return this._pairs.map(function(n){return t(n[0])+"="+t(n[1])},"").join("&")};function c_(i){return encodeURIComponent(i).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Fb(i,e,t){if(!e)return i;const s=t&&t.encode||c_;he.isFunction(t)&&(t={serialize:t});const n=t&&t.serialize;let r;if(n?r=n(e,t):r=he.isURLSearchParams(e)?e.toString():new S0(e,t).toString(s),r){const o=i.indexOf("#");o!==-1&&(i=i.slice(0,o)),i+=(i.indexOf("?")===-1?"?":"&")+r}return i}class RT{constructor(){this.handlers=[]}use(e,t,s){return this.handlers.push({fulfilled:e,rejected:t,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){he.forEach(this.handlers,function(s){s!==null&&e(s)})}}const Bb={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},u_=typeof URLSearchParams<"u"?URLSearchParams:S0,d_=typeof FormData<"u"?FormData:null,h_=typeof Blob<"u"?Blob:null,f_={isBrowser:!0,classes:{URLSearchParams:u_,FormData:d_,Blob:h_},protocols:["http","https","file","blob","url","data"]},x0=typeof window<"u"&&typeof document<"u",Ip=typeof navigator=="object"&&navigator||void 0,m_=x0&&(!Ip||["ReactNative","NativeScript","NS"].indexOf(Ip.product)<0),g_=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",p_=x0&&window.location.href||"http://localhost",y_=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:x0,hasStandardBrowserEnv:m_,hasStandardBrowserWebWorkerEnv:g_,navigator:Ip,origin:p_},Symbol.toStringTag,{value:"Module"})),Ks={...y_,...f_};function v_(i,e){return Gh(i,new Ks.classes.URLSearchParams,Object.assign({visitor:function(t,s,n,r){return Ks.isNode&&he.isBuffer(t)?(this.append(s,t.toString("base64")),!1):r.defaultVisitor.apply(this,arguments)}},e))}function S_(i){return he.matchAll(/\w+|\[(\w*)]/g,i).map(e=>e[0]==="[]"?"":e[1]||e[0])}function x_(i){const e={},t=Object.keys(i);let s;const n=t.length;let r;for(s=0;s<n;s++)r=t[s],e[r]=i[r];return e}function jb(i){function e(t,s,n,r){let o=t[r++];if(o==="__proto__")return!0;const c=Number.isFinite(+o),d=r>=t.length;return o=!o&&he.isArray(n)?n.length:o,d?(he.hasOwnProp(n,o)?n[o]=[n[o],s]:n[o]=s,!c):((!n[o]||!he.isObject(n[o]))&&(n[o]=[]),e(t,s,n[o],r)&&he.isArray(n[o])&&(n[o]=x_(n[o])),!c)}if(he.isFormData(i)&&he.isFunction(i.entries)){const t={};return he.forEachEntry(i,(s,n)=>{e(S_(s),n,t,0)}),t}return null}function T_(i,e,t){if(he.isString(i))try{return(e||JSON.parse)(i),he.trim(i)}catch(s){if(s.name!=="SyntaxError")throw s}return(t||JSON.stringify)(i)}const mu={transitional:Bb,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const s=t.getContentType()||"",n=s.indexOf("application/json")>-1,r=he.isObject(e);if(r&&he.isHTMLForm(e)&&(e=new FormData(e)),he.isFormData(e))return n?JSON.stringify(jb(e)):e;if(he.isArrayBuffer(e)||he.isBuffer(e)||he.isStream(e)||he.isFile(e)||he.isBlob(e)||he.isReadableStream(e))return e;if(he.isArrayBufferView(e))return e.buffer;if(he.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let c;if(r){if(s.indexOf("application/x-www-form-urlencoded")>-1)return v_(e,this.formSerializer).toString();if((c=he.isFileList(e))||s.indexOf("multipart/form-data")>-1){const d=this.env&&this.env.FormData;return Gh(c?{"files[]":e}:e,d&&new d,this.formSerializer)}}return r||n?(t.setContentType("application/json",!1),T_(e)):e}],transformResponse:[function(e){const t=this.transitional||mu.transitional,s=t&&t.forcedJSONParsing,n=this.responseType==="json";if(he.isResponse(e)||he.isReadableStream(e))return e;if(e&&he.isString(e)&&(s&&!this.responseType||n)){const o=!(t&&t.silentJSONParsing)&&n;try{return JSON.parse(e)}catch(c){if(o)throw c.name==="SyntaxError"?ut.from(c,ut.ERR_BAD_RESPONSE,this,null,this.response):c}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ks.classes.FormData,Blob:Ks.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};he.forEach(["delete","get","head","post","put","patch"],i=>{mu.headers[i]={}});const E_=he.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),b_=i=>{const e={};let t,s,n;return i&&i.split(`
`).forEach(function(o){n=o.indexOf(":"),t=o.substring(0,n).trim().toLowerCase(),s=o.substring(n+1).trim(),!(!t||e[t]&&E_[t])&&(t==="set-cookie"?e[t]?e[t].push(s):e[t]=[s]:e[t]=e[t]?e[t]+", "+s:s)}),e},LT=Symbol("internals");function Dc(i){return i&&String(i).trim().toLowerCase()}function th(i){return i===!1||i==null?i:he.isArray(i)?i.map(th):String(i)}function A_(i){const e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=t.exec(i);)e[s[1]]=s[2];return e}const I_=i=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(i.trim());function xg(i,e,t,s,n){if(he.isFunction(s))return s.call(this,e,t);if(n&&(e=t),!!he.isString(e)){if(he.isString(s))return e.indexOf(s)!==-1;if(he.isRegExp(s))return s.test(e)}}function R_(i){return i.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,s)=>t.toUpperCase()+s)}function L_(i,e){const t=he.toCamelCase(" "+e);["get","set","has"].forEach(s=>{Object.defineProperty(i,s+t,{value:function(n,r,o){return this[s].call(this,e,n,r,o)},configurable:!0})})}let mi=class{constructor(e){e&&this.set(e)}set(e,t,s){const n=this;function r(c,d,u){const f=Dc(d);if(!f)throw new Error("header name must be a non-empty string");const m=he.findKey(n,f);(!m||n[m]===void 0||u===!0||u===void 0&&n[m]!==!1)&&(n[m||d]=th(c))}const o=(c,d)=>he.forEach(c,(u,f)=>r(u,f,d));if(he.isPlainObject(e)||e instanceof this.constructor)o(e,t);else if(he.isString(e)&&(e=e.trim())&&!I_(e))o(b_(e),t);else if(he.isObject(e)&&he.isIterable(e)){let c={},d,u;for(const f of e){if(!he.isArray(f))throw TypeError("Object iterator must return a key-value pair");c[u=f[0]]=(d=c[u])?he.isArray(d)?[...d,f[1]]:[d,f[1]]:f[1]}o(c,t)}else e!=null&&r(t,e,s);return this}get(e,t){if(e=Dc(e),e){const s=he.findKey(this,e);if(s){const n=this[s];if(!t)return n;if(t===!0)return A_(n);if(he.isFunction(t))return t.call(this,n,s);if(he.isRegExp(t))return t.exec(n);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=Dc(e),e){const s=he.findKey(this,e);return!!(s&&this[s]!==void 0&&(!t||xg(this,this[s],s,t)))}return!1}delete(e,t){const s=this;let n=!1;function r(o){if(o=Dc(o),o){const c=he.findKey(s,o);c&&(!t||xg(s,s[c],c,t))&&(delete s[c],n=!0)}}return he.isArray(e)?e.forEach(r):r(e),n}clear(e){const t=Object.keys(this);let s=t.length,n=!1;for(;s--;){const r=t[s];(!e||xg(this,this[r],r,e,!0))&&(delete this[r],n=!0)}return n}normalize(e){const t=this,s={};return he.forEach(this,(n,r)=>{const o=he.findKey(s,r);if(o){t[o]=th(n),delete t[r];return}const c=e?R_(r):String(r).trim();c!==r&&delete t[r],t[c]=th(n),s[c]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return he.forEach(this,(s,n)=>{s!=null&&s!==!1&&(t[n]=e&&he.isArray(s)?s.join(", "):s)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const s=new this(e);return t.forEach(n=>s.set(n)),s}static accessor(e){const s=(this[LT]=this[LT]={accessors:{}}).accessors,n=this.prototype;function r(o){const c=Dc(o);s[c]||(L_(n,o),s[c]=!0)}return he.isArray(e)?e.forEach(r):r(e),this}};mi.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);he.reduceDescriptors(mi.prototype,({value:i},e)=>{let t=e[0].toUpperCase()+e.slice(1);return{get:()=>i,set(s){this[t]=s}}});he.freezeMethods(mi);function Tg(i,e){const t=this||mu,s=e||t,n=mi.from(s.headers);let r=s.data;return he.forEach(i,function(c){r=c.call(t,r,n.normalize(),e?e.status:void 0)}),n.normalize(),r}function Vb(i){return!!(i&&i.__CANCEL__)}function wl(i,e,t){ut.call(this,i??"canceled",ut.ERR_CANCELED,e,t),this.name="CanceledError"}he.inherits(wl,ut,{__CANCEL__:!0});function $b(i,e,t){const s=t.config.validateStatus;!t.status||!s||s(t.status)?i(t):e(new ut("Request failed with status code "+t.status,[ut.ERR_BAD_REQUEST,ut.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function w_(i){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(i);return e&&e[1]||""}function C_(i,e){i=i||10;const t=new Array(i),s=new Array(i);let n=0,r=0,o;return e=e!==void 0?e:1e3,function(d){const u=Date.now(),f=s[r];o||(o=u),t[n]=d,s[n]=u;let m=r,p=0;for(;m!==n;)p+=t[m++],m=m%i;if(n=(n+1)%i,n===r&&(r=(r+1)%i),u-o<e)return;const v=f&&u-f;return v?Math.round(p*1e3/v):void 0}}function O_(i,e){let t=0,s=1e3/e,n,r;const o=(u,f=Date.now())=>{t=f,n=null,r&&(clearTimeout(r),r=null),i.apply(null,u)};return[(...u)=>{const f=Date.now(),m=f-t;m>=s?o(u,f):(n=u,r||(r=setTimeout(()=>{r=null,o(n)},s-m)))},()=>n&&o(n)]}const yh=(i,e,t=3)=>{let s=0;const n=C_(50,250);return O_(r=>{const o=r.loaded,c=r.lengthComputable?r.total:void 0,d=o-s,u=n(d),f=o<=c;s=o;const m={loaded:o,total:c,progress:c?o/c:void 0,bytes:d,rate:u||void 0,estimated:u&&c&&f?(c-o)/u:void 0,event:r,lengthComputable:c!=null,[e?"download":"upload"]:!0};i(m)},t)},wT=(i,e)=>{const t=i!=null;return[s=>e[0]({lengthComputable:t,total:i,loaded:s}),e[1]]},CT=i=>(...e)=>he.asap(()=>i(...e)),D_=Ks.hasStandardBrowserEnv?((i,e)=>t=>(t=new URL(t,Ks.origin),i.protocol===t.protocol&&i.host===t.host&&(e||i.port===t.port)))(new URL(Ks.origin),Ks.navigator&&/(msie|trident)/i.test(Ks.navigator.userAgent)):()=>!0,__=Ks.hasStandardBrowserEnv?{write(i,e,t,s,n,r){const o=[i+"="+encodeURIComponent(e)];he.isNumber(t)&&o.push("expires="+new Date(t).toGMTString()),he.isString(s)&&o.push("path="+s),he.isString(n)&&o.push("domain="+n),r===!0&&o.push("secure"),document.cookie=o.join("; ")},read(i){const e=document.cookie.match(new RegExp("(^|;\\s*)("+i+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(i){this.write(i,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function P_(i){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(i)}function k_(i,e){return e?i.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):i}function Gb(i,e,t){let s=!P_(e);return i&&(s||t==!1)?k_(i,e):e}const OT=i=>i instanceof mi?{...i}:i;function to(i,e){e=e||{};const t={};function s(u,f,m,p){return he.isPlainObject(u)&&he.isPlainObject(f)?he.merge.call({caseless:p},u,f):he.isPlainObject(f)?he.merge({},f):he.isArray(f)?f.slice():f}function n(u,f,m,p){if(he.isUndefined(f)){if(!he.isUndefined(u))return s(void 0,u,m,p)}else return s(u,f,m,p)}function r(u,f){if(!he.isUndefined(f))return s(void 0,f)}function o(u,f){if(he.isUndefined(f)){if(!he.isUndefined(u))return s(void 0,u)}else return s(void 0,f)}function c(u,f,m){if(m in e)return s(u,f);if(m in i)return s(void 0,u)}const d={url:r,method:r,data:r,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:c,headers:(u,f,m)=>n(OT(u),OT(f),m,!0)};return he.forEach(Object.keys(Object.assign({},i,e)),function(f){const m=d[f]||n,p=m(i[f],e[f],f);he.isUndefined(p)&&m!==c||(t[f]=p)}),t}const Hb=i=>{const e=to({},i);let{data:t,withXSRFToken:s,xsrfHeaderName:n,xsrfCookieName:r,headers:o,auth:c}=e;e.headers=o=mi.from(o),e.url=Fb(Gb(e.baseURL,e.url,e.allowAbsoluteUrls),i.params,i.paramsSerializer),c&&o.set("Authorization","Basic "+btoa((c.username||"")+":"+(c.password?unescape(encodeURIComponent(c.password)):"")));let d;if(he.isFormData(t)){if(Ks.hasStandardBrowserEnv||Ks.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((d=o.getContentType())!==!1){const[u,...f]=d?d.split(";").map(m=>m.trim()).filter(Boolean):[];o.setContentType([u||"multipart/form-data",...f].join("; "))}}if(Ks.hasStandardBrowserEnv&&(s&&he.isFunction(s)&&(s=s(e)),s||s!==!1&&D_(e.url))){const u=n&&r&&__.read(r);u&&o.set(n,u)}return e},N_=typeof XMLHttpRequest<"u",M_=N_&&function(i){return new Promise(function(t,s){const n=Hb(i);let r=n.data;const o=mi.from(n.headers).normalize();let{responseType:c,onUploadProgress:d,onDownloadProgress:u}=n,f,m,p,v,S;function y(){v&&v(),S&&S(),n.cancelToken&&n.cancelToken.unsubscribe(f),n.signal&&n.signal.removeEventListener("abort",f)}let E=new XMLHttpRequest;E.open(n.method.toUpperCase(),n.url,!0),E.timeout=n.timeout;function A(){if(!E)return;const I=mi.from("getAllResponseHeaders"in E&&E.getAllResponseHeaders()),L={data:!c||c==="text"||c==="json"?E.responseText:E.response,status:E.status,statusText:E.statusText,headers:I,config:i,request:E};$b(function(_){t(_),y()},function(_){s(_),y()},L),E=null}"onloadend"in E?E.onloadend=A:E.onreadystatechange=function(){!E||E.readyState!==4||E.status===0&&!(E.responseURL&&E.responseURL.indexOf("file:")===0)||setTimeout(A)},E.onabort=function(){E&&(s(new ut("Request aborted",ut.ECONNABORTED,i,E)),E=null)},E.onerror=function(){s(new ut("Network Error",ut.ERR_NETWORK,i,E)),E=null},E.ontimeout=function(){let C=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const L=n.transitional||Bb;n.timeoutErrorMessage&&(C=n.timeoutErrorMessage),s(new ut(C,L.clarifyTimeoutError?ut.ETIMEDOUT:ut.ECONNABORTED,i,E)),E=null},r===void 0&&o.setContentType(null),"setRequestHeader"in E&&he.forEach(o.toJSON(),function(C,L){E.setRequestHeader(L,C)}),he.isUndefined(n.withCredentials)||(E.withCredentials=!!n.withCredentials),c&&c!=="json"&&(E.responseType=n.responseType),u&&([p,S]=yh(u,!0),E.addEventListener("progress",p)),d&&E.upload&&([m,v]=yh(d),E.upload.addEventListener("progress",m),E.upload.addEventListener("loadend",v)),(n.cancelToken||n.signal)&&(f=I=>{E&&(s(!I||I.type?new wl(null,i,E):I),E.abort(),E=null)},n.cancelToken&&n.cancelToken.subscribe(f),n.signal&&(n.signal.aborted?f():n.signal.addEventListener("abort",f)));const R=w_(n.url);if(R&&Ks.protocols.indexOf(R)===-1){s(new ut("Unsupported protocol "+R+":",ut.ERR_BAD_REQUEST,i));return}E.send(r||null)})},U_=(i,e)=>{const{length:t}=i=i?i.filter(Boolean):[];if(e||t){let s=new AbortController,n;const r=function(u){if(!n){n=!0,c();const f=u instanceof Error?u:this.reason;s.abort(f instanceof ut?f:new wl(f instanceof Error?f.message:f))}};let o=e&&setTimeout(()=>{o=null,r(new ut(`timeout ${e} of ms exceeded`,ut.ETIMEDOUT))},e);const c=()=>{i&&(o&&clearTimeout(o),o=null,i.forEach(u=>{u.unsubscribe?u.unsubscribe(r):u.removeEventListener("abort",r)}),i=null)};i.forEach(u=>u.addEventListener("abort",r));const{signal:d}=s;return d.unsubscribe=()=>he.asap(c),d}},F_=function*(i,e){let t=i.byteLength;if(t<e){yield i;return}let s=0,n;for(;s<t;)n=s+e,yield i.slice(s,n),s=n},B_=async function*(i,e){for await(const t of j_(i))yield*F_(t,e)},j_=async function*(i){if(i[Symbol.asyncIterator]){yield*i;return}const e=i.getReader();try{for(;;){const{done:t,value:s}=await e.read();if(t)break;yield s}}finally{await e.cancel()}},DT=(i,e,t,s)=>{const n=B_(i,e);let r=0,o,c=d=>{o||(o=!0,s&&s(d))};return new ReadableStream({async pull(d){try{const{done:u,value:f}=await n.next();if(u){c(),d.close();return}let m=f.byteLength;if(t){let p=r+=m;t(p)}d.enqueue(new Uint8Array(f))}catch(u){throw c(u),u}},cancel(d){return c(d),n.return()}},{highWaterMark:2})},Hh=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",zb=Hh&&typeof ReadableStream=="function",V_=Hh&&(typeof TextEncoder=="function"?(i=>e=>i.encode(e))(new TextEncoder):async i=>new Uint8Array(await new Response(i).arrayBuffer())),Kb=(i,...e)=>{try{return!!i(...e)}catch{return!1}},$_=zb&&Kb(()=>{let i=!1;const e=new Request(Ks.origin,{body:new ReadableStream,method:"POST",get duplex(){return i=!0,"half"}}).headers.has("Content-Type");return i&&!e}),_T=64*1024,Rp=zb&&Kb(()=>he.isReadableStream(new Response("").body)),vh={stream:Rp&&(i=>i.body)};Hh&&(i=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!vh[e]&&(vh[e]=he.isFunction(i[e])?t=>t[e]():(t,s)=>{throw new ut(`Response type '${e}' is not supported`,ut.ERR_NOT_SUPPORT,s)})})})(new Response);const G_=async i=>{if(i==null)return 0;if(he.isBlob(i))return i.size;if(he.isSpecCompliantForm(i))return(await new Request(Ks.origin,{method:"POST",body:i}).arrayBuffer()).byteLength;if(he.isArrayBufferView(i)||he.isArrayBuffer(i))return i.byteLength;if(he.isURLSearchParams(i)&&(i=i+""),he.isString(i))return(await V_(i)).byteLength},H_=async(i,e)=>{const t=he.toFiniteNumber(i.getContentLength());return t??G_(e)},z_=Hh&&(async i=>{let{url:e,method:t,data:s,signal:n,cancelToken:r,timeout:o,onDownloadProgress:c,onUploadProgress:d,responseType:u,headers:f,withCredentials:m="same-origin",fetchOptions:p}=Hb(i);u=u?(u+"").toLowerCase():"text";let v=U_([n,r&&r.toAbortSignal()],o),S;const y=v&&v.unsubscribe&&(()=>{v.unsubscribe()});let E;try{if(d&&$_&&t!=="get"&&t!=="head"&&(E=await H_(f,s))!==0){let L=new Request(e,{method:"POST",body:s,duplex:"half"}),D;if(he.isFormData(s)&&(D=L.headers.get("content-type"))&&f.setContentType(D),L.body){const[_,M]=wT(E,yh(CT(d)));s=DT(L.body,_T,_,M)}}he.isString(m)||(m=m?"include":"omit");const A="credentials"in Request.prototype;S=new Request(e,{...p,signal:v,method:t.toUpperCase(),headers:f.normalize().toJSON(),body:s,duplex:"half",credentials:A?m:void 0});let R=await fetch(S);const I=Rp&&(u==="stream"||u==="response");if(Rp&&(c||I&&y)){const L={};["status","statusText","headers"].forEach(U=>{L[U]=R[U]});const D=he.toFiniteNumber(R.headers.get("content-length")),[_,M]=c&&wT(D,yh(CT(c),!0))||[];R=new Response(DT(R.body,_T,_,()=>{M&&M(),y&&y()}),L)}u=u||"text";let C=await vh[he.findKey(vh,u)||"text"](R,i);return!I&&y&&y(),await new Promise((L,D)=>{$b(L,D,{data:C,headers:mi.from(R.headers),status:R.status,statusText:R.statusText,config:i,request:S})})}catch(A){throw y&&y(),A&&A.name==="TypeError"&&/Load failed|fetch/i.test(A.message)?Object.assign(new ut("Network Error",ut.ERR_NETWORK,i,S),{cause:A.cause||A}):ut.from(A,A&&A.code,i,S)}}),Lp={http:a_,xhr:M_,fetch:z_};he.forEach(Lp,(i,e)=>{if(i){try{Object.defineProperty(i,"name",{value:e})}catch{}Object.defineProperty(i,"adapterName",{value:e})}});const PT=i=>`- ${i}`,K_=i=>he.isFunction(i)||i===null||i===!1,Yb={getAdapter:i=>{i=he.isArray(i)?i:[i];const{length:e}=i;let t,s;const n={};for(let r=0;r<e;r++){t=i[r];let o;if(s=t,!K_(t)&&(s=Lp[(o=String(t)).toLowerCase()],s===void 0))throw new ut(`Unknown adapter '${o}'`);if(s)break;n[o||"#"+r]=s}if(!s){const r=Object.entries(n).map(([c,d])=>`adapter ${c} `+(d===!1?"is not supported by the environment":"is not available in the build"));let o=e?r.length>1?`since :
`+r.map(PT).join(`
`):" "+PT(r[0]):"as no adapter specified";throw new ut("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return s},adapters:Lp};function Eg(i){if(i.cancelToken&&i.cancelToken.throwIfRequested(),i.signal&&i.signal.aborted)throw new wl(null,i)}function kT(i){return Eg(i),i.headers=mi.from(i.headers),i.data=Tg.call(i,i.transformRequest),["post","put","patch"].indexOf(i.method)!==-1&&i.headers.setContentType("application/x-www-form-urlencoded",!1),Yb.getAdapter(i.adapter||mu.adapter)(i).then(function(s){return Eg(i),s.data=Tg.call(i,i.transformResponse,s),s.headers=mi.from(s.headers),s},function(s){return Vb(s)||(Eg(i),s&&s.response&&(s.response.data=Tg.call(i,i.transformResponse,s.response),s.response.headers=mi.from(s.response.headers))),Promise.reject(s)})}const qb="1.9.0",zh={};["object","boolean","number","function","string","symbol"].forEach((i,e)=>{zh[i]=function(s){return typeof s===i||"a"+(e<1?"n ":" ")+i}});const NT={};zh.transitional=function(e,t,s){function n(r,o){return"[Axios v"+qb+"] Transitional option '"+r+"'"+o+(s?". "+s:"")}return(r,o,c)=>{if(e===!1)throw new ut(n(o," has been removed"+(t?" in "+t:"")),ut.ERR_DEPRECATED);return t&&!NT[o]&&(NT[o]=!0,console.warn(n(o," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(r,o,c):!0}};zh.spelling=function(e){return(t,s)=>(console.warn(`${s} is likely a misspelling of ${e}`),!0)};function Y_(i,e,t){if(typeof i!="object")throw new ut("options must be an object",ut.ERR_BAD_OPTION_VALUE);const s=Object.keys(i);let n=s.length;for(;n-- >0;){const r=s[n],o=e[r];if(o){const c=i[r],d=c===void 0||o(c,r,i);if(d!==!0)throw new ut("option "+r+" must be "+d,ut.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new ut("Unknown option "+r,ut.ERR_BAD_OPTION)}}const sh={assertOptions:Y_,validators:zh},Sn=sh.validators;let Za=class{constructor(e){this.defaults=e||{},this.interceptors={request:new RT,response:new RT}}async request(e,t){try{return await this._request(e,t)}catch(s){if(s instanceof Error){let n={};Error.captureStackTrace?Error.captureStackTrace(n):n=new Error;const r=n.stack?n.stack.replace(/^.+\n/,""):"";try{s.stack?r&&!String(s.stack).endsWith(r.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+r):s.stack=r}catch{}}throw s}}_request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=to(this.defaults,t);const{transitional:s,paramsSerializer:n,headers:r}=t;s!==void 0&&sh.assertOptions(s,{silentJSONParsing:Sn.transitional(Sn.boolean),forcedJSONParsing:Sn.transitional(Sn.boolean),clarifyTimeoutError:Sn.transitional(Sn.boolean)},!1),n!=null&&(he.isFunction(n)?t.paramsSerializer={serialize:n}:sh.assertOptions(n,{encode:Sn.function,serialize:Sn.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),sh.assertOptions(t,{baseUrl:Sn.spelling("baseURL"),withXsrfToken:Sn.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let o=r&&he.merge(r.common,r[t.method]);r&&he.forEach(["delete","get","head","post","put","patch","common"],S=>{delete r[S]}),t.headers=mi.concat(o,r);const c=[];let d=!0;this.interceptors.request.forEach(function(y){typeof y.runWhen=="function"&&y.runWhen(t)===!1||(d=d&&y.synchronous,c.unshift(y.fulfilled,y.rejected))});const u=[];this.interceptors.response.forEach(function(y){u.push(y.fulfilled,y.rejected)});let f,m=0,p;if(!d){const S=[kT.bind(this),void 0];for(S.unshift.apply(S,c),S.push.apply(S,u),p=S.length,f=Promise.resolve(t);m<p;)f=f.then(S[m++],S[m++]);return f}p=c.length;let v=t;for(m=0;m<p;){const S=c[m++],y=c[m++];try{v=S(v)}catch(E){y.call(this,E);break}}try{f=kT.call(this,v)}catch(S){return Promise.reject(S)}for(m=0,p=u.length;m<p;)f=f.then(u[m++],u[m++]);return f}getUri(e){e=to(this.defaults,e);const t=Gb(e.baseURL,e.url,e.allowAbsoluteUrls);return Fb(t,e.params,e.paramsSerializer)}};he.forEach(["delete","get","head","options"],function(e){Za.prototype[e]=function(t,s){return this.request(to(s||{},{method:e,url:t,data:(s||{}).data}))}});he.forEach(["post","put","patch"],function(e){function t(s){return function(r,o,c){return this.request(to(c||{},{method:e,headers:s?{"Content-Type":"multipart/form-data"}:{},url:r,data:o}))}}Za.prototype[e]=t(),Za.prototype[e+"Form"]=t(!0)});let q_=class Qb{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(r){t=r});const s=this;this.promise.then(n=>{if(!s._listeners)return;let r=s._listeners.length;for(;r-- >0;)s._listeners[r](n);s._listeners=null}),this.promise.then=n=>{let r;const o=new Promise(c=>{s.subscribe(c),r=c}).then(n);return o.cancel=function(){s.unsubscribe(r)},o},e(function(r,o,c){s.reason||(s.reason=new wl(r,o,c),t(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=s=>{e.abort(s)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new Qb(function(n){e=n}),cancel:e}}};function Q_(i){return function(t){return i.apply(null,t)}}function X_(i){return he.isObject(i)&&i.isAxiosError===!0}const wp={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(wp).forEach(([i,e])=>{wp[e]=i});function Xb(i){const e=new Za(i),t=Rb(Za.prototype.request,e);return he.extend(t,Za.prototype,e,{allOwnKeys:!0}),he.extend(t,e,null,{allOwnKeys:!0}),t.create=function(n){return Xb(to(i,n))},t}const Se=Xb(mu);Se.Axios=Za;Se.CanceledError=wl;Se.CancelToken=q_;Se.isCancel=Vb;Se.VERSION=qb;Se.toFormData=Gh;Se.AxiosError=ut;Se.Cancel=Se.CanceledError;Se.all=function(e){return Promise.all(e)};Se.spread=Q_;Se.isAxiosError=X_;Se.mergeConfig=to;Se.AxiosHeaders=mi;Se.formToJSON=i=>jb(he.isHTMLForm(i)?new FormData(i):i);Se.getAdapter=Yb.getAdapter;Se.HttpStatusCode=wp;Se.default=Se;const{Axios:O6,AxiosError:D6,CanceledError:_6,isCancel:P6,CancelToken:k6,VERSION:N6,all:M6,Cancel:U6,isAxiosError:F6,spread:B6,toFormData:j6,AxiosHeaders:V6,HttpStatusCode:$6,formToJSON:G6,getAdapter:H6,mergeConfig:z6}=Se,Ae="http://localhost".replace(/\/+$/,"");class Nn{constructor(e,t=Ae,s=Se){var n;this.basePath=t,this.axios=s,e&&(this.configuration=e,this.basePath=(n=e.basePath)!==null&&n!==void 0?n:t)}}class W_ extends Error{constructor(e,t){super(t),this.field=e,this.name="RequiredError"}}const Re={},Le="https://example.com",Pe=function(i,e,t){if(t==null)throw new W_(e,`Required parameter ${e} was null or undefined when calling ${i}.`)},ke=async function(i,e,t){if(t&&t.apiKey){const s=typeof t.apiKey=="function"?await t.apiKey(e):await t.apiKey;i[e]=s}};function Cp(i,e,t=""){e!=null&&(typeof e=="object"?Array.isArray(e)?e.forEach(s=>Cp(i,s,t)):Object.keys(e).forEach(s=>Cp(i,e[s],`${t}${t!==""?".":""}${s}`)):i.has(t)?i.append(t,e):i.set(t,e))}const we=function(i,...e){const t=new URLSearchParams(i.search);Cp(t,e),i.search=t.toString()},xs=function(i,e,t){const s=typeof i!="string";return(s&&t&&t.isJsonMime?t.isJsonMime(e.headers["Content-Type"]):s)?JSON.stringify(i!==void 0?i:{}):i||""},Ce=function(i){return i.pathname+i.search+i.hash},Oe=function(i,e,t,s){return(n=e,r=t)=>{var o;const c={...i.options,url:(n.defaults.baseURL?"":(o=s==null?void 0:s.basePath)!==null&&o!==void 0?o:r)+i.url};return n.request(c)}},Z_=function(i){return{getAlbumArtists:async(e,t,s,n,r,o,c,d,u,f,m,p,v,S,y,E,A,R,I,C,L,D,_,M,U,F,z,V,ae,G,Z,B,Q={})=>{const re="/Artists/AlbumArtists",J=new URL(re,Le);let N;i&&(N=i.baseOptions);const K={method:"GET",...N,...Q},le={},H={};await ke(le,"Authorization",i),e!==void 0&&(H.minCommunityRating=e),t!==void 0&&(H.startIndex=t),s!==void 0&&(H.limit=s),n!==void 0&&(H.searchTerm=n),r!==void 0&&(H.parentId=r),o&&(H.fields=o),c&&(H.excludeItemTypes=c),d&&(H.includeItemTypes=d),u&&(H.filters=u),f!==void 0&&(H.isFavorite=f),m&&(H.mediaTypes=m),p&&(H.genres=p),v&&(H.genreIds=v),S&&(H.officialRatings=S),y&&(H.tags=y),E&&(H.years=E),A!==void 0&&(H.enableUserData=A),R!==void 0&&(H.imageTypeLimit=R),I&&(H.enableImageTypes=I),C!==void 0&&(H.person=C),L&&(H.personIds=L),D&&(H.personTypes=D),_&&(H.studios=_),M&&(H.studioIds=M),U!==void 0&&(H.userId=U),F!==void 0&&(H.nameStartsWithOrGreater=F),z!==void 0&&(H.nameStartsWith=z),V!==void 0&&(H.nameLessThan=V),ae&&(H.sortBy=ae),G&&(H.sortOrder=G),Z!==void 0&&(H.enableImages=Z),B!==void 0&&(H.enableTotalRecordCount=B),we(J,H);let ue=N&&N.headers?N.headers:{};return K.headers={...le,...ue,...Q.headers},{url:Ce(J),options:K}},getArtistByName:async(e,t,s={})=>{Pe("getArtistByName","name",e);const n="/Artists/{name}".replace("{name}",encodeURIComponent(String(e))),r=new URL(n,Le);let o;i&&(o=i.baseOptions);const c={method:"GET",...o,...s},d={},u={};await ke(d,"Authorization",i),t!==void 0&&(u.userId=t),we(r,u);let f=o&&o.headers?o.headers:{};return c.headers={...d,...f,...s.headers},{url:Ce(r),options:c}},getArtists:async(e,t,s,n,r,o,c,d,u,f,m,p,v,S,y,E,A,R,I,C,L,D,_,M,U,F,z,V,ae,G,Z,B,Q={})=>{const re="/Artists",J=new URL(re,Le);let N;i&&(N=i.baseOptions);const K={method:"GET",...N,...Q},le={},H={};await ke(le,"Authorization",i),e!==void 0&&(H.minCommunityRating=e),t!==void 0&&(H.startIndex=t),s!==void 0&&(H.limit=s),n!==void 0&&(H.searchTerm=n),r!==void 0&&(H.parentId=r),o&&(H.fields=o),c&&(H.excludeItemTypes=c),d&&(H.includeItemTypes=d),u&&(H.filters=u),f!==void 0&&(H.isFavorite=f),m&&(H.mediaTypes=m),p&&(H.genres=p),v&&(H.genreIds=v),S&&(H.officialRatings=S),y&&(H.tags=y),E&&(H.years=E),A!==void 0&&(H.enableUserData=A),R!==void 0&&(H.imageTypeLimit=R),I&&(H.enableImageTypes=I),C!==void 0&&(H.person=C),L&&(H.personIds=L),D&&(H.personTypes=D),_&&(H.studios=_),M&&(H.studioIds=M),U!==void 0&&(H.userId=U),F!==void 0&&(H.nameStartsWithOrGreater=F),z!==void 0&&(H.nameStartsWith=z),V!==void 0&&(H.nameLessThan=V),ae&&(H.sortBy=ae),G&&(H.sortOrder=G),Z!==void 0&&(H.enableImages=Z),B!==void 0&&(H.enableTotalRecordCount=B),we(J,H);let ue=N&&N.headers?N.headers:{};return K.headers={...le,...ue,...Q.headers},{url:Ce(J),options:K}}}},bg=function(i){const e=Z_(i);return{async getAlbumArtists(t,s,n,r,o,c,d,u,f,m,p,v,S,y,E,A,R,I,C,L,D,_,M,U,F,z,V,ae,G,Z,B,Q,re){var J,N,K;const le=await e.getAlbumArtists(t,s,n,r,o,c,d,u,f,m,p,v,S,y,E,A,R,I,C,L,D,_,M,U,F,z,V,ae,G,Z,B,Q,re),H=(J=i==null?void 0:i.serverIndex)!==null&&J!==void 0?J:0,ue=(K=(N=Re["ArtistsApi.getAlbumArtists"])===null||N===void 0?void 0:N[H])===null||K===void 0?void 0:K.url;return(xe,fe)=>Oe(le,Se,Ae,i)(xe,ue||fe)},async getArtistByName(t,s,n){var r,o,c;const d=await e.getArtistByName(t,s,n),u=(r=i==null?void 0:i.serverIndex)!==null&&r!==void 0?r:0,f=(c=(o=Re["ArtistsApi.getArtistByName"])===null||o===void 0?void 0:o[u])===null||c===void 0?void 0:c.url;return(m,p)=>Oe(d,Se,Ae,i)(m,f||p)},async getArtists(t,s,n,r,o,c,d,u,f,m,p,v,S,y,E,A,R,I,C,L,D,_,M,U,F,z,V,ae,G,Z,B,Q,re){var J,N,K;const le=await e.getArtists(t,s,n,r,o,c,d,u,f,m,p,v,S,y,E,A,R,I,C,L,D,_,M,U,F,z,V,ae,G,Z,B,Q,re),H=(J=i==null?void 0:i.serverIndex)!==null&&J!==void 0?J:0,ue=(K=(N=Re["ArtistsApi.getArtists"])===null||N===void 0?void 0:N[H])===null||K===void 0?void 0:K.url;return(xe,fe)=>Oe(le,Se,Ae,i)(xe,ue||fe)}}};class Ag extends Nn{getAlbumArtists(e={},t){return bg(this.configuration).getAlbumArtists(e.minCommunityRating,e.startIndex,e.limit,e.searchTerm,e.parentId,e.fields,e.excludeItemTypes,e.includeItemTypes,e.filters,e.isFavorite,e.mediaTypes,e.genres,e.genreIds,e.officialRatings,e.tags,e.years,e.enableUserData,e.imageTypeLimit,e.enableImageTypes,e.person,e.personIds,e.personTypes,e.studios,e.studioIds,e.userId,e.nameStartsWithOrGreater,e.nameStartsWith,e.nameLessThan,e.sortBy,e.sortOrder,e.enableImages,e.enableTotalRecordCount,t).then(s=>s(this.axios,this.basePath))}getArtistByName(e,t){return bg(this.configuration).getArtistByName(e.name,e.userId,t).then(s=>s(this.axios,this.basePath))}getArtists(e={},t){return bg(this.configuration).getArtists(e.minCommunityRating,e.startIndex,e.limit,e.searchTerm,e.parentId,e.fields,e.excludeItemTypes,e.includeItemTypes,e.filters,e.isFavorite,e.mediaTypes,e.genres,e.genreIds,e.officialRatings,e.tags,e.years,e.enableUserData,e.imageTypeLimit,e.enableImageTypes,e.person,e.personIds,e.personTypes,e.studios,e.studioIds,e.userId,e.nameStartsWithOrGreater,e.nameStartsWith,e.nameLessThan,e.sortBy,e.sortOrder,e.enableImages,e.enableTotalRecordCount,t).then(s=>s(this.axios,this.basePath))}}const J_=function(i){return{getGenre:async(e,t,s={})=>{Pe("getGenre","genreName",e);const n="/Genres/{genreName}".replace("{genreName}",encodeURIComponent(String(e))),r=new URL(n,Le);let o;i&&(o=i.baseOptions);const c={method:"GET",...o,...s},d={},u={};await ke(d,"Authorization",i),t!==void 0&&(u.userId=t),we(r,u);let f=o&&o.headers?o.headers:{};return c.headers={...d,...f,...s.headers},{url:Ce(r),options:c}},getGenres:async(e,t,s,n,r,o,c,d,u,f,m,p,v,S,y,E,A,R,I={})=>{const C="/Genres",L=new URL(C,Le);let D;i&&(D=i.baseOptions);const _={method:"GET",...D,...I},M={},U={};await ke(M,"Authorization",i),e!==void 0&&(U.startIndex=e),t!==void 0&&(U.limit=t),s!==void 0&&(U.searchTerm=s),n!==void 0&&(U.parentId=n),r&&(U.fields=r),o&&(U.excludeItemTypes=o),c&&(U.includeItemTypes=c),d!==void 0&&(U.isFavorite=d),u!==void 0&&(U.imageTypeLimit=u),f&&(U.enableImageTypes=f),m!==void 0&&(U.userId=m),p!==void 0&&(U.nameStartsWithOrGreater=p),v!==void 0&&(U.nameStartsWith=v),S!==void 0&&(U.nameLessThan=S),y&&(U.sortBy=y),E&&(U.sortOrder=E),A!==void 0&&(U.enableImages=A),R!==void 0&&(U.enableTotalRecordCount=R),we(L,U);let F=D&&D.headers?D.headers:{};return _.headers={...M,...F,...I.headers},{url:Ce(L),options:_}}}},MT=function(i){const e=J_(i);return{async getGenre(t,s,n){var r,o,c;const d=await e.getGenre(t,s,n),u=(r=i==null?void 0:i.serverIndex)!==null&&r!==void 0?r:0,f=(c=(o=Re["GenresApi.getGenre"])===null||o===void 0?void 0:o[u])===null||c===void 0?void 0:c.url;return(m,p)=>Oe(d,Se,Ae,i)(m,f||p)},async getGenres(t,s,n,r,o,c,d,u,f,m,p,v,S,y,E,A,R,I,C){var L,D,_;const M=await e.getGenres(t,s,n,r,o,c,d,u,f,m,p,v,S,y,E,A,R,I,C),U=(L=i==null?void 0:i.serverIndex)!==null&&L!==void 0?L:0,F=(_=(D=Re["GenresApi.getGenres"])===null||D===void 0?void 0:D[U])===null||_===void 0?void 0:_.url;return(z,V)=>Oe(M,Se,Ae,i)(z,F||V)}}};class eP extends Nn{getGenre(e,t){return MT(this.configuration).getGenre(e.genreName,e.userId,t).then(s=>s(this.axios,this.basePath))}getGenres(e={},t){return MT(this.configuration).getGenres(e.startIndex,e.limit,e.searchTerm,e.parentId,e.fields,e.excludeItemTypes,e.includeItemTypes,e.isFavorite,e.imageTypeLimit,e.enableImageTypes,e.userId,e.nameStartsWithOrGreater,e.nameStartsWith,e.nameLessThan,e.sortBy,e.sortOrder,e.enableImages,e.enableTotalRecordCount,t).then(s=>s(this.axios,this.basePath))}}const tP=function(i){return{getInstantMixFromAlbum:async(e,t,s,n,r,o,c,d,u={})=>{Pe("getInstantMixFromAlbum","itemId",e);const f="/Albums/{itemId}/InstantMix".replace("{itemId}",encodeURIComponent(String(e))),m=new URL(f,Le);let p;i&&(p=i.baseOptions);const v={method:"GET",...p,...u},S={},y={};await ke(S,"Authorization",i),t!==void 0&&(y.userId=t),s!==void 0&&(y.limit=s),n&&(y.fields=n),r!==void 0&&(y.enableImages=r),o!==void 0&&(y.enableUserData=o),c!==void 0&&(y.imageTypeLimit=c),d&&(y.enableImageTypes=d),we(m,y);let E=p&&p.headers?p.headers:{};return v.headers={...S,...E,...u.headers},{url:Ce(m),options:v}},getInstantMixFromArtists:async(e,t,s,n,r,o,c,d,u={})=>{Pe("getInstantMixFromArtists","itemId",e);const f="/Artists/{itemId}/InstantMix".replace("{itemId}",encodeURIComponent(String(e))),m=new URL(f,Le);let p;i&&(p=i.baseOptions);const v={method:"GET",...p,...u},S={},y={};await ke(S,"Authorization",i),t!==void 0&&(y.userId=t),s!==void 0&&(y.limit=s),n&&(y.fields=n),r!==void 0&&(y.enableImages=r),o!==void 0&&(y.enableUserData=o),c!==void 0&&(y.imageTypeLimit=c),d&&(y.enableImageTypes=d),we(m,y);let E=p&&p.headers?p.headers:{};return v.headers={...S,...E,...u.headers},{url:Ce(m),options:v}},getInstantMixFromArtists2:async(e,t,s,n,r,o,c,d,u={})=>{Pe("getInstantMixFromArtists2","id",e);const f="/Artists/InstantMix",m=new URL(f,Le);let p;i&&(p=i.baseOptions);const v={method:"GET",...p,...u},S={},y={};await ke(S,"Authorization",i),e!==void 0&&(y.id=e),t!==void 0&&(y.userId=t),s!==void 0&&(y.limit=s),n&&(y.fields=n),r!==void 0&&(y.enableImages=r),o!==void 0&&(y.enableUserData=o),c!==void 0&&(y.imageTypeLimit=c),d&&(y.enableImageTypes=d),we(m,y);let E=p&&p.headers?p.headers:{};return v.headers={...S,...E,...u.headers},{url:Ce(m),options:v}},getInstantMixFromItem:async(e,t,s,n,r,o,c,d,u={})=>{Pe("getInstantMixFromItem","itemId",e);const f="/Items/{itemId}/InstantMix".replace("{itemId}",encodeURIComponent(String(e))),m=new URL(f,Le);let p;i&&(p=i.baseOptions);const v={method:"GET",...p,...u},S={},y={};await ke(S,"Authorization",i),t!==void 0&&(y.userId=t),s!==void 0&&(y.limit=s),n&&(y.fields=n),r!==void 0&&(y.enableImages=r),o!==void 0&&(y.enableUserData=o),c!==void 0&&(y.imageTypeLimit=c),d&&(y.enableImageTypes=d),we(m,y);let E=p&&p.headers?p.headers:{};return v.headers={...S,...E,...u.headers},{url:Ce(m),options:v}},getInstantMixFromMusicGenreById:async(e,t,s,n,r,o,c,d,u={})=>{Pe("getInstantMixFromMusicGenreById","id",e);const f="/MusicGenres/InstantMix",m=new URL(f,Le);let p;i&&(p=i.baseOptions);const v={method:"GET",...p,...u},S={},y={};await ke(S,"Authorization",i),e!==void 0&&(y.id=e),t!==void 0&&(y.userId=t),s!==void 0&&(y.limit=s),n&&(y.fields=n),r!==void 0&&(y.enableImages=r),o!==void 0&&(y.enableUserData=o),c!==void 0&&(y.imageTypeLimit=c),d&&(y.enableImageTypes=d),we(m,y);let E=p&&p.headers?p.headers:{};return v.headers={...S,...E,...u.headers},{url:Ce(m),options:v}},getInstantMixFromMusicGenreByName:async(e,t,s,n,r,o,c,d,u={})=>{Pe("getInstantMixFromMusicGenreByName","name",e);const f="/MusicGenres/{name}/InstantMix".replace("{name}",encodeURIComponent(String(e))),m=new URL(f,Le);let p;i&&(p=i.baseOptions);const v={method:"GET",...p,...u},S={},y={};await ke(S,"Authorization",i),t!==void 0&&(y.userId=t),s!==void 0&&(y.limit=s),n&&(y.fields=n),r!==void 0&&(y.enableImages=r),o!==void 0&&(y.enableUserData=o),c!==void 0&&(y.imageTypeLimit=c),d&&(y.enableImageTypes=d),we(m,y);let E=p&&p.headers?p.headers:{};return v.headers={...S,...E,...u.headers},{url:Ce(m),options:v}},getInstantMixFromPlaylist:async(e,t,s,n,r,o,c,d,u={})=>{Pe("getInstantMixFromPlaylist","itemId",e);const f="/Playlists/{itemId}/InstantMix".replace("{itemId}",encodeURIComponent(String(e))),m=new URL(f,Le);let p;i&&(p=i.baseOptions);const v={method:"GET",...p,...u},S={},y={};await ke(S,"Authorization",i),t!==void 0&&(y.userId=t),s!==void 0&&(y.limit=s),n&&(y.fields=n),r!==void 0&&(y.enableImages=r),o!==void 0&&(y.enableUserData=o),c!==void 0&&(y.imageTypeLimit=c),d&&(y.enableImageTypes=d),we(m,y);let E=p&&p.headers?p.headers:{};return v.headers={...S,...E,...u.headers},{url:Ce(m),options:v}},getInstantMixFromSong:async(e,t,s,n,r,o,c,d,u={})=>{Pe("getInstantMixFromSong","itemId",e);const f="/Songs/{itemId}/InstantMix".replace("{itemId}",encodeURIComponent(String(e))),m=new URL(f,Le);let p;i&&(p=i.baseOptions);const v={method:"GET",...p,...u},S={},y={};await ke(S,"Authorization",i),t!==void 0&&(y.userId=t),s!==void 0&&(y.limit=s),n&&(y.fields=n),r!==void 0&&(y.enableImages=r),o!==void 0&&(y.enableUserData=o),c!==void 0&&(y.imageTypeLimit=c),d&&(y.enableImageTypes=d),we(m,y);let E=p&&p.headers?p.headers:{};return v.headers={...S,...E,...u.headers},{url:Ce(m),options:v}}}},Gr=function(i){const e=tP(i);return{async getInstantMixFromAlbum(t,s,n,r,o,c,d,u,f){var m,p,v;const S=await e.getInstantMixFromAlbum(t,s,n,r,o,c,d,u,f),y=(m=i==null?void 0:i.serverIndex)!==null&&m!==void 0?m:0,E=(v=(p=Re["InstantMixApi.getInstantMixFromAlbum"])===null||p===void 0?void 0:p[y])===null||v===void 0?void 0:v.url;return(A,R)=>Oe(S,Se,Ae,i)(A,E||R)},async getInstantMixFromArtists(t,s,n,r,o,c,d,u,f){var m,p,v;const S=await e.getInstantMixFromArtists(t,s,n,r,o,c,d,u,f),y=(m=i==null?void 0:i.serverIndex)!==null&&m!==void 0?m:0,E=(v=(p=Re["InstantMixApi.getInstantMixFromArtists"])===null||p===void 0?void 0:p[y])===null||v===void 0?void 0:v.url;return(A,R)=>Oe(S,Se,Ae,i)(A,E||R)},async getInstantMixFromArtists2(t,s,n,r,o,c,d,u,f){var m,p,v;const S=await e.getInstantMixFromArtists2(t,s,n,r,o,c,d,u,f),y=(m=i==null?void 0:i.serverIndex)!==null&&m!==void 0?m:0,E=(v=(p=Re["InstantMixApi.getInstantMixFromArtists2"])===null||p===void 0?void 0:p[y])===null||v===void 0?void 0:v.url;return(A,R)=>Oe(S,Se,Ae,i)(A,E||R)},async getInstantMixFromItem(t,s,n,r,o,c,d,u,f){var m,p,v;const S=await e.getInstantMixFromItem(t,s,n,r,o,c,d,u,f),y=(m=i==null?void 0:i.serverIndex)!==null&&m!==void 0?m:0,E=(v=(p=Re["InstantMixApi.getInstantMixFromItem"])===null||p===void 0?void 0:p[y])===null||v===void 0?void 0:v.url;return(A,R)=>Oe(S,Se,Ae,i)(A,E||R)},async getInstantMixFromMusicGenreById(t,s,n,r,o,c,d,u,f){var m,p,v;const S=await e.getInstantMixFromMusicGenreById(t,s,n,r,o,c,d,u,f),y=(m=i==null?void 0:i.serverIndex)!==null&&m!==void 0?m:0,E=(v=(p=Re["InstantMixApi.getInstantMixFromMusicGenreById"])===null||p===void 0?void 0:p[y])===null||v===void 0?void 0:v.url;return(A,R)=>Oe(S,Se,Ae,i)(A,E||R)},async getInstantMixFromMusicGenreByName(t,s,n,r,o,c,d,u,f){var m,p,v;const S=await e.getInstantMixFromMusicGenreByName(t,s,n,r,o,c,d,u,f),y=(m=i==null?void 0:i.serverIndex)!==null&&m!==void 0?m:0,E=(v=(p=Re["InstantMixApi.getInstantMixFromMusicGenreByName"])===null||p===void 0?void 0:p[y])===null||v===void 0?void 0:v.url;return(A,R)=>Oe(S,Se,Ae,i)(A,E||R)},async getInstantMixFromPlaylist(t,s,n,r,o,c,d,u,f){var m,p,v;const S=await e.getInstantMixFromPlaylist(t,s,n,r,o,c,d,u,f),y=(m=i==null?void 0:i.serverIndex)!==null&&m!==void 0?m:0,E=(v=(p=Re["InstantMixApi.getInstantMixFromPlaylist"])===null||p===void 0?void 0:p[y])===null||v===void 0?void 0:v.url;return(A,R)=>Oe(S,Se,Ae,i)(A,E||R)},async getInstantMixFromSong(t,s,n,r,o,c,d,u,f){var m,p,v;const S=await e.getInstantMixFromSong(t,s,n,r,o,c,d,u,f),y=(m=i==null?void 0:i.serverIndex)!==null&&m!==void 0?m:0,E=(v=(p=Re["InstantMixApi.getInstantMixFromSong"])===null||p===void 0?void 0:p[y])===null||v===void 0?void 0:v.url;return(A,R)=>Oe(S,Se,Ae,i)(A,E||R)}}};class sP extends Nn{getInstantMixFromAlbum(e,t){return Gr(this.configuration).getInstantMixFromAlbum(e.itemId,e.userId,e.limit,e.fields,e.enableImages,e.enableUserData,e.imageTypeLimit,e.enableImageTypes,t).then(s=>s(this.axios,this.basePath))}getInstantMixFromArtists(e,t){return Gr(this.configuration).getInstantMixFromArtists(e.itemId,e.userId,e.limit,e.fields,e.enableImages,e.enableUserData,e.imageTypeLimit,e.enableImageTypes,t).then(s=>s(this.axios,this.basePath))}getInstantMixFromArtists2(e,t){return Gr(this.configuration).getInstantMixFromArtists2(e.id,e.userId,e.limit,e.fields,e.enableImages,e.enableUserData,e.imageTypeLimit,e.enableImageTypes,t).then(s=>s(this.axios,this.basePath))}getInstantMixFromItem(e,t){return Gr(this.configuration).getInstantMixFromItem(e.itemId,e.userId,e.limit,e.fields,e.enableImages,e.enableUserData,e.imageTypeLimit,e.enableImageTypes,t).then(s=>s(this.axios,this.basePath))}getInstantMixFromMusicGenreById(e,t){return Gr(this.configuration).getInstantMixFromMusicGenreById(e.id,e.userId,e.limit,e.fields,e.enableImages,e.enableUserData,e.imageTypeLimit,e.enableImageTypes,t).then(s=>s(this.axios,this.basePath))}getInstantMixFromMusicGenreByName(e,t){return Gr(this.configuration).getInstantMixFromMusicGenreByName(e.name,e.userId,e.limit,e.fields,e.enableImages,e.enableUserData,e.imageTypeLimit,e.enableImageTypes,t).then(s=>s(this.axios,this.basePath))}getInstantMixFromPlaylist(e,t){return Gr(this.configuration).getInstantMixFromPlaylist(e.itemId,e.userId,e.limit,e.fields,e.enableImages,e.enableUserData,e.imageTypeLimit,e.enableImageTypes,t).then(s=>s(this.axios,this.basePath))}getInstantMixFromSong(e,t){return Gr(this.configuration).getInstantMixFromSong(e.itemId,e.userId,e.limit,e.fields,e.enableImages,e.enableUserData,e.imageTypeLimit,e.enableImageTypes,t).then(s=>s(this.axios,this.basePath))}}const iP=function(i){return{getItemUserData:async(e,t,s={})=>{Pe("getItemUserData","itemId",e);const n="/UserItems/{itemId}/UserData".replace("{itemId}",encodeURIComponent(String(e))),r=new URL(n,Le);let o;i&&(o=i.baseOptions);const c={method:"GET",...o,...s},d={},u={};await ke(d,"Authorization",i),t!==void 0&&(u.userId=t),we(r,u);let f=o&&o.headers?o.headers:{};return c.headers={...d,...f,...s.headers},{url:Ce(r),options:c}},getItems:async(e,t,s,n,r,o,c,d,u,f,m,p,v,S,y,E,A,R,I,C,L,D,_,M,U,F,z,V,ae,G,Z,B,Q,re,J,N,K,le,H,ue,xe,fe,We,de,Be,lt,Ee,Ne,Me,Qe,st,W,j,ne,ge,Ie,Ue,Ve,it,xt,Rt,Dt,bt,$t,St,_s,hs,Xt,Ps,ps,Ws,Bn,hn,ao,pa,ya,pr,fn,oo,va,Sa,yr,vr,xa,lo,gi,ls={})=>{const Is="/Items",pi=new URL(Is,Le);let yi;i&&(yi=i.baseOptions);const Sr={method:"GET",...yi,...ls},co={},be={};await ke(co,"Authorization",i),e!==void 0&&(be.userId=e),t!==void 0&&(be.maxOfficialRating=t),s!==void 0&&(be.hasThemeSong=s),n!==void 0&&(be.hasThemeVideo=n),r!==void 0&&(be.hasSubtitles=r),o!==void 0&&(be.hasSpecialFeature=o),c!==void 0&&(be.hasTrailer=c),d!==void 0&&(be.adjacentTo=d),u!==void 0&&(be.indexNumber=u),f!==void 0&&(be.parentIndexNumber=f),m!==void 0&&(be.hasParentalRating=m),p!==void 0&&(be.isHd=p),v!==void 0&&(be.is4K=v),S&&(be.locationTypes=S),y&&(be.excludeLocationTypes=y),E!==void 0&&(be.isMissing=E),A!==void 0&&(be.isUnaired=A),R!==void 0&&(be.minCommunityRating=R),I!==void 0&&(be.minCriticRating=I),C!==void 0&&(be.minPremiereDate=C instanceof Date?C.toISOString():C),L!==void 0&&(be.minDateLastSaved=L instanceof Date?L.toISOString():L),D!==void 0&&(be.minDateLastSavedForUser=D instanceof Date?D.toISOString():D),_!==void 0&&(be.maxPremiereDate=_ instanceof Date?_.toISOString():_),M!==void 0&&(be.hasOverview=M),U!==void 0&&(be.hasImdbId=U),F!==void 0&&(be.hasTmdbId=F),z!==void 0&&(be.hasTvdbId=z),V!==void 0&&(be.isMovie=V),ae!==void 0&&(be.isSeries=ae),G!==void 0&&(be.isNews=G),Z!==void 0&&(be.isKids=Z),B!==void 0&&(be.isSports=B),Q&&(be.excludeItemIds=Q),re!==void 0&&(be.startIndex=re),J!==void 0&&(be.limit=J),N!==void 0&&(be.recursive=N),K!==void 0&&(be.searchTerm=K),le&&(be.sortOrder=le),H!==void 0&&(be.parentId=H),ue&&(be.fields=ue),xe&&(be.excludeItemTypes=xe),fe&&(be.includeItemTypes=fe),We&&(be.filters=We),de!==void 0&&(be.isFavorite=de),Be&&(be.mediaTypes=Be),lt&&(be.imageTypes=lt),Ee&&(be.sortBy=Ee),Ne!==void 0&&(be.isPlayed=Ne),Me&&(be.genres=Me),Qe&&(be.officialRatings=Qe),st&&(be.tags=st),W&&(be.years=W),j!==void 0&&(be.enableUserData=j),ne!==void 0&&(be.imageTypeLimit=ne),ge&&(be.enableImageTypes=ge),Ie!==void 0&&(be.person=Ie),Ue&&(be.personIds=Ue),Ve&&(be.personTypes=Ve),it&&(be.studios=it),xt&&(be.artists=xt),Rt&&(be.excludeArtistIds=Rt),Dt&&(be.artistIds=Dt),bt&&(be.albumArtistIds=bt),$t&&(be.contributingArtistIds=$t),St&&(be.albums=St),_s&&(be.albumIds=_s),hs&&(be.ids=hs),Xt&&(be.videoTypes=Xt),Ps!==void 0&&(be.minOfficialRating=Ps),ps!==void 0&&(be.isLocked=ps),Ws!==void 0&&(be.isPlaceHolder=Ws),Bn!==void 0&&(be.hasOfficialRating=Bn),hn!==void 0&&(be.collapseBoxSetItems=hn),ao!==void 0&&(be.minWidth=ao),pa!==void 0&&(be.minHeight=pa),ya!==void 0&&(be.maxWidth=ya),pr!==void 0&&(be.maxHeight=pr),fn!==void 0&&(be.is3D=fn),oo&&(be.seriesStatus=oo),va!==void 0&&(be.nameStartsWithOrGreater=va),Sa!==void 0&&(be.nameStartsWith=Sa),yr!==void 0&&(be.nameLessThan=yr),vr&&(be.studioIds=vr),xa&&(be.genreIds=xa),lo!==void 0&&(be.enableTotalRecordCount=lo),gi!==void 0&&(be.enableImages=gi),we(pi,be);let jn=yi&&yi.headers?yi.headers:{};return Sr.headers={...co,...jn,...ls.headers},{url:Ce(pi),options:Sr}},getResumeItems:async(e,t,s,n,r,o,c,d,u,f,m,p,v,S,y,E={})=>{const A="/UserItems/Resume",R=new URL(A,Le);let I;i&&(I=i.baseOptions);const C={method:"GET",...I,...E},L={},D={};await ke(L,"Authorization",i),e!==void 0&&(D.userId=e),t!==void 0&&(D.startIndex=t),s!==void 0&&(D.limit=s),n!==void 0&&(D.searchTerm=n),r!==void 0&&(D.parentId=r),o&&(D.fields=o),c&&(D.mediaTypes=c),d!==void 0&&(D.enableUserData=d),u!==void 0&&(D.imageTypeLimit=u),f&&(D.enableImageTypes=f),m&&(D.excludeItemTypes=m),p&&(D.includeItemTypes=p),v!==void 0&&(D.enableTotalRecordCount=v),S!==void 0&&(D.enableImages=S),y!==void 0&&(D.excludeActiveSessions=y),we(R,D);let _=I&&I.headers?I.headers:{};return C.headers={...L,..._,...E.headers},{url:Ce(R),options:C}},updateItemUserData:async(e,t,s,n={})=>{Pe("updateItemUserData","itemId",e),Pe("updateItemUserData","updateUserItemDataDto",t);const r="/UserItems/{itemId}/UserData".replace("{itemId}",encodeURIComponent(String(e))),o=new URL(r,Le);let c;i&&(c=i.baseOptions);const d={method:"POST",...c,...n},u={},f={};await ke(u,"Authorization",i),s!==void 0&&(f.userId=s),u["Content-Type"]="application/json",we(o,f);let m=c&&c.headers?c.headers:{};return d.headers={...u,...m,...n.headers},d.data=xs(t,d,i),{url:Ce(o),options:d}}}},_d=function(i){const e=iP(i);return{async getItemUserData(t,s,n){var r,o,c;const d=await e.getItemUserData(t,s,n),u=(r=i==null?void 0:i.serverIndex)!==null&&r!==void 0?r:0,f=(c=(o=Re["ItemsApi.getItemUserData"])===null||o===void 0?void 0:o[u])===null||c===void 0?void 0:c.url;return(m,p)=>Oe(d,Se,Ae,i)(m,f||p)},async getItems(t,s,n,r,o,c,d,u,f,m,p,v,S,y,E,A,R,I,C,L,D,_,M,U,F,z,V,ae,G,Z,B,Q,re,J,N,K,le,H,ue,xe,fe,We,de,Be,lt,Ee,Ne,Me,Qe,st,W,j,ne,ge,Ie,Ue,Ve,it,xt,Rt,Dt,bt,$t,St,_s,hs,Xt,Ps,ps,Ws,Bn,hn,ao,pa,ya,pr,fn,oo,va,Sa,yr,vr,xa,lo,gi,ls,Is){var pi,yi,Sr;const co=await e.getItems(t,s,n,r,o,c,d,u,f,m,p,v,S,y,E,A,R,I,C,L,D,_,M,U,F,z,V,ae,G,Z,B,Q,re,J,N,K,le,H,ue,xe,fe,We,de,Be,lt,Ee,Ne,Me,Qe,st,W,j,ne,ge,Ie,Ue,Ve,it,xt,Rt,Dt,bt,$t,St,_s,hs,Xt,Ps,ps,Ws,Bn,hn,ao,pa,ya,pr,fn,oo,va,Sa,yr,vr,xa,lo,gi,ls,Is),be=(pi=i==null?void 0:i.serverIndex)!==null&&pi!==void 0?pi:0,jn=(Sr=(yi=Re["ItemsApi.getItems"])===null||yi===void 0?void 0:yi[be])===null||Sr===void 0?void 0:Sr.url;return(_l,xr)=>Oe(co,Se,Ae,i)(_l,jn||xr)},async getResumeItems(t,s,n,r,o,c,d,u,f,m,p,v,S,y,E,A){var R,I,C;const L=await e.getResumeItems(t,s,n,r,o,c,d,u,f,m,p,v,S,y,E,A),D=(R=i==null?void 0:i.serverIndex)!==null&&R!==void 0?R:0,_=(C=(I=Re["ItemsApi.getResumeItems"])===null||I===void 0?void 0:I[D])===null||C===void 0?void 0:C.url;return(M,U)=>Oe(L,Se,Ae,i)(M,_||U)},async updateItemUserData(t,s,n,r){var o,c,d;const u=await e.updateItemUserData(t,s,n,r),f=(o=i==null?void 0:i.serverIndex)!==null&&o!==void 0?o:0,m=(d=(c=Re["ItemsApi.updateItemUserData"])===null||c===void 0?void 0:c[f])===null||d===void 0?void 0:d.url;return(p,v)=>Oe(u,Se,Ae,i)(p,m||v)}}};class Zt extends Nn{getItemUserData(e,t){return _d(this.configuration).getItemUserData(e.itemId,e.userId,t).then(s=>s(this.axios,this.basePath))}getItems(e={},t){return _d(this.configuration).getItems(e.userId,e.maxOfficialRating,e.hasThemeSong,e.hasThemeVideo,e.hasSubtitles,e.hasSpecialFeature,e.hasTrailer,e.adjacentTo,e.indexNumber,e.parentIndexNumber,e.hasParentalRating,e.isHd,e.is4K,e.locationTypes,e.excludeLocationTypes,e.isMissing,e.isUnaired,e.minCommunityRating,e.minCriticRating,e.minPremiereDate,e.minDateLastSaved,e.minDateLastSavedForUser,e.maxPremiereDate,e.hasOverview,e.hasImdbId,e.hasTmdbId,e.hasTvdbId,e.isMovie,e.isSeries,e.isNews,e.isKids,e.isSports,e.excludeItemIds,e.startIndex,e.limit,e.recursive,e.searchTerm,e.sortOrder,e.parentId,e.fields,e.excludeItemTypes,e.includeItemTypes,e.filters,e.isFavorite,e.mediaTypes,e.imageTypes,e.sortBy,e.isPlayed,e.genres,e.officialRatings,e.tags,e.years,e.enableUserData,e.imageTypeLimit,e.enableImageTypes,e.person,e.personIds,e.personTypes,e.studios,e.artists,e.excludeArtistIds,e.artistIds,e.albumArtistIds,e.contributingArtistIds,e.albums,e.albumIds,e.ids,e.videoTypes,e.minOfficialRating,e.isLocked,e.isPlaceHolder,e.hasOfficialRating,e.collapseBoxSetItems,e.minWidth,e.minHeight,e.maxWidth,e.maxHeight,e.is3D,e.seriesStatus,e.nameStartsWithOrGreater,e.nameStartsWith,e.nameLessThan,e.studioIds,e.genreIds,e.enableTotalRecordCount,e.enableImages,t).then(s=>s(this.axios,this.basePath))}getResumeItems(e={},t){return _d(this.configuration).getResumeItems(e.userId,e.startIndex,e.limit,e.searchTerm,e.parentId,e.fields,e.mediaTypes,e.enableUserData,e.imageTypeLimit,e.enableImageTypes,e.excludeItemTypes,e.includeItemTypes,e.enableTotalRecordCount,e.enableImages,e.excludeActiveSessions,t).then(s=>s(this.axios,this.basePath))}updateItemUserData(e,t){return _d(this.configuration).updateItemUserData(e.itemId,e.updateUserItemDataDto,e.userId,t).then(s=>s(this.axios,this.basePath))}}const nP=function(i){return{addItemToPlaylist:async(e,t,s,n={})=>{Pe("addItemToPlaylist","playlistId",e);const r="/Playlists/{playlistId}/Items".replace("{playlistId}",encodeURIComponent(String(e))),o=new URL(r,Le);let c;i&&(c=i.baseOptions);const d={method:"POST",...c,...n},u={},f={};await ke(u,"Authorization",i),t&&(f.ids=t),s!==void 0&&(f.userId=s),we(o,f);let m=c&&c.headers?c.headers:{};return d.headers={...u,...m,...n.headers},{url:Ce(o),options:d}},createPlaylist:async(e,t,s,n,r,o={})=>{const c="/Playlists",d=new URL(c,Le);let u;i&&(u=i.baseOptions);const f={method:"POST",...u,...o},m={},p={};await ke(m,"Authorization",i),e!==void 0&&(p.name=e),t&&(p.ids=t),s!==void 0&&(p.userId=s),n!==void 0&&(p.mediaType=n),m["Content-Type"]="application/json",we(d,p);let v=u&&u.headers?u.headers:{};return f.headers={...m,...v,...o.headers},f.data=xs(r,f,i),{url:Ce(d),options:f}},getPlaylist:async(e,t={})=>{Pe("getPlaylist","playlistId",e);const s="/Playlists/{playlistId}".replace("{playlistId}",encodeURIComponent(String(e))),n=new URL(s,Le);let r;i&&(r=i.baseOptions);const o={method:"GET",...r,...t},c={},d={};await ke(c,"Authorization",i),we(n,d);let u=r&&r.headers?r.headers:{};return o.headers={...c,...u,...t.headers},{url:Ce(n),options:o}},getPlaylistItems:async(e,t,s,n,r,o,c,d,u,f={})=>{Pe("getPlaylistItems","playlistId",e);const m="/Playlists/{playlistId}/Items".replace("{playlistId}",encodeURIComponent(String(e))),p=new URL(m,Le);let v;i&&(v=i.baseOptions);const S={method:"GET",...v,...f},y={},E={};await ke(y,"Authorization",i),t!==void 0&&(E.userId=t),s!==void 0&&(E.startIndex=s),n!==void 0&&(E.limit=n),r&&(E.fields=r),o!==void 0&&(E.enableImages=o),c!==void 0&&(E.enableUserData=c),d!==void 0&&(E.imageTypeLimit=d),u&&(E.enableImageTypes=u),we(p,E);let A=v&&v.headers?v.headers:{};return S.headers={...y,...A,...f.headers},{url:Ce(p),options:S}},getPlaylistUser:async(e,t,s={})=>{Pe("getPlaylistUser","playlistId",e),Pe("getPlaylistUser","userId",t);const n="/Playlists/{playlistId}/Users/{userId}".replace("{playlistId}",encodeURIComponent(String(e))).replace("{userId}",encodeURIComponent(String(t))),r=new URL(n,Le);let o;i&&(o=i.baseOptions);const c={method:"GET",...o,...s},d={},u={};await ke(d,"Authorization",i),we(r,u);let f=o&&o.headers?o.headers:{};return c.headers={...d,...f,...s.headers},{url:Ce(r),options:c}},getPlaylistUsers:async(e,t={})=>{Pe("getPlaylistUsers","playlistId",e);const s="/Playlists/{playlistId}/Users".replace("{playlistId}",encodeURIComponent(String(e))),n=new URL(s,Le);let r;i&&(r=i.baseOptions);const o={method:"GET",...r,...t},c={},d={};await ke(c,"Authorization",i),we(n,d);let u=r&&r.headers?r.headers:{};return o.headers={...c,...u,...t.headers},{url:Ce(n),options:o}},moveItem:async(e,t,s,n={})=>{Pe("moveItem","playlistId",e),Pe("moveItem","itemId",t),Pe("moveItem","newIndex",s);const r="/Playlists/{playlistId}/Items/{itemId}/Move/{newIndex}".replace("{playlistId}",encodeURIComponent(String(e))).replace("{itemId}",encodeURIComponent(String(t))).replace("{newIndex}",encodeURIComponent(String(s))),o=new URL(r,Le);let c;i&&(c=i.baseOptions);const d={method:"POST",...c,...n},u={},f={};await ke(u,"Authorization",i),we(o,f);let m=c&&c.headers?c.headers:{};return d.headers={...u,...m,...n.headers},{url:Ce(o),options:d}},removeItemFromPlaylist:async(e,t,s={})=>{Pe("removeItemFromPlaylist","playlistId",e);const n="/Playlists/{playlistId}/Items".replace("{playlistId}",encodeURIComponent(String(e))),r=new URL(n,Le);let o;i&&(o=i.baseOptions);const c={method:"DELETE",...o,...s},d={},u={};await ke(d,"Authorization",i),t&&(u.entryIds=t),we(r,u);let f=o&&o.headers?o.headers:{};return c.headers={...d,...f,...s.headers},{url:Ce(r),options:c}},removeUserFromPlaylist:async(e,t,s={})=>{Pe("removeUserFromPlaylist","playlistId",e),Pe("removeUserFromPlaylist","userId",t);const n="/Playlists/{playlistId}/Users/{userId}".replace("{playlistId}",encodeURIComponent(String(e))).replace("{userId}",encodeURIComponent(String(t))),r=new URL(n,Le);let o;i&&(o=i.baseOptions);const c={method:"DELETE",...o,...s},d={},u={};await ke(d,"Authorization",i),we(r,u);let f=o&&o.headers?o.headers:{};return c.headers={...d,...f,...s.headers},{url:Ce(r),options:c}},updatePlaylist:async(e,t,s={})=>{Pe("updatePlaylist","playlistId",e),Pe("updatePlaylist","updatePlaylistDto",t);const n="/Playlists/{playlistId}".replace("{playlistId}",encodeURIComponent(String(e))),r=new URL(n,Le);let o;i&&(o=i.baseOptions);const c={method:"POST",...o,...s},d={},u={};await ke(d,"Authorization",i),d["Content-Type"]="application/json",we(r,u);let f=o&&o.headers?o.headers:{};return c.headers={...d,...f,...s.headers},c.data=xs(t,c,i),{url:Ce(r),options:c}},updatePlaylistUser:async(e,t,s,n={})=>{Pe("updatePlaylistUser","playlistId",e),Pe("updatePlaylistUser","userId",t),Pe("updatePlaylistUser","updatePlaylistUserDto",s);const r="/Playlists/{playlistId}/Users/{userId}".replace("{playlistId}",encodeURIComponent(String(e))).replace("{userId}",encodeURIComponent(String(t))),o=new URL(r,Le);let c;i&&(c=i.baseOptions);const d={method:"POST",...c,...n},u={},f={};await ke(u,"Authorization",i),u["Content-Type"]="application/json",we(o,f);let m=c&&c.headers?c.headers:{};return d.headers={...u,...m,...n.headers},d.data=xs(s,d,i),{url:Ce(o),options:d}}}},en=function(i){const e=nP(i);return{async addItemToPlaylist(t,s,n,r){var o,c,d;const u=await e.addItemToPlaylist(t,s,n,r),f=(o=i==null?void 0:i.serverIndex)!==null&&o!==void 0?o:0,m=(d=(c=Re["PlaylistsApi.addItemToPlaylist"])===null||c===void 0?void 0:c[f])===null||d===void 0?void 0:d.url;return(p,v)=>Oe(u,Se,Ae,i)(p,m||v)},async createPlaylist(t,s,n,r,o,c){var d,u,f;const m=await e.createPlaylist(t,s,n,r,o,c),p=(d=i==null?void 0:i.serverIndex)!==null&&d!==void 0?d:0,v=(f=(u=Re["PlaylistsApi.createPlaylist"])===null||u===void 0?void 0:u[p])===null||f===void 0?void 0:f.url;return(S,y)=>Oe(m,Se,Ae,i)(S,v||y)},async getPlaylist(t,s){var n,r,o;const c=await e.getPlaylist(t,s),d=(n=i==null?void 0:i.serverIndex)!==null&&n!==void 0?n:0,u=(o=(r=Re["PlaylistsApi.getPlaylist"])===null||r===void 0?void 0:r[d])===null||o===void 0?void 0:o.url;return(f,m)=>Oe(c,Se,Ae,i)(f,u||m)},async getPlaylistItems(t,s,n,r,o,c,d,u,f,m){var p,v,S;const y=await e.getPlaylistItems(t,s,n,r,o,c,d,u,f,m),E=(p=i==null?void 0:i.serverIndex)!==null&&p!==void 0?p:0,A=(S=(v=Re["PlaylistsApi.getPlaylistItems"])===null||v===void 0?void 0:v[E])===null||S===void 0?void 0:S.url;return(R,I)=>Oe(y,Se,Ae,i)(R,A||I)},async getPlaylistUser(t,s,n){var r,o,c;const d=await e.getPlaylistUser(t,s,n),u=(r=i==null?void 0:i.serverIndex)!==null&&r!==void 0?r:0,f=(c=(o=Re["PlaylistsApi.getPlaylistUser"])===null||o===void 0?void 0:o[u])===null||c===void 0?void 0:c.url;return(m,p)=>Oe(d,Se,Ae,i)(m,f||p)},async getPlaylistUsers(t,s){var n,r,o;const c=await e.getPlaylistUsers(t,s),d=(n=i==null?void 0:i.serverIndex)!==null&&n!==void 0?n:0,u=(o=(r=Re["PlaylistsApi.getPlaylistUsers"])===null||r===void 0?void 0:r[d])===null||o===void 0?void 0:o.url;return(f,m)=>Oe(c,Se,Ae,i)(f,u||m)},async moveItem(t,s,n,r){var o,c,d;const u=await e.moveItem(t,s,n,r),f=(o=i==null?void 0:i.serverIndex)!==null&&o!==void 0?o:0,m=(d=(c=Re["PlaylistsApi.moveItem"])===null||c===void 0?void 0:c[f])===null||d===void 0?void 0:d.url;return(p,v)=>Oe(u,Se,Ae,i)(p,m||v)},async removeItemFromPlaylist(t,s,n){var r,o,c;const d=await e.removeItemFromPlaylist(t,s,n),u=(r=i==null?void 0:i.serverIndex)!==null&&r!==void 0?r:0,f=(c=(o=Re["PlaylistsApi.removeItemFromPlaylist"])===null||o===void 0?void 0:o[u])===null||c===void 0?void 0:c.url;return(m,p)=>Oe(d,Se,Ae,i)(m,f||p)},async removeUserFromPlaylist(t,s,n){var r,o,c;const d=await e.removeUserFromPlaylist(t,s,n),u=(r=i==null?void 0:i.serverIndex)!==null&&r!==void 0?r:0,f=(c=(o=Re["PlaylistsApi.removeUserFromPlaylist"])===null||o===void 0?void 0:o[u])===null||c===void 0?void 0:c.url;return(m,p)=>Oe(d,Se,Ae,i)(m,f||p)},async updatePlaylist(t,s,n){var r,o,c;const d=await e.updatePlaylist(t,s,n),u=(r=i==null?void 0:i.serverIndex)!==null&&r!==void 0?r:0,f=(c=(o=Re["PlaylistsApi.updatePlaylist"])===null||o===void 0?void 0:o[u])===null||c===void 0?void 0:c.url;return(m,p)=>Oe(d,Se,Ae,i)(m,f||p)},async updatePlaylistUser(t,s,n,r){var o,c,d;const u=await e.updatePlaylistUser(t,s,n,r),f=(o=i==null?void 0:i.serverIndex)!==null&&o!==void 0?o:0,m=(d=(c=Re["PlaylistsApi.updatePlaylistUser"])===null||c===void 0?void 0:c[f])===null||d===void 0?void 0:d.url;return(p,v)=>Oe(u,Se,Ae,i)(p,m||v)}}};class Ig extends Nn{addItemToPlaylist(e,t){return en(this.configuration).addItemToPlaylist(e.playlistId,e.ids,e.userId,t).then(s=>s(this.axios,this.basePath))}createPlaylist(e={},t){return en(this.configuration).createPlaylist(e.name,e.ids,e.userId,e.mediaType,e.createPlaylistDto,t).then(s=>s(this.axios,this.basePath))}getPlaylist(e,t){return en(this.configuration).getPlaylist(e.playlistId,t).then(s=>s(this.axios,this.basePath))}getPlaylistItems(e,t){return en(this.configuration).getPlaylistItems(e.playlistId,e.userId,e.startIndex,e.limit,e.fields,e.enableImages,e.enableUserData,e.imageTypeLimit,e.enableImageTypes,t).then(s=>s(this.axios,this.basePath))}getPlaylistUser(e,t){return en(this.configuration).getPlaylistUser(e.playlistId,e.userId,t).then(s=>s(this.axios,this.basePath))}getPlaylistUsers(e,t){return en(this.configuration).getPlaylistUsers(e.playlistId,t).then(s=>s(this.axios,this.basePath))}moveItem(e,t){return en(this.configuration).moveItem(e.playlistId,e.itemId,e.newIndex,t).then(s=>s(this.axios,this.basePath))}removeItemFromPlaylist(e,t){return en(this.configuration).removeItemFromPlaylist(e.playlistId,e.entryIds,t).then(s=>s(this.axios,this.basePath))}removeUserFromPlaylist(e,t){return en(this.configuration).removeUserFromPlaylist(e.playlistId,e.userId,t).then(s=>s(this.axios,this.basePath))}updatePlaylist(e,t){return en(this.configuration).updatePlaylist(e.playlistId,e.updatePlaylistDto,t).then(s=>s(this.axios,this.basePath))}updatePlaylistUser(e,t){return en(this.configuration).updatePlaylistUser(e.playlistId,e.userId,e.updatePlaylistUserDto,t).then(s=>s(this.axios,this.basePath))}}const rP=function(i){return{markPlayedItem:async(e,t,s,n={})=>{Pe("markPlayedItem","itemId",e);const r="/UserPlayedItems/{itemId}".replace("{itemId}",encodeURIComponent(String(e))),o=new URL(r,Le);let c;i&&(c=i.baseOptions);const d={method:"POST",...c,...n},u={},f={};await ke(u,"Authorization",i),t!==void 0&&(f.userId=t),s!==void 0&&(f.datePlayed=s instanceof Date?s.toISOString():s),we(o,f);let m=c&&c.headers?c.headers:{};return d.headers={...u,...m,...n.headers},{url:Ce(o),options:d}},markUnplayedItem:async(e,t,s={})=>{Pe("markUnplayedItem","itemId",e);const n="/UserPlayedItems/{itemId}".replace("{itemId}",encodeURIComponent(String(e))),r=new URL(n,Le);let o;i&&(o=i.baseOptions);const c={method:"DELETE",...o,...s},d={},u={};await ke(d,"Authorization",i),t!==void 0&&(u.userId=t),we(r,u);let f=o&&o.headers?o.headers:{};return c.headers={...d,...f,...s.headers},{url:Ce(r),options:c}},onPlaybackProgress:async(e,t,s,n,r,o,c,d,u,f,m,p,v={})=>{Pe("onPlaybackProgress","itemId",e);const S="/PlayingItems/{itemId}/Progress".replace("{itemId}",encodeURIComponent(String(e))),y=new URL(S,Le);let E;i&&(E=i.baseOptions);const A={method:"POST",...E,...v},R={},I={};await ke(R,"Authorization",i),t!==void 0&&(I.mediaSourceId=t),s!==void 0&&(I.positionTicks=s),n!==void 0&&(I.audioStreamIndex=n),r!==void 0&&(I.subtitleStreamIndex=r),o!==void 0&&(I.volumeLevel=o),c!==void 0&&(I.playMethod=c),d!==void 0&&(I.liveStreamId=d),u!==void 0&&(I.playSessionId=u),f!==void 0&&(I.repeatMode=f),m!==void 0&&(I.isPaused=m),p!==void 0&&(I.isMuted=p),we(y,I);let C=E&&E.headers?E.headers:{};return A.headers={...R,...C,...v.headers},{url:Ce(y),options:A}},onPlaybackStart:async(e,t,s,n,r,o,c,d,u={})=>{Pe("onPlaybackStart","itemId",e);const f="/PlayingItems/{itemId}".replace("{itemId}",encodeURIComponent(String(e))),m=new URL(f,Le);let p;i&&(p=i.baseOptions);const v={method:"POST",...p,...u},S={},y={};await ke(S,"Authorization",i),t!==void 0&&(y.mediaSourceId=t),s!==void 0&&(y.audioStreamIndex=s),n!==void 0&&(y.subtitleStreamIndex=n),r!==void 0&&(y.playMethod=r),o!==void 0&&(y.liveStreamId=o),c!==void 0&&(y.playSessionId=c),d!==void 0&&(y.canSeek=d),we(m,y);let E=p&&p.headers?p.headers:{};return v.headers={...S,...E,...u.headers},{url:Ce(m),options:v}},onPlaybackStopped:async(e,t,s,n,r,o,c={})=>{Pe("onPlaybackStopped","itemId",e);const d="/PlayingItems/{itemId}".replace("{itemId}",encodeURIComponent(String(e))),u=new URL(d,Le);let f;i&&(f=i.baseOptions);const m={method:"DELETE",...f,...c},p={},v={};await ke(p,"Authorization",i),t!==void 0&&(v.mediaSourceId=t),s!==void 0&&(v.nextMediaType=s),n!==void 0&&(v.positionTicks=n),r!==void 0&&(v.liveStreamId=r),o!==void 0&&(v.playSessionId=o),we(u,v);let S=f&&f.headers?f.headers:{};return m.headers={...p,...S,...c.headers},{url:Ce(u),options:m}},pingPlaybackSession:async(e,t={})=>{Pe("pingPlaybackSession","playSessionId",e);const s="/Sessions/Playing/Ping",n=new URL(s,Le);let r;i&&(r=i.baseOptions);const o={method:"POST",...r,...t},c={},d={};await ke(c,"Authorization",i),e!==void 0&&(d.playSessionId=e),we(n,d);let u=r&&r.headers?r.headers:{};return o.headers={...c,...u,...t.headers},{url:Ce(n),options:o}},reportPlaybackProgress:async(e,t={})=>{const s="/Sessions/Playing/Progress",n=new URL(s,Le);let r;i&&(r=i.baseOptions);const o={method:"POST",...r,...t},c={},d={};await ke(c,"Authorization",i),c["Content-Type"]="application/json",we(n,d);let u=r&&r.headers?r.headers:{};return o.headers={...c,...u,...t.headers},o.data=xs(e,o,i),{url:Ce(n),options:o}},reportPlaybackStart:async(e,t={})=>{const s="/Sessions/Playing",n=new URL(s,Le);let r;i&&(r=i.baseOptions);const o={method:"POST",...r,...t},c={},d={};await ke(c,"Authorization",i),c["Content-Type"]="application/json",we(n,d);let u=r&&r.headers?r.headers:{};return o.headers={...c,...u,...t.headers},o.data=xs(e,o,i),{url:Ce(n),options:o}},reportPlaybackStopped:async(e,t={})=>{const s="/Sessions/Playing/Stopped",n=new URL(s,Le);let r;i&&(r=i.baseOptions);const o={method:"POST",...r,...t},c={},d={};await ke(c,"Authorization",i),c["Content-Type"]="application/json",we(n,d);let u=r&&r.headers?r.headers:{};return o.headers={...c,...u,...t.headers},o.data=xs(e,o,i),{url:Ce(n),options:o}}}},sr=function(i){const e=rP(i);return{async markPlayedItem(t,s,n,r){var o,c,d;const u=await e.markPlayedItem(t,s,n,r),f=(o=i==null?void 0:i.serverIndex)!==null&&o!==void 0?o:0,m=(d=(c=Re["PlaystateApi.markPlayedItem"])===null||c===void 0?void 0:c[f])===null||d===void 0?void 0:d.url;return(p,v)=>Oe(u,Se,Ae,i)(p,m||v)},async markUnplayedItem(t,s,n){var r,o,c;const d=await e.markUnplayedItem(t,s,n),u=(r=i==null?void 0:i.serverIndex)!==null&&r!==void 0?r:0,f=(c=(o=Re["PlaystateApi.markUnplayedItem"])===null||o===void 0?void 0:o[u])===null||c===void 0?void 0:c.url;return(m,p)=>Oe(d,Se,Ae,i)(m,f||p)},async onPlaybackProgress(t,s,n,r,o,c,d,u,f,m,p,v,S){var y,E,A;const R=await e.onPlaybackProgress(t,s,n,r,o,c,d,u,f,m,p,v,S),I=(y=i==null?void 0:i.serverIndex)!==null&&y!==void 0?y:0,C=(A=(E=Re["PlaystateApi.onPlaybackProgress"])===null||E===void 0?void 0:E[I])===null||A===void 0?void 0:A.url;return(L,D)=>Oe(R,Se,Ae,i)(L,C||D)},async onPlaybackStart(t,s,n,r,o,c,d,u,f){var m,p,v;const S=await e.onPlaybackStart(t,s,n,r,o,c,d,u,f),y=(m=i==null?void 0:i.serverIndex)!==null&&m!==void 0?m:0,E=(v=(p=Re["PlaystateApi.onPlaybackStart"])===null||p===void 0?void 0:p[y])===null||v===void 0?void 0:v.url;return(A,R)=>Oe(S,Se,Ae,i)(A,E||R)},async onPlaybackStopped(t,s,n,r,o,c,d){var u,f,m;const p=await e.onPlaybackStopped(t,s,n,r,o,c,d),v=(u=i==null?void 0:i.serverIndex)!==null&&u!==void 0?u:0,S=(m=(f=Re["PlaystateApi.onPlaybackStopped"])===null||f===void 0?void 0:f[v])===null||m===void 0?void 0:m.url;return(y,E)=>Oe(p,Se,Ae,i)(y,S||E)},async pingPlaybackSession(t,s){var n,r,o;const c=await e.pingPlaybackSession(t,s),d=(n=i==null?void 0:i.serverIndex)!==null&&n!==void 0?n:0,u=(o=(r=Re["PlaystateApi.pingPlaybackSession"])===null||r===void 0?void 0:r[d])===null||o===void 0?void 0:o.url;return(f,m)=>Oe(c,Se,Ae,i)(f,u||m)},async reportPlaybackProgress(t,s){var n,r,o;const c=await e.reportPlaybackProgress(t,s),d=(n=i==null?void 0:i.serverIndex)!==null&&n!==void 0?n:0,u=(o=(r=Re["PlaystateApi.reportPlaybackProgress"])===null||r===void 0?void 0:r[d])===null||o===void 0?void 0:o.url;return(f,m)=>Oe(c,Se,Ae,i)(f,u||m)},async reportPlaybackStart(t,s){var n,r,o;const c=await e.reportPlaybackStart(t,s),d=(n=i==null?void 0:i.serverIndex)!==null&&n!==void 0?n:0,u=(o=(r=Re["PlaystateApi.reportPlaybackStart"])===null||r===void 0?void 0:r[d])===null||o===void 0?void 0:o.url;return(f,m)=>Oe(c,Se,Ae,i)(f,u||m)},async reportPlaybackStopped(t,s){var n,r,o;const c=await e.reportPlaybackStopped(t,s),d=(n=i==null?void 0:i.serverIndex)!==null&&n!==void 0?n:0,u=(o=(r=Re["PlaystateApi.reportPlaybackStopped"])===null||r===void 0?void 0:r[d])===null||o===void 0?void 0:o.url;return(f,m)=>Oe(c,Se,Ae,i)(f,u||m)}}};class Rg extends Nn{markPlayedItem(e,t){return sr(this.configuration).markPlayedItem(e.itemId,e.userId,e.datePlayed,t).then(s=>s(this.axios,this.basePath))}markUnplayedItem(e,t){return sr(this.configuration).markUnplayedItem(e.itemId,e.userId,t).then(s=>s(this.axios,this.basePath))}onPlaybackProgress(e,t){return sr(this.configuration).onPlaybackProgress(e.itemId,e.mediaSourceId,e.positionTicks,e.audioStreamIndex,e.subtitleStreamIndex,e.volumeLevel,e.playMethod,e.liveStreamId,e.playSessionId,e.repeatMode,e.isPaused,e.isMuted,t).then(s=>s(this.axios,this.basePath))}onPlaybackStart(e,t){return sr(this.configuration).onPlaybackStart(e.itemId,e.mediaSourceId,e.audioStreamIndex,e.subtitleStreamIndex,e.playMethod,e.liveStreamId,e.playSessionId,e.canSeek,t).then(s=>s(this.axios,this.basePath))}onPlaybackStopped(e,t){return sr(this.configuration).onPlaybackStopped(e.itemId,e.mediaSourceId,e.nextMediaType,e.positionTicks,e.liveStreamId,e.playSessionId,t).then(s=>s(this.axios,this.basePath))}pingPlaybackSession(e,t){return sr(this.configuration).pingPlaybackSession(e.playSessionId,t).then(s=>s(this.axios,this.basePath))}reportPlaybackProgress(e={},t){return sr(this.configuration).reportPlaybackProgress(e.playbackProgressInfo,t).then(s=>s(this.axios,this.basePath))}reportPlaybackStart(e={},t){return sr(this.configuration).reportPlaybackStart(e.playbackStartInfo,t).then(s=>s(this.axios,this.basePath))}reportPlaybackStopped(e={},t){return sr(this.configuration).reportPlaybackStopped(e.playbackStopInfo,t).then(s=>s(this.axios,this.basePath))}}const aP=function(i){return{addUserToSession:async(e,t,s={})=>{Pe("addUserToSession","sessionId",e),Pe("addUserToSession","userId",t);const n="/Sessions/{sessionId}/User/{userId}".replace("{sessionId}",encodeURIComponent(String(e))).replace("{userId}",encodeURIComponent(String(t))),r=new URL(n,Le);let o;i&&(o=i.baseOptions);const c={method:"POST",...o,...s},d={},u={};await ke(d,"Authorization",i),we(r,u);let f=o&&o.headers?o.headers:{};return c.headers={...d,...f,...s.headers},{url:Ce(r),options:c}},displayContent:async(e,t,s,n,r={})=>{Pe("displayContent","sessionId",e),Pe("displayContent","itemType",t),Pe("displayContent","itemId",s),Pe("displayContent","itemName",n);const o="/Sessions/{sessionId}/Viewing".replace("{sessionId}",encodeURIComponent(String(e))),c=new URL(o,Le);let d;i&&(d=i.baseOptions);const u={method:"POST",...d,...r},f={},m={};await ke(f,"Authorization",i),t!==void 0&&(m.itemType=t),s!==void 0&&(m.itemId=s),n!==void 0&&(m.itemName=n),we(c,m);let p=d&&d.headers?d.headers:{};return u.headers={...f,...p,...r.headers},{url:Ce(c),options:u}},getAuthProviders:async(e={})=>{const t="/Auth/Providers",s=new URL(t,Le);let n;i&&(n=i.baseOptions);const r={method:"GET",...n,...e},o={},c={};await ke(o,"Authorization",i),we(s,c);let d=n&&n.headers?n.headers:{};return r.headers={...o,...d,...e.headers},{url:Ce(s),options:r}},getPasswordResetProviders:async(e={})=>{const t="/Auth/PasswordResetProviders",s=new URL(t,Le);let n;i&&(n=i.baseOptions);const r={method:"GET",...n,...e},o={},c={};await ke(o,"Authorization",i),we(s,c);let d=n&&n.headers?n.headers:{};return r.headers={...o,...d,...e.headers},{url:Ce(s),options:r}},getSessions:async(e,t,s,n={})=>{const r="/Sessions",o=new URL(r,Le);let c;i&&(c=i.baseOptions);const d={method:"GET",...c,...n},u={},f={};await ke(u,"Authorization",i),e!==void 0&&(f.controllableByUserId=e),t!==void 0&&(f.deviceId=t),s!==void 0&&(f.activeWithinSeconds=s),we(o,f);let m=c&&c.headers?c.headers:{};return d.headers={...u,...m,...n.headers},{url:Ce(o),options:d}},play:async(e,t,s,n,r,o,c,d,u={})=>{Pe("play","sessionId",e),Pe("play","playCommand",t),Pe("play","itemIds",s);const f="/Sessions/{sessionId}/Playing".replace("{sessionId}",encodeURIComponent(String(e))),m=new URL(f,Le);let p;i&&(p=i.baseOptions);const v={method:"POST",...p,...u},S={},y={};await ke(S,"Authorization",i),t!==void 0&&(y.playCommand=t),s&&(y.itemIds=s),n!==void 0&&(y.startPositionTicks=n),r!==void 0&&(y.mediaSourceId=r),o!==void 0&&(y.audioStreamIndex=o),c!==void 0&&(y.subtitleStreamIndex=c),d!==void 0&&(y.startIndex=d),we(m,y);let E=p&&p.headers?p.headers:{};return v.headers={...S,...E,...u.headers},{url:Ce(m),options:v}},postCapabilities:async(e,t,s,n,r,o={})=>{const c="/Sessions/Capabilities",d=new URL(c,Le);let u;i&&(u=i.baseOptions);const f={method:"POST",...u,...o},m={},p={};await ke(m,"Authorization",i),e!==void 0&&(p.id=e),t&&(p.playableMediaTypes=t),s&&(p.supportedCommands=s),n!==void 0&&(p.supportsMediaControl=n),r!==void 0&&(p.supportsPersistentIdentifier=r),we(d,p);let v=u&&u.headers?u.headers:{};return f.headers={...m,...v,...o.headers},{url:Ce(d),options:f}},postFullCapabilities:async(e,t,s={})=>{Pe("postFullCapabilities","clientCapabilitiesDto",e);const n="/Sessions/Capabilities/Full",r=new URL(n,Le);let o;i&&(o=i.baseOptions);const c={method:"POST",...o,...s},d={},u={};await ke(d,"Authorization",i),t!==void 0&&(u.id=t),d["Content-Type"]="application/json",we(r,u);let f=o&&o.headers?o.headers:{};return c.headers={...d,...f,...s.headers},c.data=xs(e,c,i),{url:Ce(r),options:c}},removeUserFromSession:async(e,t,s={})=>{Pe("removeUserFromSession","sessionId",e),Pe("removeUserFromSession","userId",t);const n="/Sessions/{sessionId}/User/{userId}".replace("{sessionId}",encodeURIComponent(String(e))).replace("{userId}",encodeURIComponent(String(t))),r=new URL(n,Le);let o;i&&(o=i.baseOptions);const c={method:"DELETE",...o,...s},d={},u={};await ke(d,"Authorization",i),we(r,u);let f=o&&o.headers?o.headers:{};return c.headers={...d,...f,...s.headers},{url:Ce(r),options:c}},reportSessionEnded:async(e={})=>{const t="/Sessions/Logout",s=new URL(t,Le);let n;i&&(n=i.baseOptions);const r={method:"POST",...n,...e},o={},c={};await ke(o,"Authorization",i),we(s,c);let d=n&&n.headers?n.headers:{};return r.headers={...o,...d,...e.headers},{url:Ce(s),options:r}},reportViewing:async(e,t,s={})=>{Pe("reportViewing","itemId",e);const n="/Sessions/Viewing",r=new URL(n,Le);let o;i&&(o=i.baseOptions);const c={method:"POST",...o,...s},d={},u={};await ke(d,"Authorization",i),t!==void 0&&(u.sessionId=t),e!==void 0&&(u.itemId=e),we(r,u);let f=o&&o.headers?o.headers:{};return c.headers={...d,...f,...s.headers},{url:Ce(r),options:c}},sendFullGeneralCommand:async(e,t,s={})=>{Pe("sendFullGeneralCommand","sessionId",e),Pe("sendFullGeneralCommand","generalCommand",t);const n="/Sessions/{sessionId}/Command".replace("{sessionId}",encodeURIComponent(String(e))),r=new URL(n,Le);let o;i&&(o=i.baseOptions);const c={method:"POST",...o,...s},d={},u={};await ke(d,"Authorization",i),d["Content-Type"]="application/json",we(r,u);let f=o&&o.headers?o.headers:{};return c.headers={...d,...f,...s.headers},c.data=xs(t,c,i),{url:Ce(r),options:c}},sendGeneralCommand:async(e,t,s={})=>{Pe("sendGeneralCommand","sessionId",e),Pe("sendGeneralCommand","command",t);const n="/Sessions/{sessionId}/Command/{command}".replace("{sessionId}",encodeURIComponent(String(e))).replace("{command}",encodeURIComponent(String(t))),r=new URL(n,Le);let o;i&&(o=i.baseOptions);const c={method:"POST",...o,...s},d={},u={};await ke(d,"Authorization",i),we(r,u);let f=o&&o.headers?o.headers:{};return c.headers={...d,...f,...s.headers},{url:Ce(r),options:c}},sendMessageCommand:async(e,t,s={})=>{Pe("sendMessageCommand","sessionId",e),Pe("sendMessageCommand","messageCommand",t);const n="/Sessions/{sessionId}/Message".replace("{sessionId}",encodeURIComponent(String(e))),r=new URL(n,Le);let o;i&&(o=i.baseOptions);const c={method:"POST",...o,...s},d={},u={};await ke(d,"Authorization",i),d["Content-Type"]="application/json",we(r,u);let f=o&&o.headers?o.headers:{};return c.headers={...d,...f,...s.headers},c.data=xs(t,c,i),{url:Ce(r),options:c}},sendPlaystateCommand:async(e,t,s,n,r={})=>{Pe("sendPlaystateCommand","sessionId",e),Pe("sendPlaystateCommand","command",t);const o="/Sessions/{sessionId}/Playing/{command}".replace("{sessionId}",encodeURIComponent(String(e))).replace("{command}",encodeURIComponent(String(t))),c=new URL(o,Le);let d;i&&(d=i.baseOptions);const u={method:"POST",...d,...r},f={},m={};await ke(f,"Authorization",i),s!==void 0&&(m.seekPositionTicks=s),n!==void 0&&(m.controllingUserId=n),we(c,m);let p=d&&d.headers?d.headers:{};return u.headers={...f,...p,...r.headers},{url:Ce(c),options:u}},sendSystemCommand:async(e,t,s={})=>{Pe("sendSystemCommand","sessionId",e),Pe("sendSystemCommand","command",t);const n="/Sessions/{sessionId}/System/{command}".replace("{sessionId}",encodeURIComponent(String(e))).replace("{command}",encodeURIComponent(String(t))),r=new URL(n,Le);let o;i&&(o=i.baseOptions);const c={method:"POST",...o,...s},d={},u={};await ke(d,"Authorization",i),we(r,u);let f=o&&o.headers?o.headers:{};return c.headers={...d,...f,...s.headers},{url:Ce(r),options:c}}}},$s=function(i){const e=aP(i);return{async addUserToSession(t,s,n){var r,o,c;const d=await e.addUserToSession(t,s,n),u=(r=i==null?void 0:i.serverIndex)!==null&&r!==void 0?r:0,f=(c=(o=Re["SessionApi.addUserToSession"])===null||o===void 0?void 0:o[u])===null||c===void 0?void 0:c.url;return(m,p)=>Oe(d,Se,Ae,i)(m,f||p)},async displayContent(t,s,n,r,o){var c,d,u;const f=await e.displayContent(t,s,n,r,o),m=(c=i==null?void 0:i.serverIndex)!==null&&c!==void 0?c:0,p=(u=(d=Re["SessionApi.displayContent"])===null||d===void 0?void 0:d[m])===null||u===void 0?void 0:u.url;return(v,S)=>Oe(f,Se,Ae,i)(v,p||S)},async getAuthProviders(t){var s,n,r;const o=await e.getAuthProviders(t),c=(s=i==null?void 0:i.serverIndex)!==null&&s!==void 0?s:0,d=(r=(n=Re["SessionApi.getAuthProviders"])===null||n===void 0?void 0:n[c])===null||r===void 0?void 0:r.url;return(u,f)=>Oe(o,Se,Ae,i)(u,d||f)},async getPasswordResetProviders(t){var s,n,r;const o=await e.getPasswordResetProviders(t),c=(s=i==null?void 0:i.serverIndex)!==null&&s!==void 0?s:0,d=(r=(n=Re["SessionApi.getPasswordResetProviders"])===null||n===void 0?void 0:n[c])===null||r===void 0?void 0:r.url;return(u,f)=>Oe(o,Se,Ae,i)(u,d||f)},async getSessions(t,s,n,r){var o,c,d;const u=await e.getSessions(t,s,n,r),f=(o=i==null?void 0:i.serverIndex)!==null&&o!==void 0?o:0,m=(d=(c=Re["SessionApi.getSessions"])===null||c===void 0?void 0:c[f])===null||d===void 0?void 0:d.url;return(p,v)=>Oe(u,Se,Ae,i)(p,m||v)},async play(t,s,n,r,o,c,d,u,f){var m,p,v;const S=await e.play(t,s,n,r,o,c,d,u,f),y=(m=i==null?void 0:i.serverIndex)!==null&&m!==void 0?m:0,E=(v=(p=Re["SessionApi.play"])===null||p===void 0?void 0:p[y])===null||v===void 0?void 0:v.url;return(A,R)=>Oe(S,Se,Ae,i)(A,E||R)},async postCapabilities(t,s,n,r,o,c){var d,u,f;const m=await e.postCapabilities(t,s,n,r,o,c),p=(d=i==null?void 0:i.serverIndex)!==null&&d!==void 0?d:0,v=(f=(u=Re["SessionApi.postCapabilities"])===null||u===void 0?void 0:u[p])===null||f===void 0?void 0:f.url;return(S,y)=>Oe(m,Se,Ae,i)(S,v||y)},async postFullCapabilities(t,s,n){var r,o,c;const d=await e.postFullCapabilities(t,s,n),u=(r=i==null?void 0:i.serverIndex)!==null&&r!==void 0?r:0,f=(c=(o=Re["SessionApi.postFullCapabilities"])===null||o===void 0?void 0:o[u])===null||c===void 0?void 0:c.url;return(m,p)=>Oe(d,Se,Ae,i)(m,f||p)},async removeUserFromSession(t,s,n){var r,o,c;const d=await e.removeUserFromSession(t,s,n),u=(r=i==null?void 0:i.serverIndex)!==null&&r!==void 0?r:0,f=(c=(o=Re["SessionApi.removeUserFromSession"])===null||o===void 0?void 0:o[u])===null||c===void 0?void 0:c.url;return(m,p)=>Oe(d,Se,Ae,i)(m,f||p)},async reportSessionEnded(t){var s,n,r;const o=await e.reportSessionEnded(t),c=(s=i==null?void 0:i.serverIndex)!==null&&s!==void 0?s:0,d=(r=(n=Re["SessionApi.reportSessionEnded"])===null||n===void 0?void 0:n[c])===null||r===void 0?void 0:r.url;return(u,f)=>Oe(o,Se,Ae,i)(u,d||f)},async reportViewing(t,s,n){var r,o,c;const d=await e.reportViewing(t,s,n),u=(r=i==null?void 0:i.serverIndex)!==null&&r!==void 0?r:0,f=(c=(o=Re["SessionApi.reportViewing"])===null||o===void 0?void 0:o[u])===null||c===void 0?void 0:c.url;return(m,p)=>Oe(d,Se,Ae,i)(m,f||p)},async sendFullGeneralCommand(t,s,n){var r,o,c;const d=await e.sendFullGeneralCommand(t,s,n),u=(r=i==null?void 0:i.serverIndex)!==null&&r!==void 0?r:0,f=(c=(o=Re["SessionApi.sendFullGeneralCommand"])===null||o===void 0?void 0:o[u])===null||c===void 0?void 0:c.url;return(m,p)=>Oe(d,Se,Ae,i)(m,f||p)},async sendGeneralCommand(t,s,n){var r,o,c;const d=await e.sendGeneralCommand(t,s,n),u=(r=i==null?void 0:i.serverIndex)!==null&&r!==void 0?r:0,f=(c=(o=Re["SessionApi.sendGeneralCommand"])===null||o===void 0?void 0:o[u])===null||c===void 0?void 0:c.url;return(m,p)=>Oe(d,Se,Ae,i)(m,f||p)},async sendMessageCommand(t,s,n){var r,o,c;const d=await e.sendMessageCommand(t,s,n),u=(r=i==null?void 0:i.serverIndex)!==null&&r!==void 0?r:0,f=(c=(o=Re["SessionApi.sendMessageCommand"])===null||o===void 0?void 0:o[u])===null||c===void 0?void 0:c.url;return(m,p)=>Oe(d,Se,Ae,i)(m,f||p)},async sendPlaystateCommand(t,s,n,r,o){var c,d,u;const f=await e.sendPlaystateCommand(t,s,n,r,o),m=(c=i==null?void 0:i.serverIndex)!==null&&c!==void 0?c:0,p=(u=(d=Re["SessionApi.sendPlaystateCommand"])===null||d===void 0?void 0:d[m])===null||u===void 0?void 0:u.url;return(v,S)=>Oe(f,Se,Ae,i)(v,p||S)},async sendSystemCommand(t,s,n){var r,o,c;const d=await e.sendSystemCommand(t,s,n),u=(r=i==null?void 0:i.serverIndex)!==null&&r!==void 0?r:0,f=(c=(o=Re["SessionApi.sendSystemCommand"])===null||o===void 0?void 0:o[u])===null||c===void 0?void 0:c.url;return(m,p)=>Oe(d,Se,Ae,i)(m,f||p)}}};class Wb extends Nn{addUserToSession(e,t){return $s(this.configuration).addUserToSession(e.sessionId,e.userId,t).then(s=>s(this.axios,this.basePath))}displayContent(e,t){return $s(this.configuration).displayContent(e.sessionId,e.itemType,e.itemId,e.itemName,t).then(s=>s(this.axios,this.basePath))}getAuthProviders(e){return $s(this.configuration).getAuthProviders(e).then(t=>t(this.axios,this.basePath))}getPasswordResetProviders(e){return $s(this.configuration).getPasswordResetProviders(e).then(t=>t(this.axios,this.basePath))}getSessions(e={},t){return $s(this.configuration).getSessions(e.controllableByUserId,e.deviceId,e.activeWithinSeconds,t).then(s=>s(this.axios,this.basePath))}play(e,t){return $s(this.configuration).play(e.sessionId,e.playCommand,e.itemIds,e.startPositionTicks,e.mediaSourceId,e.audioStreamIndex,e.subtitleStreamIndex,e.startIndex,t).then(s=>s(this.axios,this.basePath))}postCapabilities(e={},t){return $s(this.configuration).postCapabilities(e.id,e.playableMediaTypes,e.supportedCommands,e.supportsMediaControl,e.supportsPersistentIdentifier,t).then(s=>s(this.axios,this.basePath))}postFullCapabilities(e,t){return $s(this.configuration).postFullCapabilities(e.clientCapabilitiesDto,e.id,t).then(s=>s(this.axios,this.basePath))}removeUserFromSession(e,t){return $s(this.configuration).removeUserFromSession(e.sessionId,e.userId,t).then(s=>s(this.axios,this.basePath))}reportSessionEnded(e){return $s(this.configuration).reportSessionEnded(e).then(t=>t(this.axios,this.basePath))}reportViewing(e,t){return $s(this.configuration).reportViewing(e.itemId,e.sessionId,t).then(s=>s(this.axios,this.basePath))}sendFullGeneralCommand(e,t){return $s(this.configuration).sendFullGeneralCommand(e.sessionId,e.generalCommand,t).then(s=>s(this.axios,this.basePath))}sendGeneralCommand(e,t){return $s(this.configuration).sendGeneralCommand(e.sessionId,e.command,t).then(s=>s(this.axios,this.basePath))}sendMessageCommand(e,t){return $s(this.configuration).sendMessageCommand(e.sessionId,e.messageCommand,t).then(s=>s(this.axios,this.basePath))}sendPlaystateCommand(e,t){return $s(this.configuration).sendPlaystateCommand(e.sessionId,e.command,e.seekPositionTicks,e.controllingUserId,t).then(s=>s(this.axios,this.basePath))}sendSystemCommand(e,t){return $s(this.configuration).sendSystemCommand(e.sessionId,e.command,t).then(s=>s(this.axios,this.basePath))}}const oP=function(i){return{getEndpointInfo:async(e={})=>{const t="/System/Endpoint",s=new URL(t,Le);let n;i&&(n=i.baseOptions);const r={method:"GET",...n,...e},o={},c={};await ke(o,"Authorization",i),we(s,c);let d=n&&n.headers?n.headers:{};return r.headers={...o,...d,...e.headers},{url:Ce(s),options:r}},getLogFile:async(e,t={})=>{Pe("getLogFile","name",e);const s="/System/Logs/Log",n=new URL(s,Le);let r;i&&(r=i.baseOptions);const o={method:"GET",...r,...t},c={},d={};await ke(c,"Authorization",i),e!==void 0&&(d.name=e),we(n,d);let u=r&&r.headers?r.headers:{};return o.headers={...c,...u,...t.headers},{url:Ce(n),options:o}},getPingSystem:async(e={})=>{const t="/System/Ping",s=new URL(t,Le);let n;i&&(n=i.baseOptions);const r={method:"GET",...n,...e},o={};we(s,{});let d=n&&n.headers?n.headers:{};return r.headers={...o,...d,...e.headers},{url:Ce(s),options:r}},getPublicSystemInfo:async(e={})=>{const t="/System/Info/Public",s=new URL(t,Le);let n;i&&(n=i.baseOptions);const r={method:"GET",...n,...e},o={};we(s,{});let d=n&&n.headers?n.headers:{};return r.headers={...o,...d,...e.headers},{url:Ce(s),options:r}},getServerLogs:async(e={})=>{const t="/System/Logs",s=new URL(t,Le);let n;i&&(n=i.baseOptions);const r={method:"GET",...n,...e},o={},c={};await ke(o,"Authorization",i),we(s,c);let d=n&&n.headers?n.headers:{};return r.headers={...o,...d,...e.headers},{url:Ce(s),options:r}},getSystemInfo:async(e={})=>{const t="/System/Info",s=new URL(t,Le);let n;i&&(n=i.baseOptions);const r={method:"GET",...n,...e},o={},c={};await ke(o,"Authorization",i),we(s,c);let d=n&&n.headers?n.headers:{};return r.headers={...o,...d,...e.headers},{url:Ce(s),options:r}},getWakeOnLanInfo:async(e={})=>{const t="/System/WakeOnLanInfo",s=new URL(t,Le);let n;i&&(n=i.baseOptions);const r={method:"GET",...n,...e},o={},c={};await ke(o,"Authorization",i),we(s,c);let d=n&&n.headers?n.headers:{};return r.headers={...o,...d,...e.headers},{url:Ce(s),options:r}},postPingSystem:async(e={})=>{const t="/System/Ping",s=new URL(t,Le);let n;i&&(n=i.baseOptions);const r={method:"POST",...n,...e},o={};we(s,{});let d=n&&n.headers?n.headers:{};return r.headers={...o,...d,...e.headers},{url:Ce(s),options:r}},restartApplication:async(e={})=>{const t="/System/Restart",s=new URL(t,Le);let n;i&&(n=i.baseOptions);const r={method:"POST",...n,...e},o={},c={};await ke(o,"Authorization",i),we(s,c);let d=n&&n.headers?n.headers:{};return r.headers={...o,...d,...e.headers},{url:Ce(s),options:r}},shutdownApplication:async(e={})=>{const t="/System/Shutdown",s=new URL(t,Le);let n;i&&(n=i.baseOptions);const r={method:"POST",...n,...e},o={},c={};await ke(o,"Authorization",i),we(s,c);let d=n&&n.headers?n.headers:{};return r.headers={...o,...d,...e.headers},{url:Ce(s),options:r}}}},xn=function(i){const e=oP(i);return{async getEndpointInfo(t){var s,n,r;const o=await e.getEndpointInfo(t),c=(s=i==null?void 0:i.serverIndex)!==null&&s!==void 0?s:0,d=(r=(n=Re["SystemApi.getEndpointInfo"])===null||n===void 0?void 0:n[c])===null||r===void 0?void 0:r.url;return(u,f)=>Oe(o,Se,Ae,i)(u,d||f)},async getLogFile(t,s){var n,r,o;const c=await e.getLogFile(t,s),d=(n=i==null?void 0:i.serverIndex)!==null&&n!==void 0?n:0,u=(o=(r=Re["SystemApi.getLogFile"])===null||r===void 0?void 0:r[d])===null||o===void 0?void 0:o.url;return(f,m)=>Oe(c,Se,Ae,i)(f,u||m)},async getPingSystem(t){var s,n,r;const o=await e.getPingSystem(t),c=(s=i==null?void 0:i.serverIndex)!==null&&s!==void 0?s:0,d=(r=(n=Re["SystemApi.getPingSystem"])===null||n===void 0?void 0:n[c])===null||r===void 0?void 0:r.url;return(u,f)=>Oe(o,Se,Ae,i)(u,d||f)},async getPublicSystemInfo(t){var s,n,r;const o=await e.getPublicSystemInfo(t),c=(s=i==null?void 0:i.serverIndex)!==null&&s!==void 0?s:0,d=(r=(n=Re["SystemApi.getPublicSystemInfo"])===null||n===void 0?void 0:n[c])===null||r===void 0?void 0:r.url;return(u,f)=>Oe(o,Se,Ae,i)(u,d||f)},async getServerLogs(t){var s,n,r;const o=await e.getServerLogs(t),c=(s=i==null?void 0:i.serverIndex)!==null&&s!==void 0?s:0,d=(r=(n=Re["SystemApi.getServerLogs"])===null||n===void 0?void 0:n[c])===null||r===void 0?void 0:r.url;return(u,f)=>Oe(o,Se,Ae,i)(u,d||f)},async getSystemInfo(t){var s,n,r;const o=await e.getSystemInfo(t),c=(s=i==null?void 0:i.serverIndex)!==null&&s!==void 0?s:0,d=(r=(n=Re["SystemApi.getSystemInfo"])===null||n===void 0?void 0:n[c])===null||r===void 0?void 0:r.url;return(u,f)=>Oe(o,Se,Ae,i)(u,d||f)},async getWakeOnLanInfo(t){var s,n,r;const o=await e.getWakeOnLanInfo(t),c=(s=i==null?void 0:i.serverIndex)!==null&&s!==void 0?s:0,d=(r=(n=Re["SystemApi.getWakeOnLanInfo"])===null||n===void 0?void 0:n[c])===null||r===void 0?void 0:r.url;return(u,f)=>Oe(o,Se,Ae,i)(u,d||f)},async postPingSystem(t){var s,n,r;const o=await e.postPingSystem(t),c=(s=i==null?void 0:i.serverIndex)!==null&&s!==void 0?s:0,d=(r=(n=Re["SystemApi.postPingSystem"])===null||n===void 0?void 0:n[c])===null||r===void 0?void 0:r.url;return(u,f)=>Oe(o,Se,Ae,i)(u,d||f)},async restartApplication(t){var s,n,r;const o=await e.restartApplication(t),c=(s=i==null?void 0:i.serverIndex)!==null&&s!==void 0?s:0,d=(r=(n=Re["SystemApi.restartApplication"])===null||n===void 0?void 0:n[c])===null||r===void 0?void 0:r.url;return(u,f)=>Oe(o,Se,Ae,i)(u,d||f)},async shutdownApplication(t){var s,n,r;const o=await e.shutdownApplication(t),c=(s=i==null?void 0:i.serverIndex)!==null&&s!==void 0?s:0,d=(r=(n=Re["SystemApi.shutdownApplication"])===null||n===void 0?void 0:n[c])===null||r===void 0?void 0:r.url;return(u,f)=>Oe(o,Se,Ae,i)(u,d||f)}}};class Zb extends Nn{getEndpointInfo(e){return xn(this.configuration).getEndpointInfo(e).then(t=>t(this.axios,this.basePath))}getLogFile(e,t){return xn(this.configuration).getLogFile(e.name,t).then(s=>s(this.axios,this.basePath))}getPingSystem(e){return xn(this.configuration).getPingSystem(e).then(t=>t(this.axios,this.basePath))}getPublicSystemInfo(e){return xn(this.configuration).getPublicSystemInfo(e).then(t=>t(this.axios,this.basePath))}getServerLogs(e){return xn(this.configuration).getServerLogs(e).then(t=>t(this.axios,this.basePath))}getSystemInfo(e){return xn(this.configuration).getSystemInfo(e).then(t=>t(this.axios,this.basePath))}getWakeOnLanInfo(e){return xn(this.configuration).getWakeOnLanInfo(e).then(t=>t(this.axios,this.basePath))}postPingSystem(e){return xn(this.configuration).postPingSystem(e).then(t=>t(this.axios,this.basePath))}restartApplication(e){return xn(this.configuration).restartApplication(e).then(t=>t(this.axios,this.basePath))}shutdownApplication(e){return xn(this.configuration).shutdownApplication(e).then(t=>t(this.axios,this.basePath))}}const lP=function(i){return{authenticateUserByName:async(e,t={})=>{Pe("authenticateUserByName","authenticateUserByName",e);const s="/Users/AuthenticateByName",n=new URL(s,Le);let r;i&&(r=i.baseOptions);const o={method:"POST",...r,...t},c={},d={};c["Content-Type"]="application/json",we(n,d);let u=r&&r.headers?r.headers:{};return o.headers={...c,...u,...t.headers},o.data=xs(e,o,i),{url:Ce(n),options:o}},authenticateWithQuickConnect:async(e,t={})=>{Pe("authenticateWithQuickConnect","quickConnectDto",e);const s="/Users/AuthenticateWithQuickConnect",n=new URL(s,Le);let r;i&&(r=i.baseOptions);const o={method:"POST",...r,...t},c={},d={};c["Content-Type"]="application/json",we(n,d);let u=r&&r.headers?r.headers:{};return o.headers={...c,...u,...t.headers},o.data=xs(e,o,i),{url:Ce(n),options:o}},createUserByName:async(e,t={})=>{Pe("createUserByName","createUserByName",e);const s="/Users/New",n=new URL(s,Le);let r;i&&(r=i.baseOptions);const o={method:"POST",...r,...t},c={},d={};await ke(c,"Authorization",i),c["Content-Type"]="application/json",we(n,d);let u=r&&r.headers?r.headers:{};return o.headers={...c,...u,...t.headers},o.data=xs(e,o,i),{url:Ce(n),options:o}},deleteUser:async(e,t={})=>{Pe("deleteUser","userId",e);const s="/Users/{userId}".replace("{userId}",encodeURIComponent(String(e))),n=new URL(s,Le);let r;i&&(r=i.baseOptions);const o={method:"DELETE",...r,...t},c={},d={};await ke(c,"Authorization",i),we(n,d);let u=r&&r.headers?r.headers:{};return o.headers={...c,...u,...t.headers},{url:Ce(n),options:o}},forgotPassword:async(e,t={})=>{Pe("forgotPassword","forgotPasswordDto",e);const s="/Users/ForgotPassword",n=new URL(s,Le);let r;i&&(r=i.baseOptions);const o={method:"POST",...r,...t},c={},d={};c["Content-Type"]="application/json",we(n,d);let u=r&&r.headers?r.headers:{};return o.headers={...c,...u,...t.headers},o.data=xs(e,o,i),{url:Ce(n),options:o}},forgotPasswordPin:async(e,t={})=>{Pe("forgotPasswordPin","forgotPasswordPinDto",e);const s="/Users/ForgotPassword/Pin",n=new URL(s,Le);let r;i&&(r=i.baseOptions);const o={method:"POST",...r,...t},c={},d={};c["Content-Type"]="application/json",we(n,d);let u=r&&r.headers?r.headers:{};return o.headers={...c,...u,...t.headers},o.data=xs(e,o,i),{url:Ce(n),options:o}},getCurrentUser:async(e={})=>{const t="/Users/Me",s=new URL(t,Le);let n;i&&(n=i.baseOptions);const r={method:"GET",...n,...e},o={},c={};await ke(o,"Authorization",i),we(s,c);let d=n&&n.headers?n.headers:{};return r.headers={...o,...d,...e.headers},{url:Ce(s),options:r}},getPublicUsers:async(e={})=>{const t="/Users/Public",s=new URL(t,Le);let n;i&&(n=i.baseOptions);const r={method:"GET",...n,...e},o={};we(s,{});let d=n&&n.headers?n.headers:{};return r.headers={...o,...d,...e.headers},{url:Ce(s),options:r}},getUserById:async(e,t={})=>{Pe("getUserById","userId",e);const s="/Users/{userId}".replace("{userId}",encodeURIComponent(String(e))),n=new URL(s,Le);let r;i&&(r=i.baseOptions);const o={method:"GET",...r,...t},c={},d={};await ke(c,"Authorization",i),we(n,d);let u=r&&r.headers?r.headers:{};return o.headers={...c,...u,...t.headers},{url:Ce(n),options:o}},getUsers:async(e,t,s={})=>{const n="/Users",r=new URL(n,Le);let o;i&&(o=i.baseOptions);const c={method:"GET",...o,...s},d={},u={};await ke(d,"Authorization",i),e!==void 0&&(u.isHidden=e),t!==void 0&&(u.isDisabled=t),we(r,u);let f=o&&o.headers?o.headers:{};return c.headers={...d,...f,...s.headers},{url:Ce(r),options:c}},updateUser:async(e,t,s={})=>{Pe("updateUser","userDto",e);const n="/Users",r=new URL(n,Le);let o;i&&(o=i.baseOptions);const c={method:"POST",...o,...s},d={},u={};await ke(d,"Authorization",i),t!==void 0&&(u.userId=t),d["Content-Type"]="application/json",we(r,u);let f=o&&o.headers?o.headers:{};return c.headers={...d,...f,...s.headers},c.data=xs(e,c,i),{url:Ce(r),options:c}},updateUserConfiguration:async(e,t,s={})=>{Pe("updateUserConfiguration","userConfiguration",e);const n="/Users/Configuration",r=new URL(n,Le);let o;i&&(o=i.baseOptions);const c={method:"POST",...o,...s},d={},u={};await ke(d,"Authorization",i),t!==void 0&&(u.userId=t),d["Content-Type"]="application/json",we(r,u);let f=o&&o.headers?o.headers:{};return c.headers={...d,...f,...s.headers},c.data=xs(e,c,i),{url:Ce(r),options:c}},updateUserPassword:async(e,t,s={})=>{Pe("updateUserPassword","updateUserPassword",e);const n="/Users/Password",r=new URL(n,Le);let o;i&&(o=i.baseOptions);const c={method:"POST",...o,...s},d={},u={};await ke(d,"Authorization",i),t!==void 0&&(u.userId=t),d["Content-Type"]="application/json",we(r,u);let f=o&&o.headers?o.headers:{};return c.headers={...d,...f,...s.headers},c.data=xs(e,c,i),{url:Ce(r),options:c}},updateUserPolicy:async(e,t,s={})=>{Pe("updateUserPolicy","userId",e),Pe("updateUserPolicy","userPolicy",t);const n="/Users/{userId}/Policy".replace("{userId}",encodeURIComponent(String(e))),r=new URL(n,Le);let o;i&&(o=i.baseOptions);const c={method:"POST",...o,...s},d={},u={};await ke(d,"Authorization",i),d["Content-Type"]="application/json",we(r,u);let f=o&&o.headers?o.headers:{};return c.headers={...d,...f,...s.headers},c.data=xs(t,c,i),{url:Ce(r),options:c}}}},li=function(i){const e=lP(i);return{async authenticateUserByName(t,s){var n,r,o;const c=await e.authenticateUserByName(t,s),d=(n=i==null?void 0:i.serverIndex)!==null&&n!==void 0?n:0,u=(o=(r=Re["UserApi.authenticateUserByName"])===null||r===void 0?void 0:r[d])===null||o===void 0?void 0:o.url;return(f,m)=>Oe(c,Se,Ae,i)(f,u||m)},async authenticateWithQuickConnect(t,s){var n,r,o;const c=await e.authenticateWithQuickConnect(t,s),d=(n=i==null?void 0:i.serverIndex)!==null&&n!==void 0?n:0,u=(o=(r=Re["UserApi.authenticateWithQuickConnect"])===null||r===void 0?void 0:r[d])===null||o===void 0?void 0:o.url;return(f,m)=>Oe(c,Se,Ae,i)(f,u||m)},async createUserByName(t,s){var n,r,o;const c=await e.createUserByName(t,s),d=(n=i==null?void 0:i.serverIndex)!==null&&n!==void 0?n:0,u=(o=(r=Re["UserApi.createUserByName"])===null||r===void 0?void 0:r[d])===null||o===void 0?void 0:o.url;return(f,m)=>Oe(c,Se,Ae,i)(f,u||m)},async deleteUser(t,s){var n,r,o;const c=await e.deleteUser(t,s),d=(n=i==null?void 0:i.serverIndex)!==null&&n!==void 0?n:0,u=(o=(r=Re["UserApi.deleteUser"])===null||r===void 0?void 0:r[d])===null||o===void 0?void 0:o.url;return(f,m)=>Oe(c,Se,Ae,i)(f,u||m)},async forgotPassword(t,s){var n,r,o;const c=await e.forgotPassword(t,s),d=(n=i==null?void 0:i.serverIndex)!==null&&n!==void 0?n:0,u=(o=(r=Re["UserApi.forgotPassword"])===null||r===void 0?void 0:r[d])===null||o===void 0?void 0:o.url;return(f,m)=>Oe(c,Se,Ae,i)(f,u||m)},async forgotPasswordPin(t,s){var n,r,o;const c=await e.forgotPasswordPin(t,s),d=(n=i==null?void 0:i.serverIndex)!==null&&n!==void 0?n:0,u=(o=(r=Re["UserApi.forgotPasswordPin"])===null||r===void 0?void 0:r[d])===null||o===void 0?void 0:o.url;return(f,m)=>Oe(c,Se,Ae,i)(f,u||m)},async getCurrentUser(t){var s,n,r;const o=await e.getCurrentUser(t),c=(s=i==null?void 0:i.serverIndex)!==null&&s!==void 0?s:0,d=(r=(n=Re["UserApi.getCurrentUser"])===null||n===void 0?void 0:n[c])===null||r===void 0?void 0:r.url;return(u,f)=>Oe(o,Se,Ae,i)(u,d||f)},async getPublicUsers(t){var s,n,r;const o=await e.getPublicUsers(t),c=(s=i==null?void 0:i.serverIndex)!==null&&s!==void 0?s:0,d=(r=(n=Re["UserApi.getPublicUsers"])===null||n===void 0?void 0:n[c])===null||r===void 0?void 0:r.url;return(u,f)=>Oe(o,Se,Ae,i)(u,d||f)},async getUserById(t,s){var n,r,o;const c=await e.getUserById(t,s),d=(n=i==null?void 0:i.serverIndex)!==null&&n!==void 0?n:0,u=(o=(r=Re["UserApi.getUserById"])===null||r===void 0?void 0:r[d])===null||o===void 0?void 0:o.url;return(f,m)=>Oe(c,Se,Ae,i)(f,u||m)},async getUsers(t,s,n){var r,o,c;const d=await e.getUsers(t,s,n),u=(r=i==null?void 0:i.serverIndex)!==null&&r!==void 0?r:0,f=(c=(o=Re["UserApi.getUsers"])===null||o===void 0?void 0:o[u])===null||c===void 0?void 0:c.url;return(m,p)=>Oe(d,Se,Ae,i)(m,f||p)},async updateUser(t,s,n){var r,o,c;const d=await e.updateUser(t,s,n),u=(r=i==null?void 0:i.serverIndex)!==null&&r!==void 0?r:0,f=(c=(o=Re["UserApi.updateUser"])===null||o===void 0?void 0:o[u])===null||c===void 0?void 0:c.url;return(m,p)=>Oe(d,Se,Ae,i)(m,f||p)},async updateUserConfiguration(t,s,n){var r,o,c;const d=await e.updateUserConfiguration(t,s,n),u=(r=i==null?void 0:i.serverIndex)!==null&&r!==void 0?r:0,f=(c=(o=Re["UserApi.updateUserConfiguration"])===null||o===void 0?void 0:o[u])===null||c===void 0?void 0:c.url;return(m,p)=>Oe(d,Se,Ae,i)(m,f||p)},async updateUserPassword(t,s,n){var r,o,c;const d=await e.updateUserPassword(t,s,n),u=(r=i==null?void 0:i.serverIndex)!==null&&r!==void 0?r:0,f=(c=(o=Re["UserApi.updateUserPassword"])===null||o===void 0?void 0:o[u])===null||c===void 0?void 0:c.url;return(m,p)=>Oe(d,Se,Ae,i)(m,f||p)},async updateUserPolicy(t,s,n){var r,o,c;const d=await e.updateUserPolicy(t,s,n),u=(r=i==null?void 0:i.serverIndex)!==null&&r!==void 0?r:0,f=(c=(o=Re["UserApi.updateUserPolicy"])===null||o===void 0?void 0:o[u])===null||c===void 0?void 0:c.url;return(m,p)=>Oe(d,Se,Ae,i)(m,f||p)}}};class Jb extends Nn{authenticateUserByName(e,t){return li(this.configuration).authenticateUserByName(e.authenticateUserByName,t).then(s=>s(this.axios,this.basePath))}authenticateWithQuickConnect(e,t){return li(this.configuration).authenticateWithQuickConnect(e.quickConnectDto,t).then(s=>s(this.axios,this.basePath))}createUserByName(e,t){return li(this.configuration).createUserByName(e.createUserByName,t).then(s=>s(this.axios,this.basePath))}deleteUser(e,t){return li(this.configuration).deleteUser(e.userId,t).then(s=>s(this.axios,this.basePath))}forgotPassword(e,t){return li(this.configuration).forgotPassword(e.forgotPasswordDto,t).then(s=>s(this.axios,this.basePath))}forgotPasswordPin(e,t){return li(this.configuration).forgotPasswordPin(e.forgotPasswordPinDto,t).then(s=>s(this.axios,this.basePath))}getCurrentUser(e){return li(this.configuration).getCurrentUser(e).then(t=>t(this.axios,this.basePath))}getPublicUsers(e){return li(this.configuration).getPublicUsers(e).then(t=>t(this.axios,this.basePath))}getUserById(e,t){return li(this.configuration).getUserById(e.userId,t).then(s=>s(this.axios,this.basePath))}getUsers(e={},t){return li(this.configuration).getUsers(e.isHidden,e.isDisabled,t).then(s=>s(this.axios,this.basePath))}updateUser(e,t){return li(this.configuration).updateUser(e.userDto,e.userId,t).then(s=>s(this.axios,this.basePath))}updateUserConfiguration(e,t){return li(this.configuration).updateUserConfiguration(e.userConfiguration,e.userId,t).then(s=>s(this.axios,this.basePath))}updateUserPassword(e,t){return li(this.configuration).updateUserPassword(e.updateUserPassword,e.userId,t).then(s=>s(this.axios,this.basePath))}updateUserPolicy(e,t){return li(this.configuration).updateUserPolicy(e.userId,e.userPolicy,t).then(s=>s(this.axios,this.basePath))}}const cP=function(i){return{deleteUserItemRating:async(e,t,s={})=>{Pe("deleteUserItemRating","itemId",e);const n="/UserItems/{itemId}/Rating".replace("{itemId}",encodeURIComponent(String(e))),r=new URL(n,Le);let o;i&&(o=i.baseOptions);const c={method:"DELETE",...o,...s},d={},u={};await ke(d,"Authorization",i),t!==void 0&&(u.userId=t),we(r,u);let f=o&&o.headers?o.headers:{};return c.headers={...d,...f,...s.headers},{url:Ce(r),options:c}},getIntros:async(e,t,s={})=>{Pe("getIntros","itemId",e);const n="/Items/{itemId}/Intros".replace("{itemId}",encodeURIComponent(String(e))),r=new URL(n,Le);let o;i&&(o=i.baseOptions);const c={method:"GET",...o,...s},d={},u={};await ke(d,"Authorization",i),t!==void 0&&(u.userId=t),we(r,u);let f=o&&o.headers?o.headers:{};return c.headers={...d,...f,...s.headers},{url:Ce(r),options:c}},getItem:async(e,t,s={})=>{Pe("getItem","itemId",e);const n="/Items/{itemId}".replace("{itemId}",encodeURIComponent(String(e))),r=new URL(n,Le);let o;i&&(o=i.baseOptions);const c={method:"GET",...o,...s},d={},u={};await ke(d,"Authorization",i),t!==void 0&&(u.userId=t),we(r,u);let f=o&&o.headers?o.headers:{};return c.headers={...d,...f,...s.headers},{url:Ce(r),options:c}},getLatestMedia:async(e,t,s,n,r,o,c,d,u,f,m,p={})=>{const v="/Items/Latest",S=new URL(v,Le);let y;i&&(y=i.baseOptions);const E={method:"GET",...y,...p},A={},R={};await ke(A,"Authorization",i),e!==void 0&&(R.userId=e),t!==void 0&&(R.parentId=t),s&&(R.fields=s),n&&(R.includeItemTypes=n),r!==void 0&&(R.isPlayed=r),o!==void 0&&(R.enableImages=o),c!==void 0&&(R.imageTypeLimit=c),d&&(R.enableImageTypes=d),u!==void 0&&(R.enableUserData=u),f!==void 0&&(R.limit=f),m!==void 0&&(R.groupItems=m),we(S,R);let I=y&&y.headers?y.headers:{};return E.headers={...A,...I,...p.headers},{url:Ce(S),options:E}},getLocalTrailers:async(e,t,s={})=>{Pe("getLocalTrailers","itemId",e);const n="/Items/{itemId}/LocalTrailers".replace("{itemId}",encodeURIComponent(String(e))),r=new URL(n,Le);let o;i&&(o=i.baseOptions);const c={method:"GET",...o,...s},d={},u={};await ke(d,"Authorization",i),t!==void 0&&(u.userId=t),we(r,u);let f=o&&o.headers?o.headers:{};return c.headers={...d,...f,...s.headers},{url:Ce(r),options:c}},getRootFolder:async(e,t={})=>{const s="/Items/Root",n=new URL(s,Le);let r;i&&(r=i.baseOptions);const o={method:"GET",...r,...t},c={},d={};await ke(c,"Authorization",i),e!==void 0&&(d.userId=e),we(n,d);let u=r&&r.headers?r.headers:{};return o.headers={...c,...u,...t.headers},{url:Ce(n),options:o}},getSpecialFeatures:async(e,t,s={})=>{Pe("getSpecialFeatures","itemId",e);const n="/Items/{itemId}/SpecialFeatures".replace("{itemId}",encodeURIComponent(String(e))),r=new URL(n,Le);let o;i&&(o=i.baseOptions);const c={method:"GET",...o,...s},d={},u={};await ke(d,"Authorization",i),t!==void 0&&(u.userId=t),we(r,u);let f=o&&o.headers?o.headers:{};return c.headers={...d,...f,...s.headers},{url:Ce(r),options:c}},markFavoriteItem:async(e,t,s={})=>{Pe("markFavoriteItem","itemId",e);const n="/UserFavoriteItems/{itemId}".replace("{itemId}",encodeURIComponent(String(e))),r=new URL(n,Le);let o;i&&(o=i.baseOptions);const c={method:"POST",...o,...s},d={},u={};await ke(d,"Authorization",i),t!==void 0&&(u.userId=t),we(r,u);let f=o&&o.headers?o.headers:{};return c.headers={...d,...f,...s.headers},{url:Ce(r),options:c}},unmarkFavoriteItem:async(e,t,s={})=>{Pe("unmarkFavoriteItem","itemId",e);const n="/UserFavoriteItems/{itemId}".replace("{itemId}",encodeURIComponent(String(e))),r=new URL(n,Le);let o;i&&(o=i.baseOptions);const c={method:"DELETE",...o,...s},d={},u={};await ke(d,"Authorization",i),t!==void 0&&(u.userId=t),we(r,u);let f=o&&o.headers?o.headers:{};return c.headers={...d,...f,...s.headers},{url:Ce(r),options:c}},updateUserItemRating:async(e,t,s,n={})=>{Pe("updateUserItemRating","itemId",e);const r="/UserItems/{itemId}/Rating".replace("{itemId}",encodeURIComponent(String(e))),o=new URL(r,Le);let c;i&&(c=i.baseOptions);const d={method:"POST",...c,...n},u={},f={};await ke(u,"Authorization",i),t!==void 0&&(f.userId=t),s!==void 0&&(f.likes=s),we(o,f);let m=c&&c.headers?c.headers:{};return d.headers={...u,...m,...n.headers},{url:Ce(o),options:d}}}},Tn=function(i){const e=cP(i);return{async deleteUserItemRating(t,s,n){var r,o,c;const d=await e.deleteUserItemRating(t,s,n),u=(r=i==null?void 0:i.serverIndex)!==null&&r!==void 0?r:0,f=(c=(o=Re["UserLibraryApi.deleteUserItemRating"])===null||o===void 0?void 0:o[u])===null||c===void 0?void 0:c.url;return(m,p)=>Oe(d,Se,Ae,i)(m,f||p)},async getIntros(t,s,n){var r,o,c;const d=await e.getIntros(t,s,n),u=(r=i==null?void 0:i.serverIndex)!==null&&r!==void 0?r:0,f=(c=(o=Re["UserLibraryApi.getIntros"])===null||o===void 0?void 0:o[u])===null||c===void 0?void 0:c.url;return(m,p)=>Oe(d,Se,Ae,i)(m,f||p)},async getItem(t,s,n){var r,o,c;const d=await e.getItem(t,s,n),u=(r=i==null?void 0:i.serverIndex)!==null&&r!==void 0?r:0,f=(c=(o=Re["UserLibraryApi.getItem"])===null||o===void 0?void 0:o[u])===null||c===void 0?void 0:c.url;return(m,p)=>Oe(d,Se,Ae,i)(m,f||p)},async getLatestMedia(t,s,n,r,o,c,d,u,f,m,p,v){var S,y,E;const A=await e.getLatestMedia(t,s,n,r,o,c,d,u,f,m,p,v),R=(S=i==null?void 0:i.serverIndex)!==null&&S!==void 0?S:0,I=(E=(y=Re["UserLibraryApi.getLatestMedia"])===null||y===void 0?void 0:y[R])===null||E===void 0?void 0:E.url;return(C,L)=>Oe(A,Se,Ae,i)(C,I||L)},async getLocalTrailers(t,s,n){var r,o,c;const d=await e.getLocalTrailers(t,s,n),u=(r=i==null?void 0:i.serverIndex)!==null&&r!==void 0?r:0,f=(c=(o=Re["UserLibraryApi.getLocalTrailers"])===null||o===void 0?void 0:o[u])===null||c===void 0?void 0:c.url;return(m,p)=>Oe(d,Se,Ae,i)(m,f||p)},async getRootFolder(t,s){var n,r,o;const c=await e.getRootFolder(t,s),d=(n=i==null?void 0:i.serverIndex)!==null&&n!==void 0?n:0,u=(o=(r=Re["UserLibraryApi.getRootFolder"])===null||r===void 0?void 0:r[d])===null||o===void 0?void 0:o.url;return(f,m)=>Oe(c,Se,Ae,i)(f,u||m)},async getSpecialFeatures(t,s,n){var r,o,c;const d=await e.getSpecialFeatures(t,s,n),u=(r=i==null?void 0:i.serverIndex)!==null&&r!==void 0?r:0,f=(c=(o=Re["UserLibraryApi.getSpecialFeatures"])===null||o===void 0?void 0:o[u])===null||c===void 0?void 0:c.url;return(m,p)=>Oe(d,Se,Ae,i)(m,f||p)},async markFavoriteItem(t,s,n){var r,o,c;const d=await e.markFavoriteItem(t,s,n),u=(r=i==null?void 0:i.serverIndex)!==null&&r!==void 0?r:0,f=(c=(o=Re["UserLibraryApi.markFavoriteItem"])===null||o===void 0?void 0:o[u])===null||c===void 0?void 0:c.url;return(m,p)=>Oe(d,Se,Ae,i)(m,f||p)},async unmarkFavoriteItem(t,s,n){var r,o,c;const d=await e.unmarkFavoriteItem(t,s,n),u=(r=i==null?void 0:i.serverIndex)!==null&&r!==void 0?r:0,f=(c=(o=Re["UserLibraryApi.unmarkFavoriteItem"])===null||o===void 0?void 0:o[u])===null||c===void 0?void 0:c.url;return(m,p)=>Oe(d,Se,Ae,i)(m,f||p)},async updateUserItemRating(t,s,n,r){var o,c,d;const u=await e.updateUserItemRating(t,s,n,r),f=(o=i==null?void 0:i.serverIndex)!==null&&o!==void 0?o:0,m=(d=(c=Re["UserLibraryApi.updateUserItemRating"])===null||c===void 0?void 0:c[f])===null||d===void 0?void 0:d.url;return(p,v)=>Oe(u,Se,Ae,i)(p,m||v)}}};class _c extends Nn{deleteUserItemRating(e,t){return Tn(this.configuration).deleteUserItemRating(e.itemId,e.userId,t).then(s=>s(this.axios,this.basePath))}getIntros(e,t){return Tn(this.configuration).getIntros(e.itemId,e.userId,t).then(s=>s(this.axios,this.basePath))}getItem(e,t){return Tn(this.configuration).getItem(e.itemId,e.userId,t).then(s=>s(this.axios,this.basePath))}getLatestMedia(e={},t){return Tn(this.configuration).getLatestMedia(e.userId,e.parentId,e.fields,e.includeItemTypes,e.isPlayed,e.enableImages,e.imageTypeLimit,e.enableImageTypes,e.enableUserData,e.limit,e.groupItems,t).then(s=>s(this.axios,this.basePath))}getLocalTrailers(e,t){return Tn(this.configuration).getLocalTrailers(e.itemId,e.userId,t).then(s=>s(this.axios,this.basePath))}getRootFolder(e={},t){return Tn(this.configuration).getRootFolder(e.userId,t).then(s=>s(this.axios,this.basePath))}getSpecialFeatures(e,t){return Tn(this.configuration).getSpecialFeatures(e.itemId,e.userId,t).then(s=>s(this.axios,this.basePath))}markFavoriteItem(e,t){return Tn(this.configuration).markFavoriteItem(e.itemId,e.userId,t).then(s=>s(this.axios,this.basePath))}unmarkFavoriteItem(e,t){return Tn(this.configuration).unmarkFavoriteItem(e.itemId,e.userId,t).then(s=>s(this.axios,this.basePath))}updateUserItemRating(e,t){return Tn(this.configuration).updateUserItemRating(e.itemId,e.userId,e.likes,t).then(s=>s(this.axios,this.basePath))}}class uP{constructor(e={}){this.apiKey=e.apiKey,this.username=e.username,this.password=e.password,this.accessToken=e.accessToken,this.basePath=e.basePath,this.serverIndex=e.serverIndex,this.baseOptions=e.baseOptions,this.formDataCtor=e.formDataCtor}isJsonMime(e){const t=new RegExp("^(application/json|[^;/ 	]+/[^;/ 	]+[+]json)[ 	]*(;.*)?$","i");return e!==null&&(t.test(e)||e.toLowerCase()==="application/json-patch+json")}}const je={AggregateFolder:"AggregateFolder",Audio:"Audio",AudioBook:"AudioBook",BasePluginFolder:"BasePluginFolder",Book:"Book",BoxSet:"BoxSet",Channel:"Channel",ChannelFolderItem:"ChannelFolderItem",CollectionFolder:"CollectionFolder",Episode:"Episode",Folder:"Folder",Genre:"Genre",ManualPlaylistsFolder:"ManualPlaylistsFolder",Movie:"Movie",LiveTvChannel:"LiveTvChannel",LiveTvProgram:"LiveTvProgram",MusicAlbum:"MusicAlbum",MusicArtist:"MusicArtist",MusicGenre:"MusicGenre",MusicVideo:"MusicVideo",Person:"Person",Photo:"Photo",PhotoAlbum:"PhotoAlbum",Playlist:"Playlist",PlaylistsFolder:"PlaylistsFolder",Program:"Program",Recording:"Recording",Season:"Season",Series:"Series",Studio:"Studio",Trailer:"Trailer",TvChannel:"TvChannel",TvProgram:"TvProgram",UserRootFolder:"UserRootFolder",UserView:"UserView",Video:"Video",Year:"Year"},Pd={IsPlayed:"IsPlayed",IsFavorite:"IsFavorite"},Ht={DateCreated:"DateCreated",DatePlayed:"DatePlayed",PremiereDate:"PremiereDate",SortName:"SortName",Random:"Random",Runtime:"Runtime",ProductionYear:"ProductionYear",PlayCount:"PlayCount",IndexNumber:"IndexNumber"},UT={DirectStream:"DirectStream"},ds={Ascending:"Ascending",Descending:"Descending"};var T0=(i=>(i.Added="Added",i.Tracks="Tracks",i.Released="Released",i.Runtime="Runtime",i.Random="Random",i.Artists="Artists",i.Albums="Albums",i.None="",i))(T0||{}),E0=(i=>(i.Ascending="Ascending",i.Descending="Descending",i.None="",i))(E0||{});const FT={"/tracks":"Added","/albums":"Added","/genre":"Added","/favorites":"Tracks"},BT=i=>Object.values(T0).map(e=>e.toLowerCase()).includes(i.toLowerCase()),jT=i=>Object.values(E0).map(e=>e.toLowerCase()).includes(i.toLowerCase()),dP=()=>{const i=Xs(),[e,t]=nD(),s=e.get("sort"),n=e.get("order"),r=s&&BT(s)?Object.values(T0).find(S=>S.toLowerCase()===s.toLowerCase()):null,o=n&&jT(n)?Object.values(E0).find(S=>S.toLowerCase()===n.toLowerCase()):null,c=FT[i.pathname]||"",d=c==="Added"||c===""?"Descending":"Ascending",[u,f]=P.useState({sort:r||c,order:o||d}),m=P.useCallback(S=>{const y=S(u),E=new URLSearchParams;FT[i.pathname]!==y.sort&&y.sort&&E.set("sort",y.sort),d!==y.order&&y.order&&E.set("order",y.order),t(E),f(y)},[u,i.pathname,d,t]);P.useEffect(()=>{const S=e.get("sort")||c,y=e.get("order")||d;f({sort:BT(S)?S:"",order:jT(y)?y:""})},[e,c,d]);const p=P.useMemo(()=>{let S;switch(u.sort){case"Added":S=[Ht.DateCreated];break;case"Released":S=[Ht.PremiereDate];break;case"Runtime":S=[Ht.Runtime];break;case"Random":S=[Ht.Random];break;default:S=[Ht.DateCreated]}const y=u.order==="Ascending"?[ds.Ascending]:[ds.Descending];return{sortBy:S,sortOrder:y}},[u]),v=P.useMemo(()=>{switch(u.sort){case"Artists":return je.MusicArtist;case"Albums":return je.MusicAlbum;default:return je.Audio}},[u.sort]);return{filter:u,setFilter:m,jellySort:p,jellyItemKind:v}},hP=({children:i})=>{const e=dP();return T.jsx(Ib.Provider,{value:e,children:i})},eA=P.createContext({}),fP=()=>P.useContext(eA),tA=P.createContext({}),mr=()=>P.useContext(tA),sA=P.createContext({}),Qs=()=>P.useContext(sA),iA=P.createContext({}),b0=()=>P.useContext(iA),Op=(i,e)=>{if(i)return i;if(e.pathname.startsWith("/album/"))return"Album";if(e.pathname.startsWith("/artist/"))return e.pathname.includes("/tracks")?"Tracks":"Artist";if(e.pathname.startsWith("/genre/"))return"Genre";if(e.pathname.startsWith("/playlist/"))return"Playlist";if(e.pathname.startsWith("/search/"))return`Search results for '${decodeURIComponent(e.pathname.split("/search/")[1])}'`;switch(e.pathname){case"/":return"Home";case"/tracks":return"Tracks";case"/albums":return"Albums";case"/artists":return"Artists";case"/favorites":return"Favorites";case"/settings":return"Settings";case"/synced":return"Synced";case"/recently":return"Recently Played";case"/frequently":return"Frequently Played";default:return"Home"}};class Sh extends P.Component{render(){const{width:e,height:t,className:s}=this.props;return T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16.1328 15.7715",width:e,height:t,className:s,children:T.jsxs("g",{children:[T.jsx("rect",{height:"15.7715",opacity:"0",width:"16.1328",x:"0",y:"0"}),T.jsx("path",{d:"M15.7715 7.88086C15.7715 12.2266 12.2363 15.7617 7.88086 15.7617C3.53516 15.7617 0 12.2266 0 7.88086C0 3.53516 3.53516 0 7.88086 0C12.2363 0 15.7715 3.53516 15.7715 7.88086ZM4.75586 7.87109C4.75586 9.59961 6.15234 10.9961 7.88086 10.9961C9.61914 10.9961 11.0156 9.59961 11.0156 7.87109C11.0156 6.14258 9.61914 4.73633 7.88086 4.73633C6.15234 4.73633 4.75586 6.14258 4.75586 7.87109Z"}),T.jsx("circle",{className:"spindle-hole",cx:"7.88086",cy:"7.87109",r:"1.5"})]})})}}js(Sh,"defaultProps",{width:"100%",height:"100%"});class nA extends P.Component{render(){const{width:e,height:t,className:s}=this.props;return T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 9.90234 15.9277",width:e,height:t,className:s,children:T.jsxs("g",{children:[T.jsx("rect",{height:"15.9277",opacity:"0",width:"9.90234",x:"0",y:"0"}),T.jsx("path",{d:"M9.54102 3.88672L9.54102 0.966797C9.54102 0.546875 9.19922 0.263672 8.7793 0.351562L4.75586 1.23047C4.22852 1.34766 3.94531 1.62109 3.94531 2.08008L3.94531 10.6738C3.99414 11.0254 3.82812 11.25 3.51562 11.3086L2.29492 11.5625C0.732422 11.8945 0 12.6953 0 13.8867C0 15.0879 0.927734 15.9277 2.22656 15.9277C3.36914 15.9277 5.08789 15.0781 5.08789 12.8125L5.08789 5.74219C5.08789 5.35156 5.15625 5.29297 5.49805 5.22461L9.10156 4.42383C9.36523 4.36523 9.54102 4.16016 9.54102 3.88672Z"})]})})}}js(nA,"defaultProps",{width:"100%",height:"100%"});class rA extends P.Component{render(){const{width:e,height:t,className:s}=this.props;return T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 38 48",role:"presentation",focusable:"false",width:e,height:t,className:s,children:T.jsx("path",{d:"M36.15 0c-.18.02-1.76.3-1.95.33l-19.7 3.7c-.58.13-1.03.32-1.37.6a2.1 2.1 0 0 0-.74 1.36c-.02.12-.05.36-.05.72v26.81c0 1.18-.9 2.16-2.1 2.38l-5.27.86A6 6 0 0 0 0 42.57C0 45.63 2.6 48 5.64 48c.37 0 .74-.04 1.11-.1l1.82-.36a7.13 7.13 0 0 0 5.8-7.08V17.25c0-1.22.4-1.54 1.42-1.78 0 0 17.52-3.52 18.37-3.68.22-.04.43-.07.61-.07.78 0 1.17.4 1.17 1.36v15.47c0 1.18-.89 2.16-2.1 2.39l-4.86.95c-3.1.55-5.35 2.97-5.35 5.77 0 3.04 2.8 5.4 6.08 5.4.4 0 .8-.03 1.2-.1l1.96-.35c4.23-1.2 5.13-5.07 5.13-7.75v-33C38 .74 37.41 0 36.36 0h-.2z"})})}}js(rA,"defaultProps",{width:"100%",height:"100%"});class A0 extends P.Component{render(){const{width:e,height:t,className:s}=this.props;return T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16.1328 15.7715",width:e,height:t,className:s,children:T.jsxs("g",{children:[T.jsx("rect",{height:"15.7715",opacity:"0",width:"16.1328",x:"0",y:"0"}),T.jsx("path",{d:"M7.88086 15.7617C12.2363 15.7617 15.7715 12.2363 15.7715 7.88086C15.7715 3.52539 12.2363 0 7.88086 0C3.53516 0 0 3.52539 0 7.88086C0 12.2363 3.53516 15.7617 7.88086 15.7617ZM7.88086 14.2773C4.3457 14.2773 1.49414 11.416 1.49414 7.88086C1.49414 4.3457 4.3457 1.48438 7.88086 1.48438C11.416 1.48438 14.2773 4.3457 14.2773 7.88086C14.2773 11.416 11.416 14.2773 7.88086 14.2773ZM13.1445 12.959L13.1152 12.8613C12.7637 11.7188 10.7227 10.5078 7.88086 10.5078C5.03906 10.5078 3.00781 11.7188 2.65625 12.8613L2.62695 12.959C4.02344 14.3164 6.50391 15.0879 7.88086 15.0879C9.26758 15.0879 11.748 14.3164 13.1445 12.959ZM7.88086 9.21875C9.35547 9.23828 10.5176 7.97852 10.5176 6.32812C10.5176 4.77539 9.35547 3.49609 7.88086 3.49609C6.41602 3.49609 5.24414 4.77539 5.25391 6.32812C5.26367 7.97852 6.40625 9.19922 7.88086 9.21875Z"})]})})}}js(A0,"defaultProps",{width:"100%",height:"100%"});class I0 extends P.Component{render(){const{width:e,height:t,className:s}=this.props;return T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16.1523 15.9277",width:e,height:t,className:s,children:T.jsxs("g",{children:[T.jsx("rect",{height:"15.9277",opacity:"0",width:"16.1523",x:"0",y:"0"}),T.jsx("path",{d:"M0.585938 9.82422L7.33398 9.82422C7.66602 9.82422 7.91992 9.57031 7.91992 9.23828C7.91992 8.92578 7.65625 8.66211 7.33398 8.66211L0.585938 8.66211C0.263672 8.66211 0 8.92578 0 9.23828C0 9.57031 0.253906 9.82422 0.585938 9.82422Z"}),T.jsx("path",{d:"M0.585938 7.06055L7.33398 7.06055C7.66602 7.06055 7.91992 6.79688 7.91992 6.47461C7.91992 6.15234 7.65625 5.89844 7.33398 5.89844L0.585938 5.89844C0.263672 5.89844 0 6.15234 0 6.47461C0 6.79688 0.253906 7.06055 0.585938 7.06055Z"}),T.jsx("path",{d:"M0.585938 4.30664L7.33398 4.30664C7.65625 4.30664 7.91992 4.04297 7.91992 3.7207C7.91992 3.39844 7.65625 3.13477 7.33398 3.13477L0.585938 3.13477C0.263672 3.13477 0 3.39844 0 3.7207C0 4.04297 0.263672 4.30664 0.585938 4.30664Z"}),T.jsx("path",{d:"M15.791 3.88672L15.791 0.966797C15.791 0.546875 15.4492 0.263672 15.0391 0.351562L11.0059 1.23047C10.4785 1.34766 10.1953 1.62109 10.1953 2.08008L10.1953 10.6738C10.2441 11.0254 10.0781 11.25 9.77539 11.3086L8.55469 11.5625C6.98242 11.8945 6.25 12.6953 6.25 13.8867C6.25 15.0879 7.17773 15.9277 8.47656 15.9277C9.61914 15.9277 11.3477 15.0781 11.3477 12.8125L11.3477 5.74219C11.3477 5.35156 11.4062 5.29297 11.748 5.22461L15.3516 4.42383C15.625 4.36523 15.791 4.16016 15.791 3.88672Z"})]})})}}js(I0,"defaultProps",{width:"100%",height:"100%"});class aA extends P.Component{render(){const{width:e,height:t,className:s}=this.props;return T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 15.4395 15.2246",width:e,height:t,className:s,children:T.jsxs("g",{children:[T.jsx("rect",{height:"15.2246",opacity:"0",width:"15.4395",x:"0",y:"0"}),T.jsx("path",{d:"M0 6.21094C0 9.63867 2.7832 12.4121 6.21094 12.4121C7.5293 12.4121 8.74023 12.002 9.74609 11.2988L13.3789 14.9414C13.584 15.1367 13.8379 15.2246 14.1016 15.2246C14.668 15.2246 15.0781 14.7949 15.0781 14.2285C15.0781 13.9551 14.9707 13.7109 14.8047 13.5254L11.1914 9.90234C11.9629 8.86719 12.4121 7.59766 12.4121 6.21094C12.4121 2.7832 9.63867 0 6.21094 0C2.7832 0 0 2.7832 0 6.21094ZM1.50391 6.21094C1.50391 3.60352 3.60352 1.50391 6.21094 1.50391C8.80859 1.50391 10.918 3.60352 10.918 6.21094C10.918 8.80859 8.80859 10.918 6.21094 10.918C3.60352 10.918 1.50391 8.80859 1.50391 6.21094Z"})]})})}}js(aA,"defaultProps",{width:"100%",height:"100%"});class oA extends P.Component{render(){const{width:e,height:t,className:s}=this.props;return T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16.1328 15.7715",width:e,height:t,className:s,children:T.jsxs("g",{children:[T.jsx("rect",{height:"15.7715",opacity:"0",width:"16.1328",x:"0",y:"0"}),T.jsx("path",{d:"M15.7715 7.88086C15.7715 12.2266 12.2363 15.7617 7.88086 15.7617C3.53516 15.7617 0 12.2266 0 7.88086C0 3.53516 3.53516 0 7.88086 0C12.2363 0 15.7715 3.53516 15.7715 7.88086ZM9.98047 4.80469L7.88086 6.88477L5.81055 4.81445C5.67383 4.6875 5.51758 4.61914 5.3125 4.61914C4.92188 4.61914 4.59961 4.92188 4.59961 5.33203C4.59961 5.51758 4.67773 5.69336 4.80469 5.83008L6.86523 7.89062L4.80469 9.95117C4.67773 10.0879 4.59961 10.2637 4.59961 10.4492C4.59961 10.8594 4.92188 11.1816 5.3125 11.1816C5.51758 11.1816 5.70312 11.1133 5.83008 10.9766L7.88086 8.90625L9.94141 10.9766C10.0684 11.1133 10.2539 11.1816 10.4492 11.1816C10.8594 11.1816 11.1816 10.8594 11.1816 10.4492C11.1816 10.2539 11.1133 10.0781 10.9668 9.94141L8.90625 7.89062L10.9766 5.82031C11.1328 5.67383 11.1914 5.50781 11.1914 5.3125C11.1914 4.91211 10.8691 4.59961 10.4688 4.59961C10.2832 4.59961 10.127 4.66797 9.98047 4.80469Z"})]})})}}js(oA,"defaultProps",{width:"100%",height:"100%"});class Kh extends P.Component{render(){const{width:e,height:t,className:s}=this.props;return T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 12.1562 3",width:e,height:t,className:s,children:T.jsxs("g",{children:[T.jsx("rect",{height:"3",opacity:"0",width:"12.1562",x:"0",y:"0"}),T.jsx("circle",{cx:"10.5391",cy:"1.5",r:"1.3"}),T.jsx("circle",{cx:"5.875",cy:"1.5",r:"1.3"}),T.jsx("circle",{cx:"1.31094",cy:"1.5",r:"1.3"})]})})}}js(Kh,"defaultProps",{width:"100%",height:"100%"});class lA extends P.Component{render(){const{width:e,height:t,className:s}=this.props;return T.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 28 20",width:e,height:t,className:s,children:[T.jsx("rect",{x:"2",y:"12",width:"2",height:"8",rx:"1",className:"bar bar1"}),T.jsx("rect",{x:"6",y:"10",width:"2",height:"10",rx:"1",className:"bar bar2"}),T.jsx("rect",{x:"10",y:"14",width:"2",height:"6",rx:"1",className:"bar bar3"}),T.jsx("rect",{x:"14",y:"11",width:"2",height:"9",rx:"1",className:"bar bar4"}),T.jsx("rect",{x:"18",y:"13",width:"2",height:"7",rx:"1",className:"bar bar5"}),T.jsx("rect",{x:"22",y:"12",width:"2",height:"8",rx:"1",className:"bar bar6"})]})}}js(lA,"defaultProps",{width:"100%",height:"100%"});class R0 extends P.Component{render(){const{width:e,height:t,className:s}=this.props;return T.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 18 18",width:e,height:t,className:s,children:[T.jsx("rect",{x:"1",y:"10",width:"3",height:"8",rx:"1.5",className:"bar bar1"}),T.jsx("rect",{x:"5",y:"9",width:"3",height:"9",rx:"1.5",className:"bar bar2"}),T.jsx("rect",{x:"9",y:"11",width:"3",height:"7",rx:"1.5",className:"bar bar3"}),T.jsx("rect",{x:"13",y:"10",width:"3",height:"8",rx:"1.5",className:"bar bar4"})]})}}js(R0,"defaultProps",{width:"100%",height:"100%"});class cA extends P.Component{render(){const{width:e,height:t,className:s}=this.props;return T.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 14 14",width:e,height:t,className:s,children:[T.jsx("rect",{x:"1",y:"8",width:"3",height:"6",rx:"1.5",className:"bar bar1"}),T.jsx("rect",{x:"5.5",y:"7",width:"3",height:"7",rx:"1.5",className:"bar bar2"}),T.jsx("rect",{x:"10",y:"9",width:"3",height:"5",rx:"1.5",className:"bar bar3"})]})}}js(cA,"defaultProps",{width:"100%",height:"100%"});class na extends P.Component{render(){const{width:e,height:t,className:s}=this.props;return T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 13.0234 12.6172",width:e,height:t,className:s,children:T.jsxs("g",{children:[T.jsx("rect",{height:"12.6172",opacity:"0",width:"13.0234",x:"0",y:"0"}),T.jsx("path",{d:"M6.30469 12.6094C9.78906 12.6094 12.6172 9.78906 12.6172 6.30469C12.6172 2.82031 9.78906 0 6.30469 0C2.82812 0 0 2.82031 0 6.30469C0 9.78906 2.82812 12.6094 6.30469 12.6094ZM6.30469 11.4219C3.47656 11.4219 1.19531 9.13281 1.19531 6.30469C1.19531 3.47656 3.47656 1.1875 6.30469 1.1875C9.13281 1.1875 11.4219 3.47656 11.4219 6.30469C11.4219 9.13281 9.13281 11.4219 6.30469 11.4219Z"}),T.jsx("path",{d:"M6.30469 9.41406C6.45312 9.41406 6.57031 9.36719 6.71094 9.22656L8.71875 7.3125C8.82031 7.20312 8.88281 7.09375 8.88281 6.94531C8.88281 6.65625 8.66406 6.45312 8.375 6.45312C8.23438 6.45312 8.09375 6.50781 7.99219 6.61719L7.13281 7.55469L6.82031 7.89062L6.86719 6.96094L6.86719 3.73438C6.86719 3.44531 6.60938 3.19531 6.30469 3.19531C6.00781 3.19531 5.75 3.44531 5.75 3.73438L5.75 6.96094L5.79688 7.89062L5.47656 7.55469L4.61719 6.61719C4.52344 6.50781 4.36719 6.45312 4.23438 6.45312C3.94531 6.45312 3.73438 6.65625 3.73438 6.94531C3.73438 7.09375 3.78906 7.20312 3.89844 7.3125L5.89844 9.22656C6.04688 9.36719 6.16406 9.41406 6.30469 9.41406Z"})]})})}}js(na,"defaultProps",{width:"100%",height:"100%"});class Va extends P.Component{render(){const{width:e,height:t,className:s}=this.props;return T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 13.0234 12.6172",width:e,height:t,className:s,children:T.jsxs("g",{children:[T.jsx("rect",{height:"12.6172",opacity:"0",width:"13.0234",x:"0",y:"0"}),T.jsx("path",{d:"M12.6172 6.30469C12.6172 9.78125 9.78906 12.6094 6.30469 12.6094C2.82812 12.6094 0 9.78125 0 6.30469C0 2.82812 2.82812 0 6.30469 0C9.78906 0 12.6172 2.82812 12.6172 6.30469ZM5.73438 3.64062L5.73438 6.98438L5.78125 7.95312L5.45312 7.60156L4.5625 6.63281C4.46094 6.51562 4.30469 6.46094 4.16406 6.46094C3.85938 6.46094 3.64062 6.67188 3.64062 6.96875C3.64062 7.125 3.70312 7.24219 3.8125 7.35156L5.89844 9.33594C6.04688 9.48438 6.16406 9.53125 6.3125 9.53125C6.46875 9.53125 6.58594 9.48438 6.73438 9.33594L8.8125 7.35156C8.92969 7.24219 8.98438 7.125 8.98438 6.96875C8.98438 6.67188 8.75781 6.46094 8.46094 6.46094C8.32031 6.46094 8.16406 6.51562 8.07031 6.63281L7.17188 7.60156L6.85156 7.95312L6.89062 6.98438L6.89062 3.64062C6.89062 3.32812 6.63281 3.07812 6.3125 3.07812C6 3.07812 5.73438 3.32812 5.73438 3.64062Z"})]})})}}js(Va,"defaultProps",{width:"100%",height:"100%"});class $a extends P.Component{render(){const{width:e,height:t,className:s}=this.props;return T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 13.0234 12.6172",width:e,height:t,className:s,children:T.jsxs("g",{children:[T.jsx("rect",{height:"12.6172",opacity:"0",width:"13.0234",x:"0",y:"0"}),T.jsx("path",{d:"M12.6172 6.30469C12.6172 9.78125 9.78906 12.6094 6.30469 12.6094C2.82812 12.6094 0 9.78125 0 6.30469C0 2.82812 2.82812 0 6.30469 0C9.78906 0 12.6172 2.82812 12.6172 6.30469ZM3.92969 5.70312C3.5 5.70312 3.22656 5.92188 3.22656 6.32031C3.22656 6.71094 3.51562 6.92188 3.92969 6.92188L8.69531 6.92188C9.10938 6.92188 9.38281 6.71094 9.38281 6.32031C9.38281 5.92188 9.125 5.70312 8.69531 5.70312Z"})]})})}}js($a,"defaultProps",{width:"100%",height:"100%"});class uA extends P.Component{render(){const{width:e,height:t,className:s}=this.props;return T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 15.4834 11.9011",width:e,height:t,className:s,children:T.jsxs("g",{children:[T.jsx("rect",{height:"11.9011",opacity:"0",width:"15.4834",x:"0",y:"0"}),T.jsx("path",{className:"arrow up",d:"M11.7615 11.6415L14.8371 8.475C14.9816 8.32516 15.0771 8.09791 15.0771 7.90475C15.0771 7.4428 14.7523 7.12324 14.2956 7.12324C14.0787 7.12324 13.8987 7.19816 13.7542 7.34765L12.5485 8.6051L11.9198 9.3617L11.9624 8.13288L11.9624 0.79319C11.9624 0.339051 11.6326 0.00919333 11.1784 0.00919333C10.7243 0.00919333 10.3891 0.339051 10.3891 0.79319L10.3891 8.13288L10.4371 9.3617L9.80302 8.6051L8.59741 7.34765C8.45823 7.19816 8.27288 7.12324 8.05593 7.12324C7.59931 7.12324 7.27975 7.4428 7.27975 7.90475C7.27975 8.09791 7.36993 8.32516 7.51978 8.475L10.5901 11.6415C10.9178 11.9849 11.4337 11.9902 11.7615 11.6415Z"}),T.jsx("path",{className:"arrow down",d:"M3.31567 0.262005L0.24003 3.42607C0.0955153 3.57591 0 3.79783 0 3.99631C0 4.45827 0.324889 4.77783 0.781512 4.77783C0.998465 4.77783 1.17848 4.70291 1.32299 4.55342L2.5286 3.29597L3.15733 2.53404L3.10938 3.76818L3.10938 11.1079C3.10938 11.5698 3.44456 11.8997 3.8987 11.8997C4.35284 11.8997 4.68802 11.5698 4.68802 11.1079L4.68802 3.76818L4.64007 2.53404L5.2688 3.29597L6.47441 4.55342C6.61892 4.70291 6.79893 4.77783 7.01589 4.77783C7.47251 4.77783 7.7974 4.45827 7.7974 3.99631C7.7974 3.79783 7.70188 3.57591 7.55737 3.42607L4.48706 0.262005C4.15932-0.0760251 3.6434-0.0813533 3.31567 0.262005Z"})]})})}}js(uA,"defaultProps",{width:"100%",height:"100%"});const Gs=i=>{var e;return T.jsx(hP,{children:T.jsx(mP,{...i})},(e=i.content)==null?void 0:e.name)},mP=({content:i,filterType:e})=>{const t=Qs(),{pageTitle:s}=mr(),{goBack:n}=fP(),r=Xs(),{toggleSidenav:o}=b0(),{filter:c,setFilter:d}=fr();P.useEffect(()=>{window.scrollTo({top:0,behavior:"instant"})},[r.pathname]);const u=P.useMemo(()=>T.jsxs("div",{className:"main_header",children:[T.jsxs("div",{className:"primary",children:[T.jsx("div",{onClick:n,className:"return_icon",title:"Back",children:T.jsx(Ab,{size:16})}),T.jsx("div",{className:"container",children:T.jsxs("div",{className:"page_title",children:[T.jsx("div",{className:"text",title:Op(s,r),children:Op(s,r)}),r.pathname.startsWith("/album/")&&s&&T.jsx("div",{className:"page-icon album",title:"Album",children:T.jsx(Sh,{width:16,height:16})}),s&&(r.pathname.match(/^\/artist\/[^/]+\/tracks$/)?T.jsx("div",{className:"page-icon artist-tracks",title:"Tracks",children:T.jsx(rA,{width:12,height:12})}):r.pathname.startsWith("/artist/")?T.jsx("div",{className:"page-icon artist",title:"Artist",children:T.jsx(A0,{width:16,height:16})}):null),r.pathname.startsWith("/genre/")&&s&&T.jsx("div",{className:"page-icon genre",title:"Genre",children:T.jsx(p0,{size:16})}),r.pathname.startsWith("/playlist/")&&s&&T.jsx("div",{className:"page-icon playlist",title:"Playlist",children:T.jsx(I0,{width:12,height:12})})]})})]}),T.jsxs("div",{className:"secondary noSelect",children:[e==="mediaItems"&&T.jsx(T.Fragment,{children:T.jsxs("div",{className:"sorting",children:[T.jsxs("div",{className:"filter",children:[T.jsxs("select",{onChange:p=>d(v=>({...v,sort:p.target.value})),value:c.sort,children:[T.jsx("option",{value:"Added",children:"Added"}),T.jsx("option",{value:"Released",children:"Released"}),T.jsx("option",{value:"Runtime",children:"Runtime"}),T.jsx("option",{value:"Random",children:"Random"})]}),T.jsx("div",{className:"icon",children:T.jsx(TT,{size:12})})]}),T.jsx("div",{className:"sort",onClick:()=>{d(p=>({...p,order:p.order==="Ascending"?"Descending":"Ascending"}))},title:c.order==="Ascending"?"Ascending":"Descending",children:T.jsx("div",{className:"icon"+(c.order==="Ascending"?" active":""),children:T.jsx(uA,{width:12,height:12})})})]})}),e==="favorites"&&T.jsx("div",{className:"sorting",children:T.jsxs("div",{className:"filter",children:[T.jsxs("select",{onChange:p=>d(v=>({...v,sort:p.target.value})),value:c.sort,children:[T.jsx("option",{value:"Tracks",children:"Tracks"}),T.jsx("option",{value:"Albums",children:"Albums"}),T.jsx("option",{value:"Artists",children:"Artists"})]}),T.jsx("div",{className:"icon",children:T.jsx(TT,{size:12})})]})}),T.jsxs("div",{className:"sidenav_toggle",onClick:o,children:[T.jsx("div",{className:"bar"}),T.jsx("div",{className:"bar"})]})]})]}),[c.order,c.sort,e,r,s,n,d,o]),f=P.useMemo(()=>T.jsx("div",{className:"main_content",children:T.jsx(i,{})}),[i]),m=P.useMemo(()=>{var p,v,S,y,E,A,R,I,C,L,D;return T.jsx("div",{className:"main_footer",children:T.jsxs("div",{className:t.isPlaying?"playback playing":t.currentTrack?"playback paused":"playback",children:[T.jsx(gP,{}),T.jsxs("div",{className:"container",children:[T.jsxs("div",{className:"track-info",children:[T.jsxs("div",{className:"track-name",children:[T.jsx("div",{className:"text",title:((p=t.currentTrack)==null?void 0:p.Name)||"No Track Played",children:(v=t.currentTrack)!=null&&v.Name?T.jsx(qi,{to:"/queue",children:t.currentTrack.Name}):"No Track Played"}),((y=(S=t.currentTrack)==null?void 0:S.UserData)==null?void 0:y.IsFavorite)&&T.jsx("span",{className:"favorited",title:"Favorited",children:T.jsx(on,{size:12})})]}),T.jsx("div",{className:"artist",title:((A=(E=t.currentTrack)==null?void 0:E.Artists)==null?void 0:A.join(", "))||((R=t.currentTrack)==null?void 0:R.AlbumArtist)||"No Artist",children:t.currentTrack&&t.currentTrack.ArtistItems&&t.currentTrack.ArtistItems.length>0?(()=>{const _=t.currentTrack.ArtistItems;return _.map((M,U)=>T.jsxs("span",{children:[T.jsx(qi,{to:`/artist/${M.Id}`,className:"text",children:M.Name}),U<_.length-1&&", "]},M.Id))})():((C=(I=t.currentTrack)==null?void 0:I.Artists)==null?void 0:C.join(", "))||((L=t.currentTrack)==null?void 0:L.AlbumArtist)||"No Artist"}),T.jsxs("div",{className:"album",children:[(D=t.currentTrack)!=null&&D.Album?T.jsx(qi,{to:`/album/${t.currentTrack.AlbumId}`,className:"text",title:t.currentTrack.Album,children:t.currentTrack.Album}):T.jsx("div",{className:"text",children:"No Album"}),T.jsx("div",{className:"album-icon",title:"Album",children:T.jsx(Sh,{width:12,height:12})})]})]}),T.jsxs("div",{className:"controls",children:[T.jsxs("div",{className:"knobs",children:[T.jsx("div",{className:`shuffle ${t.shuffle?"active":""}`,onClick:t.toggleShuffle,title:"Shuffle",children:T.jsx("div",{className:"shuffle-icon"})}),T.jsxs("div",{className:"primary",children:[T.jsx("div",{className:"previous",onClick:t.previousTrack,title:"Previous",children:T.jsx("div",{className:"previous-icon"})}),T.jsxs("div",{className:"container",children:[T.jsx("div",{className:"play",onClick:t.togglePlayPause,title:"Play",children:T.jsx("div",{className:"play-icon"})}),T.jsx("div",{className:"pause",onClick:t.togglePlayPause,title:"Pause",children:T.jsx("div",{className:"pause-icon"})})]}),T.jsx("div",{className:"next",onClick:t.nextTrack,title:"Next",children:T.jsx("div",{className:"next-icon"})})]}),T.jsx("div",{className:`repeat ${t.repeat==="off"?"":"active"}`,onClick:t.toggleRepeat,title:"Repeat",children:T.jsx("div",{className:`repeat-icon${t.repeat==="one"?"-one":""}`})})]}),T.jsx(pP,{})]})]})]})})},[t.currentTrack,t.isPlaying,t.nextTrack,t.previousTrack,t.repeat,t.shuffle,t.togglePlayPause,t.toggleRepeat,t.toggleShuffle]);return T.jsxs("main",{className:"main",children:[u,f,m]})},gP=()=>{const i=Qs(),e=i.audioRef.current,t=P.useRef(null),s=P.useRef(!1),n=P.useCallback(()=>(e==null?void 0:e.duration)||0,[e]),r=P.useCallback(()=>{if(!e)return 0;const d=n(),u=e.currentTime||0;return d>0?u/d*100:0},[e,n]),o=P.useCallback(()=>{var d,u,f,m,p;s.current||((d=t.current)==null||d.style.setProperty("--transition-duration","0s"),(u=t.current)==null||u.style.setProperty("--progress-width",`${r()}%`),i.isPlaying&&((f=t.current)==null||f.offsetWidth,(m=t.current)==null||m.style.setProperty("--transition-duration",`${n()-((e==null?void 0:e.currentTime)||0)}s`),(p=t.current)==null||p.style.setProperty("--progress-width","100%")))},[e==null?void 0:e.currentTime,n,r,i.isPlaying]),c=P.useCallback(()=>e&&e.buffered.length>0?e.buffered.end(e.buffered.length-1)/(e.duration||1)*100:0,[e]);return P.useEffect(()=>{var d,u;e&&((d=t.current)==null||d.style.setProperty("--progress-width",`${r()}%`),(u=t.current)==null||u.style.setProperty("--transition-duration",`${n()}s`))},[e,n,r]),P.useEffect(()=>{var d,u;e&&(i.isPlaying?o():((d=t.current)==null||d.style.setProperty("--progress-width",`${r()}%`),(u=t.current)==null||u.style.setProperty("--transition-duration","0s")))},[e,e==null?void 0:e.src,r,i.isPlaying,o]),P.useEffect(()=>{if(!e)return;const d=()=>{e.duration&&o()},u=()=>{var S;(S=t.current)==null||S.style.setProperty("--buffered-width",`${c()}%`)},f=()=>{var S,y,E,A;(S=t.current)==null||S.style.setProperty("--buffered-width","0%"),(y=t.current)==null||y.style.setProperty("--progress-width","0%"),(E=t.current)==null||E.style.setProperty("--transition-duration","0s"),(A=t.current)==null||A.offsetWidth},m=()=>{var S,y;(S=t.current)==null||S.style.setProperty("--progress-width",`${r()}%`),(y=t.current)==null||y.style.setProperty("--transition-duration",`${n()}s`)},p=()=>{var S,y,E;s.current=!0,(S=t.current)==null||S.classList.add("loading"),(y=t.current)==null||y.style.setProperty("--transition-duration","0s"),(E=t.current)==null||E.style.setProperty("--progress-width",`${r()}%`)},v=()=>{var S;s.current=!1,(S=t.current)==null||S.classList.remove("loading"),o()};return e.addEventListener("timeupdate",d),e.addEventListener("emptied",f),e.addEventListener("progress",u),e.addEventListener("loadedmetadata",m),e.addEventListener("waiting",p),e.addEventListener("playing",v),()=>{e.removeEventListener("timeupdate",d),e.removeEventListener("emptied",f),e.removeEventListener("progress",u),e.removeEventListener("loadedmetadata",m),e.removeEventListener("waiting",p),e.removeEventListener("playing",v)}},[e,c,n,r,o]),T.jsx("div",{className:"progress",children:T.jsx("input",{ref:t,type:"range",id:"track-progress",name:"track-progress",step:"0.01",min:"0",max:(e==null?void 0:e.duration)||0,style:{"--progress-width":`${r()}%`,"--buffered-width":`${c()}%`,"--transition-duration":`${n()}s`},onChange:d=>{if(!e)return;const u=parseFloat(d.currentTarget.value);e.currentTime=u,o()}})})},pP=P.memo(()=>{const i=Qs(),e=i.audioRef.current,[t,s]=P.useState(e.currentTime||0),[n,r]=P.useState(e.duration||0);return P.useEffect(()=>{if(!e)return;const o=()=>{s(e.currentTime),r(e.duration)};return e.addEventListener("timeupdate",o),e.addEventListener("loadedmetadata",o),()=>{e.removeEventListener("timeupdate",o),e.removeEventListener("loadedmetadata",o)}},[e]),T.jsxs("div",{className:"duration noSelect",children:[T.jsx("div",{className:"current",children:i.formatTime(t)}),T.jsx("div",{className:"divider",children:"/"}),T.jsx("div",{className:"total",children:i.formatTime(n)})]})}),dA=P.createContext({}),L0=()=>P.useContext(dA),VT=(i,e)=>{if(i.offlineState==="downloaded"){const t=e.filter(s=>s.offlineState!=="downloaded");if(t.length){for(const s of t)s.offlineState="downloading";window.addToDownloads(t)}}},yP=async(i,e)=>{if(i?await window.audioStorage.hasTrack(i):!1){const s=e.filter(n=>n.offlineState!=="downloaded");if(s.length){for(const n of s)n.offlineState="downloading";window.addToDownloads(s)}}},hA=P.createContext({}),ns=()=>P.useContext(hA),fA=P.createContext({}),mA=()=>P.useContext(fA),gA=()=>{const i=ns(),{data:e,isFetching:t,isPending:s,error:n}=la({queryKey:["playlists"],queryFn:async()=>await i.getAllPlaylists()});return{playlists:e||[],loading:t||s,error:n?n.message:null}},vP=()=>T.jsx("div",{className:"inline-loader",children:T.jsxs("svg",{className:"loading",children:[T.jsx("circle",{cx:"6",cy:"6",r:"6"}),T.jsx("circle",{cx:"6",cy:"6",r:"6"})]})}),SP=i=>{const e=ns(),t=Qs(),s=P.useRef(null),{showSidenav:n,closeSidenav:r}=b0(),{playlists:o,loading:c,error:d}=gA(),{disabled:u,setDisabled:f}=mA(),[m,p]=P.useState(new URLSearchParams(location.search).get("search")||""),[v,S]=P.useState([]),[y,E]=P.useState(!1),[A,R]=P.useState(null),[I,C]=P.useState(!1),L=hr(),{storageStats:D}=L0(),_=V=>{const ae=parseFloat(V.target.value);t.setVolume(ae)},M=V=>{V.stopPropagation();const ae=V.deltaY>0?-.02:.02,G=Math.max(0,Math.min(1,t.volume+ae));t.setVolume(G)};P.useEffect(()=>{const V=setTimeout(()=>{(async()=>{if(!m||!e.auth.serverUrl||!e.auth.token||!e.auth.userId){S([]),C(!1);return}E(!0),R(null),C(!0);try{const[G,Z,B]=await Promise.all([e.searchArtists(m,20),e.searchItems(m,40),e.searchGenres(m,20)]),Q=G.slice(0,4),re=Z.filter(H=>H.Type==="Audio").slice(0,6),J=Z.filter(H=>H.Type==="MusicAlbum").slice(0,4),N=Z.filter(H=>H.Type==="Playlist").slice(0,4),K=B.slice(0,4),le=[...re,...Q,...J,...N,...K];S(le)}catch(G){console.error("Search Error:",G),R("Failed to load search results")}finally{E(!1)}})()},200);return()=>clearTimeout(V)},[m,e.auth.serverUrl,e.auth.token,e.auth.userId,e]);const U=V=>{p(V.target.value)},F=()=>{p(""),S([]),C(!1)},z=V=>{var ae;V&&(V.Id===((ae=t.currentTrack)==null?void 0:ae.Id)?t.togglePlayPause():(t.setCurrentPlaylist({playlist:[V],title:"Sidenav Track"}),t.playTrack(0)),r())};return P.useEffect(()=>{const V=ae=>{var G;(ae.ctrlKey||ae.metaKey)&&ae.key==="k"&&(ae.preventDefault(),(G=s.current)==null||G.focus())};return window.addEventListener("keydown",V),()=>window.removeEventListener("keydown",V)},[]),T.jsx("aside",{className:"sidenav",children:T.jsxs("div",{className:"sidenav_wrapper"+(n?" active":"")+(u?" lockscroll":""),children:[T.jsx("div",{className:"sidenav_header",children:T.jsx($i,{to:"/",onClick:r,className:"logo"})}),T.jsxs("nav",{className:"sidenav_content",children:[T.jsxs("ul",{className:"links noSelect",children:[T.jsx("li",{children:T.jsx($i,{to:"/",onClick:r,children:"Home"})}),T.jsx("li",{children:T.jsx($i,{to:"/tracks",onClick:r,children:"Tracks"})}),T.jsx("li",{children:T.jsx($i,{to:"/albums",onClick:r,children:"Albums"})}),T.jsx("li",{children:T.jsx($i,{to:"/artists",onClick:r,children:"Artists"})}),T.jsx("li",{children:T.jsx($i,{to:"/favorites",onClick:r,children:"Favorites"})})]}),T.jsxs("div",{className:"search",children:[T.jsx("div",{className:"search_header",children:T.jsxs("div",{className:`input_container ${m?"active":""}`,children:[T.jsx("div",{className:"search-icon noSelect",children:T.jsx(aA,{width:13,height:13})}),T.jsx("input",{type:"search",placeholder:"Search",value:m,onChange:U,ref:s}),!y&&T.jsx("div",{className:"search-clear",onClick:F,children:T.jsx(oA,{width:13,height:13})}),y&&T.jsx("div",{className:"search-loading noSelect",children:T.jsx(vP,{})})]})}),T.jsx("div",{className:"search_results",children:m&&T.jsxs(T.Fragment,{children:[A&&T.jsx("div",{className:"indicator error",children:A}),!y&&I&&!A&&v.length===0&&T.jsxs("div",{className:"empty",children:["Search for ",T.jsxs("span",{className:"keyword",children:["'",m,"'"]})," yields no results"]}),!y&&!A&&v.length>0&&T.jsxs("div",{className:"results noSelect",children:[v.map(V=>{var Z,B,Q,re,J,N;const ae=((Z=L.selectedItem)==null?void 0:Z.Id)===V.Id&&L.isOpen,G=[V.Type==="Audio"&&((B=t.currentTrack)==null?void 0:B.Id)===V.Id?t.isPlaying?"playing":"paused":"",ae?"active":""].filter(Boolean).join(" ");return V.Type==="Audio"?T.jsx("div",{onClick:()=>z(V),className:`result ${G}`,onContextMenu:K=>L.onContextMenu(K,{item:V}),onTouchStart:K=>L.onTouchStart(K,{item:V}),onTouchMove:L.onTouchClear,onTouchEnd:L.onTouchClear,children:T.jsxs("div",{className:"type song",children:[T.jsxs("div",{className:"icon",title:"Track",children:[T.jsx("div",{className:"song-icon",children:T.jsx(nA,{width:14,height:14})}),T.jsx("div",{className:"play-icon"}),T.jsx("div",{className:"pause-icon"}),T.jsx("div",{className:"play-state-animation",children:T.jsx(cA,{width:14,height:14,className:"sound-bars"})})]}),T.jsxs("div",{className:"text",children:[V.Name," ",T.jsxs("span",{className:"artist",children:["(",((re=(Q=V.ArtistItems)==null?void 0:Q[0])==null?void 0:re.Name)||((J=V.Artists)==null?void 0:J[0])||"Unknown Artist",")"]})]})]})},`${V.Type}-${V.Id}`):T.jsxs($i,{to:`/${V.Type===je.MusicArtist?"artist":V.Type===je.MusicAlbum?"album":(N=V.Type)==null?void 0:N.toLowerCase()}/${V.Type===je.Genre?encodeURIComponent(V.Name):V.Id}`,onClick:r,className:`result ${G}`,...V.Type!==je.Genre&&{onContextMenu:K=>L.onContextMenu(K,{item:V}),onTouchStart:K=>L.onTouchStart(K,{item:V}),onTouchMove:L.onTouchClear,onTouchEnd:L.onTouchClear},children:[V.Type===je.MusicArtist&&T.jsxs("div",{className:"type artist",children:[T.jsx("div",{className:"icon",title:"Artist",children:T.jsx(A0,{width:14,height:14})}),T.jsx("div",{className:"text",children:V.Name})]}),V.Type===je.MusicAlbum&&T.jsxs("div",{className:"type album",children:[T.jsx("div",{className:"icon",title:"Album",children:T.jsx(Sh,{width:14,height:14})}),T.jsx("div",{className:"text",children:V.Name})]}),V.Type===je.Playlist&&T.jsxs("div",{className:"type playlist",children:[T.jsx("div",{className:"icon",title:"Playlist",children:T.jsx(I0,{width:14,height:14})}),T.jsx("div",{className:"text",children:V.Name})]}),V.Type===je.Genre&&T.jsxs("div",{className:"type genre",children:[T.jsx("div",{className:"icon",title:"Genre",children:T.jsx(p0,{size:14})}),T.jsx("div",{className:"text",children:V.Name})]})]},`${V.Type}-${V.Id}`)}),T.jsx("div",{className:"additional",children:T.jsx($i,{to:`/search/${encodeURIComponent(m)}`,onClick:r,className:"textlink",children:"See more results"})})]})]})})]}),!m&&T.jsxs("div",{className:"playlists",children:[c&&T.jsx("div",{className:"indicator loading",children:"Loading playlists..."}),d&&T.jsx("div",{className:"indicator error",children:d}),!c&&!d&&o.length===0&&T.jsx("div",{className:"indicator info",children:"No playlists found"}),T.jsx("div",{className:"container noSelect",children:o.map(V=>T.jsx($i,{to:`/playlist/${V.Id}`,onClick:r,className:({isActive:ae})=>ae?"playlist active":"playlist",children:V.Name},V.Id))})]})]}),T.jsxs("div",{className:"sidenav_footer",children:[T.jsxs("div",{className:"volume",children:[T.jsxs("div",{className:"indicator",children:["Volume: ",(t.volume*100).toFixed(0),"%"]}),T.jsx("div",{className:"control",children:T.jsx("input",{type:"range",id:"volume",name:"volume",min:"0",max:"1",step:"0.02",value:t.volume,onChange:_,onWheel:M,onMouseEnter:()=>f(!0),onMouseLeave:()=>f(!1)})})]}),T.jsxs("div",{className:"account",children:[T.jsxs("div",{className:"status",children:[T.jsx("div",{className:"indicator",children:"Connected"}),T.jsx("div",{className:"username",title:i.username,children:i.username})]}),T.jsxs("div",{className:"actions",children:[D.trackCount>0&&T.jsx($i,{to:"/synced",className:"icon synced",onClick:r,title:"Synced",children:T.jsx(na,{width:16,height:16})}),T.jsx($i,{to:"/settings",className:"icon settings",onClick:r,title:"Settings",children:T.jsx(xD,{size:16})})]})]})]})]})})},pA=P.createContext({}),Yh=()=>P.useContext(pA),xP=()=>{const i="OfflineAudioDB",e="tracks",s=P.useRef(new Promise((v,S)=>{const y=indexedDB.open(i,3);y.onupgradeneeded=E=>{const A=y.result,R=E.oldVersion;if(A.objectStoreNames.contains(e))R<2&&y.transaction.objectStore(e).createIndex("by_kind","mediaItem.Type",{unique:!1}),R<3&&y.transaction.objectStore(e).createIndex("by_containerId","containerId",{unique:!1});else{const I=A.createObjectStore(e);I.createIndex("by_kind","mediaItem.Type",{unique:!1}),I.createIndex("by_containerId","containerId",{unique:!1})}},y.onsuccess=()=>{v(y.result)},y.onerror=()=>{console.error("IndexedDB error:",y.error),S(y.error)}})),n=P.useCallback(async(v,S)=>{if(!s.current)throw new Error("Database not initialized");const E=(await s.current).transaction(e,"readwrite");return E.objectStore(e).put(S,v),new Promise((A,R)=>{E.oncomplete=()=>A(),E.onerror=()=>R(E.error),E.onabort=()=>R(E.error)})},[]),r=P.useCallback(async v=>{if(!s.current)throw new Error("Database not initialized");const y=(await s.current).transaction(e,"readwrite"),E=y.objectStore(e),A=E.get(v);return A.onsuccess=()=>{const R=A.result;if(E.delete(v),(R==null?void 0:R.type)==="container"&&v){const I=E.index("by_containerId"),C=IDBKeyRange.only(v),L=I.openCursor(C);L.onsuccess=D=>{const _=D.target.result;_&&(E.delete(_.primaryKey),_.continue())}}},A.onerror=()=>{console.error("Error fetching record for deletion:",A.error)},new Promise((R,I)=>{y.oncomplete=()=>R(),y.onerror=()=>I(y.error),y.onabort=()=>I(y.error)})},[]),o=P.useCallback(async v=>{if(!s.current)throw new Error("Database not initialized");const E=(await s.current).transaction(e,"readonly").objectStore(e).get(v);return new Promise((A,R)=>{E.onsuccess=()=>A(E.result||null),E.onerror=()=>R(E.error)})},[]),c=P.useCallback(async v=>await o(v)!==null,[o]),d=P.useCallback(async v=>{const S=await o(v);return(S==null?void 0:S.type)==="song"?{type:"song",url:URL.createObjectURL(S.blob)}:(S==null?void 0:S.type)==="m3u8"?{type:"m3u8",url:URL.createObjectURL(S.playlist)}:void 0},[o]),u=P.useCallback(async()=>{try{if(!s.current)throw new Error("Database not initialized");const E=(await s.current).transaction(e,"readonly").objectStore(e).index("by_kind"),A=IDBKeyRange.only(je.Audio),R=E.count(A);return await new Promise((C,L)=>{R.onsuccess=()=>C(R.result),R.onerror=()=>L(R.error)})}catch(v){throw console.error("Failed to get storage stats:",v),v}},[]),f=P.useCallback(async()=>{if(!s.current)throw new Error("Database not initialized");const S=(await s.current).transaction(e,"readwrite");return S.objectStore(e).clear(),new Promise((y,E)=>{S.oncomplete=()=>y(),S.onerror=()=>E(S.error),S.onabort=()=>E(S.error)})},[]),p={saveTrack:n,removeTrack:r,getTrack:o,hasTrack:c,getPlayableUrl:d,getTrackCount:u,clearAllDownloads:f,getPageFromIndexedDb:async(v,S,y)=>{if(!s.current)throw new Error("Database not initialized");const I=(await s.current).transaction(e,"readonly").objectStore(e).index("by_kind"),C=IDBKeyRange.only(S);return new Promise((L,D)=>{const _=[];let M=0;const U=v*y,F=I.openCursor(C);F.onerror=()=>{D(F.error)},F.onsuccess=z=>{const V=z.target.result;if(!V){L(_);return}if(M<U){const G=U-M;try{V.advance(G),M+=G}catch(Z){console.error("Failed to skip ahead in cursor:",Z),M++,V.continue()}return}const ae=V.value;ae.mediaItem&&_.push(ae.mediaItem),_.length<y?V.continue():L(_)}})}};return window.audioStorage=p,p},TP=({children:i})=>{const e=xP();return T.jsx(pA.Provider,{value:e,children:i})};var w0=function(){function i(){this.listeners={}}var e=i.prototype;return e.on=function(s,n){this.listeners[s]||(this.listeners[s]=[]),this.listeners[s].push(n)},e.off=function(s,n){if(!this.listeners[s])return!1;var r=this.listeners[s].indexOf(n);return this.listeners[s]=this.listeners[s].slice(0),this.listeners[s].splice(r,1),r>-1},e.trigger=function(s){var n=this.listeners[s];if(n)if(arguments.length===2)for(var r=n.length,o=0;o<r;++o)n[o].call(this,arguments[1]);else for(var c=Array.prototype.slice.call(arguments,1),d=n.length,u=0;u<d;++u)n[u].apply(this,c)},e.dispose=function(){this.listeners={}},e.pipe=function(s){this.on("data",function(n){s.push(n)})},i}();function el(){return el=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)({}).hasOwnProperty.call(t,s)&&(i[s]=t[s])}return i},el.apply(null,arguments)}var Lg,$T;function EP(){if($T)return Lg;$T=1;var i;return typeof window<"u"?i=window:typeof qx<"u"?i=qx:typeof self<"u"?i=self:i={},Lg=i,Lg}var bP=EP();const GT=i0(bP);var AP=function(e){return GT.atob?GT.atob(e):Buffer.from(e,"base64").toString("binary")};function IP(i){for(var e=AP(i),t=new Uint8Array(e.length),s=0;s<e.length;s++)t[s]=e.charCodeAt(s);return t}/*! @name m3u8-parser @version 7.2.0 @license Apache-2.0 */class RP extends w0{constructor(){super(),this.buffer=""}push(e){let t;for(this.buffer+=e,t=this.buffer.indexOf(`
`);t>-1;t=this.buffer.indexOf(`
`))this.trigger("data",this.buffer.substring(0,t)),this.buffer=this.buffer.substring(t+1)}}const LP="	",wg=function(i){const e=/([0-9.]*)?@?([0-9.]*)?/.exec(i||""),t={};return e[1]&&(t.length=parseInt(e[1],10)),e[2]&&(t.offset=parseInt(e[2],10)),t},wP=function(){const t="(?:"+"[^=]*"+")=(?:"+'"[^"]*"|[^,]*'+")";return new RegExp("(?:^|,)("+t+")")},Js=function(i){const e={};if(!i)return e;const t=i.split(wP());let s=t.length,n;for(;s--;)t[s]!==""&&(n=/([^=]*)=(.*)/.exec(t[s]).slice(1),n[0]=n[0].replace(/^\s+|\s+$/g,""),n[1]=n[1].replace(/^\s+|\s+$/g,""),n[1]=n[1].replace(/^['"](.*)['"]$/g,"$1"),e[n[0]]=n[1]);return e},HT=i=>{const e=i.split("x"),t={};return e[0]&&(t.width=parseInt(e[0],10)),e[1]&&(t.height=parseInt(e[1],10)),t};class CP extends w0{constructor(){super(),this.customParsers=[],this.tagMappers=[]}push(e){let t,s;if(e=e.trim(),e.length===0)return;if(e[0]!=="#"){this.trigger("data",{type:"uri",uri:e});return}this.tagMappers.reduce((r,o)=>{const c=o(e);return c===e?r:r.concat([c])},[e]).forEach(r=>{for(let o=0;o<this.customParsers.length;o++)if(this.customParsers[o].call(this,r))return;if(r.indexOf("#EXT")!==0){this.trigger("data",{type:"comment",text:r.slice(1)});return}if(r=r.replace("\r",""),t=/^#EXTM3U/.exec(r),t){this.trigger("data",{type:"tag",tagType:"m3u"});return}if(t=/^#EXTINF:([0-9\.]*)?,?(.*)?$/.exec(r),t){s={type:"tag",tagType:"inf"},t[1]&&(s.duration=parseFloat(t[1])),t[2]&&(s.title=t[2]),this.trigger("data",s);return}if(t=/^#EXT-X-TARGETDURATION:([0-9.]*)?/.exec(r),t){s={type:"tag",tagType:"targetduration"},t[1]&&(s.duration=parseInt(t[1],10)),this.trigger("data",s);return}if(t=/^#EXT-X-VERSION:([0-9.]*)?/.exec(r),t){s={type:"tag",tagType:"version"},t[1]&&(s.version=parseInt(t[1],10)),this.trigger("data",s);return}if(t=/^#EXT-X-MEDIA-SEQUENCE:(\-?[0-9.]*)?/.exec(r),t){s={type:"tag",tagType:"media-sequence"},t[1]&&(s.number=parseInt(t[1],10)),this.trigger("data",s);return}if(t=/^#EXT-X-DISCONTINUITY-SEQUENCE:(\-?[0-9.]*)?/.exec(r),t){s={type:"tag",tagType:"discontinuity-sequence"},t[1]&&(s.number=parseInt(t[1],10)),this.trigger("data",s);return}if(t=/^#EXT-X-PLAYLIST-TYPE:(.*)?$/.exec(r),t){s={type:"tag",tagType:"playlist-type"},t[1]&&(s.playlistType=t[1]),this.trigger("data",s);return}if(t=/^#EXT-X-BYTERANGE:(.*)?$/.exec(r),t){s=el(wg(t[1]),{type:"tag",tagType:"byterange"}),this.trigger("data",s);return}if(t=/^#EXT-X-ALLOW-CACHE:(YES|NO)?/.exec(r),t){s={type:"tag",tagType:"allow-cache"},t[1]&&(s.allowed=!/NO/.test(t[1])),this.trigger("data",s);return}if(t=/^#EXT-X-MAP:(.*)$/.exec(r),t){if(s={type:"tag",tagType:"map"},t[1]){const o=Js(t[1]);o.URI&&(s.uri=o.URI),o.BYTERANGE&&(s.byterange=wg(o.BYTERANGE))}this.trigger("data",s);return}if(t=/^#EXT-X-STREAM-INF:(.*)$/.exec(r),t){s={type:"tag",tagType:"stream-inf"},t[1]&&(s.attributes=Js(t[1]),s.attributes.RESOLUTION&&(s.attributes.RESOLUTION=HT(s.attributes.RESOLUTION)),s.attributes.BANDWIDTH&&(s.attributes.BANDWIDTH=parseInt(s.attributes.BANDWIDTH,10)),s.attributes["FRAME-RATE"]&&(s.attributes["FRAME-RATE"]=parseFloat(s.attributes["FRAME-RATE"])),s.attributes["PROGRAM-ID"]&&(s.attributes["PROGRAM-ID"]=parseInt(s.attributes["PROGRAM-ID"],10))),this.trigger("data",s);return}if(t=/^#EXT-X-MEDIA:(.*)$/.exec(r),t){s={type:"tag",tagType:"media"},t[1]&&(s.attributes=Js(t[1])),this.trigger("data",s);return}if(t=/^#EXT-X-ENDLIST/.exec(r),t){this.trigger("data",{type:"tag",tagType:"endlist"});return}if(t=/^#EXT-X-DISCONTINUITY/.exec(r),t){this.trigger("data",{type:"tag",tagType:"discontinuity"});return}if(t=/^#EXT-X-PROGRAM-DATE-TIME:(.*)$/.exec(r),t){s={type:"tag",tagType:"program-date-time"},t[1]&&(s.dateTimeString=t[1],s.dateTimeObject=new Date(t[1])),this.trigger("data",s);return}if(t=/^#EXT-X-KEY:(.*)$/.exec(r),t){s={type:"tag",tagType:"key"},t[1]&&(s.attributes=Js(t[1]),s.attributes.IV&&(s.attributes.IV.substring(0,2).toLowerCase()==="0x"&&(s.attributes.IV=s.attributes.IV.substring(2)),s.attributes.IV=s.attributes.IV.match(/.{8}/g),s.attributes.IV[0]=parseInt(s.attributes.IV[0],16),s.attributes.IV[1]=parseInt(s.attributes.IV[1],16),s.attributes.IV[2]=parseInt(s.attributes.IV[2],16),s.attributes.IV[3]=parseInt(s.attributes.IV[3],16),s.attributes.IV=new Uint32Array(s.attributes.IV))),this.trigger("data",s);return}if(t=/^#EXT-X-START:(.*)$/.exec(r),t){s={type:"tag",tagType:"start"},t[1]&&(s.attributes=Js(t[1]),s.attributes["TIME-OFFSET"]=parseFloat(s.attributes["TIME-OFFSET"]),s.attributes.PRECISE=/YES/.test(s.attributes.PRECISE)),this.trigger("data",s);return}if(t=/^#EXT-X-CUE-OUT-CONT:(.*)?$/.exec(r),t){s={type:"tag",tagType:"cue-out-cont"},t[1]?s.data=t[1]:s.data="",this.trigger("data",s);return}if(t=/^#EXT-X-CUE-OUT:(.*)?$/.exec(r),t){s={type:"tag",tagType:"cue-out"},t[1]?s.data=t[1]:s.data="",this.trigger("data",s);return}if(t=/^#EXT-X-CUE-IN:?(.*)?$/.exec(r),t){s={type:"tag",tagType:"cue-in"},t[1]?s.data=t[1]:s.data="",this.trigger("data",s);return}if(t=/^#EXT-X-SKIP:(.*)$/.exec(r),t&&t[1]){s={type:"tag",tagType:"skip"},s.attributes=Js(t[1]),s.attributes.hasOwnProperty("SKIPPED-SEGMENTS")&&(s.attributes["SKIPPED-SEGMENTS"]=parseInt(s.attributes["SKIPPED-SEGMENTS"],10)),s.attributes.hasOwnProperty("RECENTLY-REMOVED-DATERANGES")&&(s.attributes["RECENTLY-REMOVED-DATERANGES"]=s.attributes["RECENTLY-REMOVED-DATERANGES"].split(LP)),this.trigger("data",s);return}if(t=/^#EXT-X-PART:(.*)$/.exec(r),t&&t[1]){s={type:"tag",tagType:"part"},s.attributes=Js(t[1]),["DURATION"].forEach(function(o){s.attributes.hasOwnProperty(o)&&(s.attributes[o]=parseFloat(s.attributes[o]))}),["INDEPENDENT","GAP"].forEach(function(o){s.attributes.hasOwnProperty(o)&&(s.attributes[o]=/YES/.test(s.attributes[o]))}),s.attributes.hasOwnProperty("BYTERANGE")&&(s.attributes.byterange=wg(s.attributes.BYTERANGE)),this.trigger("data",s);return}if(t=/^#EXT-X-SERVER-CONTROL:(.*)$/.exec(r),t&&t[1]){s={type:"tag",tagType:"server-control"},s.attributes=Js(t[1]),["CAN-SKIP-UNTIL","PART-HOLD-BACK","HOLD-BACK"].forEach(function(o){s.attributes.hasOwnProperty(o)&&(s.attributes[o]=parseFloat(s.attributes[o]))}),["CAN-SKIP-DATERANGES","CAN-BLOCK-RELOAD"].forEach(function(o){s.attributes.hasOwnProperty(o)&&(s.attributes[o]=/YES/.test(s.attributes[o]))}),this.trigger("data",s);return}if(t=/^#EXT-X-PART-INF:(.*)$/.exec(r),t&&t[1]){s={type:"tag",tagType:"part-inf"},s.attributes=Js(t[1]),["PART-TARGET"].forEach(function(o){s.attributes.hasOwnProperty(o)&&(s.attributes[o]=parseFloat(s.attributes[o]))}),this.trigger("data",s);return}if(t=/^#EXT-X-PRELOAD-HINT:(.*)$/.exec(r),t&&t[1]){s={type:"tag",tagType:"preload-hint"},s.attributes=Js(t[1]),["BYTERANGE-START","BYTERANGE-LENGTH"].forEach(function(o){if(s.attributes.hasOwnProperty(o)){s.attributes[o]=parseInt(s.attributes[o],10);const c=o==="BYTERANGE-LENGTH"?"length":"offset";s.attributes.byterange=s.attributes.byterange||{},s.attributes.byterange[c]=s.attributes[o],delete s.attributes[o]}}),this.trigger("data",s);return}if(t=/^#EXT-X-RENDITION-REPORT:(.*)$/.exec(r),t&&t[1]){s={type:"tag",tagType:"rendition-report"},s.attributes=Js(t[1]),["LAST-MSN","LAST-PART"].forEach(function(o){s.attributes.hasOwnProperty(o)&&(s.attributes[o]=parseInt(s.attributes[o],10))}),this.trigger("data",s);return}if(t=/^#EXT-X-DATERANGE:(.*)$/.exec(r),t&&t[1]){s={type:"tag",tagType:"daterange"},s.attributes=Js(t[1]),["ID","CLASS"].forEach(function(c){s.attributes.hasOwnProperty(c)&&(s.attributes[c]=String(s.attributes[c]))}),["START-DATE","END-DATE"].forEach(function(c){s.attributes.hasOwnProperty(c)&&(s.attributes[c]=new Date(s.attributes[c]))}),["DURATION","PLANNED-DURATION"].forEach(function(c){s.attributes.hasOwnProperty(c)&&(s.attributes[c]=parseFloat(s.attributes[c]))}),["END-ON-NEXT"].forEach(function(c){s.attributes.hasOwnProperty(c)&&(s.attributes[c]=/YES/i.test(s.attributes[c]))}),["SCTE35-CMD"," SCTE35-OUT","SCTE35-IN"].forEach(function(c){s.attributes.hasOwnProperty(c)&&(s.attributes[c]=s.attributes[c].toString(16))});const o=/^X-([A-Z]+-)+[A-Z]+$/;for(const c in s.attributes){if(!o.test(c))continue;const d=/[0-9A-Fa-f]{6}/g.test(s.attributes[c]),u=/^\d+(\.\d+)?$/.test(s.attributes[c]);s.attributes[c]=d?s.attributes[c].toString(16):u?parseFloat(s.attributes[c]):String(s.attributes[c])}this.trigger("data",s);return}if(t=/^#EXT-X-INDEPENDENT-SEGMENTS/.exec(r),t){this.trigger("data",{type:"tag",tagType:"independent-segments"});return}if(t=/^#EXT-X-I-FRAMES-ONLY/.exec(r),t){this.trigger("data",{type:"tag",tagType:"i-frames-only"});return}if(t=/^#EXT-X-CONTENT-STEERING:(.*)$/.exec(r),t){s={type:"tag",tagType:"content-steering"},s.attributes=Js(t[1]),this.trigger("data",s);return}if(t=/^#EXT-X-I-FRAME-STREAM-INF:(.*)$/.exec(r),t){s={type:"tag",tagType:"i-frame-playlist"},s.attributes=Js(t[1]),s.attributes.URI&&(s.uri=s.attributes.URI),s.attributes.BANDWIDTH&&(s.attributes.BANDWIDTH=parseInt(s.attributes.BANDWIDTH,10)),s.attributes.RESOLUTION&&(s.attributes.RESOLUTION=HT(s.attributes.RESOLUTION)),s.attributes["AVERAGE-BANDWIDTH"]&&(s.attributes["AVERAGE-BANDWIDTH"]=parseInt(s.attributes["AVERAGE-BANDWIDTH"],10)),s.attributes["FRAME-RATE"]&&(s.attributes["FRAME-RATE"]=parseFloat(s.attributes["FRAME-RATE"])),this.trigger("data",s);return}if(t=/^#EXT-X-DEFINE:(.*)$/.exec(r),t){s={type:"tag",tagType:"define"},s.attributes=Js(t[1]),this.trigger("data",s);return}this.trigger("data",{type:"tag",data:r.slice(4)})})}addParser({expression:e,customType:t,dataParser:s,segment:n}){typeof s!="function"&&(s=r=>r),this.customParsers.push(r=>{if(e.exec(r))return this.trigger("data",{type:"custom",data:s(r),customType:t,segment:n}),!0})}addTagMapper({expression:e,map:t}){const s=n=>e.test(n)?t(n):n;this.tagMappers.push(s)}}const OP=i=>i.toLowerCase().replace(/-(\w)/g,e=>e[1].toUpperCase()),Hr=function(i){const e={};return Object.keys(i).forEach(function(t){e[OP(t)]=i[t]}),e},Cg=function(i){const{serverControl:e,targetDuration:t,partTargetDuration:s}=i;if(!e)return;const n="#EXT-X-SERVER-CONTROL",r="holdBack",o="partHoldBack",c=t&&t*3,d=s&&s*2;t&&!e.hasOwnProperty(r)&&(e[r]=c,this.trigger("info",{message:`${n} defaulting HOLD-BACK to targetDuration * 3 (${c}).`})),c&&e[r]<c&&(this.trigger("warn",{message:`${n} clamping HOLD-BACK (${e[r]}) to targetDuration * 3 (${c})`}),e[r]=c),s&&!e.hasOwnProperty(o)&&(e[o]=s*3,this.trigger("info",{message:`${n} defaulting PART-HOLD-BACK to partTargetDuration * 3 (${e[o]}).`})),s&&e[o]<d&&(this.trigger("warn",{message:`${n} clamping PART-HOLD-BACK (${e[o]}) to partTargetDuration * 2 (${d}).`}),e[o]=d)};class DP extends w0{constructor(e={}){super(),this.lineStream=new RP,this.parseStream=new CP,this.lineStream.pipe(this.parseStream),this.mainDefinitions=e.mainDefinitions||{},this.params=new URL(e.uri,"https://a.com").searchParams,this.lastProgramDateTime=null;const t=this,s=[];let n={},r,o,c=!1;const d=function(){},u={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},f="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed";let m=0;this.manifest={allowCache:!0,discontinuityStarts:[],dateRanges:[],iFramePlaylists:[],segments:[]};let p=0,v=0;const S={};this.on("end",()=>{n.uri||!n.parts&&!n.preloadHints||(!n.map&&r&&(n.map=r),!n.key&&o&&(n.key=o),!n.timeline&&typeof m=="number"&&(n.timeline=m),this.manifest.preloadSegment=n)}),this.parseStream.on("data",function(y){let E,A;if(t.manifest.definitions){for(const R in t.manifest.definitions)if(y.uri&&(y.uri=y.uri.replace(`{$${R}}`,t.manifest.definitions[R])),y.attributes)for(const I in y.attributes)typeof y.attributes[I]=="string"&&(y.attributes[I]=y.attributes[I].replace(`{$${R}}`,t.manifest.definitions[R]))}({tag(){({version(){y.version&&(this.manifest.version=y.version)},"allow-cache"(){this.manifest.allowCache=y.allowed,"allowed"in y||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange(){const R={};"length"in y&&(n.byterange=R,R.length=y.length,"offset"in y||(y.offset=p)),"offset"in y&&(n.byterange=R,R.offset=y.offset),p=R.offset+R.length},endlist(){this.manifest.endList=!0},inf(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),y.title&&(n.title=y.title),y.duration>0&&(n.duration=y.duration),y.duration===0&&(n.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=s},key(){if(!y.attributes){this.trigger("warn",{message:"ignoring key declaration without attribute list"});return}if(y.attributes.METHOD==="NONE"){o=null;return}if(!y.attributes.URI){this.trigger("warn",{message:"ignoring key declaration without URI"});return}if(y.attributes.KEYFORMAT==="com.apple.streamingkeydelivery"){this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.apple.fps.1_0"]={attributes:y.attributes};return}if(y.attributes.KEYFORMAT==="com.microsoft.playready"){this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.microsoft.playready"]={uri:y.attributes.URI};return}if(y.attributes.KEYFORMAT===f){if(["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"].indexOf(y.attributes.METHOD)===-1){this.trigger("warn",{message:"invalid key method provided for Widevine"});return}if(y.attributes.METHOD==="SAMPLE-AES-CENC"&&this.trigger("warn",{message:"SAMPLE-AES-CENC is deprecated, please use SAMPLE-AES-CTR instead"}),y.attributes.URI.substring(0,23)!=="data:text/plain;base64,"){this.trigger("warn",{message:"invalid key URI provided for Widevine"});return}if(!(y.attributes.KEYID&&y.attributes.KEYID.substring(0,2)==="0x")){this.trigger("warn",{message:"invalid key ID provided for Widevine"});return}this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.widevine.alpha"]={attributes:{schemeIdUri:y.attributes.KEYFORMAT,keyId:y.attributes.KEYID.substring(2)},pssh:IP(y.attributes.URI.split(",")[1])};return}y.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),o={method:y.attributes.METHOD||"AES-128",uri:y.attributes.URI},typeof y.attributes.IV<"u"&&(o.iv=y.attributes.IV)},"media-sequence"(){if(!isFinite(y.number)){this.trigger("warn",{message:"ignoring invalid media sequence: "+y.number});return}this.manifest.mediaSequence=y.number},"discontinuity-sequence"(){if(!isFinite(y.number)){this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+y.number});return}this.manifest.discontinuitySequence=y.number,m=y.number},"playlist-type"(){if(!/VOD|EVENT/.test(y.playlistType)){this.trigger("warn",{message:"ignoring unknown playlist type: "+y.playlist});return}this.manifest.playlistType=y.playlistType},map(){r={},y.uri&&(r.uri=y.uri),y.byterange&&(r.byterange=y.byterange),o&&(r.key=o)},"stream-inf"(){if(this.manifest.playlists=s,this.manifest.mediaGroups=this.manifest.mediaGroups||u,!y.attributes){this.trigger("warn",{message:"ignoring empty stream-inf attributes"});return}n.attributes||(n.attributes={}),el(n.attributes,y.attributes)},media(){if(this.manifest.mediaGroups=this.manifest.mediaGroups||u,!(y.attributes&&y.attributes.TYPE&&y.attributes["GROUP-ID"]&&y.attributes.NAME)){this.trigger("warn",{message:"ignoring incomplete or missing media group"});return}const R=this.manifest.mediaGroups[y.attributes.TYPE];R[y.attributes["GROUP-ID"]]=R[y.attributes["GROUP-ID"]]||{},E=R[y.attributes["GROUP-ID"]],A={default:/yes/i.test(y.attributes.DEFAULT)},A.default?A.autoselect=!0:A.autoselect=/yes/i.test(y.attributes.AUTOSELECT),y.attributes.LANGUAGE&&(A.language=y.attributes.LANGUAGE),y.attributes.URI&&(A.uri=y.attributes.URI),y.attributes["INSTREAM-ID"]&&(A.instreamId=y.attributes["INSTREAM-ID"]),y.attributes.CHARACTERISTICS&&(A.characteristics=y.attributes.CHARACTERISTICS),y.attributes.FORCED&&(A.forced=/yes/i.test(y.attributes.FORCED)),E[y.attributes.NAME]=A},discontinuity(){m+=1,n.discontinuity=!0,this.manifest.discontinuityStarts.push(s.length)},"program-date-time"(){typeof this.manifest.dateTimeString>"u"&&(this.manifest.dateTimeString=y.dateTimeString,this.manifest.dateTimeObject=y.dateTimeObject),n.dateTimeString=y.dateTimeString,n.dateTimeObject=y.dateTimeObject;const{lastProgramDateTime:R}=this;this.lastProgramDateTime=new Date(y.dateTimeString).getTime(),R===null&&this.manifest.segments.reduceRight((I,C)=>(C.programDateTime=I-C.duration*1e3,C.programDateTime),this.lastProgramDateTime)},targetduration(){if(!isFinite(y.duration)||y.duration<0){this.trigger("warn",{message:"ignoring invalid target duration: "+y.duration});return}this.manifest.targetDuration=y.duration,Cg.call(this,this.manifest)},start(){if(!y.attributes||isNaN(y.attributes["TIME-OFFSET"])){this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"});return}this.manifest.start={timeOffset:y.attributes["TIME-OFFSET"],precise:y.attributes.PRECISE}},"cue-out"(){n.cueOut=y.data},"cue-out-cont"(){n.cueOutCont=y.data},"cue-in"(){n.cueIn=y.data},skip(){this.manifest.skip=Hr(y.attributes),this.warnOnMissingAttributes_("#EXT-X-SKIP",y.attributes,["SKIPPED-SEGMENTS"])},part(){c=!0;const R=this.manifest.segments.length,I=Hr(y.attributes);n.parts=n.parts||[],n.parts.push(I),I.byterange&&(I.byterange.hasOwnProperty("offset")||(I.byterange.offset=v),v=I.byterange.offset+I.byterange.length);const C=n.parts.length-1;this.warnOnMissingAttributes_(`#EXT-X-PART #${C} for segment #${R}`,y.attributes,["URI","DURATION"]),this.manifest.renditionReports&&this.manifest.renditionReports.forEach((L,D)=>{L.hasOwnProperty("lastPart")||this.trigger("warn",{message:`#EXT-X-RENDITION-REPORT #${D} lacks required attribute(s): LAST-PART`})})},"server-control"(){const R=this.manifest.serverControl=Hr(y.attributes);R.hasOwnProperty("canBlockReload")||(R.canBlockReload=!1,this.trigger("info",{message:"#EXT-X-SERVER-CONTROL defaulting CAN-BLOCK-RELOAD to false"})),Cg.call(this,this.manifest),R.canSkipDateranges&&!R.hasOwnProperty("canSkipUntil")&&this.trigger("warn",{message:"#EXT-X-SERVER-CONTROL lacks required attribute CAN-SKIP-UNTIL which is required when CAN-SKIP-DATERANGES is set"})},"preload-hint"(){const R=this.manifest.segments.length,I=Hr(y.attributes),C=I.type&&I.type==="PART";n.preloadHints=n.preloadHints||[],n.preloadHints.push(I),I.byterange&&(I.byterange.hasOwnProperty("offset")||(I.byterange.offset=C?v:0,C&&(v=I.byterange.offset+I.byterange.length)));const L=n.preloadHints.length-1;if(this.warnOnMissingAttributes_(`#EXT-X-PRELOAD-HINT #${L} for segment #${R}`,y.attributes,["TYPE","URI"]),!!I.type)for(let D=0;D<n.preloadHints.length-1;D++){const _=n.preloadHints[D];_.type&&_.type===I.type&&this.trigger("warn",{message:`#EXT-X-PRELOAD-HINT #${L} for segment #${R} has the same TYPE ${I.type} as preload hint #${D}`})}},"rendition-report"(){const R=Hr(y.attributes);this.manifest.renditionReports=this.manifest.renditionReports||[],this.manifest.renditionReports.push(R);const I=this.manifest.renditionReports.length-1,C=["LAST-MSN","URI"];c&&C.push("LAST-PART"),this.warnOnMissingAttributes_(`#EXT-X-RENDITION-REPORT #${I}`,y.attributes,C)},"part-inf"(){this.manifest.partInf=Hr(y.attributes),this.warnOnMissingAttributes_("#EXT-X-PART-INF",y.attributes,["PART-TARGET"]),this.manifest.partInf.partTarget&&(this.manifest.partTargetDuration=this.manifest.partInf.partTarget),Cg.call(this,this.manifest)},daterange(){this.manifest.dateRanges.push(Hr(y.attributes));const R=this.manifest.dateRanges.length-1;this.warnOnMissingAttributes_(`#EXT-X-DATERANGE #${R}`,y.attributes,["ID","START-DATE"]);const I=this.manifest.dateRanges[R];I.endDate&&I.startDate&&new Date(I.endDate)<new Date(I.startDate)&&this.trigger("warn",{message:"EXT-X-DATERANGE END-DATE must be equal to or later than the value of the START-DATE"}),I.duration&&I.duration<0&&this.trigger("warn",{message:"EXT-X-DATERANGE DURATION must not be negative"}),I.plannedDuration&&I.plannedDuration<0&&this.trigger("warn",{message:"EXT-X-DATERANGE PLANNED-DURATION must not be negative"});const C=!!I.endOnNext;if(C&&!I.class&&this.trigger("warn",{message:"EXT-X-DATERANGE with an END-ON-NEXT=YES attribute must have a CLASS attribute"}),C&&(I.duration||I.endDate)&&this.trigger("warn",{message:"EXT-X-DATERANGE with an END-ON-NEXT=YES attribute must not contain DURATION or END-DATE attributes"}),I.duration&&I.endDate){const D=I.startDate.getTime()+I.duration*1e3;this.manifest.dateRanges[R].endDate=new Date(D)}if(!S[I.id])S[I.id]=I;else{for(const D in S[I.id])if(I[D]&&JSON.stringify(S[I.id][D])!==JSON.stringify(I[D])){this.trigger("warn",{message:"EXT-X-DATERANGE tags with the same ID in a playlist must have the same attributes values"});break}const L=this.manifest.dateRanges.findIndex(D=>D.id===I.id);this.manifest.dateRanges[L]=el(this.manifest.dateRanges[L],I),S[I.id]=el(S[I.id],I),this.manifest.dateRanges.pop()}},"independent-segments"(){this.manifest.independentSegments=!0},"i-frames-only"(){this.manifest.iFramesOnly=!0,this.requiredCompatibilityversion(this.manifest.version,4)},"content-steering"(){this.manifest.contentSteering=Hr(y.attributes),this.warnOnMissingAttributes_("#EXT-X-CONTENT-STEERING",y.attributes,["SERVER-URI"])},define(){this.manifest.definitions=this.manifest.definitions||{};const R=(I,C)=>{if(I in this.manifest.definitions){this.trigger("error",{message:`EXT-X-DEFINE: Duplicate name ${I}`});return}this.manifest.definitions[I]=C};if("QUERYPARAM"in y.attributes){if("NAME"in y.attributes||"IMPORT"in y.attributes){this.trigger("error",{message:"EXT-X-DEFINE: Invalid attributes"});return}const I=this.params.get(y.attributes.QUERYPARAM);if(!I){this.trigger("error",{message:`EXT-X-DEFINE: No query param ${y.attributes.QUERYPARAM}`});return}R(y.attributes.QUERYPARAM,decodeURIComponent(I));return}if("NAME"in y.attributes){if("IMPORT"in y.attributes){this.trigger("error",{message:"EXT-X-DEFINE: Invalid attributes"});return}if(!("VALUE"in y.attributes)||typeof y.attributes.VALUE!="string"){this.trigger("error",{message:`EXT-X-DEFINE: No value for ${y.attributes.NAME}`});return}R(y.attributes.NAME,y.attributes.VALUE);return}if("IMPORT"in y.attributes){if(!this.mainDefinitions[y.attributes.IMPORT]){this.trigger("error",{message:`EXT-X-DEFINE: No value ${y.attributes.IMPORT} to import, or IMPORT used on main playlist`});return}R(y.attributes.IMPORT,this.mainDefinitions[y.attributes.IMPORT]);return}this.trigger("error",{message:"EXT-X-DEFINE: No attribute"})},"i-frame-playlist"(){this.manifest.iFramePlaylists.push({attributes:y.attributes,uri:y.uri,timeline:m}),this.warnOnMissingAttributes_("#EXT-X-I-FRAME-STREAM-INF",y.attributes,["BANDWIDTH","URI"])}}[y.tagType]||d).call(t)},uri(){n.uri=y.uri,s.push(n),this.manifest.targetDuration&&!("duration"in n)&&(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),n.duration=this.manifest.targetDuration),o&&(n.key=o),n.timeline=m,r&&(n.map=r),v=0,this.lastProgramDateTime!==null&&(n.programDateTime=this.lastProgramDateTime,this.lastProgramDateTime+=n.duration*1e3),n={}},comment(){},custom(){y.segment?(n.custom=n.custom||{},n.custom[y.customType]=y.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[y.customType]=y.data)}})[y.type].call(t)})}requiredCompatibilityversion(e,t){(e<t||!e)&&this.trigger("warn",{message:`manifest must be at least version ${t}`})}warnOnMissingAttributes_(e,t,s){const n=[];s.forEach(function(r){t.hasOwnProperty(r)||n.push(r)}),n.length&&this.trigger("warn",{message:`${e} lacks required attribute(s): ${n.join(", ")}`})}push(e){this.lineStream.push(e)}end(){this.lineStream.push(`
`),this.manifest.dateRanges.length&&this.lastProgramDateTime===null&&this.trigger("warn",{message:"A playlist with EXT-X-DATERANGE tag must contain atleast one EXT-X-PROGRAM-DATE-TIME tag"}),this.lastProgramDateTime=null,this.trigger("end")}addParser(e){this.parseStream.addParser(e)}addTagMapper(e){this.parseStream.addTagMapper(e)}}const Dp=i=>"pages"in i&&!!i.pages,_P=i=>"Id"in i&&!!i.Id,PP=i=>typeof i=="object",ih=(i,e,t)=>{if(!i)return i;if(Array.isArray(i))return i.map(s=>ih(s,e,t));if(PP(i)){if(_P(i)&&e.includes(i.Id))return t(i);if(Dp(i))return{...i,pages:i.pages.map(n=>ih(n,e,t))};const s={};for(const n in i)s[n]=ih(i[n],e,t);return s}return i},C0=()=>{const i=El(),e=(t,s)=>{const n=i.getQueryCache().findAll();for(const r of n){const o=r.state.data;o&&i.setQueryData(r.queryKey,ih(o,t,s))}};return{patchMediaItem:(t,s)=>e([t],s),patchMediaItems:e,prependItemsToQueryData:(t,s)=>{const n=i.getQueryCache().findAll();for(const r of n){const o=r.state.data;if(o&&r.queryKey.slice(0,t.length).join(",")===t.join(","))if(Dp(o)){const[c,...d]=o.pages;r.setData({...o,pages:[[...s,...c],...d]})}else r.setData([...s,...o])}},removeItemFromQueryData:(t,s)=>{const n=i.getQueryCache().findAll();for(const r of n){const o=r.state.data;o&&r.queryKey.slice(0,t.length).join(",")===t.join(",")&&(Dp(o)?r.setData({...o,pages:o.pages.map(c=>c.filter(d=>d.Id!==s))}):r.setData(o.filter(c=>c.Id!==s)))}}}},zT="mediaTaskQueue",kP=()=>{const i=ns(),e=Qs(),t=Yh(),{patchMediaItem:s,patchMediaItems:n}=C0(),r=El(),[o,c]=P.useState({usage:0,indexedDB:0,trackCount:0}),d=P.useCallback(async()=>{var E,A;try{const R=await t.getTrackCount(),I=await((E=navigator.storage)==null?void 0:E.estimate());c({usage:(I==null?void 0:I.usage)||0,indexedDB:((A=I==null?void 0:I.usageDetails)==null?void 0:A.indexedDB)||0,trackCount:R})}catch(R){console.error("Failed to load storage stats:",R)}},[t]);P.useEffect(()=>{d()},[d]);const[u,f]=P.useState(()=>{try{const E=localStorage.getItem(zT);return E?JSON.parse(E):[]}catch(E){return console.error("Failed to load media task queue:",E),[]}}),m=P.useRef(!1),p=P.useRef(null);P.useEffect(()=>{try{localStorage.setItem(zT,JSON.stringify(u))}catch(E){console.error("Failed to save media task queue:",E)}},[u]);const v=(E,A)=>{const R=A==null?void 0:A.Id;n(E.map(I=>I.Id),I=>({...I,offlineState:"downloading"})),R&&s(R,I=>({...I,offlineState:"downloading"})),f(I=>{const C=I.filter(D=>!E.some(_=>_.Id===D.mediaItem.Id)),L=E.map(D=>({mediaItem:D,action:"download",containerId:R}));return R&&L.push({mediaItem:A,action:"download"}),L.length?[...C,...L]:C})},S=(E,A)=>{const R=A==null?void 0:A.Id;n(E.map(I=>I.Id),I=>({...I,offlineState:"deleting"})),R&&s(R,I=>({...I,offlineState:"deleting"})),f(I=>{const C=I.filter(D=>!E.some(_=>_.Id===D.mediaItem.Id)),L=E.map(D=>({mediaItem:D,action:"remove",containerId:R}));return R&&L.push({mediaItem:A,action:"remove"}),L.length?[...C,...L]:C})},y=P.useCallback(()=>{p.current&&(p.current.abort("clearQueue"),p.current=null),u.forEach(({mediaItem:E})=>{s(E.Id,A=>({...A,offlineState:A.offlineState==="downloading"?void 0:A.offlineState==="deleting"?"downloaded":A.offlineState}))}),f([])},[u,s]);return P.useEffect(()=>{(async()=>{if(m.current)return;const A=u[0];if(!A)return;m.current=!0,p.current=new AbortController;const R=p.current.signal,{mediaItem:I,action:C}=A;try{if(C==="download")if(await t.hasTrack(I.Id))s(I.Id,D=>({...D,offlineState:"downloaded"}));else{if(I.offlineState="downloaded",I.Type===je.Audio){const D=[128e3,192e3,256e3,32e4].includes(e.bitrate),_=i.getStreamUrl(I.Id,e.bitrate);if(D){const{playlist:M,ts:U}=await yA(_,R);await t.saveTrack(I.Id,{type:"m3u8",mediaItem:I,bitrate:e.bitrate,playlist:M,ts:U,containerId:A.containerId})}else{const M=await fetch(_,{signal:R});if(!M.ok)throw new Error(`HTTP ${M.status}`);const U=await M.blob();await t.saveTrack(I.Id,{type:"song",bitrate:e.bitrate,mediaItem:I,blob:U,containerId:A.containerId})}}else await t.saveTrack(I.Id,{type:"container",bitrate:e.bitrate,mediaItem:I});s(I.Id,D=>({...D,offlineState:"downloaded"}))}else C==="remove"&&(await t.removeTrack(I.Id),s(I.Id,L=>({...L,offlineState:void 0})));r.invalidateQueries({queryKey:["downloads"]}),d()}catch(L){console.error(`Task failed for ${C} id=${I.Id}`,L),C==="download"?s(I.Id,D=>({...D,offlineState:void 0})):C==="remove"&&s(I.Id,D=>({...D,offlineState:"downloaded"}))}finally{p.current=null,f(L=>L.slice(1)),m.current=!1}})()},[i,t,d,s,e,r,u]),window.addToDownloads=v,{addToDownloads:v,removeFromDownloads:S,storageStats:o,refreshStorageStats:d,queueCount:u.length,clearQueue:y}},NP=({children:i})=>{const e=kP();return T.jsx(dA.Provider,{value:e,children:i})},yA=async(i,e)=>{const t=await(await fetch(i,{signal:e})).text(),s=new DP;s.push(t),s.end();const n=i.replace(/\/[^/]+$/,"/"),r=new Blob([t],{type:"application/vnd.apple.mpegurl"});if(s.manifest.playlists&&s.manifest.playlists.length>0){const d=s.manifest.playlists[0].uri,u=new URL(d,n).toString();return await yA(u,e)}const o=s.manifest.segments;if(!o||o.length===0)throw new Error("No segments found in media playlist");const c=[];for(const{uri:d}of o){const u=new URL(d,n).toString(),f=await fetch(u,{signal:e});if(!f.ok)throw new Error(`Segment error ${f.status}`);c.push(await f.blob())}return{playlist:r,ts:c}},qh=()=>{const i=ns(),{patchMediaItem:e,prependItemsToQueryData:t,removeItemFromQueryData:s}=C0();return{addToFavorites:async n=>{const r=await i.addToFavorites(n.Id);t(["favorites",n.Type||""],[n]),e(n.Id,o=>({...o,UserData:r.data}))},removeFromFavorites:async n=>{const r=await i.removeFromFavorites(n.Id);s(["favorites",n.Type||""],n.Id),e(n.Id,o=>({...o,UserData:r.data}))}}},MP=()=>{const i=ns(),{prependItemsToQueryData:e,removeItemFromQueryData:t}=C0();return{addToPlaylist:async(s,n)=>{await i.addToPlaylist(n,[s.Id]),e(["playlistTracks",n],[s])},addItemsToPlaylist:async(s,n)=>{await i.addToPlaylist(n,s.map(r=>r.Id)),e(["playlistTracks",n],s)},removeFromPlaylist:async(s,n)=>{await i.removeFromPlaylist(n,s.Id),t(["playlistTracks",n],s.Id)},createPlaylist:async s=>{const n=await i.createPlaylist(s),r=await i.getPlaylist(n.Id);return e(["playlists"],[r]),r},deletePlaylist:async s=>{await i.deletePlaylist(s),t(["playlists"],s)}}},UP=()=>{const[i,e]=P.useState(!1),[t,s]=P.useState({x:0,y:0}),[n,r]=P.useState(),[o,c]=P.useState({isOpen:!1,type:"",flipX:!1,flipY:!1,width:0,height:0,top:0,measured:!1,triggerRect:null}),[d,u]=P.useState(!1),f=mA(),[m,p]=P.useState(),v=io(),S=ns(),y=Qs(),{playlists:E}=gA(),{addToFavorites:A,removeFromFavorites:R}=qh(),{addToDownloads:I,removeFromDownloads:C}=L0(),{addToPlaylist:L,addItemsToPlaylist:D,removeFromPlaylist:_,createPlaylist:M,deletePlaylist:U}=MP(),F=P.useRef(null),z=P.useRef(null),[V,ae]=P.useState(""),G=P.useCallback(()=>{c(Ee=>({...Ee,isOpen:!1,type:"",measured:!1,triggerRect:null}))},[]);P.useEffect(()=>{let Ee;return i||(Ee=setTimeout(()=>{s({x:0,y:0})},200)),()=>{clearTimeout(Ee)}},[i]);const Z=P.useCallback(()=>{e(!1),c({isOpen:!1,type:"",flipX:!1,flipY:!1,width:0,height:0,top:0,measured:!1,triggerRect:null})},[]),B=P.useCallback(Ee=>ae(Ee.target.value),[]),Q=P.useCallback(async Ee=>{if(Ee.key==="Enter"&&V.trim()&&n){const Ne=await M(V.trim());await L(n.item,Ne.Id),ae(""),Z()}else Ee.key==="Escape"&&ae("")},[L,Z,n,M,V]),re=P.useCallback(async Ee=>{if(Ee.stopPropagation(),V.trim()&&n){const Ne=await M(V.trim());await L(n.item,Ne.Id),ae(""),Z()}},[L,Z,n,M,V]);P.useEffect(()=>{const Ee=Ne=>{Ne.key==="Escape"&&Z()};return document.addEventListener("keydown",Ee),()=>document.removeEventListener("keydown",Ee)},[Z]),P.useEffect(()=>{const Ee=Ne=>{var st;if(!i)return;(((st=Ne.composedPath)==null?void 0:st.call(Ne))||[]).some(W=>W===z.current||W instanceof HTMLElement&&(W.closest(".dropdown")!==null||W.closest(".sub-dropdown")!==null))||Z()};return document.addEventListener("pointerdown",Ee,!0),()=>{document.removeEventListener("pointerdown",Ee,!0)}},[Z,i]);const J=P.useCallback((Ee,Ne)=>{const Me=Ne.currentTarget.getBoundingClientRect();c({isOpen:!0,type:Ee,flipX:!1,flipY:!1,width:0,height:0,top:0,measured:!1,triggerRect:Me})},[]);P.useLayoutEffect(()=>{var Ue;if(!o.isOpen||o.measured||!o.triggerRect)return;const Ee=(Ue=F.current)==null?void 0:Ue.querySelector(".dropdown-menu");if(!Ee)return;const{width:Ne,height:Me}=Ee.getBoundingClientRect(),Qe=o.triggerRect,st=20,W=window.innerWidth,j=window.innerHeight,ne=Qe.left+Qe.width+Ne+st>W&&Qe.left-Ne-st<0?!1:Qe.left+Qe.width+Ne+st>W,ge=Qe.top+Me+st>j;let Ie=ge?-Me+Qe.height:0;Qe.top+Ie<st?Ie=-Qe.top+st:Qe.top+Ie+Me+st>j&&(Ie=j-Me-Qe.top-st),c(Ve=>({...Ve,width:Ne,height:Me,flipX:ne,flipY:ge,top:Ie,measured:!0}))},[o.isOpen,o.measured,o.triggerRect]),P.useEffect(()=>{const Ee="ontouchstart"in window||navigator.maxTouchPoints>0||window.innerWidth<=480;u(Ee)},[]),P.useEffect(()=>{f&&d&&f.setDisabled(i)},[i,d,f]);const N=P.useCallback((Ee,Ne,Me,Qe)=>{let st=Ne,W=Me;if(d)st=0,W=window.innerHeight;else if(Qe){let j=document.elementFromPoint(Ne,Me);if(j){for(;j&&!j.classList.contains("more");)j=j.parentElement;if(j){const ne=j.getBoundingClientRect();st=ne.left-window.pageXOffset-142,W=ne.bottom+window.pageYOffset+8}}}else{const Ie=window.innerWidth,Ue=window.innerHeight+window.pageYOffset;st=Ne+210+20>Ie?Ie-210-20:Ne,W=Me+180+20>Ue?Ue-180-20:Me,W=Me<20?20:W,st=Ne<20?20:st}e(!0),s({x:st,y:W}),r(Ee),c({isOpen:!1,type:"",flipX:!1,flipY:!1,top:0,width:0,height:0,measured:!1,triggerRect:null})},[d]),K=P.useCallback(async Ee=>Ee.Type===je.MusicAlbum?(await S.getAlbumDetails(Ee.Id)).tracks:Ee.Type===je.MusicArtist?(await S.getArtistDetails(Ee.Id)).tracks:Ee.Type===je.Playlist?await S.getPlaylistAllTracks(Ee.Id):[Ee],[S]),le=P.useCallback(async Ee=>{const Ne=(y.currentTrackIndex??-1)+1,Me=y.currentPlaylist,Qe=[...Me.slice(0,Ne),...await K(Ee),...Me.slice(Ne)];y.setCurrentPlaylist({playlist:Qe,title:"Direct Queue"}),y.currentTrackIndex===-1&&y.playTrack(0),Z()},[Z,K,y]),H=P.useCallback(async Ee=>{const Me=[...y.currentPlaylist,...await K(Ee)];y.setCurrentPlaylist({playlist:Me,title:"Direct Queue"}),y.currentTrackIndex===-1&&y.playTrack(0),Z()},[Z,K,y]),ue=P.useCallback(Ee=>{Z(),Ee.AlbumId&&v(`/album/${Ee.AlbumId}`)},[Z,v]),xe=P.useCallback(Ee=>{Z(),Ee&&v(`/artist/${Ee}`)},[Z,v]),fe=P.useMemo(()=>{var Ee,Ne;return{next:T.jsx("div",{className:"dropdown-item play-next",onClick:async()=>await le(n.item),onMouseEnter:G,children:T.jsx("span",{children:"Play next"})}),add_to_queue:T.jsx("div",{className:"dropdown-item add-queue",onClick:async()=>await H(n.item),onMouseEnter:G,children:T.jsx("span",{children:"Add to queue"})}),remove_from_queue:T.jsx("div",{className:"dropdown-item remove-queue has-removable",onClick:async()=>{if(Z(),n){const Me=y.currentPlaylist.filter(Qe=>Qe!==n.item);y.setCurrentPlaylist({playlist:Me,title:"Direct Queue"})}},onMouseEnter:G,children:T.jsx("span",{children:"Remove from queue"})}),instant_mix:T.jsx("div",{className:"dropdown-item instant-mix",onClick:async()=>{if(!n)return;Z();const Me=await S.getInstantMixFromSong(n.item.Id);Me&&(y.setCurrentPlaylist({playlist:Me,title:"Instant Mix"}),y.playTrack(0),v("/queue"))},onMouseEnter:G,children:T.jsx("span",{children:"Play instant mix"})}),delete_playlist:T.jsx("div",{className:"dropdown-item delete-playlist has-removable",onClick:async()=>{Z(),n!=null&&n.item.Id&&confirm("Are you sure you want to delete this playlist?")&&await U(n.item.Id)},onMouseEnter:G,children:T.jsx("span",{children:"Delete playlist"})}),view_artists:T.jsxs("div",{className:`dropdown-item view-artists has-sub-menu${o.isOpen&&o.type==="view-artists"?" active":""}`,onMouseEnter:d?void 0:Me=>J("view-artists",Me),onClick:d?Me=>J("view-artists",Me):void 0,children:[T.jsx("span",{children:"View artists"}),T.jsx(ET,{size:12,className:"icon"}),!d&&o.isOpen&&o.type==="view-artists"&&T.jsx("div",{ref:F,className:"sub-dropdown"+(o.flipX?" flip-x":"")+(o.flipY?" flip-y":""),style:!o.measured||!o.triggerRect?{visibility:"hidden",position:"absolute",left:"-9999px",top:"-9999px"}:{position:"absolute",top:`${o.top}px`,left:o.flipX?"auto":"100%",right:o.flipX?"100%":"auto"},children:T.jsx("div",{className:"dropdown-menu",children:(Ne=(Ee=n==null?void 0:n.item)==null?void 0:Ee.ArtistItems)==null?void 0:Ne.map(Me=>T.jsx("div",{className:"dropdown-item",onClick:()=>xe(Me.Id),children:Me.Name||"Unknown Artist"},Me.Id))})})]}),view_artist:T.jsx("div",{className:"dropdown-item view-artist",onClick:()=>{var Me,Qe;return xe((Qe=(Me=n==null?void 0:n.item)==null?void 0:Me.ArtistItems)==null?void 0:Qe[0].Id)},onMouseEnter:G,children:T.jsx("span",{children:"View artist"})}),view_album:T.jsx("div",{className:"dropdown-item view-album",onClick:()=>ue(n.item),onMouseEnter:G,children:T.jsx("span",{children:"View album"})}),add_to_favorite:T.jsx("div",{className:"dropdown-item add-favorite",onClick:async()=>{Z(),n&&await A(n.item)},onMouseEnter:G,children:T.jsx("span",{children:"Add to favorites"})}),remove_from_favorite:T.jsx("div",{className:"dropdown-item remove-favorite has-removable",onClick:async()=>{Z(),n&&await R(n.item)},onMouseEnter:G,children:T.jsx("span",{children:"Remove from favorites"})}),add_to_playlist:T.jsxs("div",{className:`dropdown-item add-playlist has-sub-menu${o.isOpen&&o.type==="add-playlist"?" active":""}`,onMouseEnter:d?void 0:Me=>J("add-playlist",Me),onClick:d?Me=>J("add-playlist",Me):void 0,children:[T.jsx("span",{children:"Add to playlist"}),T.jsx(ET,{size:12,className:"icon"}),!d&&o.isOpen&&o.type==="add-playlist"&&T.jsx("div",{ref:F,className:`sub-dropdown${o.flipX?" flip-x":""}${o.flipY?" flip-y":""}`,style:!o.measured||!o.triggerRect?{visibility:"hidden",position:"absolute",left:"-9999px",top:"-9999px"}:{position:"absolute",top:`${o.top}px`,left:o.flipX?"auto":"100%",right:o.flipX?"100%":"auto"},children:T.jsxs("div",{className:"dropdown-menu",children:[T.jsx("div",{className:"dropdown-item",children:T.jsxs("div",{className:"playlist-input-container",children:[T.jsx("input",{value:V,onChange:B,onKeyDown:Q,onClick:Me=>Me.stopPropagation(),placeholder:"New...",className:`playlist-input${V.trim()?" has-text":""}`}),T.jsx("button",{className:"create-btn",onClick:re,children:"Create"})]})}),T.jsx("div",{className:"dropdown-separator"}),E.map(Me=>T.jsx("div",{className:"dropdown-item",onClick:async()=>{Z(),n&&await D(await K(n.item),Me.Id)},children:Me.Name},Me.Id))]})})]}),remove_from_playlist:n!=null&&n.playlistId?T.jsx("div",{className:"dropdown-item remove-playlist has-removable",onClick:async()=>{Z(),await _(n.item,n.playlistId)},onMouseEnter:G,children:T.jsx("span",{children:"Remove from playlist"})}):null,download_song:(n==null?void 0:n.item.offlineState)==="downloaded"?T.jsx("div",{className:"dropdown-item remove-song has-removable",onClick:async()=>{Z(),n&&C(await K(n.item),n.item.Type===je.Audio?void 0:n.item)},onMouseEnter:G,children:T.jsx("span",{children:"Unsync from cache"})}):(n==null?void 0:n.item.offlineState)==="deleting"?T.jsx("div",{className:"dropdown-item disabled",onMouseEnter:G,children:T.jsx("span",{children:"Unsyncing..."})}):n!=null&&n.item.offlineState?T.jsx("div",{className:"dropdown-item disabled",onMouseEnter:G,children:T.jsx("span",{children:"Syncing..."})}):T.jsx("div",{className:"dropdown-item",onClick:async()=>{Z(),n&&I(await K(n.item),n.item.Type===je.Audio?void 0:n.item)},onMouseEnter:G,children:T.jsx("span",{children:"Sync to cache"})})}},[D,I,A,S,Z,G,n,U,K,H,re,B,Q,le,ue,xe,d,v,J,y,V,E,C,R,_,o.flipX,o.flipY,o.isOpen,o.measured,o.top,o.triggerRect,o.type]),We=P.useMemo(()=>{const Ee=()=>{var st,W;const Me=T.jsxs("div",{className:"dropdown-item return-item",onClick:G,children:[T.jsx(Ab,{size:16,className:"return-icon"}),T.jsx("span",{children:"Back"})]},"back-button");let Qe=[];return o.type==="view-artists"?Qe=((W=(st=n==null?void 0:n.item)==null?void 0:st.ArtistItems)==null?void 0:W.map(j=>T.jsx("div",{className:"dropdown-item",onClick:()=>{xe(j.Id)},children:j.Name||"Unknown Artist"},j.Id)))||[]:o.type==="add-playlist"&&(Qe=[T.jsx("div",{className:"dropdown-item",children:T.jsxs("div",{className:"playlist-input-container",children:[T.jsx("input",{value:V,onChange:B,onKeyDown:Q,onClick:j=>j.stopPropagation(),placeholder:"New...",className:`playlist-input${V.trim()?" has-text":""}`}),T.jsxs("button",{className:"create-btn",onClick:re,children:[" ","Create"]})]})},"playlist-input-item"),T.jsx("div",{className:"dropdown-separator"},"playlist-separator"),...E.map(j=>T.jsx("div",{className:"dropdown-item",onClick:async()=>{Z(),n&&await L(n.item,j.Id)},children:j.Name},j.Id))]),[Me,T.jsx("div",{className:"dropdown-separator"},"back-separator"),...Qe]},Ne=()=>{var st,W,j,ne,ge,Ie,Ue;const Qe=[[{isVisible:!(m!=null&&m.next)&&((n==null?void 0:n.item.Type)===je.Audio||(n==null?void 0:n.item.Type)===je.MusicAlbum||(n==null?void 0:n.item.Type)===je.MusicArtist),node:fe.next},{isVisible:!(m!=null&&m.add_to_queue)&&((n==null?void 0:n.item.Type)===je.Audio||(n==null?void 0:n.item.Type)===je.MusicAlbum||(n==null?void 0:n.item.Type)===je.MusicArtist),node:fe.add_to_queue},{isVisible:!!(m!=null&&m.add_to_queue)&&!(m!=null&&m.remove_from_queue)&&((n==null?void 0:n.item.Type)===je.Audio||(n==null?void 0:n.item.Type)===je.MusicAlbum||(n==null?void 0:n.item.Type)===je.MusicArtist),node:fe.remove_from_queue},{isVisible:!(m!=null&&m.instant_mix),node:fe.instant_mix}],[{isVisible:!(m!=null&&m.view_artists)&&(((W=(st=n==null?void 0:n.item)==null?void 0:st.ArtistItems)==null?void 0:W.length)||0)>1,node:fe.view_artists},{isVisible:!(m!=null&&m.view_artist)&&((ne=(j=n==null?void 0:n.item)==null?void 0:j.ArtistItems)==null?void 0:ne.length)===1,node:fe.view_artist},{isVisible:!!(!(m!=null&&m.view_album)&&(n==null?void 0:n.item.Type)!==je.MusicAlbum&&(n!=null&&n.item.AlbumId)),node:fe.view_album}],[{isVisible:!(m!=null&&m.add_to_favorite)&&!((Ie=(ge=n==null?void 0:n.item)==null?void 0:ge.UserData)!=null&&Ie.IsFavorite),node:fe.add_to_favorite},{isVisible:!!(!(m!=null&&m.remove_from_favorite)&&((Ue=n==null?void 0:n.item.UserData)!=null&&Ue.IsFavorite)),node:fe.remove_from_favorite},{isVisible:!(m!=null&&m.remove_from_playlist)&&(n==null?void 0:n.item.Type)===je.Audio,node:fe.remove_from_playlist},{isVisible:!(m!=null&&m.add_to_playlist)&&((n==null?void 0:n.item.Type)===je.Audio||(n==null?void 0:n.item.Type)===je.MusicAlbum||(n==null?void 0:n.item.Type)===je.MusicArtist),node:fe.add_to_playlist},{isVisible:!(m!=null&&m.delete_playlist)&&(n==null?void 0:n.item.Type)===je.Playlist,node:fe.delete_playlist}],[{isVisible:!(m!=null&&m.download_song)&&((n==null?void 0:n.item.Type)===je.Audio||(n==null?void 0:n.item.Type)===je.MusicAlbum||(n==null?void 0:n.item.Type)===je.MusicArtist||(n==null?void 0:n.item.Type)===je.Playlist),node:fe.download_song}]].map(Ve=>Ve.filter(it=>it.isVisible)).filter(Ve=>Ve.length>0);return Qe.map((Ve,it)=>T.jsxs(P.Fragment,{children:[Ve.map((xt,Rt)=>xt.isVisible?T.jsx(P.Fragment,{children:xt.node},Rt):null),it!==Qe.length-1&&T.jsx("div",{className:"dropdown-separator"})]},it))};return T.jsx("div",{className:"dropdown noSelect"+(i?" active":""),style:{top:`${t.y}px`,left:`${t.x}px`,bottom:"auto"},ref:z,children:T.jsx("div",{className:"dropdown-menu",children:d&&o.isOpen?Ee():Ne()})})},[L,Z,G,n,re,B,Q,xe,m==null?void 0:m.add_to_favorite,m==null?void 0:m.add_to_playlist,m==null?void 0:m.add_to_queue,m==null?void 0:m.delete_playlist,m==null?void 0:m.download_song,m==null?void 0:m.instant_mix,m==null?void 0:m.next,m==null?void 0:m.remove_from_favorite,m==null?void 0:m.remove_from_playlist,m==null?void 0:m.remove_from_queue,m==null?void 0:m.view_album,m==null?void 0:m.view_artist,m==null?void 0:m.view_artists,i,d,fe.add_to_favorite,fe.add_to_playlist,fe.add_to_queue,fe.delete_playlist,fe.download_song,fe.instant_mix,fe.next,fe.remove_from_favorite,fe.remove_from_playlist,fe.remove_from_queue,fe.view_album,fe.view_artist,fe.view_artists,V,E,t.x,t.y,o.isOpen,o.type]),de=P.useRef(null),Be=P.useCallback((Ee,Ne,Me=!1,Qe={})=>{Ee.preventDefault(),de.current=window.setTimeout(()=>{const st=Ee.touches[0],W=st.clientX,j=st.clientY+window.pageYOffset;N(Ne,W,j,Me),p(Qe)},400)},[N]),lt=P.useCallback(()=>{de.current!==null&&(clearTimeout(de.current),de.current=null)},[]);return{isOpen:i,position:t,selectedItem:n==null?void 0:n.item,menuItems:fe,subDropdown:o,isTouchDevice:d,openDropdown:N,closeDropdown:Z,openSubDropdown:J,closeSubDropdown:G,onContextMenu:(Ee,Ne,Me=!1,Qe={})=>{Ee.preventDefault();const st=Ee.clientX,W=Ee.clientY+window.pageYOffset;N(Ne,st,W,Me),p(Qe)},onTouchStart:Be,onTouchClear:lt,dropdownNode:We}},FP=({children:i})=>{const e=UP();return T.jsx(bb.Provider,{value:e,children:i})},BP=()=>{const[i,e]=P.useState([]),t=io(),{pathname:s}=Xs();return P.useEffect(()=>{i[i.length-1]!==s&&e(r=>[...r,s])},[s]),{goBack:()=>{if(i.length<=1){t("/");return}e(r=>{const o=r.slice(0,-1);return t(o[o.length-1]),o})}}},jP=({children:i})=>{const e=BP();return T.jsx(eA.Provider,{value:e,children:i})};var di;(function(i){i[i.GREAT=2]="GREAT",i[i.GOOD=1]="GOOD",i[i.OK=0]="OK",i[i.BAD=-1]="BAD"})(di||(di={}));const xh="http:",Th="https:",VP=80,$P=443;function GP(i){if(i=i.trim(),/^data:/i.test(i))throw new Error("data URLs are not supported");if(/^view-source:/i.test(i))throw new Error("`view-source:` is not supported as it is a non-standard protocol");if(!i.startsWith("//")&&/^\.*\//.test(i)||(i=i.replace(/^(?!(?:\w+:)?\/\/)|^\/\//,xh)),!/^https?:/i.test(i))throw new Error("only http or https protocols are supported");const s=new URL(i);if(s.hash="",s.pathname){const n=/\b[a-z][a-z\d+\-.]{1,50}:\/\//g;let r=0,o="";for(;;){const d=n.exec(s.pathname);if(!d)break;const u=d[0],f=d.index,m=s.pathname.slice(r,f);o+=m.replace(/\/{2,}/g,"/"),o+=u,r=f+u.length}const c=s.pathname.slice(r,s.pathname.length);o+=c.replace(/\/{2,}/g,"/"),s.pathname=o}if(s.pathname)try{s.pathname=decodeURI(s.pathname)}catch{}return s.hostname&&(s.hostname=s.hostname.replace(/\.$/,"")),s.search="",s.pathname=s.pathname.replace(/\/$/,""),i=s.toString(),i}function kd(i){return new URL(i.toString())}function vA(i){if(i===xh)return VP;if(i===Th)return $P;throw new Error("Unsupported protocol")}function HP(i,e){const t=e.port||vA(e.protocol);return i.toLowerCase().startsWith(`${e.protocol}//${e.hostname.toLowerCase()}:${t}`)}function SA(i){return!i.port||i.port===vA(i.protocol).toString()}function zP(i){if(!(i!=null&&i.trim()))throw new Error("Input is required");return new URL(GP(i))}const _p=8096,xA=8920;function KT(i){let e=0;return i.protocol===Th?e+=5:e-=5,i.port===_p.toString()?e+=2:i.port===xA.toString()&&(e-=1),SA(i)&&(e+=3),e}function KP(i){const e=[];try{const t=zP(i);if(HP(i,t))return[t.toString()];if(e.push(t),t.protocol===xh){const s=kd(t);s.protocol=Th,e.push(s)}return e.filter(SA).forEach(s=>{if(s.protocol===xh){const n=kd(s);n.port=_p.toString(),e.push(n)}else if(s.protocol===Th){let n=kd(s);n.port=_p.toString(),e.push(n),n=kd(s),n.port=xA.toString(),e.push(n)}}),e.sort((s,n)=>KT(n)-KT(s)),e.map(s=>s.toString())}catch(t){return console.warn(t),[]}}class Cl{}class YP extends Cl{constructor(e){super(),this.productName=e}}class qP extends Cl{constructor(e){super(),this.responseTime=e}}class QP extends Cl{constructor(e){super(),this.error=e}}class YT extends Cl{}class XP extends Cl{constructor(e){super(),this.version=e}}class WP extends Cl{constructor(e){super(),this.version=e}}function ZP(i){return new Zb(i.configuration,void 0,i.axiosInstance)}function qT(i){const e=i.split(".").map(Number);if(e.length===3&&e.every(t=>t>=0))return e}function QT(i,e){const t=qT(i),s=qT(e);if(!t||!s)throw new TypeError("Version doesn't match a numeric-only semver format");const[n,r,o]=t,[c,d,u]=s;return n<c||n===c&&r<d||n===c&&r===d&&o<u}const JP="10.10.0",e2="10.9.0",t2="Jellyfin Server",s2=3e3,i2=5e3;function n2(i,e=di.GREAT){return i.length>0?Math.min(...i):e}function r2(i){var e,t,s;const n=[],r=[];!(!((e=i.response)===null||e===void 0)&&e.data)||i.error?(n.push(new QP(i.error)),r.push(di.BAD)):i.response.data.ProductName!==t2&&(n.push(new YP(i.response.data.ProductName)),r.push(di.BAD));const o=(t=i.response)===null||t===void 0?void 0:t.data.Version;try{o?QT(o,e2)?(n.push(new WP(o)),r.push(di.OK)):QT(o,JP)&&(n.push(new XP(o)),r.push(di.GOOD)):(n.push(new YT),r.push(di.BAD))}catch(c){c instanceof TypeError&&(n.push(new YT),r.push(di.BAD))}return i.responseTime>s2&&(n.push(new qP(i.responseTime)),r.push(di.GOOD)),{address:i.address,responseTime:i.responseTime,score:n2(r),issues:n,systemInfo:(s=i.response)===null||s===void 0?void 0:s.data}}class a2{constructor(e){this.jellyfin=e}async fetchRecommendedServerInfo(e){const t=this.jellyfin.createApi(e),s=Date.now();return ZP(t).getPublicSystemInfo({timeout:i2}).then(n=>({address:e,response:n,responseTime:Date.now()-s})).catch(n=>({address:e,error:n,responseTime:Date.now()-s})).then(n=>r2(n))}async discover(e,t=di.BAD){return(await Promise.all(e.map(s=>this.fetchRecommendedServerInfo(s)))).filter(s=>s.score>=t)}}class o2{constructor(e){this.jellyfin=e,this.recommendedServerDiscovery=new a2(this.jellyfin)}findBestServer(e){let t=e.find(s=>s.score===di.GREAT);return t||(t=e.find(s=>s.score===di.GOOD)),t||(t=e.find(s=>s.score===di.OK)),t}getAddressCandidates(e){return KP(e)}async getRecommendedServers(e,t){return this.recommendedServerDiscovery.discover(e,t)}async getRecommendedServerCandidates(e,t){return this.getRecommendedServers(this.getAddressCandidates(e),t)}}function l2(i,e,t=""){return[`MediaBrowser Client="${encodeURIComponent(i.name)}"`,`Device="${encodeURIComponent(e.name)}"`,`DeviceId="${encodeURIComponent(e.id)}"`,`Version="${encodeURIComponent(i.version)}"`,`Token="${encodeURIComponent(t)}"`].join(", ")}function c2(i){return new Wb(i.configuration,void 0,i.axiosInstance)}function u2(i){return new Jb(i.configuration,void 0,i.axiosInstance)}const d2="Authorization";class h2{constructor(e,t,s,n="",r=Se){this.basePath=e.endsWith("/")?e.slice(0,-1):e,this.clientInfo=t,this.deviceInfo=s,this.accessToken=n,this.axiosInstance=r}get configuration(){return new uP({basePath:this.basePath,apiKey:this.authorizationHeader})}authenticateUserByName(e,t){return u2(this).authenticateUserByName({authenticateUserByName:{Username:e,Pw:t}},{headers:{[d2]:this.authorizationHeader}}).then(s=>(this.accessToken=s.data.AccessToken||"",s))}logout(){return c2(this).reportSessionEnded().then(e=>(this.accessToken="",e))}get authorizationHeader(){return l2(this.clientInfo,this.deviceInfo,this.accessToken)}}class f2{constructor(e){this.clientInfo=e.clientInfo,this.deviceInfo=e.deviceInfo,this.discovery=new o2(this)}createApi(e,t,s){return new h2(e,this.clientInfo,this.deviceInfo,t,s)}}class gu extends Error{constructor(e,t){super(e),this.response=t,this.response=t}}const m2=()=>{const i=localStorage.getItem("deviceId");if(i)return i;const e=Math.random().toString(36).substring(2)+Date.now().toString(36);return localStorage.setItem("deviceId",e),e},Pp=m2(),kp=async(i,e,t)=>{try{const s=await fetch(`${i}/Users/AuthenticateByName`,{method:"POST",headers:{"X-Emby-Authorization":`MediaBrowser Client="Jelly Music App", Device="Web", DeviceId="${Pp}", Version="0.2"`,"Content-Type":"application/json"},body:JSON.stringify({Username:e,Pw:t}),signal:AbortSignal.timeout(2e4)});if(!s.ok)throw new gu(`HTTP error! status: ${s.status}`,s);const n=await s.json();return{token:n.AccessToken,userId:n.User.Id,username:n.User.Name}}catch(s){throw new Error("Login failed: "+s.message)}},g2=({serverUrl:i,userId:e,token:t})=>{const n=new f2({clientInfo:{name:"Jelly Music App",version:"0.1"},deviceInfo:{name:"Web",id:Pp}}),r=async W=>{const j=W.Id?await window.audioStorage.hasTrack(W.Id):!1;return{...W,Id:W.Id||"",Name:W.Name||"",offlineState:j?"downloaded":void 0}},o=async W=>await Promise.all((W||[]).map(r)),c=n.createApi(i,t),d=async(W,j=40)=>{const ge=await new Zt(c.configuration).getItems({userId:e,searchTerm:W,includeItemTypes:[je.MusicAlbum,je.Playlist,je.Audio],recursive:!0,limit:Math.min(j,2e3)},{signal:AbortSignal.timeout(2e4)});return await o(ge.data.Items)},u=async(W,j=20)=>{const ge=await new Ag(c.configuration).getArtists({userId:e,searchTerm:W,limit:Math.min(j,2e3)},{signal:AbortSignal.timeout(2e4)});return await o(ge.data.Items)},f=async(W,j=50)=>{const ge=await new Zt(c.configuration).getItems({userId:e,searchTerm:W,includeItemTypes:[je.MusicAlbum],recursive:!0,limit:Math.min(j,2e3)},{signal:AbortSignal.timeout(2e4)});return await o(ge.data.Items)},m=async(W,j=50)=>{const ge=await new Zt(c.configuration).getItems({userId:e,searchTerm:W,includeItemTypes:[je.Playlist],recursive:!0,limit:Math.min(j,2e3)},{signal:AbortSignal.timeout(2e4)});return await o(ge.data.Items)},p=async(W,j=20)=>{const ge=await new eP(c.configuration).getGenres({userId:e,searchTerm:W,includeItemTypes:[je.Audio],limit:Math.min(j,2e3)},{signal:AbortSignal.timeout(2e4)});return await o(ge.data.Items)},v=async()=>{const j=await new Zt(c.configuration).getItems({userId:e,sortBy:[Ht.DatePlayed],sortOrder:[ds.Descending],includeItemTypes:[je.Audio],recursive:!0,limit:Math.min(12,2e3)},{signal:AbortSignal.timeout(2e4)});return await o(j.data.Items)},S=async()=>{const j=await new Zt(c.configuration).getItems({userId:e,sortBy:[Ht.PlayCount],sortOrder:[ds.Descending],includeItemTypes:[je.Audio],recursive:!0,limit:Math.min(12,2e3)},{signal:AbortSignal.timeout(2e4)});return await o(j.data.Items)},y=async()=>{const j=await new Zt(c.configuration).getItems({userId:e,sortBy:[Ht.DateCreated],sortOrder:[ds.Descending],includeItemTypes:[je.MusicAlbum],recursive:!0,limit:Math.min(12,2e3)},{signal:AbortSignal.timeout(2e4)});return await o(j.data.Items)},E=async(W,j,ne=[Ht.DatePlayed],ge=[ds.Descending])=>{const Ue=await new Zt(c.configuration).getItems({userId:e,sortBy:ne,sortOrder:ge,includeItemTypes:[je.Audio],filters:[Pd.IsPlayed],recursive:!0,startIndex:W,limit:Math.min(j,2e3)},{signal:AbortSignal.timeout(2e4)});return await o(Ue.data.Items)},A=async(W,j,ne=[Ht.PlayCount],ge=[ds.Descending])=>{const Ue=await new Zt(c.configuration).getItems({userId:e,sortBy:ne,sortOrder:ge,includeItemTypes:[je.Audio],filters:[Pd.IsPlayed],recursive:!0,startIndex:W,limit:Math.min(j,2e3)},{signal:AbortSignal.timeout(2e4)});return await o(Ue.data.Items)},R=async(W=0,j=40,ne=[Ht.DateCreated],ge=[ds.Descending])=>{const Ue=await new Zt(c.configuration).getItems({userId:e,sortBy:ne,sortOrder:ge,includeItemTypes:[je.MusicAlbum],recursive:!0,startIndex:W,limit:Math.min(j,2e3)},{signal:AbortSignal.timeout(2e4)});return await o(Ue.data.Items)},I=async(W=0,j=40,ne=[Ht.DateCreated],ge=[ds.Descending])=>{const Ue=await new Ag(c.configuration).getArtists({userId:e,sortBy:ne,sortOrder:ge,startIndex:W,limit:Math.min(j,2e3)},{signal:AbortSignal.timeout(2e4)});return await o(Ue.data.Items)},C=async(W=0,j=40,ne=[Ht.DateCreated],ge=[ds.Descending])=>{const Ue=await new Zt(c.configuration).getItems({userId:e,sortBy:ne,sortOrder:ge,includeItemTypes:[je.Audio],recursive:!0,startIndex:W,limit:Math.min(j,2e3)},{signal:AbortSignal.timeout(2e4)});return await o(Ue.data.Items)},L=async W=>{const ne=await new sP(c.configuration).getInstantMixFromSong({userId:e,itemId:W,limit:2e3},{signal:AbortSignal.timeout(2e4)});return await o(ne.data.Items)},D=async(W=0,j=40,ne=[Ht.DateCreated],ge=[ds.Descending],Ie=je.Audio)=>{if(Ie===je.MusicArtist){const xt=await new Ag(c.configuration).getArtists({userId:e,isFavorite:!0,startIndex:W,limit:Math.min(j,2e3),sortBy:ne,sortOrder:ge},{signal:AbortSignal.timeout(2e4)});return await o(xt.data.Items)}const Ve=await new Zt(c.configuration).getItems({userId:e,filters:[Pd.IsFavorite],includeItemTypes:[Ie],recursive:!0,sortBy:ne,sortOrder:ge,startIndex:W,limit:Math.min(j,2e3)},{signal:AbortSignal.timeout(2e4)});return await o(Ve.data.Items)},_=async W=>{const j=new _c(c.configuration),ne=new Zt(c.configuration),[ge,Ie]=await Promise.all([j.getItem({userId:e,itemId:W},{signal:AbortSignal.timeout(2e4)}),ne.getItems({userId:e,parentId:W,includeItemTypes:[je.Audio],sortBy:[Ht.IndexNumber],sortOrder:[ds.Ascending],limit:2e3},{signal:AbortSignal.timeout(2e4)})]),Ue=await r(ge.data),Ve=await o(Ie.data.Items);return VT(Ue,Ve),{album:Ue,tracks:Ve}},M=async(W,j=5)=>{const ne=new _c(c.configuration),ge=new Zt(c.configuration),[Ie,Ue]=await Promise.all([ne.getItem({userId:e,itemId:W},{signal:AbortSignal.timeout(2e4)}),ge.getItems({userId:e,artistIds:[W],includeItemTypes:[je.Audio],recursive:!0,sortBy:[Ht.PlayCount,Ht.SortName],sortOrder:[ds.Descending,ds.Ascending],limit:Math.min(j,2e3)},{signal:AbortSignal.timeout(2e4)})]),Ve=await r(Ie.data),it=await o(Ue.data.Items);return VT(Ve,it),{artist:Ve,tracks:it}},U=async(W,j)=>{const ne=new Zt(c.configuration),[ge,Ie,Ue,Ve]=await Promise.all([ne.getItems({userId:e,artistIds:[W],includeItemTypes:[je.Audio],recursive:!0,limit:0,fields:["MediaSources"]},{signal:AbortSignal.timeout(2e4)}),ne.getItems({userId:e,artistIds:[W],includeItemTypes:[je.Audio],recursive:!0,fields:["MediaSources"],limit:2e3},{signal:AbortSignal.timeout(2e4)}),ne.getItems({userId:e,artistIds:[W],includeItemTypes:[je.MusicAlbum],recursive:!0,sortBy:[Ht.PremiereDate,Ht.ProductionYear,Ht.SortName],sortOrder:[ds.Descending],limit:2e3},{signal:AbortSignal.timeout(2e4)}),ne.getItems({userId:e,contributingArtistIds:[W],includeItemTypes:[je.MusicAlbum],recursive:!0,sortBy:[Ht.PremiereDate,Ht.ProductionYear,Ht.SortName],sortOrder:[ds.Descending],limit:2e3},{signal:AbortSignal.timeout(2e4)})]),it=ge.data.TotalRecordCount||0,xt=(await o(Ie.data.Items)).reduce((Xt,Ps)=>Xt+(Ps.RunTimeTicks||0),0),Rt=await o(Ue.data.Items),Dt=await o(Ve.data.Items),bt=new Map;Rt.forEach(Xt=>bt.set(Xt.Id,Xt)),Dt.forEach(Xt=>bt.set(Xt.Id,Xt));const $t=Array.from(bt.values()),St=[],_s=[];$t.forEach(Xt=>{var ps,Ws;(((Ws=(ps=Xt.AlbumArtists)==null?void 0:ps[0])==null?void 0:Ws.Name)||Xt.AlbumArtist||"Unknown Artist")===j?St.push(Xt):_s.push(Xt)});const hs=St.length+_s.length;return{albums:St,appearsInAlbums:_s,totalTrackCount:it,totalPlaytime:xt,totalAlbumCount:hs}},F=async(W,j=0,ne=40,ge=[Ht.PlayCount,Ht.SortName],Ie=[ds.Descending,ds.Ascending])=>{const Ve=await new Zt(c.configuration).getItems({userId:e,artistIds:[W],includeItemTypes:[je.Audio],sortBy:ge,sortOrder:Ie,recursive:!0,startIndex:j,limit:Math.min(ne,2e3)},{signal:AbortSignal.timeout(2e4)});return{Items:await o(Ve.data.Items),TotalRecordCount:Ve.data.TotalRecordCount||0}},z=async W=>{const j=new Zt(c.configuration),ge=(await j.getItems({userId:e,includeItemTypes:[je.Playlist],recursive:!0,limit:2e3},{signal:AbortSignal.timeout(2e4)})).data.Items,Ie=[],Ue=5;if(ge!=null&&ge.length)for(let Ve=0;Ve<ge.length;Ve+=Ue){const xt=ge.slice(Ve,Ve+Ue).map(async Dt=>{let bt=0;const $t=100;for(;;){const St=await j.getItems({userId:e,parentId:Dt.Id,includeItemTypes:[je.Audio],startIndex:bt,limit:Math.min($t,2e3)},{signal:AbortSignal.timeout(2e4)});if((await o(St.data.Items)).some(Xt=>{var Ps;return(Ps=Xt.ArtistItems)==null?void 0:Ps.some(ps=>ps.Id===W)}))return Dt;if(bt+$t>=(St.data.TotalRecordCount||0))break;bt+=$t}return null}),Rt=await Promise.all(xt);Ie.push(...Rt.filter(Dt=>Dt!==null))}return Ie},V=async(W,j=0,ne=40,ge=[Ht.DateCreated],Ie=[ds.Descending])=>{const Ve=await new Zt(c.configuration).getItems({userId:e,sortBy:ge,sortOrder:Ie,includeItemTypes:[je.Audio],recursive:!0,genres:[W],startIndex:j,limit:Math.min(ne,2e3)},{signal:AbortSignal.timeout(2e4)});return await o(Ve.data.Items)},ae=async W=>{const ne=await new _c(c.configuration).getItem({userId:e,itemId:W},{signal:AbortSignal.timeout(2e4)});return await r(ne.data)},G=async W=>{const j=new Zt(c.configuration),ge=(await j.getItems({userId:e,parentId:W,includeItemTypes:[je.Audio],recursive:!0,limit:0,fields:["MediaSources"]},{signal:AbortSignal.timeout(2e4)})).data.TotalRecordCount||0;let Ie=0;if(ge>0){const Ue=await j.getItems({userId:e,parentId:W,includeItemTypes:[je.Audio],recursive:!0,fields:["MediaSources"],limit:2e3},{signal:AbortSignal.timeout(2e4)});Ie=(await o(Ue.data.Items)).reduce((Ve,it)=>Ve+(it.RunTimeTicks||0),0)}return{totalTrackCount:ge,totalPlaytime:Ie}},Z=async W=>{const ne=await new Zt(c.configuration).getItems({userId:e,parentId:W,includeItemTypes:[je.Audio],recursive:!0,limit:2e3},{signal:AbortSignal.timeout(2e4)});return await o(ne.data.Items)},B=async(W,j=0,ne=40,ge=[Ht.DateCreated],Ie=[ds.Descending])=>{const Ve=await new Zt(c.configuration).getItems({userId:e,parentId:W,includeItemTypes:[je.Audio],sortBy:ge,sortOrder:Ie,startIndex:j,limit:Math.min(ne,2e3)},{signal:AbortSignal.timeout(2e4)}),it=await o(Ve.data.Items);return yP(W,it),it},Q=async()=>{const j=await new Zt(c.configuration).getItems({sortBy:["PlayCount","DatePlayed"],sortOrder:[ds.Descending],userId:e,includeItemTypes:[je.Playlist],recursive:!0,limit:2e3},{signal:AbortSignal.timeout(2e4)});return await o(j.data.Items)},re=async W=>{const ne=await new Zt(c.configuration).getItems({userId:e,artistIds:[W],includeItemTypes:[je.Audio],recursive:!0,limit:2e3},{signal:AbortSignal.timeout(2e4)});return await o(ne.data.Items)},J=async()=>(await new Jb(c.configuration).getUserById({userId:e})).data,N=async()=>{var ge;return((ge=(await new Wb(c.configuration).getSessions({})).data.find(Ie=>Ie.UserId===e))==null?void 0:ge.RemoteEndPoint)||null},K=async()=>{const W=performance.now();return await new Zb(c.configuration).getPingSystem({}),Math.round(performance.now()-W)},le=async()=>(await new Zt(c.configuration).getItems({userId:e,recursive:!0,includeItemTypes:[je.Audio],filters:[Pd.IsPlayed],limit:2e3})).data.TotalRecordCount||null,H=async W=>{const ne=await new Zt(c.configuration).getItems({userId:e,searchTerm:W,includeItemTypes:[je.Audio],recursive:!0,limit:Math.min(10,2e3)});return await o(ne.data.Items)},ue=async(W,j)=>{await new Rg(c.configuration).reportPlaybackStart({playbackStartInfo:{ItemId:W,PlayMethod:UT.DirectStream,PositionTicks:0,IsPaused:!1,CanSeek:!0,MediaSourceId:W,AudioStreamIndex:1}},{signal:j})};let xe=new AbortController;return{loginToJellyfin:kp,searchItems:d,searchArtists:u,searchAlbumsDetailed:f,searchPlaylistsDetailed:m,searchGenres:p,getRecentlyPlayed:v,getFrequentlyPlayed:S,getRecentlyAdded:y,getAllAlbums:R,getAllArtists:I,getAllTracks:C,getFavoriteTracks:D,getAlbumDetails:_,getArtistDetails:M,getArtistStats:U,getArtistTracks:F,getPlaylistsFeaturingArtist:z,getGenreTracks:V,getPlaylist:ae,getPlaylistTotals:G,getPlaylistAllTracks:Z,getPlaylistTracks:B,getAllPlaylists:Q,fetchAllTracks:re,fetchRecentlyPlayed:E,fetchFrequentlyPlayed:A,fetchUserInfo:J,fetchClientIp:N,measureLatency:K,fetchPlayCount:le,fetchSongs:H,reportPlaybackStart:ue,reportPlaybackProgress:async(W,j,ne)=>{xe&&(xe.abort(),xe=new AbortController),await new Rg(c.configuration).reportPlaybackProgress({playbackProgressInfo:{ItemId:W,PositionTicks:Math.floor(j*1e7),IsPaused:ne,PlayMethod:UT.DirectStream,MediaSourceId:W,AudioStreamIndex:1}},{signal:xe.signal})},reportPlaybackStopped:async(W,j,ne)=>{await new Rg(c.configuration).reportPlaybackStopped({playbackStopInfo:{ItemId:W,PositionTicks:Math.floor(j*1e7),MediaSourceId:W}},{signal:ne})},getImageUrl:(W,j,ne)=>{var ge;return(ge=W.ImageTags)!=null&&ge[j]?`${i}/Items/${W.Id}/Images/${j}?tag=${W.ImageTags[j]}&quality=100&fillWidth=${ne.width}&fillHeight=${ne.height}&format=webp&api_key=${t}`:W.AlbumId?`${i}/Items/${W.AlbumId}/Images/${j}?quality=100&fillWidth=${ne.width}&fillHeight=${ne.height}&format=webp&api_key=${t}`:"/jelly-app/default-thumbnail.png"},getStreamUrl:(W,j)=>`${i}/Audio/${W}/universal?UserId=${e}&api_key=${t}&Container=opus,webm|opus,mp3,aac,m4a|aac,m4a|alac,m4b|aac,flac,webma,webm|webma,wav,ogg&TranscodingContainer=ts&TranscodingProtocol=hls&AudioCodec=aac&MaxStreamingBitrate=${j||14e7}&StartTimeTicks=0&EnableRedirection=true&EnableRemoteMedia=false`,addToFavorites:async W=>await new _c(c.configuration).markFavoriteItem({itemId:W,userId:e},{signal:AbortSignal.timeout(2e4)}),removeFromFavorites:async W=>await new _c(c.configuration).unmarkFavoriteItem({itemId:W,userId:e},{signal:AbortSignal.timeout(2e4)}),getInstantMixFromSong:L,addToPlaylist:async(W,j)=>(await new Ig(c.configuration).addItemToPlaylist({userId:e,playlistId:W,ids:j},{signal:AbortSignal.timeout(2e4)})).data,removeFromPlaylist:async(W,j)=>(await new Ig(c.configuration).removeItemFromPlaylist({playlistId:W,entryIds:[j]},{signal:AbortSignal.timeout(2e4)})).data,createPlaylist:async W=>(await new Ig(c.configuration).createPlaylist({createPlaylistDto:{Name:W,IsPublic:!1},name:W},{signal:AbortSignal.timeout(2e4)})).data,deletePlaylist:async W=>{const j=await fetch(`${i}/Items/${W}`,{method:"DELETE",headers:{"X-Emby-Authorization":`MediaBrowser Client="Jelly Music App", Device="Web", DeviceId="${Pp}", Version="0.2"`,"Content-Type":"application/json","X-Emby-Token":t},signal:AbortSignal.timeout(2e4)});if(!j.ok)throw new gu(`HTTP error! status: ${j.status}`,j);return j.ok}}},p2=i=>{const[e]=P.useState(g2(i));return{...e,auth:i}},y2=({children:i,auth:e})=>{const t=p2(e);return T.jsx(hA.Provider,{value:t,children:i})},v2=()=>{const[i,e]=P.useState("");return{pageTitle:i,setPageTitle:e}},S2=({children:i})=>{const e=v2();return T.jsx(tA.Provider,{value:e,children:i})},Fe=Number.isFinite||function(i){return typeof i=="number"&&isFinite(i)},x2=Number.isSafeInteger||function(i){return typeof i=="number"&&Math.abs(i)<=T2},T2=Number.MAX_SAFE_INTEGER||9007199254740991;let Ke=function(i){return i.NETWORK_ERROR="networkError",i.MEDIA_ERROR="mediaError",i.KEY_SYSTEM_ERROR="keySystemError",i.MUX_ERROR="muxError",i.OTHER_ERROR="otherError",i}({}),se=function(i){return i.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",i.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",i.KEY_SYSTEM_NO_SESSION="keySystemNoSession",i.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",i.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",i.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",i.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",i.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",i.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",i.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",i.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR="keySystemDestroyMediaKeysError",i.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR="keySystemDestroyCloseSessionError",i.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR="keySystemDestroyRemoveSessionError",i.MANIFEST_LOAD_ERROR="manifestLoadError",i.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",i.MANIFEST_PARSING_ERROR="manifestParsingError",i.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",i.LEVEL_EMPTY_ERROR="levelEmptyError",i.LEVEL_LOAD_ERROR="levelLoadError",i.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",i.LEVEL_PARSING_ERROR="levelParsingError",i.LEVEL_SWITCH_ERROR="levelSwitchError",i.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",i.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",i.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",i.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",i.FRAG_LOAD_ERROR="fragLoadError",i.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",i.FRAG_DECRYPT_ERROR="fragDecryptError",i.FRAG_PARSING_ERROR="fragParsingError",i.FRAG_GAP="fragGap",i.REMUX_ALLOC_ERROR="remuxAllocError",i.KEY_LOAD_ERROR="keyLoadError",i.KEY_LOAD_TIMEOUT="keyLoadTimeOut",i.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",i.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",i.BUFFER_APPEND_ERROR="bufferAppendError",i.BUFFER_APPENDING_ERROR="bufferAppendingError",i.BUFFER_STALLED_ERROR="bufferStalledError",i.BUFFER_FULL_ERROR="bufferFullError",i.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",i.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",i.ASSET_LIST_LOAD_ERROR="assetListLoadError",i.ASSET_LIST_LOAD_TIMEOUT="assetListLoadTimeout",i.ASSET_LIST_PARSING_ERROR="assetListParsingError",i.INTERSTITIAL_ASSET_ITEM_ERROR="interstitialAssetItemError",i.INTERNAL_EXCEPTION="internalException",i.INTERNAL_ABORTED="aborted",i.ATTACH_MEDIA_ERROR="attachMediaError",i.UNKNOWN="unknown",i}({}),w=function(i){return i.MEDIA_ATTACHING="hlsMediaAttaching",i.MEDIA_ATTACHED="hlsMediaAttached",i.MEDIA_DETACHING="hlsMediaDetaching",i.MEDIA_DETACHED="hlsMediaDetached",i.MEDIA_ENDED="hlsMediaEnded",i.STALL_RESOLVED="hlsStallResolved",i.BUFFER_RESET="hlsBufferReset",i.BUFFER_CODECS="hlsBufferCodecs",i.BUFFER_CREATED="hlsBufferCreated",i.BUFFER_APPENDING="hlsBufferAppending",i.BUFFER_APPENDED="hlsBufferAppended",i.BUFFER_EOS="hlsBufferEos",i.BUFFERED_TO_END="hlsBufferedToEnd",i.BUFFER_FLUSHING="hlsBufferFlushing",i.BUFFER_FLUSHED="hlsBufferFlushed",i.MANIFEST_LOADING="hlsManifestLoading",i.MANIFEST_LOADED="hlsManifestLoaded",i.MANIFEST_PARSED="hlsManifestParsed",i.LEVEL_SWITCHING="hlsLevelSwitching",i.LEVEL_SWITCHED="hlsLevelSwitched",i.LEVEL_LOADING="hlsLevelLoading",i.LEVEL_LOADED="hlsLevelLoaded",i.LEVEL_UPDATED="hlsLevelUpdated",i.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",i.LEVELS_UPDATED="hlsLevelsUpdated",i.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",i.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",i.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",i.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",i.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",i.AUDIO_TRACK_UPDATED="hlsAudioTrackUpdated",i.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",i.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",i.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",i.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",i.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",i.SUBTITLE_TRACK_UPDATED="hlsSubtitleTrackUpdated",i.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",i.CUES_PARSED="hlsCuesParsed",i.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",i.INIT_PTS_FOUND="hlsInitPtsFound",i.FRAG_LOADING="hlsFragLoading",i.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",i.FRAG_LOADED="hlsFragLoaded",i.FRAG_DECRYPTED="hlsFragDecrypted",i.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",i.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",i.FRAG_PARSING_METADATA="hlsFragParsingMetadata",i.FRAG_PARSED="hlsFragParsed",i.FRAG_BUFFERED="hlsFragBuffered",i.FRAG_CHANGED="hlsFragChanged",i.FPS_DROP="hlsFpsDrop",i.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",i.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",i.ERROR="hlsError",i.DESTROYING="hlsDestroying",i.KEY_LOADING="hlsKeyLoading",i.KEY_LOADED="hlsKeyLoaded",i.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",i.BACK_BUFFER_REACHED="hlsBackBufferReached",i.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",i.ASSET_LIST_LOADING="hlsAssetListLoading",i.ASSET_LIST_LOADED="hlsAssetListLoaded",i.INTERSTITIALS_UPDATED="hlsInterstitialsUpdated",i.INTERSTITIALS_BUFFERED_TO_BOUNDARY="hlsInterstitialsBufferedToBoundary",i.INTERSTITIAL_ASSET_PLAYER_CREATED="hlsInterstitialAssetPlayerCreated",i.INTERSTITIAL_STARTED="hlsInterstitialStarted",i.INTERSTITIAL_ASSET_STARTED="hlsInterstitialAssetStarted",i.INTERSTITIAL_ASSET_ENDED="hlsInterstitialAssetEnded",i.INTERSTITIAL_ASSET_ERROR="hlsInterstitialAssetError",i.INTERSTITIAL_ENDED="hlsInterstitialEnded",i.INTERSTITIALS_PRIMARY_RESUMED="hlsInterstitialsPrimaryResumed",i.PLAYOUT_LIMIT_REACHED="hlsPlayoutLimitReached",i.EVENT_CUE_ENTER="hlsEventCueEnter",i}({});var gt={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},ze={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};class qo{constructor(e,t=0,s=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=s}sample(e,t){const s=Math.pow(this.alpha_,e);this.estimate_=t*(1-s)+s*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class E2{constructor(e,t,s,n=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=s,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new qo(e),this.fast_=new qo(t),this.defaultTTFB_=n,this.ttfb_=new qo(e)}update(e,t){const{slow_:s,fast_:n,ttfb_:r}=this;s.halfLife!==e&&(this.slow_=new qo(e,s.getEstimate(),s.getTotalWeight())),n.halfLife!==t&&(this.fast_=new qo(t,n.getEstimate(),n.getTotalWeight())),r.halfLife!==e&&(this.ttfb_=new qo(e,r.getEstimate(),r.getTotalWeight()))}sample(e,t){e=Math.max(e,this.minDelayMs_);const s=8*t,n=e/1e3,r=s/n;this.fast_.sample(n,r),this.slow_.sample(n,r)}sampleTTFB(e){const t=e/1e3,s=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(s,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}get defaultEstimate(){return this.defaultEstimate_}destroy(){}}function b2(i,e,t){return(e=I2(e))in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Ft(){return Ft=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)({}).hasOwnProperty.call(t,s)&&(i[s]=t[s])}return i},Ft.apply(null,arguments)}function XT(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);e&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(i,n).enumerable})),t.push.apply(t,s)}return t}function _t(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?XT(Object(t),!0).forEach(function(s){b2(i,s,t[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):XT(Object(t)).forEach(function(s){Object.defineProperty(i,s,Object.getOwnPropertyDescriptor(t,s))})}return i}function A2(i,e){if(typeof i!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var s=t.call(i,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function I2(i){var e=A2(i,"string");return typeof e=="symbol"?e:e+""}class gr{constructor(e,t){this.trace=void 0,this.debug=void 0,this.log=void 0,this.warn=void 0,this.info=void 0,this.error=void 0;const s=`[${e}]:`;this.trace=qr,this.debug=t.debug.bind(null,s),this.log=t.log.bind(null,s),this.warn=t.warn.bind(null,s),this.info=t.info.bind(null,s),this.error=t.error.bind(null,s)}}const qr=function(){},R2={trace:qr,debug:qr,log:qr,warn:qr,info:qr,error:qr};function Np(){return Ft({},R2)}function L2(i,e){const t=self.console[i];return t?t.bind(self.console,`${e?"["+e+"] ":""}[${i}] >`):qr}function WT(i,e,t){return e[i]?e[i].bind(e):L2(i,t)}const Mp=Np();function w2(i,e,t){const s=Np();if(typeof console=="object"&&i===!0||typeof i=="object"){const n=["debug","log","info","warn","error"];n.forEach(r=>{s[r]=WT(r,i,t)});try{s.log(`Debug logs enabled for "${e}" in hls.js version 1.6.4`)}catch{return Np()}n.forEach(r=>{Mp[r]=WT(r,i)})}else Ft(Mp,s);return s}const wt=Mp;function ca(i=!0){return typeof self>"u"?void 0:(i||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}function C2(i){return typeof self<"u"&&i===self.ManagedMediaSource}function TA(i,e){const t=Object.keys(i),s=Object.keys(e),n=t.length,r=s.length;return!n||!r||n===r&&!t.some(o=>s.indexOf(o)===-1)}function Ci(i,e=!1){if(typeof TextDecoder<"u"){const u=new TextDecoder("utf-8").decode(i);if(e){const f=u.indexOf("\0");return f!==-1?u.substring(0,f):u}return u.replace(/\0/g,"")}const t=i.length;let s,n,r,o="",c=0;for(;c<t;){if(s=i[c++],s===0&&e)return o;if(s===0||s===3)continue;switch(s>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:o+=String.fromCharCode(s);break;case 12:case 13:n=i[c++],o+=String.fromCharCode((s&31)<<6|n&63);break;case 14:n=i[c++],r=i[c++],o+=String.fromCharCode((s&15)<<12|(n&63)<<6|(r&63)<<0);break}}return o}const An={hexDump:function(i){let e="";for(let t=0;t<i.length;t++){let s=i[t].toString(16);s.length<2&&(s="0"+s),e+=s}return e}};function O2(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Og={exports:{}},ZT;function D2(){return ZT||(ZT=1,function(i,e){(function(t){var s=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,n=/^(?=([^\/?#]*))\1([^]*)$/,r=/(?:\/|^)\.(?=\/)/g,o=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,c={buildAbsoluteURL:function(d,u,f){if(f=f||{},d=d.trim(),u=u.trim(),!u){if(!f.alwaysNormalize)return d;var m=c.parseURL(d);if(!m)throw new Error("Error trying to parse base URL.");return m.path=c.normalizePath(m.path),c.buildURLFromParts(m)}var p=c.parseURL(u);if(!p)throw new Error("Error trying to parse relative URL.");if(p.scheme)return f.alwaysNormalize?(p.path=c.normalizePath(p.path),c.buildURLFromParts(p)):u;var v=c.parseURL(d);if(!v)throw new Error("Error trying to parse base URL.");if(!v.netLoc&&v.path&&v.path[0]!=="/"){var S=n.exec(v.path);v.netLoc=S[1],v.path=S[2]}v.netLoc&&!v.path&&(v.path="/");var y={scheme:v.scheme,netLoc:p.netLoc,path:null,params:p.params,query:p.query,fragment:p.fragment};if(!p.netLoc&&(y.netLoc=v.netLoc,p.path[0]!=="/"))if(!p.path)y.path=v.path,p.params||(y.params=v.params,p.query||(y.query=v.query));else{var E=v.path,A=E.substring(0,E.lastIndexOf("/")+1)+p.path;y.path=c.normalizePath(A)}return y.path===null&&(y.path=f.alwaysNormalize?c.normalizePath(p.path):p.path),c.buildURLFromParts(y)},parseURL:function(d){var u=s.exec(d);return u?{scheme:u[1]||"",netLoc:u[2]||"",path:u[3]||"",params:u[4]||"",query:u[5]||"",fragment:u[6]||""}:null},normalizePath:function(d){for(d=d.split("").reverse().join("").replace(r,"");d.length!==(d=d.replace(o,"")).length;);return d.split("").reverse().join("")},buildURLFromParts:function(d){return d.scheme+d.netLoc+d.path+d.params+d.query+d.fragment}};i.exports=c})()}(Og)),Og.exports}var O0=D2();class D0{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var zt={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class EA{constructor(e){this._byteRange=null,this._url=null,this._stats=null,this._streams=null,this.base=void 0,this.relurl=void 0,typeof e=="string"&&(e={url:e}),this.base=e,P2(this,"stats")}setByteRange(e,t){const s=e.split("@",2);let n;s.length===1?n=(t==null?void 0:t.byteRangeEndOffset)||0:n=parseInt(s[1]),this._byteRange=[n,parseInt(s[0])+n]}get baseurl(){return this.base.url}get byteRange(){return this._byteRange===null?[]:this._byteRange}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get elementaryStreams(){return this._streams===null&&(this._streams={[zt.AUDIO]:null,[zt.VIDEO]:null,[zt.AUDIOVIDEO]:null}),this._streams}set elementaryStreams(e){this._streams=e}get hasStats(){return this._stats!==null}get hasStreams(){return this._streams!==null}get stats(){return this._stats===null&&(this._stats=new D0),this._stats}set stats(e){this._stats=e}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=O0.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}clearElementaryStreamInfo(){const{elementaryStreams:e}=this;e[zt.AUDIO]=null,e[zt.VIDEO]=null,e[zt.AUDIOVIDEO]=null}}function Ds(i){return i.sn!=="initSegment"}class Dg extends EA{constructor(e,t){super(t),this._decryptdata=null,this._programDateTime=null,this._ref=null,this._bitrate=void 0,this.rawProgramDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.playlistOffset=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=e}get byteLength(){if(this.hasStats){const e=this.stats.total;if(e)return e}if(this.byteRange){const e=this.byteRange[0],t=this.byteRange[1];if(Fe(e)&&Fe(t))return t-e}return null}get bitrate(){return this.byteLength?this.byteLength*8/this.duration:this._bitrate?this._bitrate:null}set bitrate(e){this._bitrate=e}get decryptdata(){const{levelkeys:e}=this;if(!e&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){const t=this.levelkeys.identity;if(t)this._decryptdata=t.getDecryptData(this.sn);else{const s=Object.keys(this.levelkeys);if(s.length===1)return this._decryptdata=this.levelkeys[s[0]].getDecryptData(this.sn)}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(this.programDateTime===null)return null;const e=Fe(this.duration)?this.duration:0;return this.programDateTime+e*1e3}get encrypted(){var e;if((e=this._decryptdata)!=null&&e.encrypted)return!0;if(this.levelkeys){const t=Object.keys(this.levelkeys),s=t.length;if(s>1||s===1&&this.levelkeys[t[0]].encrypted)return!0}return!1}get programDateTime(){return this._programDateTime===null&&this.rawProgramDateTime&&(this.programDateTime=Date.parse(this.rawProgramDateTime)),this._programDateTime}set programDateTime(e){if(!Fe(e)){this._programDateTime=this.rawProgramDateTime=null;return}this._programDateTime=e}get ref(){return Ds(this)?(this._ref||(this._ref={base:this.base,start:this.start,duration:this.duration,sn:this.sn,programDateTime:this.programDateTime}),this._ref):null}addStart(e){this.setStart(this.start+e)}setStart(e){this.start=e,this._ref&&(this._ref.start=e)}setDuration(e){this.duration=e,this._ref&&(this._ref.duration=e)}setKeyFormat(e){if(this.levelkeys){const t=this.levelkeys[e];t&&!this._decryptdata&&(this._decryptdata=t.getDecryptData(this.sn))}}abortRequests(){var e,t;(e=this.loader)==null||e.abort(),(t=this.keyLoader)==null||t.abort()}setElementaryStreamInfo(e,t,s,n,r,o=!1){const{elementaryStreams:c}=this,d=c[e];if(!d){c[e]={startPTS:t,endPTS:s,startDTS:n,endDTS:r,partial:o};return}d.startPTS=Math.min(d.startPTS,t),d.endPTS=Math.max(d.endPTS,s),d.startDTS=Math.min(d.startDTS,n),d.endDTS=Math.max(d.endDTS,r)}}class _2 extends EA{constructor(e,t,s,n,r){super(s),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=t,this.index=n;const o=e.enumeratedString("BYTERANGE");o&&this.setByteRange(o,r),r&&(this.fragOffset=r.fragOffset+r.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}function bA(i,e){const t=Object.getPrototypeOf(i);if(t){const s=Object.getOwnPropertyDescriptor(t,e);return s||bA(t,e)}}function P2(i,e){const t=bA(i,e);t&&(t.enumerable=!0,Object.defineProperty(i,e,t))}const Eh=Math.pow(2,32)-1,k2=[].push,AA={video:1,audio:2,id3:3,text:4};function Ss(i){return String.fromCharCode.apply(null,i)}function IA(i,e){const t=i[e]<<8|i[e+1];return t<0?65536+t:t}function Je(i,e){const t=RA(i,e);return t<0?4294967296+t:t}function JT(i,e){let t=Je(i,e);return t*=Math.pow(2,32),t+=Je(i,e+4),t}function RA(i,e){return i[e]<<24|i[e+1]<<16|i[e+2]<<8|i[e+3]}function _g(i,e,t){i[e]=t>>24,i[e+1]=t>>16&255,i[e+2]=t>>8&255,i[e+3]=t&255}function N2(i){const e=i.byteLength;for(let t=0;t<e;){const s=Je(i,t);if(s>8&&i[t+4]===109&&i[t+5]===111&&i[t+6]===111&&i[t+7]===102)return!0;t=s>1?t+s:e}return!1}function ct(i,e){const t=[];if(!e.length)return t;const s=i.byteLength;for(let n=0;n<s;){const r=Je(i,n),o=Ss(i.subarray(n+4,n+8)),c=r>1?n+r:s;if(o===e[0])if(e.length===1)t.push(i.subarray(n+8,c));else{const d=ct(i.subarray(n+8,c),e.slice(1));d.length&&k2.apply(t,d)}n=c}return t}function M2(i){const e=[],t=i[0];let s=8;const n=Je(i,s);s+=4;let r=0,o=0;t===0?(r=Je(i,s),o=Je(i,s+4),s+=8):(r=JT(i,s),o=JT(i,s+8),s+=16),s+=2;let c=i.length+o;const d=IA(i,s);s+=2;for(let u=0;u<d;u++){let f=s;const m=Je(i,f);f+=4;const p=m&2147483647;if((m&2147483648)>>>31===1)return wt.warn("SIDX has hierarchical references (not supported)"),null;const S=Je(i,f);f+=4,e.push({referenceSize:p,subsegmentDuration:S,info:{duration:S/n,start:c,end:c+p-1}}),c+=p,f+=4,s=f}return{earliestPresentationTime:r,timescale:n,version:t,referencesCount:d,references:e}}function LA(i){const e=[],t=ct(i,["moov","trak"]);for(let n=0;n<t.length;n++){const r=t[n],o=ct(r,["tkhd"])[0];if(o){let c=o[0];const d=Je(o,c===0?12:20),u=ct(r,["mdia","mdhd"])[0];if(u){c=u[0];const f=Je(u,c===0?12:20),m=ct(r,["mdia","hdlr"])[0];if(m){const p=Ss(m.subarray(8,12)),v={soun:zt.AUDIO,vide:zt.VIDEO}[p],S=ct(r,["mdia","minf","stbl","stsd"])[0],y=U2(S);v?(e[d]={timescale:f,type:v,stsd:y},e[v]=_t({timescale:f,id:d},y)):e[d]={timescale:f,type:p,stsd:y}}}}}return ct(i,["moov","mvex","trex"]).forEach(n=>{const r=Je(n,4),o=e[r];o&&(o.default={duration:Je(n,12),flags:Je(n,20)})}),e}function U2(i){const e=i.subarray(8),t=e.subarray(86),s=Ss(e.subarray(4,8));let n=s,r;const o=s==="enca"||s==="encv";if(o){const u=ct(e,[s])[0].subarray(s==="enca"?28:78);ct(u,["sinf"]).forEach(m=>{const p=ct(m,["schm"])[0];if(p){const v=Ss(p.subarray(4,8));if(v==="cbcs"||v==="cenc"){const S=ct(m,["frma"])[0];S&&(n=Ss(S))}}})}const c=n;switch(n){case"avc1":case"avc2":case"avc3":case"avc4":{const d=ct(t,["avcC"])[0];d&&d.length>3&&(n+="."+Md(d[1])+Md(d[2])+Md(d[3]),r=Nd(c==="avc1"?"dva1":"dvav",t));break}case"mp4a":{const d=ct(e,[s])[0],u=ct(d.subarray(28),["esds"])[0];if(u&&u.length>7){let f=4;if(u[f++]!==3)break;f=Pg(u,f),f+=2;const m=u[f++];if(m&128&&(f+=2),m&64&&(f+=u[f++]),u[f++]!==4)break;f=Pg(u,f);const p=u[f++];if(p===64)n+="."+Md(p);else break;if(f+=12,u[f++]!==5)break;f=Pg(u,f);const v=u[f++];let S=(v&248)>>3;S===31&&(S+=1+((v&7)<<3)+((u[f]&224)>>5)),n+="."+S}break}case"hvc1":case"hev1":{const d=ct(t,["hvcC"])[0];if(d&&d.length>12){const u=d[1],f=["","A","B","C"][u>>6],m=u&31,p=Je(d,2),v=(u&32)>>5?"H":"L",S=d[12],y=d.subarray(6,12);n+="."+f+m,n+="."+F2(p).toString(16).toUpperCase(),n+="."+v+S;let E="";for(let A=y.length;A--;){const R=y[A];(R||E)&&(E="."+R.toString(16).toUpperCase()+E)}n+=E}r=Nd(c=="hev1"?"dvhe":"dvh1",t);break}case"dvh1":case"dvhe":case"dvav":case"dva1":case"dav1":{n=Nd(n,t)||n;break}case"vp09":{const d=ct(t,["vpcC"])[0];if(d&&d.length>6){const u=d[4],f=d[5],m=d[6]>>4&15;n+="."+bn(u)+"."+bn(f)+"."+bn(m)}break}case"av01":{const d=ct(t,["av1C"])[0];if(d&&d.length>2){const u=d[1]>>>5,f=d[1]&31,m=d[2]>>>7?"H":"M",p=(d[2]&64)>>6,v=(d[2]&32)>>5,S=u===2&&p?v?12:10:p?10:8,y=(d[2]&16)>>4,E=(d[2]&8)>>3,A=(d[2]&4)>>2,R=d[2]&3;n+="."+u+"."+bn(f)+m+"."+bn(S)+"."+y+"."+E+A+R+"."+bn(1)+"."+bn(1)+"."+bn(1)+"."+0,r=Nd("dav1",t)}break}}return{codec:n,encrypted:o,supplemental:r}}function Nd(i,e){const t=ct(e,["dvvC"]),s=t.length?t[0]:ct(e,["dvcC"])[0];if(s){const n=s[2]>>1&127,r=s[2]<<5&32|s[3]>>3&31;return i+"."+bn(n)+"."+bn(r)}}function F2(i){let e=0;for(let t=0;t<32;t++)e|=(i>>t&1)<<31-t;return e>>>0}function Pg(i,e){const t=e+5;for(;i[e++]&128&&e<t;);return e}function Md(i){return("0"+i.toString(16).toUpperCase()).slice(-2)}function bn(i){return(i<10?"0":"")+i}function B2(i,e){if(!i||!e)return i;const t=e.keyId;return t&&e.isCommonEncryption&&ct(i,["moov","trak"]).forEach(n=>{const o=ct(n,["mdia","minf","stbl","stsd"])[0].subarray(8);let c=ct(o,["enca"]);const d=c.length>0;d||(c=ct(o,["encv"])),c.forEach(u=>{const f=d?u.subarray(28):u.subarray(78);ct(f,["sinf"]).forEach(p=>{const v=wA(p);if(v){const S=v.subarray(8,24);S.some(y=>y!==0)||(wt.log(`[eme] Patching keyId in 'enc${d?"a":"v"}>sinf>>tenc' box: ${An.hexDump(S)} -> ${An.hexDump(t)}`),v.set(t,8))}})})}),i}function wA(i){const e=ct(i,["schm"])[0];if(e){const t=Ss(e.subarray(4,8));if(t==="cbcs"||t==="cenc")return ct(i,["schi","tenc"])[0]}return null}function j2(i,e,t){const s={},n=ct(i,["moof","traf"]);for(let r=0;r<n.length;r++){const o=n[r],c=ct(o,["tfhd"])[0],d=Je(c,4),u=e[d];if(!u)continue;const f=s[d]||(s[d]={start:NaN,duration:0,sampleCount:0,timescale:u.timescale,type:u.type}),m=ct(o,["tfdt"])[0];if(m){const I=m[0];let C=Je(m,4);I===1&&(C===Eh?t.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"):(C*=Eh+1,C+=Je(m,8))),Fe(C)&&(!Fe(f.start)||C<f.start)&&(f.start=C)}const p=u.default,v=Je(c,0)|(p==null?void 0:p.flags);let S=(p==null?void 0:p.duration)||0;v&8&&(v&2?S=Je(c,12):S=Je(c,8));const y=ct(o,["trun"]);let E=f.start||0,A=0,R=S;for(let I=0;I<y.length;I++){const C=y[I],L=Je(C,4),D=f.sampleCount;f.sampleCount+=L;const _=C[3]&1,M=C[3]&4,U=C[2]&1,F=C[2]&2,z=C[2]&4,V=C[2]&8;let ae=8,G=L;for(_&&(ae+=4),M&&L&&(!(C[ae+1]&1)&&f.keyFrameIndex===void 0&&(f.keyFrameIndex=D),ae+=4,U?(R=Je(C,ae),ae+=4):R=S,F&&(ae+=4),V&&(ae+=4),E+=R,A+=R,G--);G--;)U?(R=Je(C,ae),ae+=4):R=S,F&&(ae+=4),z&&(C[ae+1]&1||f.keyFrameIndex===void 0&&(f.keyFrameIndex=f.sampleCount-(G+1),f.keyFrameStart=E),ae+=4),V&&(ae+=4),E+=R,A+=R;!A&&S&&(A+=S*L)}f.duration+=A}if(!Object.keys(s).some(r=>s[r].duration)){let r=1/0,o=0;const c=ct(i,["sidx"]);for(let d=0;d<c.length;d++){const u=M2(c[d]);if(u!=null&&u.references){r=Math.min(r,u.earliestPresentationTime/u.timescale);const f=u.references.reduce((m,p)=>m+p.info.duration||0,0);o=Math.max(o,f+u.earliestPresentationTime/u.timescale)}}o&&Fe(o)&&Object.keys(s).forEach(d=>{s[d].duration||(s[d].duration=o*s[d].timescale-s[d].start)})}return s}function V2(i,e,t){ct(e,["moof","traf"]).forEach(s=>{ct(s,["tfhd"]).forEach(n=>{const r=Je(n,4),o=i[r];if(!o)return;const c=o.timescale||9e4;ct(s,["tfdt"]).forEach(d=>{const u=d[0],f=t*c;if(f){let m=Je(d,4);if(u===0)m-=f,m=Math.max(m,0),_g(d,4,m);else{m*=Math.pow(2,32),m+=Je(d,8),m-=f,m=Math.max(m,0);const p=Math.floor(m/(Eh+1)),v=Math.floor(m%(Eh+1));_g(d,4,p),_g(d,8,v)}}})})})}function $2(i){const e={valid:null,remainder:null},t=ct(i,["moof"]);if(t.length<2)return e.remainder=i,e;const s=t[t.length-1];return e.valid=i.slice(0,s.byteOffset-8),e.remainder=i.slice(s.byteOffset-8),e}function Xi(i,e){const t=new Uint8Array(i.length+e.length);return t.set(i),t.set(e,i.length),t}function e1(i,e){const t=[],s=e.samples,n=e.timescale,r=e.id;let o=!1;return ct(s,["moof"]).map(d=>{const u=d.byteOffset-8;ct(d,["traf"]).map(m=>{const p=ct(m,["tfdt"]).map(v=>{const S=v[0];let y=Je(v,4);return S===1&&(y*=Math.pow(2,32),y+=Je(v,8)),y/n})[0];return p!==void 0&&(i=p),ct(m,["tfhd"]).map(v=>{const S=Je(v,4),y=Je(v,0)&16777215,E=(y&1)!==0,A=(y&2)!==0,R=(y&8)!==0;let I=0;const C=(y&16)!==0;let L=0;const D=(y&32)!==0;let _=8;S===r&&(E&&(_+=8),A&&(_+=4),R&&(I=Je(v,_),_+=4),C&&(L=Je(v,_),_+=4),D&&(_+=4),e.type==="video"&&(o=Qh(e.codec)),ct(m,["trun"]).map(M=>{const U=M[0],F=Je(M,0)&16777215,z=(F&1)!==0;let V=0;const ae=(F&4)!==0,G=(F&256)!==0;let Z=0;const B=(F&512)!==0;let Q=0;const re=(F&1024)!==0,J=(F&2048)!==0;let N=0;const K=Je(M,4);let le=8;z&&(V=Je(M,le),le+=4),ae&&(le+=4);let H=V+u;for(let ue=0;ue<K;ue++){if(G?(Z=Je(M,le),le+=4):Z=I,B?(Q=Je(M,le),le+=4):Q=L,re&&(le+=4),J&&(U===0?N=Je(M,le):N=RA(M,le),le+=4),e.type===zt.VIDEO){let xe=0;for(;xe<Q;){const fe=Je(s,H);if(H+=4,G2(o,s[H])){const We=s.subarray(H,H+fe);_0(We,o?2:1,i+N/n,t)}H+=fe,xe+=fe+4}}i+=Z/n}}))})})}),t}function Qh(i){if(!i)return!1;const e=i.substring(0,4);return e==="hvc1"||e==="hev1"||e==="dvh1"||e==="dvhe"}function G2(i,e){if(i){const t=e>>1&63;return t===39||t===40}else return(e&31)===6}function _0(i,e,t,s){const n=CA(i);let r=0;r+=e;let o=0,c=0,d=0;for(;r<n.length;){o=0;do{if(r>=n.length)break;d=n[r++],o+=d}while(d===255);c=0;do{if(r>=n.length)break;d=n[r++],c+=d}while(d===255);const u=n.length-r;let f=r;if(c<u)r+=c;else if(c>u){wt.error(`Malformed SEI payload. ${c} is too small, only ${u} bytes left to parse.`);break}if(o===4){if(n[f++]===181){const p=IA(n,f);if(f+=2,p===49){const v=Je(n,f);if(f+=4,v===1195456820){const S=n[f++];if(S===3){const y=n[f++],E=31&y,A=64&y,R=A?2+E*3:0,I=new Uint8Array(R);if(A){I[0]=y;for(let C=1;C<R;C++)I[C]=n[f++]}s.push({type:S,payloadType:o,pts:t,bytes:I})}}}}}else if(o===5&&c>16){const m=[];for(let S=0;S<16;S++){const y=n[f++].toString(16);m.push(y.length==1?"0"+y:y),(S===3||S===5||S===7||S===9)&&m.push("-")}const p=c-16,v=new Uint8Array(p);for(let S=0;S<p;S++)v[S]=n[f++];s.push({payloadType:o,pts:t,uuid:m.join(""),userData:Ci(v),userDataBytes:v})}}}function CA(i){const e=i.byteLength,t=[];let s=1;for(;s<e-2;)i[s]===0&&i[s+1]===0&&i[s+2]===3?(t.push(s+2),s+=2):s++;if(t.length===0)return i;const n=e-t.length,r=new Uint8Array(n);let o=0;for(s=0;s<n;o++,s++)o===t[0]&&(o++,t.shift()),r[s]=i[o];return r}function H2(i){const e=i[0];let t="",s="",n=0,r=0,o=0,c=0,d=0,u=0;if(e===0){for(;Ss(i.subarray(u,u+1))!=="\0";)t+=Ss(i.subarray(u,u+1)),u+=1;for(t+=Ss(i.subarray(u,u+1)),u+=1;Ss(i.subarray(u,u+1))!=="\0";)s+=Ss(i.subarray(u,u+1)),u+=1;s+=Ss(i.subarray(u,u+1)),u+=1,n=Je(i,12),r=Je(i,16),c=Je(i,20),d=Je(i,24),u=28}else if(e===1){u+=4,n=Je(i,u),u+=4;const m=Je(i,u);u+=4;const p=Je(i,u);for(u+=4,o=2**32*m+p,x2(o)||(o=Number.MAX_SAFE_INTEGER,wt.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),c=Je(i,u),u+=4,d=Je(i,u),u+=4;Ss(i.subarray(u,u+1))!=="\0";)t+=Ss(i.subarray(u,u+1)),u+=1;for(t+=Ss(i.subarray(u,u+1)),u+=1;Ss(i.subarray(u,u+1))!=="\0";)s+=Ss(i.subarray(u,u+1)),u+=1;s+=Ss(i.subarray(u,u+1)),u+=1}const f=i.subarray(u,i.byteLength);return{schemeIdUri:t,value:s,timeScale:n,presentationTime:o,presentationTimeDelta:r,eventDuration:c,id:d,payload:f}}function z2(i,...e){const t=e.length;let s=8,n=t;for(;n--;)s+=e[n].byteLength;const r=new Uint8Array(s);for(r[0]=s>>24&255,r[1]=s>>16&255,r[2]=s>>8&255,r[3]=s&255,r.set(i,4),n=0,s=8;n<t;n++)r.set(e[n],s),s+=e[n].byteLength;return r}function K2(i,e,t){if(i.byteLength!==16)throw new RangeError("Invalid system id");let s,n;s=0,n=new Uint8Array;let r;s>0?(r=new Uint8Array(4),e.length>0&&new DataView(r.buffer).setUint32(0,e.length,!1)):r=new Uint8Array;const o=new Uint8Array(4);return t&&t.byteLength>0&&new DataView(o.buffer).setUint32(0,t.byteLength,!1),z2([112,115,115,104],new Uint8Array([s,0,0,0]),i,r,n,o,t||new Uint8Array)}function Y2(i){const e=[];if(i instanceof ArrayBuffer){const t=i.byteLength;let s=0;for(;s+32<t;){const n=new DataView(i,s),r=q2(n);e.push(r),s+=r.size}}return e}function q2(i){const e=i.getUint32(0),t=i.byteOffset,s=i.byteLength;if(s<e)return{offset:t,size:s};if(i.getUint32(4)!==1886614376)return{offset:t,size:e};const r=i.getUint32(8)>>>24;if(r!==0&&r!==1)return{offset:t,size:e};const o=i.buffer,c=An.hexDump(new Uint8Array(o,t+12,16)),d=i.getUint32(28);let u=null,f=null;if(r===0){if(e-32<d||d<22)return{offset:t,size:e};f=new Uint8Array(o,t+32,d)}else if(r===1){if(!d||s<t+32+d*16+16)return{offset:t,size:e};u=[];for(let m=0;m<d;m++)u.push(new Uint8Array(o,t+32+m*16,16))}return{version:r,systemId:c,kids:u,data:f,offset:t,size:e}}const OA=()=>/\(Windows.+Firefox\//i.test(navigator.userAgent),vl={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,dav1:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function DA(i,e){const t=vl[e];return!!t&&!!t[i.slice(0,4)]}function Up(i,e,t=!0){return!i.split(",").some(s=>!_A(s,e,t))}function _A(i,e,t=!0){var s;const n=ca(t);return(s=n==null?void 0:n.isTypeSupported(Yc(i,e)))!=null?s:!1}function Yc(i,e){return`${e}/mp4;codecs=${i}`}function t1(i){if(i){const e=i.substring(0,4);return vl.video[e]}return 2}function bh(i){const e=OA();return i.split(",").reduce((t,s)=>{const r=e&&Qh(s)?9:vl.video[s];return r?(r*2+t)/(t?3:2):(vl.audio[s]+t)/(t?2:1)},0)}const kg={};function Q2(i,e=!0){if(kg[i])return kg[i];const t={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"],"mp4a.40.34":["mp3"]}[i];for(let n=0;n<t.length;n++){var s;if(_A(t[n],"audio",e))return kg[i]=t[n],t[n];if(t[n]==="mp3"&&(s=ca(e))!=null&&s.isTypeSupported("audio/mpeg"))return""}return i}const X2=/flac|opus|mp4a\.40\.34/i;function Ah(i,e=!0){return i.replace(X2,t=>Q2(t.toLowerCase(),e))}function W2(i,e){const t=[];if(i){const s=i.split(",");for(let n=0;n<s.length;n++)DA(s[n],"video")||t.push(s[n])}return e&&t.push(e),t.join(",")}function nh(i,e){if(i&&(i.length>4||["ac-3","ec-3","alac","fLaC","Opus"].indexOf(i)!==-1))return i;if(e){const t=e.split(",");if(t.length>1){if(i){for(let s=t.length;s--;)if(t[s].substring(0,4)===i.substring(0,4))return t[s]}return t[0]}}return e||i}function Z2(i){const e=i.split(",");for(let t=0;t<e.length;t++){const s=e[t].split(".");s.length>2&&s[0]==="avc1"&&(e[t]=`avc1.${parseInt(s[1]).toString(16)}${("000"+parseInt(s[2]).toString(16)).slice(-4)}`)}return e.join(",")}function J2(i){if(i.startsWith("av01.")){const e=i.split("."),t=["0","111","01","01","01","0"];for(let s=e.length;s>4&&s<10;s++)e[s]=t[s-4];return e.join(".")}return i}function s1(i){const e=ca(i)||{isTypeSupported:()=>!1};return{mpeg:e.isTypeSupported("audio/mpeg"),mp3:e.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:e.isTypeSupported('audio/mp4; codecs="ac-3"')}}function PA(i){return i.replace(/^.+codecs=["']?([^"']+).*$/,"$1")}const kA={supported:!0,configurations:[],decodingInfoResults:[{supported:!0,powerEfficient:!0,smooth:!0}]};function NA(i,e){return{supported:!1,configurations:e,decodingInfoResults:[{supported:!1,smooth:!1,powerEfficient:!1}],error:i}}const i1={};function ek(i,e,t,s,n,r){const o=i.audioCodec?i.audioGroups:null,c=r==null?void 0:r.audioCodec,d=r==null?void 0:r.channels,u=d?parseInt(d):c?1/0:2;let f=null;if(o!=null&&o.length)try{o.length===1&&o[0]?f=e.groups[o[0]].channels:f=o.reduce((m,p)=>{if(p){const v=e.groups[p];if(!v)throw new Error(`Audio track group ${p} not found`);Object.keys(v.channels).forEach(S=>{m[S]=(m[S]||0)+v.channels[S]})}return m},{2:0})}catch{return!0}return i.videoCodec!==void 0&&(i.width>1920&&i.height>1088||i.height>1920&&i.width>1088||i.frameRate>Math.max(s,30)||i.videoRange!=="SDR"&&i.videoRange!==t||i.bitrate>Math.max(n,8e6))||!!f&&Fe(u)&&Object.keys(f).some(m=>parseInt(m)>u)}function MA(i,e,t){const s=i.videoCodec,n=i.audioCodec;if(!s&&!n||!t)return Promise.resolve(kA);const r=[];if(s){const o={width:i.width,height:i.height,bitrate:Math.ceil(Math.max(i.bitrate*.9,i.averageBitrate)),framerate:i.frameRate||30},c=i.videoRange;c!=="SDR"&&(o.transferFunction=c.toLowerCase());const d=s.split(","),u=navigator.userAgent;if(d.some(f=>Qh(f))&&OA())return Promise.resolve(NA(new Error(`Overriding Windows Firefox HEVC MediaCapabilities result based on user-agent sting: (${u})`),r));r.push.apply(r,d.map(f=>({type:"media-source",video:_t(_t({},o),{},{contentType:Yc(J2(f),"video")})})))}return n&&i.audioGroups&&i.audioGroups.forEach(o=>{var c;o&&((c=e.groups[o])==null||c.tracks.forEach(d=>{if(d.groupId===o){const u=d.channels||"",f=parseFloat(u);Fe(f)&&f>2&&r.push.apply(r,n.split(",").map(m=>({type:"media-source",audio:{contentType:Yc(m,"audio"),channels:""+f}})))}}))}),Promise.all(r.map(o=>{const c=tk(o);return i1[c]||(i1[c]=t.decodingInfo(o))})).then(o=>({supported:!o.some(c=>!c.supported),configurations:r,decodingInfoResults:o})).catch(o=>({supported:!1,configurations:r,decodingInfoResults:[],error:o}))}function tk(i){const{audio:e,video:t}=i,s=t||e;if(s){const n=PA(s.contentType);if(t)return`r${t.height}x${t.width}f${Math.ceil(t.framerate)}${t.transferFunction||"sd"}_${n}_${Math.ceil(t.bitrate/1e5)}`;if(e)return`c${e.channels}${e.spatialRendering?"s":"n"}_${n}`}return""}const Fp=["NONE","TYPE-0","TYPE-1",null];function sk(i){return Fp.indexOf(i)>-1}const Ih=["SDR","PQ","HLG"];function ik(i){return!!i&&Ih.indexOf(i)>-1}var rh={No:"",Yes:"YES",v2:"v2"};function n1(i){const{canSkipUntil:e,canSkipDateRanges:t,age:s}=i,n=s<e/2;return e&&n?t?rh.v2:rh.Yes:rh.No}class r1{constructor(e,t,s){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=s}addDirectives(e){const t=new self.URL(e);return this.msn!==void 0&&t.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}class qc{constructor(e){if(this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.supplemental=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.frameRate=e.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=e.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.codecSet=[e.videoCodec,e.audioCodec].filter(s=>!!s).map(s=>s.substring(0,4)).join(","),"supplemental"in e){var t;this.supplemental=e.supplemental;const s=(t=e.supplemental)==null?void 0:t.videoCodec;s&&s!==e.videoCodec&&(this.codecSet+=`,${s.substring(0,4)}`)}this.addGroupId("audio",e.attrs.AUDIO),this.addGroupId("text",e.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(e){return a1(this._audioGroups,e)}hasSubtitleGroup(e){return a1(this._subtitleGroups,e)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(e,t){if(t){if(e==="audio"){let s=this._audioGroups;s||(s=this._audioGroups=[]),s.indexOf(t)===-1&&s.push(t)}else if(e==="text"){let s=this._subtitleGroups;s||(s=this._subtitleGroups=[]),s.indexOf(t)===-1&&s.push(t)}}}get urlId(){return 0}set urlId(e){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var e;return(e=this.audioGroups)==null?void 0:e[0]}get textGroupId(){var e;return(e=this.subtitleGroups)==null?void 0:e[0]}addFallback(){}}function a1(i,e){return!e||!i?!1:i.indexOf(e)!==-1}function nk(){if(typeof matchMedia=="function"){const i=matchMedia("(dynamic-range: high)"),e=matchMedia("bad query");if(i.media!==e.media)return i.matches===!0}return!1}function rk(i,e){let t=!1,s=[];if(i&&(t=i!=="SDR",s=[i]),e){s=e.allowedVideoRanges||Ih.slice(0);const n=s.join("")!=="SDR"&&!e.videoCodec;t=e.preferHDR!==void 0?e.preferHDR:n&&nk(),t||(s=["SDR"])}return{preferHDR:t,allowedVideoRanges:s}}const ak=i=>{const e=new WeakSet;return(t,s)=>{if(i&&(s=i(t,s)),typeof s=="object"&&s!==null){if(e.has(s))return;e.add(s)}return s}},es=(i,e)=>JSON.stringify(i,ak(e));function ok(i,e,t,s,n){const r=Object.keys(i),o=s==null?void 0:s.channels,c=s==null?void 0:s.audioCodec,d=n==null?void 0:n.videoCodec,u=o&&parseInt(o)===2;let f=!1,m=!1,p=1/0,v=1/0,S=1/0,y=1/0,E=0,A=[];const{preferHDR:R,allowedVideoRanges:I}=rk(e,n);for(let M=r.length;M--;){const U=i[r[M]];f||(f=U.channels[2]>0),p=Math.min(p,U.minHeight),v=Math.min(v,U.minFramerate),S=Math.min(S,U.minBitrate),I.filter(z=>U.videoRanges[z]>0).length>0&&(m=!0)}p=Fe(p)?p:0,v=Fe(v)?v:0;const C=Math.max(1080,p),L=Math.max(30,v);S=Fe(S)?S:t,t=Math.max(S,t),m||(e=void 0);const D=r.length>1;return{codecSet:r.reduce((M,U)=>{const F=i[U];if(U===M)return M;if(A=m?I.filter(z=>F.videoRanges[z]>0):[],D){if(F.minBitrate>t)return En(U,`min bitrate of ${F.minBitrate} > current estimate of ${t}`),M;if(!F.hasDefaultAudio)return En(U,"no renditions with default or auto-select sound found"),M;if(c&&U.indexOf(c.substring(0,4))%5!==0)return En(U,`audio codec preference "${c}" not found`),M;if(o&&!u){if(!F.channels[o])return En(U,`no renditions with ${o} channel sound found (channels options: ${Object.keys(F.channels)})`),M}else if((!c||u)&&f&&F.channels[2]===0)return En(U,"no renditions with stereo sound found"),M;if(F.minHeight>C)return En(U,`min resolution of ${F.minHeight} > maximum of ${C}`),M;if(F.minFramerate>L)return En(U,`min framerate of ${F.minFramerate} > maximum of ${L}`),M;if(!A.some(z=>F.videoRanges[z]>0))return En(U,`no variants with VIDEO-RANGE of ${es(A)} found`),M;if(d&&U.indexOf(d.substring(0,4))%5!==0)return En(U,`video codec preference "${d}" not found`),M;if(F.maxScore<E)return En(U,`max score of ${F.maxScore} < selected max of ${E}`),M}return M&&(bh(U)>=bh(M)||F.fragmentError>i[M].fragmentError)?M:(y=F.minIndex,E=F.maxScore,U)},void 0),videoRanges:A,preferHDR:R,minFramerate:v,minBitrate:S,minIndex:y}}function En(i,e){wt.log(`[abr] start candidates with "${i}" ignored because ${e}`)}function UA(i){return i.reduce((e,t)=>{let s=e.groups[t.groupId];s||(s=e.groups[t.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),s.tracks.push(t);const n=t.channels||"2";return s.channels[n]=(s.channels[n]||0)+1,s.hasDefault=s.hasDefault||t.default,s.hasAutoSelect=s.hasAutoSelect||t.autoselect,s.hasDefault&&(e.hasDefaultAudio=!0),s.hasAutoSelect&&(e.hasAutoSelectAudio=!0),e},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function lk(i,e,t,s){return i.slice(t,s+1).reduce((n,r,o)=>{if(!r.codecSet)return n;const c=r.audioGroups;let d=n[r.codecSet];d||(n[r.codecSet]=d={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,minIndex:o,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!c,fragmentError:0}),d.minBitrate=Math.min(d.minBitrate,r.bitrate);const u=Math.min(r.height,r.width);return d.minHeight=Math.min(d.minHeight,u),d.minFramerate=Math.min(d.minFramerate,r.frameRate),d.minIndex=Math.min(d.minIndex,o),d.maxScore=Math.max(d.maxScore,r.score),d.fragmentError+=r.fragmentError,d.videoRanges[r.videoRange]=(d.videoRanges[r.videoRange]||0)+1,c&&c.forEach(f=>{if(!f)return;const m=e.groups[f];m&&(d.hasDefaultAudio=d.hasDefaultAudio||e.hasDefaultAudio?m.hasDefault:m.hasAutoSelect||!e.hasDefaultAudio&&!e.hasAutoSelectAudio,Object.keys(m.channels).forEach(p=>{d.channels[p]=(d.channels[p]||0)+m.channels[p]}))}),n},{})}function o1(i){if(!i)return i;const{lang:e,assocLang:t,characteristics:s,channels:n,audioCodec:r}=i;return{lang:e,assocLang:t,characteristics:s,channels:n,audioCodec:r}}function On(i,e,t){if("attrs"in i){const s=e.indexOf(i);if(s!==-1)return s}for(let s=0;s<e.length;s++){const n=e[s];if(Ja(i,n,t))return s}return-1}function Ja(i,e,t){const{groupId:s,name:n,lang:r,assocLang:o,default:c}=i,d=i.forced;return(s===void 0||e.groupId===s)&&(n===void 0||e.name===n)&&(r===void 0||ck(r,e.lang))&&(r===void 0||e.assocLang===o)&&(c===void 0||e.default===c)&&(d===void 0||e.forced===d)&&(!("characteristics"in i)||uk(i.characteristics||"",e.characteristics))&&(t===void 0||t(i,e))}function ck(i,e="--"){return i.length===e.length?i===e:i.startsWith(e)||e.startsWith(i)}function uk(i,e=""){const t=i.split(","),s=e.split(",");return t.length===s.length&&!t.some(n=>s.indexOf(n)===-1)}function Ba(i,e){const{audioCodec:t,channels:s}=i;return(t===void 0||(e.audioCodec||"").substring(0,4)===t.substring(0,4))&&(s===void 0||s===(e.channels||"2"))}function dk(i,e,t,s,n){const r=e[s],c=e.reduce((p,v,S)=>{const y=v.uri;return(p[y]||(p[y]=[])).push(S),p},{})[r.uri];c.length>1&&(s=Math.max.apply(Math,c));const d=r.videoRange,u=r.frameRate,f=r.codecSet.substring(0,4),m=l1(e,s,p=>{if(p.videoRange!==d||p.frameRate!==u||p.codecSet.substring(0,4)!==f)return!1;const v=p.audioGroups,S=t.filter(y=>!v||v.indexOf(y.groupId)!==-1);return On(i,S,n)>-1});return m>-1?m:l1(e,s,p=>{const v=p.audioGroups,S=t.filter(y=>!v||v.indexOf(y.groupId)!==-1);return On(i,S,n)>-1})}function l1(i,e,t){for(let s=e;s>-1;s--)if(t(i[s]))return s;for(let s=e+1;s<i.length;s++)if(t(i[s]))return s;return-1}function Rh(i,e){var t;return!!i&&i!==((t=e.loadLevelObj)==null?void 0:t.uri)}class hk extends gr{constructor(e){super("abr",e.logger),this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.rebufferNotice=-1,this.bwEstimator=void 0,this._abandonRulesCheck=t=>{var s;const{fragCurrent:n,partCurrent:r,hls:o}=this,{autoLevelEnabled:c,media:d}=o;if(!n||!d)return;const u=performance.now(),f=r?r.stats:n.stats,m=r?r.duration:n.duration,p=u-f.loading.start,v=o.minAutoLevel,S=n.level,y=this._nextAutoLevel;if(f.aborted||f.loaded&&f.loaded===f.total||S<=v){this.clearTimer(),this._nextAutoLevel=-1;return}if(!c)return;const E=y>-1&&y!==S,A=!!t||E;if(!A&&(d.paused||!d.playbackRate||!d.readyState))return;const R=o.mainForwardBufferInfo;if(!A&&R===null)return;const I=this.bwEstimator.getEstimateTTFB(),C=Math.abs(d.playbackRate);if(p<=Math.max(I,1e3*(m/(C*2))))return;const L=R?R.len/C:0,D=f.loading.first?f.loading.first-f.loading.start:-1,_=f.loaded&&D>-1,M=this.getBwEstimate(),U=o.levels,F=U[S],z=Math.max(f.loaded,Math.round(m*(n.bitrate||F.averageBitrate)/8));let V=_?p-D:p;V<1&&_&&(V=Math.min(p,f.loaded*8/M));const ae=_?f.loaded*1e3/V:0,G=I/1e3,Z=ae?(z-f.loaded)/ae:z*8/M+G;if(Z<=L)return;const B=ae?ae*8:M,Q=((s=(t==null?void 0:t.details)||this.hls.latestLevelDetails)==null?void 0:s.live)===!0,re=this.hls.config.abrBandWidthUpFactor;let J=Number.POSITIVE_INFINITY,N;for(N=S-1;N>v;N--){const ue=U[N].maxBitrate,xe=!U[N].details||Q;if(J=this.getTimeToLoadFrag(G,B,m*ue,xe),J<Math.min(L,m+G))break}if(J>=Z||J>m*10)return;_?this.bwEstimator.sample(p-Math.min(I,D),f.loaded):this.bwEstimator.sampleTTFB(p);const K=U[N].maxBitrate;this.getBwEstimate()*re>K&&this.resetEstimator(K);const le=this.findBestLevel(K,v,N,0,L,1,1);le>-1&&(N=le),this.warn(`Fragment ${n.sn}${r?" part "+r.index:""} of level ${S} is loading too slowly;
      Fragment duration: ${n.duration.toFixed(3)}
      Time to underbuffer: ${L.toFixed(3)} s
      Estimated load time for current fragment: ${Z.toFixed(3)} s
      Estimated load time for down switch fragment: ${J.toFixed(3)} s
      TTFB estimate: ${D|0} ms
      Current BW estimate: ${Fe(M)?M|0:"Unknown"} bps
      New BW estimate: ${this.getBwEstimate()|0} bps
      Switching to level ${N} @ ${K|0} bps`),o.nextLoadLevel=o.nextAutoLevel=N,this.clearTimer();const H=()=>{if(this.clearTimer(),this.fragCurrent===n&&this.hls.loadLevel===N&&N>0){const ue=this.getStarvationDelay();if(this.warn(`Aborting inflight request ${N>0?"and switching down":""}
      Fragment duration: ${n.duration.toFixed(3)} s
      Time to underbuffer: ${ue.toFixed(3)} s`),n.abortRequests(),this.fragCurrent=this.partCurrent=null,N>v){let xe=this.findBestLevel(this.hls.levels[v].bitrate,v,N,0,ue,1,1);xe===-1&&(xe=v),this.hls.nextLoadLevel=this.hls.nextAutoLevel=xe,this.resetEstimator(this.hls.levels[xe].bitrate)}}};E||Z>J*2?H():this.timer=self.setInterval(H,J*1e3),o.trigger(w.FRAG_LOAD_EMERGENCY_ABORTED,{frag:n,part:r,stats:f})},this.hls=e,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(e){e&&(this.log(`setting initial bwe to ${e}`),this.hls.config.abrEwmaDefaultEstimate=e),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const e=this.hls.config;return new E2(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate)}registerListeners(){const{hls:e}=this;e.on(w.MANIFEST_LOADING,this.onManifestLoading,this),e.on(w.FRAG_LOADING,this.onFragLoading,this),e.on(w.FRAG_LOADED,this.onFragLoaded,this),e.on(w.FRAG_BUFFERED,this.onFragBuffered,this),e.on(w.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(w.LEVEL_LOADED,this.onLevelLoaded,this),e.on(w.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(w.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.on(w.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e&&(e.off(w.MANIFEST_LOADING,this.onManifestLoading,this),e.off(w.FRAG_LOADING,this.onFragLoading,this),e.off(w.FRAG_LOADED,this.onFragLoaded,this),e.off(w.FRAG_BUFFERED,this.onFragBuffered,this),e.off(w.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(w.LEVEL_LOADED,this.onLevelLoaded,this),e.off(w.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(w.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.off(w.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(e,t){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(e,t){const s=t.frag;if(!this.ignoreFragment(s)){if(!s.bitrateTest){var n;this.fragCurrent=s,this.partCurrent=(n=t.part)!=null?n:null}this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(e,t){this.clearTimer()}onError(e,t){if(!t.fatal)switch(t.details){case se.BUFFER_ADD_CODEC_ERROR:case se.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case se.FRAG_LOAD_TIMEOUT:{const s=t.frag,{fragCurrent:n,partCurrent:r}=this;if(s&&n&&s.sn===n.sn&&s.level===n.level){const o=performance.now(),c=r?r.stats:s.stats,d=o-c.loading.start,u=c.loading.first?c.loading.first-c.loading.start:-1;if(c.loaded&&u>-1){const m=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(d-Math.min(m,u),c.loaded)}else this.bwEstimator.sampleTTFB(d)}break}}}getTimeToLoadFrag(e,t,s,n){const r=e+s/t,o=n?e+this.lastLevelLoadSec:0;return r+o}onLevelLoaded(e,t){const s=this.hls.config,{loading:n}=t.stats,r=n.end-n.first;Fe(r)&&(this.lastLevelLoadSec=r/1e3),t.details.live?this.bwEstimator.update(s.abrEwmaSlowLive,s.abrEwmaFastLive):this.bwEstimator.update(s.abrEwmaSlowVoD,s.abrEwmaFastVoD),this.timer>-1&&this._abandonRulesCheck(t.levelInfo)}onFragLoaded(e,{frag:t,part:s}){const n=s?s.stats:t.stats;if(t.type===ze.MAIN&&this.bwEstimator.sampleTTFB(n.loading.first-n.loading.start),!this.ignoreFragment(t)){if(this.clearTimer(),t.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const r=s?s.duration:t.duration,o=this.hls.levels[t.level],c=(o.loaded?o.loaded.bytes:0)+n.loaded,d=(o.loaded?o.loaded.duration:0)+r;o.loaded={bytes:c,duration:d},o.realBitrate=Math.round(8*c/d)}if(t.bitrateTest){const r={stats:n,frag:t,part:s,id:t.type};this.onFragBuffered(w.FRAG_BUFFERED,r),t.bitrateTest=!1}else this.lastLoadedFragLevel=t.level}}onFragBuffered(e,t){const{frag:s,part:n}=t,r=n!=null&&n.stats.loaded?n.stats:s.stats;if(r.aborted||this.ignoreFragment(s))return;const o=r.parsing.end-r.loading.start-Math.min(r.loading.first-r.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(o,r.loaded),r.bwEstimate=this.getBwEstimate(),s.bitrateTest?this.bitrateTestDelay=o/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==ze.MAIN||e.sn==="initSegment"}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:e,minAutoLevel:t}=this.hls,s=this.getBwEstimate(),n=this.hls.config.maxStarvationDelay,r=this.findBestLevel(s,t,e,0,n,1,1);if(r>-1)return r;const o=this.hls.firstLevel,c=Math.min(Math.max(o,t),e);return this.warn(`Could not find best starting auto level. Defaulting to first in playlist ${o} clamped to ${c}`),c}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const e=this.forcedAutoLevel,s=this.bwEstimator.canEstimate(),n=this.lastLoadedFragLevel>-1;if(e!==-1&&(!s||!n||this.nextAutoLevelKey===this.getAutoLevelKey()))return e;const r=s&&n?this.getNextABRAutoLevel():this.firstAutoLevel;if(e!==-1){const o=this.hls.levels;if(o.length>Math.max(e,r)&&o[e].loadError<=o[r].loadError)return e}return this._nextAutoLevel=r,this.nextAutoLevelKey=this.getAutoLevelKey(),r}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:t,hls:s}=this;if(s.levels.length<=1)return s.loadLevel;const{maxAutoLevel:n,config:r,minAutoLevel:o}=s,c=t?t.duration:e?e.duration:0,d=this.getBwEstimate(),u=this.getStarvationDelay();let f=r.abrBandWidthFactor,m=r.abrBandWidthUpFactor;if(u){const E=this.findBestLevel(d,o,n,u,0,f,m);if(E>=0)return this.rebufferNotice=-1,E}let p=c?Math.min(c,r.maxStarvationDelay):r.maxStarvationDelay;if(!u){const E=this.bitrateTestDelay;E&&(p=(c?Math.min(c,r.maxLoadingDelay):r.maxLoadingDelay)-E,this.info(`bitrate test took ${Math.round(1e3*E)}ms, set first fragment max fetchDuration to ${Math.round(1e3*p)} ms`),f=m=1)}const v=this.findBestLevel(d,o,n,u,p,f,m);if(this.rebufferNotice!==v&&(this.rebufferNotice=v,this.info(`${u?"rebuffering expected":"buffer is empty"}, optimal quality level ${v}`)),v>-1)return v;const S=s.levels[o],y=s.loadLevelObj;return y&&(S==null?void 0:S.bitrate)<y.bitrate?o:s.loadLevel}getStarvationDelay(){const e=this.hls,t=e.media;if(!t)return 1/0;const s=t&&t.playbackRate!==0?Math.abs(t.playbackRate):1,n=e.mainForwardBufferInfo;return(n?n.len:0)/s}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(e,t,s,n,r,o,c){var d;const u=n+r,f=this.lastLoadedFragLevel,m=f===-1?this.hls.firstLevel:f,{fragCurrent:p,partCurrent:v}=this,{levels:S,allAudioTracks:y,loadLevel:E,config:A}=this.hls;if(S.length===1)return 0;const R=S[m],I=!!((d=this.hls.latestLevelDetails)!=null&&d.live),C=E===-1||f===-1;let L,D="SDR",_=(R==null?void 0:R.frameRate)||0;const{audioPreference:M,videoPreference:U}=A,F=this.audioTracksByGroup||(this.audioTracksByGroup=UA(y));let z=-1;if(C){if(this.firstSelection!==-1)return this.firstSelection;const B=this.codecTiers||(this.codecTiers=lk(S,F,t,s)),Q=ok(B,D,e,M,U),{codecSet:re,videoRanges:J,minFramerate:N,minBitrate:K,minIndex:le,preferHDR:H}=Q;z=le,L=re,D=H?J[J.length-1]:J[0],_=N,e=Math.max(e,K),this.log(`picked start tier ${es(Q)}`)}else L=R==null?void 0:R.codecSet,D=R==null?void 0:R.videoRange;const V=v?v.duration:p?p.duration:0,ae=this.bwEstimator.getEstimateTTFB()/1e3,G=[];for(let B=s;B>=t;B--){var Z;const Q=S[B],re=B>m;if(!Q)continue;if(A.useMediaCapabilities&&!Q.supportedResult&&!Q.supportedPromise){const xe=navigator.mediaCapabilities;typeof(xe==null?void 0:xe.decodingInfo)=="function"&&(ek(Q,F,D,_,e,M)||Qh(Q.videoCodec))?(Q.supportedPromise=MA(Q,F,xe),Q.supportedPromise.then(fe=>{if(!this.hls)return;Q.supportedResult=fe;const We=this.hls.levels,de=We.indexOf(Q);fe.error?this.warn(`MediaCapabilities decodingInfo error: "${fe.error}" for level ${de} ${es(fe)}`):fe.supported||(this.warn(`Unsupported MediaCapabilities decodingInfo result for level ${de} ${es(fe)}`),de>-1&&We.length>1&&(this.log(`Removing unsupported level ${de}`),this.hls.removeLevel(de),this.hls.loadLevel===-1&&(this.hls.nextLoadLevel=0)))})):Q.supportedResult=kA}if((L&&Q.codecSet!==L||D&&Q.videoRange!==D||re&&_>Q.frameRate||!re&&_>0&&_<Q.frameRate||Q.supportedResult&&!((Z=Q.supportedResult.decodingInfoResults)!=null&&Z[0].smooth))&&(!C||B!==z)){G.push(B);continue}const J=Q.details,N=(v?J==null?void 0:J.partTarget:J==null?void 0:J.averagetargetduration)||V;let K;re?K=c*e:K=o*e;const le=V&&n>=V*2&&r===0?Q.averageBitrate:Q.maxBitrate,H=this.getTimeToLoadFrag(ae,K,le*N,J===void 0);if(K>=le&&(B===f||Q.loadError===0&&Q.fragmentError===0)&&(H<=ae||!Fe(H)||I&&!this.bitrateTestDelay||H<u)){const xe=this.forcedAutoLevel;return B!==E&&(xe===-1||xe!==E)&&(G.length&&this.trace(`Skipped level(s) ${G.join(",")} of ${s} max with CODECS and VIDEO-RANGE:"${S[G[0]].codecs}" ${S[G[0]].videoRange}; not compatible with "${L}" ${D}`),this.info(`switch candidate:${m}->${B} adjustedbw(${Math.round(K)})-bitrate=${Math.round(K-le)} ttfb:${ae.toFixed(1)} avgDuration:${N.toFixed(1)} maxFetchDuration:${u.toFixed(1)} fetchDuration:${H.toFixed(1)} firstSelection:${C} codecSet:${Q.codecSet} videoRange:${Q.videoRange} hls.loadLevel:${E}`)),C&&(this.firstSelection=B),B}}return-1}set nextAutoLevel(e){const t=this.deriveNextAutoLevel(e);this._nextAutoLevel!==t&&(this.nextAutoLevelKey="",this._nextAutoLevel=t)}deriveNextAutoLevel(e){const{maxAutoLevel:t,minAutoLevel:s}=this.hls;return Math.min(Math.max(e,s),t)}}const FA={search:function(i,e){let t=0,s=i.length-1,n=null,r=null;for(;t<=s;){n=(t+s)/2|0,r=i[n];const o=e(r);if(o>0)t=n+1;else if(o<0)s=n-1;else return r}return null}};function fk(i,e,t){if(e===null||!Array.isArray(i)||!i.length||!Fe(e))return null;const s=i[0].programDateTime;if(e<(s||0))return null;const n=i[i.length-1].endProgramDateTime;if(e>=(n||0))return null;for(let r=0;r<i.length;++r){const o=i[r];if(gk(e,t,o))return o}return null}function so(i,e,t=0,s=0,n=.005){let r=null;if(i){r=e[1+i.sn-e[0].sn]||null;const c=i.endDTS-t;c>0&&c<15e-7&&(t+=15e-7),r&&i.level!==r.level&&r.end<=i.end&&(r=e[2+i.sn-e[0].sn]||null)}else t===0&&e[0].start===0&&(r=e[0]);if(r&&((!i||i.level===r.level)&&c1(t,s,r)===0||mk(r,i,Math.min(n,s))))return r;const o=FA.search(e,c1.bind(null,t,s));return o&&(o!==i||!r)?o:r}function mk(i,e,t){if(e&&e.start===0&&e.level<i.level&&(e.endPTS||0)>0){const s=e.tagList.reduce((n,r)=>(r[0]==="INF"&&(n+=parseFloat(r[1])),n),t);return i.start<=s}return!1}function c1(i=0,e=0,t){if(t.start<=i&&t.start+t.duration>i)return 0;const s=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0));return t.start+t.duration-s<=i?1:t.start-s>i&&t.start?-1:0}function gk(i,e,t){const s=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0))*1e3;return(t.endProgramDateTime||0)-s>i}function BA(i,e,t){if(i&&i.startCC<=e&&i.endCC>=e){let s=i.fragments;const{fragmentHint:n}=i;n&&(s=s.concat(n));let r;return FA.search(s,o=>o.cc<e?1:o.cc>e?-1:(r=o,o.end<=t?1:o.start>t?-1:0)),r||null}return null}function Lh(i){switch(i.details){case se.FRAG_LOAD_TIMEOUT:case se.KEY_LOAD_TIMEOUT:case se.LEVEL_LOAD_TIMEOUT:case se.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function u1(i,e){const t=Lh(e);return i.default[`${t?"timeout":"error"}Retry`]}function P0(i,e){const t=i.backoff==="linear"?1:Math.pow(2,e);return Math.min(t*i.retryDelayMs,i.maxRetryDelayMs)}function d1(i){return _t(_t({},i),{errorRetry:null,timeoutRetry:null})}function wh(i,e,t,s){if(!i)return!1;const n=s==null?void 0:s.code,r=e<i.maxNumRetry&&(pk(n)||!!t);return i.shouldRetry?i.shouldRetry(i,e,t,s,r):r}function pk(i){return i===0&&navigator.onLine===!1||!!i&&(i<400||i>499)}var zs={DoNothing:0,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,RetryRequest:5},sn={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2};class yk extends gr{constructor(e){super("error-controller",e.logger),this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(w.ERROR,this.onError,this),e.on(w.MANIFEST_LOADING,this.onManifestLoading,this),e.on(w.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const e=this.hls;e&&(e.off(w.ERROR,this.onError,this),e.off(w.ERROR,this.onErrorOut,this),e.off(w.MANIFEST_LOADING,this.onManifestLoading,this),e.off(w.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}startLoad(e){}stopLoad(){this.playlistError=0}getVariantLevelIndex(e){return(e==null?void 0:e.type)===ze.MAIN?e.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0,this.penalizedRenditions={}}onLevelUpdated(){this.playlistError=0}onError(e,t){var s;if(t.fatal)return;const n=this.hls,r=t.context;switch(t.details){case se.FRAG_LOAD_ERROR:case se.FRAG_LOAD_TIMEOUT:case se.KEY_LOAD_ERROR:case se.KEY_LOAD_TIMEOUT:t.errorAction=this.getFragRetryOrSwitchAction(t);return;case se.FRAG_PARSING_ERROR:if((s=t.frag)!=null&&s.gap){t.errorAction=Qc();return}case se.FRAG_GAP:case se.FRAG_DECRYPT_ERROR:{t.errorAction=this.getFragRetryOrSwitchAction(t),t.errorAction.action=zs.SendAlternateToPenaltyBox;return}case se.LEVEL_EMPTY_ERROR:case se.LEVEL_PARSING_ERROR:{var o,c;const u=t.parent===ze.MAIN?t.level:n.loadLevel;t.details===se.LEVEL_EMPTY_ERROR&&((o=t.context)!=null&&(c=o.levelDetails)!=null&&c.live)?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,u):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,u))}return;case se.LEVEL_LOAD_ERROR:case se.LEVEL_LOAD_TIMEOUT:typeof(r==null?void 0:r.level)=="number"&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,r.level));return;case se.AUDIO_TRACK_LOAD_ERROR:case se.AUDIO_TRACK_LOAD_TIMEOUT:case se.SUBTITLE_LOAD_ERROR:case se.SUBTITLE_TRACK_LOAD_TIMEOUT:if(r){const u=n.loadLevelObj;if(u&&(r.type===gt.AUDIO_TRACK&&u.hasAudioGroup(r.groupId)||r.type===gt.SUBTITLE_TRACK&&u.hasSubtitleGroup(r.groupId))){t.errorAction=this.getPlaylistRetryOrSwitchAction(t,n.loadLevel),t.errorAction.action=zs.SendAlternateToPenaltyBox,t.errorAction.flags=sn.MoveAllAlternatesMatchingHost;return}}return;case se.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:{const u=n.loadLevelObj,f=u==null?void 0:u.attrs["HDCP-LEVEL"];f?t.errorAction={action:zs.SendAlternateToPenaltyBox,flags:sn.MoveAllAlternatesMatchingHDCP,hdcpLevel:f}:this.keySystemError(t)}return;case se.BUFFER_ADD_CODEC_ERROR:case se.REMUX_ALLOC_ERROR:case se.BUFFER_APPEND_ERROR:if(!t.errorAction){var d;t.errorAction=this.getLevelSwitchAction(t,(d=t.level)!=null?d:n.loadLevel)}return;case se.INTERNAL_EXCEPTION:case se.BUFFER_APPENDING_ERROR:case se.BUFFER_FULL_ERROR:case se.LEVEL_SWITCH_ERROR:case se.BUFFER_STALLED_ERROR:case se.BUFFER_SEEK_OVER_HOLE:case se.BUFFER_NUDGE_ON_STALL:t.errorAction=Qc();return}t.type===Ke.KEY_SYSTEM_ERROR&&this.keySystemError(t)}keySystemError(e){const t=this.getVariantLevelIndex(e.frag);e.levelRetry=!1,e.errorAction=this.getLevelSwitchAction(e,t)}getPlaylistRetryOrSwitchAction(e,t){const s=this.hls,n=u1(s.config.playlistLoadPolicy,e),r=this.playlistError++;if(wh(n,r,Lh(e),e.response))return{action:zs.RetryRequest,flags:sn.None,retryConfig:n,retryCount:r};const c=this.getLevelSwitchAction(e,t);return n&&(c.retryConfig=n,c.retryCount=r),c}getFragRetryOrSwitchAction(e){const t=this.hls,s=this.getVariantLevelIndex(e.frag),n=t.levels[s],{fragLoadPolicy:r,keyLoadPolicy:o}=t.config,c=u1(e.details.startsWith("key")?o:r,e),d=t.levels.reduce((f,m)=>f+m.fragmentError,0);if(n&&(e.details!==se.FRAG_GAP&&n.fragmentError++,wh(c,d,Lh(e),e.response)))return{action:zs.RetryRequest,flags:sn.None,retryConfig:c,retryCount:d};const u=this.getLevelSwitchAction(e,s);return c&&(u.retryConfig=c,u.retryCount=d),u}getLevelSwitchAction(e,t){const s=this.hls;t==null&&(t=s.loadLevel);const n=this.hls.levels[t];if(n){var r,o;const u=e.details;n.loadError++,u===se.BUFFER_APPEND_ERROR&&n.fragmentError++;let f=-1;const{levels:m,loadLevel:p,minAutoLevel:v,maxAutoLevel:S}=s;!s.autoLevelEnabled&&!s.config.preserveManualLevelOnError&&(s.loadLevel=-1);const y=(r=e.frag)==null?void 0:r.type,A=(y===ze.AUDIO&&u===se.FRAG_PARSING_ERROR||e.sourceBufferName==="audio"&&(u===se.BUFFER_ADD_CODEC_ERROR||u===se.BUFFER_APPEND_ERROR))&&m.some(({audioCodec:D})=>n.audioCodec!==D),I=e.sourceBufferName==="video"&&(u===se.BUFFER_ADD_CODEC_ERROR||u===se.BUFFER_APPEND_ERROR)&&m.some(({codecSet:D,audioCodec:_})=>n.codecSet!==D&&n.audioCodec===_),{type:C,groupId:L}=(o=e.context)!=null?o:{};for(let D=m.length;D--;){const _=(D+p)%m.length;if(_!==p&&_>=v&&_<=S&&m[_].loadError===0){var c,d;const M=m[_];if(u===se.FRAG_GAP&&y===ze.MAIN&&e.frag){const U=m[_].details;if(U){const F=so(e.frag,U.fragments,e.frag.start);if(F!=null&&F.gap)continue}}else{if(C===gt.AUDIO_TRACK&&M.hasAudioGroup(L)||C===gt.SUBTITLE_TRACK&&M.hasSubtitleGroup(L))continue;if(y===ze.AUDIO&&(c=n.audioGroups)!=null&&c.some(U=>M.hasAudioGroup(U))||y===ze.SUBTITLE&&(d=n.subtitleGroups)!=null&&d.some(U=>M.hasSubtitleGroup(U))||A&&n.audioCodec===M.audioCodec||!A&&n.audioCodec!==M.audioCodec||I&&n.codecSet===M.codecSet)continue}f=_;break}}if(f>-1&&s.loadLevel!==f)return e.levelRetry=!0,this.playlistError=0,{action:zs.SendAlternateToPenaltyBox,flags:sn.None,nextAutoLevel:f}}return{action:zs.SendAlternateToPenaltyBox,flags:sn.MoveAllAlternatesMatchingHost}}onErrorOut(e,t){var s;switch((s=t.errorAction)==null?void 0:s.action){case zs.DoNothing:break;case zs.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(t),!t.errorAction.resolved&&t.details!==se.FRAG_GAP?t.fatal=!0:/MediaSource readyState: ended/.test(t.error.message)&&(this.warn(`MediaSource ended after "${t.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError());break}if(t.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(e){const t=this.hls,s=e.errorAction;if(!s)return;const{flags:n,hdcpLevel:r,nextAutoLevel:o}=s;switch(n){case sn.None:this.switchLevel(e,o);break;case sn.MoveAllAlternatesMatchingHDCP:r&&(t.maxHdcpLevel=Fp[Fp.indexOf(r)-1],s.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`);break}s.resolved||this.switchLevel(e,o)}switchLevel(e,t){if(t!==void 0&&e.errorAction&&(this.warn(`switching to level ${t} after ${e.details}`),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel,e.details===se.BUFFER_ADD_CODEC_ERROR&&e.mimeType&&e.sourceBufferName!=="audiovideo")){const s=PA(e.mimeType),n=this.hls.levels;for(let r=n.length;r--;)n[r][`${e.sourceBufferName}Codec`]===s&&this.hls.removeLevel(r)}}}function Qc(i){const e={action:zs.DoNothing,flags:sn.None};return i&&(e.resolved=!0),e}var Es={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class vk{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(w.MANIFEST_LOADING,this.onManifestLoading,this),e.on(w.BUFFER_APPENDED,this.onBufferAppended,this),e.on(w.FRAG_BUFFERED,this.onFragBuffered,this),e.on(w.FRAG_LOADED,this.onFragLoaded,this)}_unregisterListeners(){const{hls:e}=this;e.off(w.MANIFEST_LOADING,this.onManifestLoading,this),e.off(w.BUFFER_APPENDED,this.onBufferAppended,this),e.off(w.FRAG_BUFFERED,this.onFragBuffered,this),e.off(w.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,t){const s=this.activePartLists[t];if(s)for(let n=s.length;n--;){const r=s[n];if(!r)break;const o=r.end;if(r.start<=e&&o!==null&&e<=o)return r}return this.getBufferedFrag(e,t)}getBufferedFrag(e,t){return this.getFragAtPos(e,t,!0)}getFragAtPos(e,t,s){const{fragments:n}=this,r=Object.keys(n);for(let o=r.length;o--;){const c=n[r[o]];if((c==null?void 0:c.body.type)===t&&(!s||c.buffered)){const d=c.body;if(d.start<=e&&e<=d.end)return d}}return null}detectEvictedFragments(e,t,s,n,r){this.timeRanges&&(this.timeRanges[e]=t);const o=(n==null?void 0:n.fragment.sn)||-1;Object.keys(this.fragments).forEach(c=>{const d=this.fragments[c];if(!d||o>=d.body.sn)return;if(!d.buffered&&(!d.loaded||r)){d.body.type===s&&this.removeFragment(d.body);return}const u=d.range[e];if(u){if(u.time.length===0){this.removeFragment(d.body);return}u.time.some(f=>{const m=!this.isTimeBuffered(f.startPTS,f.endPTS,t);return m&&this.removeFragment(d.body),m})}})}detectPartialFragments(e){const t=this.timeRanges;if(!t||e.frag.sn==="initSegment")return;const s=e.frag,n=Qo(s),r=this.fragments[n];if(!r||r.buffered&&s.gap)return;const o=!s.relurl;Object.keys(t).forEach(c=>{const d=s.elementaryStreams[c];if(!d)return;const u=t[c],f=o||d.partial===!0;r.range[c]=this.getBufferedTimes(s,e.part,f,u)}),r.loaded=null,Object.keys(r.range).length?(r.buffered=!0,(r.body.endList=s.endList||r.body.endList)&&(this.endListFragments[r.body.type]=r),Ud(r)||this.removeParts(s.sn-1,s.type)):this.removeFragment(r.body)}removeParts(e,t){const s=this.activePartLists[t];s&&(this.activePartLists[t]=h1(s,n=>n.fragment.sn>=e))}fragBuffered(e,t){const s=Qo(e);let n=this.fragments[s];!n&&t&&(n=this.fragments[s]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),n&&(n.loaded=null,n.buffered=!0)}getBufferedTimes(e,t,s,n){const r={time:[],partial:s},o=e.start,c=e.end,d=e.minEndPTS||c,u=e.maxStartPTS||o;for(let f=0;f<n.length;f++){const m=n.start(f)-this.bufferPadding,p=n.end(f)+this.bufferPadding;if(u>=m&&d<=p){r.time.push({startPTS:Math.max(o,n.start(f)),endPTS:Math.min(c,n.end(f))});break}else if(o<p&&c>m){const v=Math.max(o,n.start(f)),S=Math.min(c,n.end(f));S>v&&(r.partial=!0,r.time.push({startPTS:v,endPTS:S}))}else if(c<=m)break}return r}getPartialFragment(e){let t=null,s,n,r,o=0;const{bufferPadding:c,fragments:d}=this;return Object.keys(d).forEach(u=>{const f=d[u];f&&Ud(f)&&(n=f.body.start-c,r=f.body.end+c,e>=n&&e<=r&&(s=Math.min(e-n,r-e),o<=s&&(t=f.body,o=s)))}),t}isEndListAppended(e){const t=this.endListFragments[e];return t!==void 0&&(t.buffered||Ud(t))}getState(e){const t=Qo(e),s=this.fragments[t];return s?s.buffered?Ud(s)?Es.PARTIAL:Es.OK:Es.APPENDING:Es.NOT_LOADED}isTimeBuffered(e,t,s){let n,r;for(let o=0;o<s.length;o++){if(n=s.start(o)-this.bufferPadding,r=s.end(o)+this.bufferPadding,e>=n&&t<=r)return!0;if(t<=n)return!1}return!1}onManifestLoading(){this.removeAllFragments()}onFragLoaded(e,t){if(t.frag.sn==="initSegment"||t.frag.bitrateTest)return;const s=t.frag,n=t.part?null:t,r=Qo(s);this.fragments[r]={body:s,appendedPTS:null,loaded:n,buffered:!1,range:Object.create(null)}}onBufferAppended(e,t){const{frag:s,part:n,timeRanges:r,type:o}=t;if(s.sn==="initSegment")return;const c=s.type;if(n){let u=this.activePartLists[c];u||(this.activePartLists[c]=u=[]),u.push(n)}this.timeRanges=r;const d=r[o];this.detectEvictedFragments(o,d,c,n)}onFragBuffered(e,t){this.detectPartialFragments(t)}hasFragment(e){const t=Qo(e);return!!this.fragments[t]}hasFragments(e){const{fragments:t}=this,s=Object.keys(t);if(!e)return s.length>0;for(let n=s.length;n--;){const r=t[s[n]];if((r==null?void 0:r.body.type)===e)return!0}return!1}hasParts(e){var t;return!!((t=this.activePartLists[e])!=null&&t.length)}removeFragmentsInRange(e,t,s,n,r){n&&!this.hasGaps||Object.keys(this.fragments).forEach(o=>{const c=this.fragments[o];if(!c)return;const d=c.body;d.type!==s||n&&!d.gap||d.start<t&&d.end>e&&(c.buffered||r)&&this.removeFragment(d)})}removeFragment(e){const t=Qo(e);e.clearElementaryStreamInfo();const s=this.activePartLists[e.type];if(s){const n=e.sn;this.activePartLists[e.type]=h1(s,r=>r.fragment.sn!==n)}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){var e,t;this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1;const s=(e=this.hls)==null||(t=e.latestLevelDetails)==null?void 0:t.partList;s&&s.forEach(n=>n.clearElementaryStreamInfo())}}function Ud(i){var e,t,s;return i.buffered&&(i.body.gap||((e=i.range.video)==null?void 0:e.partial)||((t=i.range.audio)==null?void 0:t.partial)||((s=i.range.audiovideo)==null?void 0:s.partial))}function Qo(i){return`${i.type}_${i.level}_${i.sn}`}function h1(i,e){return i.filter(t=>{const s=e(t);return s||t.clearElementaryStreamInfo(),s})}var ua={cbc:0,ctr:1};class Sk{constructor(e,t,s){this.subtle=void 0,this.aesIV=void 0,this.aesMode=void 0,this.subtle=e,this.aesIV=t,this.aesMode=s}decrypt(e,t){switch(this.aesMode){case ua.cbc:return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e);case ua.ctr:return this.subtle.decrypt({name:"AES-CTR",counter:this.aesIV,length:64},t,e);default:throw new Error(`[AESCrypto] invalid aes mode ${this.aesMode}`)}}}function xk(i){const e=i.byteLength,t=e&&new DataView(i.buffer).getUint8(e-1);return t?i.slice(0,e-t):i}class Tk{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){const t=new DataView(e),s=new Uint32Array(4);for(let n=0;n<4;n++)s[n]=t.getUint32(n*4);return s}initTable(){const e=this.sBox,t=this.invSBox,s=this.subMix,n=s[0],r=s[1],o=s[2],c=s[3],d=this.invSubMix,u=d[0],f=d[1],m=d[2],p=d[3],v=new Uint32Array(256);let S=0,y=0,E=0;for(E=0;E<256;E++)E<128?v[E]=E<<1:v[E]=E<<1^283;for(E=0;E<256;E++){let A=y^y<<1^y<<2^y<<3^y<<4;A=A>>>8^A&255^99,e[S]=A,t[A]=S;const R=v[S],I=v[R],C=v[I];let L=v[A]*257^A*16843008;n[S]=L<<24|L>>>8,r[S]=L<<16|L>>>16,o[S]=L<<8|L>>>24,c[S]=L,L=C*16843009^I*65537^R*257^S*16843008,u[A]=L<<24|L>>>8,f[A]=L<<16|L>>>16,m[A]=L<<8|L>>>24,p[A]=L,S?(S=R^v[v[v[C^R]]],y^=v[v[y]]):S=y=1}}expandKey(e){const t=this.uint8ArrayToUint32Array_(e);let s=!0,n=0;for(;n<t.length&&s;)s=t[n]===this.key[n],n++;if(s)return;this.key=t;const r=this.keySize=t.length;if(r!==4&&r!==6&&r!==8)throw new Error("Invalid aes key size="+r);const o=this.ksRows=(r+6+1)*4;let c,d;const u=this.keySchedule=new Uint32Array(o),f=this.invKeySchedule=new Uint32Array(o),m=this.sBox,p=this.rcon,v=this.invSubMix,S=v[0],y=v[1],E=v[2],A=v[3];let R,I;for(c=0;c<o;c++){if(c<r){R=u[c]=t[c];continue}I=R,c%r===0?(I=I<<8|I>>>24,I=m[I>>>24]<<24|m[I>>>16&255]<<16|m[I>>>8&255]<<8|m[I&255],I^=p[c/r|0]<<24):r>6&&c%r===4&&(I=m[I>>>24]<<24|m[I>>>16&255]<<16|m[I>>>8&255]<<8|m[I&255]),u[c]=R=(u[c-r]^I)>>>0}for(d=0;d<o;d++)c=o-d,d&3?I=u[c]:I=u[c-4],d<4||c<=4?f[d]=I:f[d]=S[m[I>>>24]]^y[m[I>>>16&255]]^E[m[I>>>8&255]]^A[m[I&255]],f[d]=f[d]>>>0}networkToHostOrderSwap(e){return e<<24|(e&65280)<<8|(e&16711680)>>8|e>>>24}decrypt(e,t,s){const n=this.keySize+6,r=this.invKeySchedule,o=this.invSBox,c=this.invSubMix,d=c[0],u=c[1],f=c[2],m=c[3],p=this.uint8ArrayToUint32Array_(s);let v=p[0],S=p[1],y=p[2],E=p[3];const A=new Int32Array(e),R=new Int32Array(A.length);let I,C,L,D,_,M,U,F,z,V,ae,G,Z,B;const Q=this.networkToHostOrderSwap;for(;t<A.length;){for(z=Q(A[t]),V=Q(A[t+1]),ae=Q(A[t+2]),G=Q(A[t+3]),_=z^r[0],M=G^r[1],U=ae^r[2],F=V^r[3],Z=4,B=1;B<n;B++)I=d[_>>>24]^u[M>>16&255]^f[U>>8&255]^m[F&255]^r[Z],C=d[M>>>24]^u[U>>16&255]^f[F>>8&255]^m[_&255]^r[Z+1],L=d[U>>>24]^u[F>>16&255]^f[_>>8&255]^m[M&255]^r[Z+2],D=d[F>>>24]^u[_>>16&255]^f[M>>8&255]^m[U&255]^r[Z+3],_=I,M=C,U=L,F=D,Z=Z+4;I=o[_>>>24]<<24^o[M>>16&255]<<16^o[U>>8&255]<<8^o[F&255]^r[Z],C=o[M>>>24]<<24^o[U>>16&255]<<16^o[F>>8&255]<<8^o[_&255]^r[Z+1],L=o[U>>>24]<<24^o[F>>16&255]<<16^o[_>>8&255]<<8^o[M&255]^r[Z+2],D=o[F>>>24]<<24^o[_>>16&255]<<16^o[M>>8&255]<<8^o[U&255]^r[Z+3],R[t]=Q(I^v),R[t+1]=Q(D^S),R[t+2]=Q(L^y),R[t+3]=Q(C^E),v=z,S=V,y=ae,E=G,t=t+4}return R.buffer}}class Ek{constructor(e,t,s){this.subtle=void 0,this.key=void 0,this.aesMode=void 0,this.subtle=e,this.key=t,this.aesMode=s}expandKey(){const e=bk(this.aesMode);return this.subtle.importKey("raw",this.key,{name:e},!1,["encrypt","decrypt"])}}function bk(i){switch(i){case ua.cbc:return"AES-CBC";case ua.ctr:return"AES-CTR";default:throw new Error(`[FastAESKey] invalid aes mode ${i}`)}}const Ak=16;class k0{constructor(e,{removePKCS7Padding:t=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.enableSoftwareAES=void 0,this.enableSoftwareAES=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{const s=self.crypto;s&&(this.subtle=s.subtle||s.webkitSubtle)}catch{}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;const s=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?xk(s):s}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,s,n){return this.useSoftware?new Promise((r,o)=>{const c=ArrayBuffer.isView(e)?e:new Uint8Array(e);this.softwareDecrypt(c,t,s,n);const d=this.flush();d?r(d.buffer):o(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(e),t,s,n)}softwareDecrypt(e,t,s,n){const{currentIV:r,currentResult:o,remainderData:c}=this;if(n!==ua.cbc||t.byteLength!==16)return wt.warn("SoftwareDecrypt: can only handle AES-128-CBC"),null;this.logOnce("JS AES decrypt"),c&&(e=Xi(c,e),this.remainderData=null);const d=this.getValidChunk(e);if(!d.length)return null;r&&(s=r);let u=this.softwareDecrypter;u||(u=this.softwareDecrypter=new Tk),u.expandKey(t);const f=o;return this.currentResult=u.decrypt(d.buffer,0,s),this.currentIV=d.slice(-16).buffer,f||null}webCryptoDecrypt(e,t,s,n){if(this.key!==t||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(e,t,s,n));this.key=t,this.fastAesKey=new Ek(this.subtle,t,n)}return this.fastAesKey.expandKey().then(r=>this.subtle?(this.logOnce("WebCrypto AES decrypt"),new Sk(this.subtle,new Uint8Array(s),n).decrypt(e.buffer,r)):Promise.reject(new Error("web crypto not initialized"))).catch(r=>(wt.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${r.name}: ${r.message}`),this.onWebCryptoError(e,t,s,n)))}onWebCryptoError(e,t,s,n){const r=this.enableSoftwareAES;if(r){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,s,n);const o=this.flush();if(o)return o.buffer}throw new Error("WebCrypto"+(r?" and softwareDecrypt":"")+": failed to decrypt data")}getValidChunk(e){let t=e;const s=e.length-e.length%Ak;return s!==e.length&&(t=e.slice(0,s),this.remainderData=e.slice(s)),t}logOnce(e){this.logEnabled&&(wt.log(`[decrypter]: ${e}`),this.logEnabled=!1)}}const f1=Math.pow(2,17);class Ik{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){const s=e.url;if(!s)return Promise.reject(new ar({type:Ke.NETWORK_ERROR,details:se.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error(`Fragment does not have a ${s?"part list":"url"}`),networkDetails:null}));this.abort();const n=this.config,r=n.fLoader,o=n.loader;return new Promise((c,d)=>{if(this.loader&&this.loader.destroy(),e.gap)if(e.tagList.some(S=>S[0]==="GAP")){d(g1(e));return}else e.gap=!1;const u=this.loader=r?new r(n):new o(n),f=m1(e);e.loader=u;const m=d1(n.fragLoadPolicy.default),p={loadPolicy:m,timeout:m.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:e.sn==="initSegment"?1/0:f1};e.stats=u.stats;const v={onSuccess:(S,y,E,A)=>{this.resetLoader(e,u);let R=S.data;E.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(R.slice(0,16)),R=R.slice(16)),c({frag:e,part:null,payload:R,networkDetails:A})},onError:(S,y,E,A)=>{this.resetLoader(e,u),d(new ar({type:Ke.NETWORK_ERROR,details:se.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:_t({url:s,data:void 0},S),error:new Error(`HTTP Error ${S.code} ${S.text}`),networkDetails:E,stats:A}))},onAbort:(S,y,E)=>{this.resetLoader(e,u),d(new ar({type:Ke.NETWORK_ERROR,details:se.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:E,stats:S}))},onTimeout:(S,y,E)=>{this.resetLoader(e,u),d(new ar({type:Ke.NETWORK_ERROR,details:se.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${p.timeout}ms`),networkDetails:E,stats:S}))}};t&&(v.onProgress=(S,y,E,A)=>t({frag:e,part:null,payload:E,networkDetails:A})),u.load(f,p,v)})}loadPart(e,t,s){this.abort();const n=this.config,r=n.fLoader,o=n.loader;return new Promise((c,d)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap){d(g1(e,t));return}const u=this.loader=r?new r(n):new o(n),f=m1(e,t);e.loader=u;const m=d1(n.fragLoadPolicy.default),p={loadPolicy:m,timeout:m.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:f1};t.stats=u.stats,u.load(f,p,{onSuccess:(v,S,y,E)=>{this.resetLoader(e,u),this.updateStatsFromPart(e,t);const A={frag:e,part:t,payload:v.data,networkDetails:E};s(A),c(A)},onError:(v,S,y,E)=>{this.resetLoader(e,u),d(new ar({type:Ke.NETWORK_ERROR,details:se.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:_t({url:f.url,data:void 0},v),error:new Error(`HTTP Error ${v.code} ${v.text}`),networkDetails:y,stats:E}))},onAbort:(v,S,y)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,u),d(new ar({type:Ke.NETWORK_ERROR,details:se.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:y,stats:v}))},onTimeout:(v,S,y)=>{this.resetLoader(e,u),d(new ar({type:Ke.NETWORK_ERROR,details:se.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error(`Timeout after ${p.timeout}ms`),networkDetails:y,stats:v}))}})})}updateStatsFromPart(e,t){const s=e.stats,n=t.stats,r=n.total;if(s.loaded+=n.loaded,r){const d=Math.round(e.duration/t.duration),u=Math.min(Math.round(s.loaded/r),d),m=(d-u)*Math.round(s.loaded/u);s.total=s.loaded+m}else s.total=Math.max(s.loaded,s.total);const o=s.loading,c=n.loading;o.start?o.first+=c.first-c.start:(o.start=c.start,o.first=c.first),o.end=c.end}resetLoader(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}}function m1(i,e=null){const t=e||i,s={frag:i,part:e,responseType:"arraybuffer",url:t.url,headers:{},rangeStart:0,rangeEnd:0},n=t.byteRangeStartOffset,r=t.byteRangeEndOffset;if(Fe(n)&&Fe(r)){var o;let c=n,d=r;if(i.sn==="initSegment"&&Rk((o=i.decryptdata)==null?void 0:o.method)){const u=r-n;u%16&&(d=r+(16-u%16)),n!==0&&(s.resetIV=!0,c=n-16)}s.rangeStart=c,s.rangeEnd=d}return s}function g1(i,e){const t=new Error(`GAP ${i.gap?"tag":"attribute"} found`),s={type:Ke.MEDIA_ERROR,details:se.FRAG_GAP,fatal:!1,frag:i,error:t,networkDetails:null};return e&&(s.part=e),(e||i).stats.aborted=!0,new ar(s)}function Rk(i){return i==="AES-128"||i==="AES-256"}class ar extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class jA extends gr{constructor(e,t){super(e,t),this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}class N0{constructor(e,t,s,n=0,r=-1,o=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=Fd(),this.buffering={audio:Fd(),video:Fd(),audiovideo:Fd()},this.level=e,this.sn=t,this.id=s,this.size=n,this.part=r,this.partial=o}}function Fd(){return{start:0,executeStart:0,executeEnd:0,end:0}}const p1={length:0,start:()=>0,end:()=>0};class at{static isBuffered(e,t){if(e){const s=at.getBuffered(e);for(let n=s.length;n--;)if(t>=s.start(n)&&t<=s.end(n))return!0}return!1}static bufferedRanges(e){if(e){const t=at.getBuffered(e);return at.timeRangesToArray(t)}return[]}static timeRangesToArray(e){const t=[];for(let s=0;s<e.length;s++)t.push({start:e.start(s),end:e.end(s)});return t}static bufferInfo(e,t,s){if(e){const n=at.bufferedRanges(e);if(n.length)return at.bufferedInfo(n,t,s)}return{len:0,start:t,end:t,bufferedIndex:-1}}static bufferedInfo(e,t,s){t=Math.max(0,t),e.length>1&&e.sort((f,m)=>f.start-m.start||m.end-f.end);let n=-1,r=[];if(s)for(let f=0;f<e.length;f++){t>=e[f].start&&t<=e[f].end&&(n=f);const m=r.length;if(m){const p=r[m-1].end;e[f].start-p<s?e[f].end>p&&(r[m-1].end=e[f].end):r.push(e[f])}else r.push(e[f])}else r=e;let o=0,c,d=t,u=t;for(let f=0;f<r.length;f++){const m=r[f].start,p=r[f].end;if(n===-1&&t>=m&&t<=p&&(n=f),t+s>=m&&t<p)d=m,u=p,o=u-t;else if(t+s<m){c=m;break}}return{len:o,start:d||0,end:u||0,nextStart:c,buffered:e,bufferedIndex:n}}static getBuffered(e){try{return e.buffered||p1}catch(t){return wt.log("failed to get media.buffered",t),p1}}}const VA=/\{\$([a-zA-Z0-9-_]+)\}/g;function y1(i){return VA.test(i)}function Bp(i,e){if(i.variableList!==null||i.hasVariableRefs){const t=i.variableList;return e.replace(VA,s=>{const n=s.substring(2,s.length-1),r=t==null?void 0:t[n];return r===void 0?(i.playlistParsingError||(i.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${n}"`)),s):r})}return e}function v1(i,e,t){let s=i.variableList;s||(i.variableList=s={});let n,r;if("QUERYPARAM"in e){n=e.QUERYPARAM;try{const o=new self.URL(t).searchParams;if(o.has(n))r=o.get(n);else throw new Error(`"${n}" does not match any query parameter in URI: "${t}"`)}catch(o){i.playlistParsingError||(i.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${o.message}`))}}else n=e.NAME,r=e.VALUE;n in s?i.playlistParsingError||(i.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${n}"`)):s[n]=r||""}function Lk(i,e,t){const s=e.IMPORT;if(t&&s in t){let n=i.variableList;n||(i.variableList=n={}),n[s]=t[s]}else i.playlistParsingError||(i.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${s}"`))}const wk=/^(\d+)x(\d+)$/,S1=/(.+?)=(".*?"|.*?)(?:,|$)/g;class is{constructor(e,t){typeof e=="string"&&(e=is.parseAttrList(e,t)),Ft(this,e)}get clientAttrs(){return Object.keys(this).filter(e=>e.substring(0,2)==="X-")}decimalInteger(e){const t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(e){if(this[e]){let t=(this[e]||"0x").slice(2);t=(t.length&1?"0":"")+t;const s=new Uint8Array(t.length/2);for(let n=0;n<t.length/2;n++)s[n]=parseInt(t.slice(n*2,n*2+2),16);return s}return null}hexadecimalIntegerAsNumber(e){const t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){const s=this[e];return s?parseFloat(s):t}enumeratedString(e){return this[e]}enumeratedStringList(e,t){const s=this[e];return(s?s.split(/[ ,]+/):[]).reduce((n,r)=>(n[r.toLowerCase()]=!0,n),t)}bool(e){return this[e]==="YES"}decimalResolution(e){const t=wk.exec(this[e]);if(t!==null)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e,t){let s;const n={},r='"';for(S1.lastIndex=0;(s=S1.exec(e))!==null;){const o=s[1].trim();let c=s[2];const d=c.indexOf(r)===0&&c.lastIndexOf(r)===c.length-1;let u=!1;if(d)c=c.slice(1,-1);else switch(o){case"IV":case"SCTE35-CMD":case"SCTE35-IN":case"SCTE35-OUT":u=!0}if(t&&(d||u))c=Bp(t,c);else if(!u&&!d)switch(o){case"CLOSED-CAPTIONS":if(c==="NONE")break;case"ALLOWED-CPC":case"CLASS":case"ASSOC-LANGUAGE":case"AUDIO":case"BYTERANGE":case"CHANNELS":case"CHARACTERISTICS":case"CODECS":case"DATA-ID":case"END-DATE":case"GROUP-ID":case"ID":case"IMPORT":case"INSTREAM-ID":case"KEYFORMAT":case"KEYFORMATVERSIONS":case"LANGUAGE":case"NAME":case"PATHWAY-ID":case"QUERYPARAM":case"RECENTLY-REMOVED-DATERANGES":case"SERVER-URI":case"STABLE-RENDITION-ID":case"STABLE-VARIANT-ID":case"START-DATE":case"SUBTITLES":case"SUPPLEMENTAL-CODECS":case"URI":case"VALUE":case"VIDEO":case"X-ASSET-LIST":case"X-ASSET-URI":wt.warn(`${e}: attribute ${o} is missing quotes`)}n[o]=c}return n}}const Ck="com.apple.hls.interstitial";function Ok(i){return i!=="ID"&&i!=="CLASS"&&i!=="CUE"&&i!=="START-DATE"&&i!=="DURATION"&&i!=="END-DATE"&&i!=="END-ON-NEXT"}function Dk(i){return i==="SCTE35-OUT"||i==="SCTE35-IN"||i==="SCTE35-CMD"}class $A{constructor(e,t,s=0){var n;if(this.attr=void 0,this.tagAnchor=void 0,this.tagOrder=void 0,this._startDate=void 0,this._endDate=void 0,this._dateAtEnd=void 0,this._cue=void 0,this._badValueForSameId=void 0,this.tagAnchor=(t==null?void 0:t.tagAnchor)||null,this.tagOrder=(n=t==null?void 0:t.tagOrder)!=null?n:s,t){const r=t.attr;for(const o in r)if(Object.prototype.hasOwnProperty.call(e,o)&&e[o]!==r[o]){wt.warn(`DATERANGE tag attribute: "${o}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=o;break}e=Ft(new is({}),r,e)}if(this.attr=e,t?(this._startDate=t._startDate,this._cue=t._cue,this._endDate=t._endDate,this._dateAtEnd=t._dateAtEnd):this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const r=(t==null?void 0:t.endDate)||new Date(this.attr["END-DATE"]);Fe(r.getTime())&&(this._endDate=r)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get cue(){const e=this._cue;return e===void 0?this._cue=this.attr.enumeratedStringList(this.attr.CUE?"CUE":"X-CUE",{pre:!1,post:!1,once:!1}):e}get startTime(){const{tagAnchor:e}=this;return e===null||e.programDateTime===null?(wt.warn(`Expected tagAnchor Fragment with PDT set for DateRange "${this.id}": ${e}`),NaN):e.start+(this.startDate.getTime()-e.programDateTime)/1e3}get startDate(){return this._startDate}get endDate(){const e=this._endDate||this._dateAtEnd;if(e)return e;const t=this.duration;return t!==null?this._dateAtEnd=new Date(this._startDate.getTime()+t*1e3):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if(Fe(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isInterstitial(){return this.class===Ck}get isValid(){return!!this.id&&!this._badValueForSameId&&Fe(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)&&(!this.attr.CUE||!this.cue.pre&&!this.cue.post||this.cue.pre!==this.cue.post)&&(!this.isInterstitial||"X-ASSET-URI"in this.attr||"X-ASSET-LIST"in this.attr)}}const _k=10;class Pk{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.dateRangeTagCount=0,this.live=!0,this.requestScheduled=-1,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.appliedTimelineOffset=void 0,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e){this.advanced=!0,this.updated=!0;return}const t=this.lastPartSn-e.lastPartSn,s=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!s||!!t||!this.live,this.advanced=this.endSN>e.endSN||t>0||t===0&&s>0,this.updated||this.advanced?this.misses=Math.floor(e.misses*.6):this.misses=e.misses+1}get hasProgramDateTime(){return this.fragments.length?Fe(this.fragments[this.fragments.length-1].programDateTime):!1}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||_k}get drift(){const e=this.driftEndTime-this.driftStartTime;return e>0?(this.driftEnd-this.driftStart)*1e3/e:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var e;return(e=this.fragments)!=null&&e.length?this.fragments[this.fragments.length-1].end:0}get fragmentStart(){var e;return(e=this.fragments)!=null&&e.length?this.fragments[0].start:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].index:-1}get maxPartIndex(){const e=this.partList;if(e){const t=this.lastPartIndex;if(t!==-1){for(let s=e.length;s--;)if(e[s].index>t)return e[s].index;return t}}return 0}get lastPartSn(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}get expired(){if(this.live&&this.age&&this.misses<3){const e=this.partEnd-this.fragmentStart;return this.age>Math.max(e,this.totalduration)+this.levelTargetDuration}return!1}}function tl(i){return i==="AES-128"||i==="AES-256"||i==="AES-256-CTR"}function M0(i){switch(i){case"AES-128":case"AES-256":return ua.cbc;case"AES-256-CTR":return ua.ctr;default:throw new Error(`invalid full segment method ${i}`)}}function U0(i){return Uint8Array.from(atob(i),e=>e.charCodeAt(0))}function jp(i){return Uint8Array.from(unescape(encodeURIComponent(i)),e=>e.charCodeAt(0))}function kk(i){const e=jp(i).subarray(0,16),t=new Uint8Array(16);return t.set(e,16-e.length),t}function Nk(i){const e=function(s,n,r){const o=s[n];s[n]=s[r],s[r]=o};e(i,0,3),e(i,1,2),e(i,4,5),e(i,6,7)}function Mk(i){const e=i.split(":");let t=null;if(e[0]==="data"&&e.length===2){const s=e[1].split(";"),n=s[s.length-1].split(",");if(n.length===2){const r=n[0]==="base64",o=n[1];r?(s.splice(-1,1),t=U0(o)):t=kk(o)}}return t}const Ch=typeof self<"u"?self:void 0;var Pt={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},hi={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function ah(i){switch(i){case hi.FAIRPLAY:return Pt.FAIRPLAY;case hi.PLAYREADY:return Pt.PLAYREADY;case hi.WIDEVINE:return Pt.WIDEVINE;case hi.CLEARKEY:return Pt.CLEARKEY}}var Bd={CENC:"1077efecc0b24d02ace33c1e52e2fb4b",CLEARKEY:"e2719d58a985b3c9781ab030af78d30e",PLAYREADY:"9a04f07998404286ab92e65be0885f95",WIDEVINE:"edef8ba979d64acea3c827dcd51d21ed"};function Ng(i){if(i===Bd.WIDEVINE)return Pt.WIDEVINE;if(i===Bd.PLAYREADY)return Pt.PLAYREADY;if(i===Bd.CENC||i===Bd.CLEARKEY)return Pt.CLEARKEY}function jd(i){switch(i){case Pt.FAIRPLAY:return hi.FAIRPLAY;case Pt.PLAYREADY:return hi.PLAYREADY;case Pt.WIDEVINE:return hi.WIDEVINE;case Pt.CLEARKEY:return hi.CLEARKEY}}function Nc(i){const{drmSystems:e,widevineLicenseUrl:t}=i,s=e?[Pt.FAIRPLAY,Pt.WIDEVINE,Pt.PLAYREADY,Pt.CLEARKEY].filter(n=>!!e[n]):[];return!s[Pt.WIDEVINE]&&t&&s.push(Pt.WIDEVINE),s}const GA=function(i){return Ch!=null&&(i=Ch.navigator)!=null&&i.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}();function Uk(i,e,t,s){let n;switch(i){case Pt.FAIRPLAY:n=["cenc","sinf"];break;case Pt.WIDEVINE:case Pt.PLAYREADY:n=["cenc"];break;case Pt.CLEARKEY:n=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${i}`)}return Fk(n,e,t,s)}function Fk(i,e,t,s){return[{initDataTypes:i,persistentState:s.persistentState||"optional",distinctiveIdentifier:s.distinctiveIdentifier||"optional",sessionTypes:s.sessionTypes||[s.sessionType||"temporary"],audioCapabilities:e.map(r=>({contentType:`audio/mp4; codecs=${r}`,robustness:s.audioRobustness||"",encryptionScheme:s.audioEncryptionScheme||null})),videoCapabilities:t.map(r=>({contentType:`video/mp4; codecs=${r}`,robustness:s.videoRobustness||"",encryptionScheme:s.videoEncryptionScheme||null}))}]}function Bk(i){var e;return i.sessionType==="persistent-license"||!!((e=i.sessionTypes)!=null&&e.some(t=>t==="persistent-license"))}function HA(i){const e=new Uint16Array(i.buffer,i.byteOffset,i.byteLength/2),t=String.fromCharCode.apply(null,Array.from(e)),s=t.substring(t.indexOf("<"),t.length),o=new DOMParser().parseFromString(s,"text/xml").getElementsByTagName("KID")[0];if(o){const c=o.childNodes[0]?o.childNodes[0].nodeValue:o.getAttribute("VALUE");if(c){const d=U0(c).subarray(0,16);return Nk(d),d}}return null}let Vd={};class Xc{static clearKeyUriToKeyIdMap(){Vd={}}constructor(e,t,s,n=[1],r=null){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=s,this.keyFormatVersions=n,this.iv=r,this.encrypted=e?e!=="NONE":!1,this.isCommonEncryption=this.encrypted&&!tl(e)}isSupported(){if(this.method){if(tl(this.method)||this.method==="NONE")return!0;if(this.keyFormat==="identity")return this.method==="SAMPLE-AES";switch(this.keyFormat){case hi.FAIRPLAY:case hi.WIDEVINE:case hi.PLAYREADY:case hi.CLEARKEY:return["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1}getDecryptData(e){if(!this.encrypted||!this.uri)return null;if(tl(this.method)&&this.uri&&!this.iv){typeof e!="number"&&(wt.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0);const s=jk(e);return new Xc(this.method,this.uri,"identity",this.keyFormatVersions,s)}const t=Mk(this.uri);if(t)switch(this.keyFormat){case hi.WIDEVINE:this.pssh=t,t.length>=22&&(this.keyId=t.subarray(t.length-22,t.length-6));break;case hi.PLAYREADY:{const s=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=K2(s,null,t),this.keyId=HA(t);break}default:{let s=t.subarray(0,16);if(s.length!==16){const n=new Uint8Array(16);n.set(s,16-s.length),s=n}this.keyId=s;break}}if(!this.keyId||this.keyId.byteLength!==16){let s=Vd[this.uri];if(!s){const n=Object.keys(Vd).length%Number.MAX_SAFE_INTEGER;s=new Uint8Array(16),new DataView(s.buffer,12,4).setUint32(0,n),Vd[this.uri]=s}this.keyId=s}return this}}function jk(i){const e=new Uint8Array(16);for(let t=12;t<16;t++)e[t]=i>>8*(15-t)&255;return e}const x1=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,T1=/#EXT-X-MEDIA:(.*)/g,Vk=/^#EXT(?:INF|-X-TARGETDURATION):/m,Mg=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#.*/.source].join("|"),"g"),$k=new RegExp([/#EXT-X-(PROGRAM-DATE-TIME|BYTERANGE|DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class Dn{static findGroup(e,t){for(let s=0;s<e.length;s++){const n=e[s];if(n.id===t)return n}}static resolve(e,t){return O0.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return Vk.test(e)}static parseMasterPlaylist(e,t){const s=y1(e),n={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:s},r=[];x1.lastIndex=0;let o;for(;(o=x1.exec(e))!=null;)if(o[1]){var c;const u=new is(o[1],n),f=Bp(n,o[2]),m={attrs:u,bitrate:u.decimalInteger("BANDWIDTH")||u.decimalInteger("AVERAGE-BANDWIDTH"),name:u.NAME,url:Dn.resolve(f,t)},p=u.decimalResolution("RESOLUTION");p&&(m.width=p.width,m.height=p.height),A1(u.CODECS,m);const v=u["SUPPLEMENTAL-CODECS"];v&&(m.supplemental={},A1(v,m.supplemental)),(c=m.unknownCodecs)!=null&&c.length||r.push(m),n.levels.push(m)}else if(o[3]){const u=o[3],f=o[4];switch(u){case"SESSION-DATA":{const m=new is(f,n),p=m["DATA-ID"];p&&(n.sessionData===null&&(n.sessionData={}),n.sessionData[p]=m);break}case"SESSION-KEY":{const m=E1(f,t,n);m.encrypted&&m.isSupported()?(n.sessionKeys===null&&(n.sessionKeys=[]),n.sessionKeys.push(m)):wt.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${f}"`);break}case"DEFINE":{{const m=new is(f,n);v1(n,m,t)}break}case"CONTENT-STEERING":{const m=new is(f,n);n.contentSteering={uri:Dn.resolve(m["SERVER-URI"],t),pathwayId:m["PATHWAY-ID"]||"."};break}case"START":{n.startTimeOffset=b1(f);break}}}const d=r.length>0&&r.length<n.levels.length;return n.levels=d?r:n.levels,n.levels.length===0&&(n.playlistParsingError=new Error("no levels found in manifest")),n}static parseMasterPlaylistMedia(e,t,s){let n;const r={},o=s.levels,c={AUDIO:o.map(u=>({id:u.attrs.AUDIO,audioCodec:u.audioCodec})),SUBTITLES:o.map(u=>({id:u.attrs.SUBTITLES,textCodec:u.textCodec})),"CLOSED-CAPTIONS":[]};let d=0;for(T1.lastIndex=0;(n=T1.exec(e))!==null;){const u=new is(n[1],s),f=u.TYPE;if(f){const m=c[f],p=r[f]||[];r[f]=p;const v=u.LANGUAGE,S=u["ASSOC-LANGUAGE"],y=u.CHANNELS,E=u.CHARACTERISTICS,A=u["INSTREAM-ID"],R={attrs:u,bitrate:0,id:d++,groupId:u["GROUP-ID"]||"",name:u.NAME||v||"",type:f,default:u.bool("DEFAULT"),autoselect:u.bool("AUTOSELECT"),forced:u.bool("FORCED"),lang:v,url:u.URI?Dn.resolve(u.URI,t):""};if(S&&(R.assocLang=S),y&&(R.channels=y),E&&(R.characteristics=E),A&&(R.instreamId=A),m!=null&&m.length){const I=Dn.findGroup(m,R.groupId)||m[0];I1(R,I,"audioCodec"),I1(R,I,"textCodec")}p.push(R)}}return r}static parseLevelPlaylist(e,t,s,n,r,o){var c;const d={url:t},u=new Pk(t),f=u.fragments,m=[];let p=null,v=0,S=0,y=0,E=0,A=0,R=null,I=new Dg(n,d),C,L,D,_=-1,M=!1,U=null,F;if(Mg.lastIndex=0,u.m3u8=e,u.hasVariableRefs=y1(e),((c=Mg.exec(e))==null?void 0:c[0])!=="#EXTM3U")return u.playlistParsingError=new Error("Missing format identifier #EXTM3U"),u;for(;(C=Mg.exec(e))!==null;){M&&(M=!1,I=new Dg(n,d),I.playlistOffset=y,I.start=y,I.sn=v,I.cc=E,A&&(I.bitrate=A),I.level=s,p&&(I.initSegment=p,p.rawProgramDateTime&&(I.rawProgramDateTime=p.rawProgramDateTime,p.rawProgramDateTime=null),U&&(I.setByteRange(U),U=null)));const G=C[1];if(G){I.duration=parseFloat(G);const Z=(" "+C[2]).slice(1);I.title=Z||null,I.tagList.push(Z?["INF",G,Z]:["INF",G])}else if(C[3]){if(Fe(I.duration)){I.playlistOffset=y,I.start=y,D&&L1(I,D,u),I.sn=v,I.level=s,I.cc=E,f.push(I);const Z=(" "+C[3]).slice(1);I.relurl=Bp(u,Z),Vp(I,R,m),R=I,y+=I.duration,v++,S=0,M=!0}}else{if(C=C[0].match($k),!C){wt.warn("No matches on slow regex match for level playlist!");continue}for(L=1;L<C.length&&C[L]===void 0;L++);const Z=(" "+C[L]).slice(1),B=(" "+C[L+1]).slice(1),Q=C[L+2]?(" "+C[L+2]).slice(1):null;switch(Z){case"BYTERANGE":R?I.setByteRange(B,R):I.setByteRange(B);break;case"PROGRAM-DATE-TIME":I.rawProgramDateTime=B,I.tagList.push(["PROGRAM-DATE-TIME",B]),_===-1&&(_=f.length);break;case"PLAYLIST-TYPE":u.type&&ir(u,Z,C),u.type=B.toUpperCase();break;case"MEDIA-SEQUENCE":u.startSN!==0?ir(u,Z,C):f.length>0&&w1(u,Z,C),v=u.startSN=parseInt(B);break;case"SKIP":{u.skippedSegments&&ir(u,Z,C);const re=new is(B,u),J=re.decimalInteger("SKIPPED-SEGMENTS");if(Fe(J)){u.skippedSegments+=J;for(let K=J;K--;)f.push(null);v+=J}const N=re.enumeratedString("RECENTLY-REMOVED-DATERANGES");N&&(u.recentlyRemovedDateranges=(u.recentlyRemovedDateranges||[]).concat(N.split("	")));break}case"TARGETDURATION":u.targetduration!==0&&ir(u,Z,C),u.targetduration=Math.max(parseInt(B),1);break;case"VERSION":u.version!==null&&ir(u,Z,C),u.version=parseInt(B);break;case"INDEPENDENT-SEGMENTS":break;case"ENDLIST":u.live||ir(u,Z,C),u.live=!1;break;case"#":(B||Q)&&I.tagList.push(Q?[B,Q]:[B]);break;case"DISCONTINUITY":E++,I.tagList.push(["DIS"]);break;case"GAP":I.gap=!0,I.tagList.push([Z]);break;case"BITRATE":I.tagList.push([Z,B]),A=parseInt(B)*1e3,Fe(A)?I.bitrate=A:A=0;break;case"DATERANGE":{const re=new is(B,u),J=new $A(re,u.dateRanges[re.ID],u.dateRangeTagCount);u.dateRangeTagCount++,J.isValid||u.skippedSegments?u.dateRanges[J.id]=J:wt.warn(`Ignoring invalid DATERANGE tag: "${B}"`),I.tagList.push(["EXT-X-DATERANGE",B]);break}case"DEFINE":{{const re=new is(B,u);"IMPORT"in re?Lk(u,re,o):v1(u,re,t)}break}case"DISCONTINUITY-SEQUENCE":u.startCC!==0?ir(u,Z,C):f.length>0&&w1(u,Z,C),u.startCC=E=parseInt(B);break;case"KEY":{const re=E1(B,t,u);if(re.isSupported()){if(re.method==="NONE"){D=void 0;break}D||(D={}),D[re.keyFormat]&&(D=Ft({},D)),D[re.keyFormat]=re}else wt.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${B}"`);break}case"START":u.startTimeOffset=b1(B);break;case"MAP":{const re=new is(B,u);if(I.duration){const J=new Dg(n,d);R1(J,re,s,D),p=J,I.initSegment=p,p.rawProgramDateTime&&!I.rawProgramDateTime&&(I.rawProgramDateTime=p.rawProgramDateTime)}else{const J=I.byteRangeEndOffset;if(J){const N=I.byteRangeStartOffset;U=`${J-N}@${N}`}else U=null;R1(I,re,s,D),p=I,M=!0}p.cc=E;break}case"SERVER-CONTROL":{F&&ir(u,Z,C),F=new is(B),u.canBlockReload=F.bool("CAN-BLOCK-RELOAD"),u.canSkipUntil=F.optionalFloat("CAN-SKIP-UNTIL",0),u.canSkipDateRanges=u.canSkipUntil>0&&F.bool("CAN-SKIP-DATERANGES"),u.partHoldBack=F.optionalFloat("PART-HOLD-BACK",0),u.holdBack=F.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{u.partTarget&&ir(u,Z,C);const re=new is(B);u.partTarget=re.decimalFloatingPoint("PART-TARGET");break}case"PART":{let re=u.partList;re||(re=u.partList=[]);const J=S>0?re[re.length-1]:void 0,N=S++,K=new is(B,u),le=new _2(K,I,d,N,J);re.push(le),I.duration+=le.duration;break}case"PRELOAD-HINT":{const re=new is(B,u);u.preloadHint=re;break}case"RENDITION-REPORT":{const re=new is(B,u);u.renditionReports=u.renditionReports||[],u.renditionReports.push(re);break}default:wt.warn(`line parsed but not handled: ${C}`);break}}}R&&!R.relurl?(f.pop(),y-=R.duration,u.partList&&(u.fragmentHint=R)):u.partList&&(Vp(I,R,m),I.cc=E,u.fragmentHint=I,D&&L1(I,D,u)),u.targetduration||(u.playlistParsingError=new Error("#EXT-X-TARGETDURATION is required"));const z=f.length,V=f[0],ae=f[z-1];if(y+=u.skippedSegments*u.targetduration,y>0&&z&&ae){u.averagetargetduration=y/z;const G=ae.sn;u.endSN=G!=="initSegment"?G:0,u.live||(ae.endList=!0),V&&u.startCC===void 0&&(u.startCC=V.cc),_>0&&(Hk(f,_),V&&m.unshift(V))}else u.endSN=0,u.startCC=0;return u.fragmentHint&&(y+=u.fragmentHint.duration),u.totalduration=y,m.length&&u.dateRangeTagCount&&V&&zA(m,u),u.endCC=E,u}}function zA(i,e){const t=i.length,s=i[t-1],n=e.live?1/0:e.totalduration,r=Object.keys(e.dateRanges);for(let o=r.length;o--;){const c=e.dateRanges[r[o]],d=c.startDate.getTime();c.tagAnchor=s.ref;for(let u=t;u--;){const f=Gk(e,d,i,u,n);if(f!==-1){c.tagAnchor=e.fragments[f].ref;break}}}}function Gk(i,e,t,s,n){const r=t[s];if(r){const c=r.programDateTime;if(e>=c||s===0){var o;const d=(((o=t[s+1])==null?void 0:o.start)||n)-r.start;if(e<=c+d*1e3){const u=t[s].sn-i.startSN,f=i.fragments;if(f.length>t.length){const p=(t[s+1]||f[f.length-1]).sn-i.startSN;for(let v=p;v>u;v--){const S=f[v].programDateTime;if(e>=S&&e<S+f[v].duration*1e3)return v}}return u}}}return-1}function E1(i,e,t){var s,n;const r=new is(i,t),o=(s=r.METHOD)!=null?s:"",c=r.URI,d=r.hexadecimalInteger("IV"),u=r.KEYFORMATVERSIONS,f=(n=r.KEYFORMAT)!=null?n:"identity";c&&r.IV&&!d&&wt.error(`Invalid IV: ${r.IV}`);const m=c?Dn.resolve(c,e):"",p=(u||"1").split("/").map(Number).filter(Number.isFinite);return new Xc(o,m,f,p,d)}function b1(i){const t=new is(i).decimalFloatingPoint("TIME-OFFSET");return Fe(t)?t:null}function A1(i,e){let t=(i||"").split(/[ ,]+/).filter(s=>s);["video","audio","text"].forEach(s=>{const n=t.filter(r=>DA(r,s));n.length&&(e[`${s}Codec`]=n.map(r=>r.split("/")[0]).join(","),t=t.filter(r=>n.indexOf(r)===-1))}),e.unknownCodecs=t}function I1(i,e,t){const s=e[t];s&&(i[t]=s)}function Hk(i,e){let t=i[e];for(let s=e;s--;){const n=i[s];if(!n)return;n.programDateTime=t.programDateTime-n.duration*1e3,t=n}}function Vp(i,e,t){i.rawProgramDateTime?t.push(i):e!=null&&e.programDateTime&&(i.programDateTime=e.endProgramDateTime)}function R1(i,e,t,s){i.relurl=e.URI,e.BYTERANGE&&i.setByteRange(e.BYTERANGE),i.level=t,i.sn="initSegment",s&&(i.levelkeys=s),i.initSegment=null}function L1(i,e,t){i.levelkeys=e;const{encryptedFragments:s}=t;(!s.length||s[s.length-1].levelkeys!==e)&&Object.keys(e).some(n=>e[n].isCommonEncryption)&&s.push(i)}function ir(i,e,t){i.playlistParsingError=new Error(`#EXT-X-${e} must not appear more than once (${t[0]})`)}function w1(i,e,t){i.playlistParsingError=new Error(`#EXT-X-${e} must appear before the first Media Segment (${t[0]})`)}function Ug(i,e){const t=e.startPTS;if(Fe(t)){let s=0,n;e.sn>i.sn?(s=t-i.start,n=i):(s=i.start-t,n=e),n.duration!==s&&n.setDuration(s)}else e.sn>i.sn?i.cc===e.cc&&i.minEndPTS?e.setStart(i.start+(i.minEndPTS-i.start)):e.setStart(i.start+i.duration):e.setStart(Math.max(i.start-e.duration,0))}function KA(i,e,t,s,n,r){s-t<=0&&(wt.warn("Fragment should have a positive duration",e),s=t+e.duration,r=n+e.duration);let c=t,d=s;const u=e.startPTS,f=e.endPTS;if(Fe(u)){const E=Math.abs(u-t);Fe(e.deltaPTS)?e.deltaPTS=Math.max(E,e.deltaPTS):e.deltaPTS=E,c=Math.max(t,u),t=Math.min(t,u),n=Math.min(n,e.startDTS),d=Math.min(s,f),s=Math.max(s,f),r=Math.max(r,e.endDTS)}const m=t-e.start;e.start!==0&&e.setStart(t),e.setDuration(s-e.start),e.startPTS=t,e.maxStartPTS=c,e.startDTS=n,e.endPTS=s,e.minEndPTS=d,e.endDTS=r;const p=e.sn;if(!i||p<i.startSN||p>i.endSN)return 0;let v;const S=p-i.startSN,y=i.fragments;for(y[S]=e,v=S;v>0;v--)Ug(y[v],y[v-1]);for(v=S;v<y.length-1;v++)Ug(y[v],y[v+1]);return i.fragmentHint&&Ug(y[y.length-1],i.fragmentHint),i.PTSKnown=i.alignedSliding=!0,m}function zk(i,e){if(i===e)return;let t=null;const s=i.fragments;for(let d=s.length-1;d>=0;d--){const u=s[d].initSegment;if(u){t=u;break}}i.fragmentHint&&delete i.fragmentHint.endPTS;let n;qk(i,e,(d,u,f,m)=>{if(!e.startCC&&u.cc!==d.cc){var p,v;const S=d.cc-u.cc;for(let y=f;y<m.length;y++)m[y].cc+=S;e.startCC=(p=(v=QA(i,e.startSN-1))==null?void 0:v.cc)!=null?p:m[0].cc,e.endCC=m[m.length-1].cc}Fe(d.startPTS)&&Fe(d.endPTS)&&(u.setStart(u.startPTS=d.startPTS),u.startDTS=d.startDTS,u.maxStartPTS=d.maxStartPTS,u.endPTS=d.endPTS,u.endDTS=d.endDTS,u.minEndPTS=d.minEndPTS,u.setDuration(d.endPTS-d.startPTS),u.duration&&(n=u),e.PTSKnown=e.alignedSliding=!0),d.hasStreams&&(u.elementaryStreams=d.elementaryStreams),u.loader=d.loader,d.hasStats&&(u.stats=d.stats),d.initSegment&&(u.initSegment=d.initSegment,t=d.initSegment)});const r=e.fragments,o=e.fragmentHint?r.concat(e.fragmentHint):r;if(t&&o.forEach(d=>{var u;d&&(!d.initSegment||d.initSegment.relurl===((u=t)==null?void 0:u.relurl))&&(d.initSegment=t)}),e.skippedSegments)if(e.deltaUpdateFailed=r.some(d=>!d),e.deltaUpdateFailed){wt.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let d=e.skippedSegments;d--;)r.shift();e.startSN=r[0].sn}else{e.endCC=r[r.length-1].cc,e.canSkipDateRanges&&(e.dateRanges=Kk(i.dateRanges,e));const d=i.fragments.filter(u=>u.rawProgramDateTime);if(i.hasProgramDateTime&&!e.hasProgramDateTime)for(let u=1;u<o.length;u++)o[u].programDateTime===null&&Vp(o[u],o[u-1],d);zA(d,e)}Yk(i.partList,e.partList,(d,u)=>{u.elementaryStreams=d.elementaryStreams,u.stats=d.stats}),n?KA(e,n,n.startPTS,n.endPTS,n.startDTS,n.endDTS):YA(i,e),r.length&&(e.totalduration=e.edge-r[0].start),e.driftStartTime=i.driftStartTime,e.driftStart=i.driftStart;const c=e.advancedDateTime;if(e.advanced&&c){const d=e.edge;e.driftStart||(e.driftStartTime=c,e.driftStart=d),e.driftEndTime=c,e.driftEnd=d}else e.driftEndTime=i.driftEndTime,e.driftEnd=i.driftEnd,e.advancedDateTime=i.advancedDateTime;e.requestScheduled===-1&&(e.requestScheduled=i.requestScheduled)}function Kk(i,e){const{dateRanges:t,recentlyRemovedDateranges:s}=e,n=Ft({},i);s&&s.forEach(c=>{delete n[c]});const o=Object.keys(n).length;return o&&Object.keys(t).forEach(c=>{const d=n[c],u=new $A(t[c].attr,d);u.isValid?(n[c]=u,d||(u.tagOrder+=o)):wt.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${es(t[c].attr)}"`)}),n}function Yk(i,e,t){if(i&&e){let s=0;for(let n=0,r=i.length;n<=r;n++){const o=i[n],c=e[n+s];o&&c&&o.index===c.index&&o.fragment.sn===c.fragment.sn?t(o,c):s--}}}function qk(i,e,t){const s=e.skippedSegments,n=Math.max(i.startSN,e.startSN)-e.startSN,r=(i.fragmentHint?1:0)+(s?e.endSN:Math.min(i.endSN,e.endSN))-e.startSN,o=e.startSN-i.startSN,c=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,d=i.fragmentHint?i.fragments.concat(i.fragmentHint):i.fragments;for(let u=n;u<=r;u++){const f=d[o+u];let m=c[u];if(s&&!m&&f&&(m=e.fragments[u]=f),f&&m){if(t(f,m,u,c),f.url&&f.url!==m.url){e.playlistParsingError=C1(`media sequence mismatch ${m.sn}:`,i,e,f,m);return}else if(f.cc!==m.cc){e.playlistParsingError=C1(`discontinuity sequence mismatch (${f.cc}!=${m.cc})`,i,e,f,m);return}}}}function C1(i,e,t,s,n){return new Error(`${i} ${n.url}
Playlist starting @${e.startSN}
${e.m3u8}

Playlist starting @${t.startSN}
${t.m3u8}`)}function YA(i,e,t=!0){const s=e.startSN+e.skippedSegments-i.startSN,n=i.fragments,r=s>=0;let o=0;if(r&&s<n.length)o=n[s].start;else if(r&&e.startSN===i.endSN+1)o=i.fragmentEnd;else if(r&&t)o=i.fragmentStart+s*e.levelTargetDuration;else if(!e.skippedSegments&&e.fragmentStart===0)o=i.fragmentStart;else return;$p(e,o)}function $p(i,e){if(e){const t=i.fragments;for(let s=i.skippedSegments;s<t.length;s++)t[s].addStart(e);i.fragmentHint&&i.fragmentHint.addStart(e)}}function qA(i,e=1/0){let t=1e3*i.targetduration;if(i.updated){const s=i.fragments;if(s.length&&t*4>e){const r=s[s.length-1].duration*1e3;r<t&&(t=r)}}else t/=2;return Math.round(t)}function QA(i,e,t){if(!i)return null;let s=i.fragments[e-i.startSN];return s||(s=i.fragmentHint,s&&s.sn===e)?s:e<i.startSN&&t&&t.sn===e?t:null}function O1(i,e,t){return i?XA(i.partList,e,t):null}function XA(i,e,t){if(i)for(let s=i.length;s--;){const n=i[s];if(n.index===t&&n.fragment.sn===e)return n}return null}function WA(i){i.forEach((e,t)=>{var s;(s=e.details)==null||s.fragments.forEach(n=>{n.level=t,n.initSegment&&(n.initSegment.level=t)})})}function Fc(i,e){for(let s=0,n=i.length;s<n;s++){var t;if(((t=i[s])==null?void 0:t.cc)===e)return i[s]}return null}function Qk(i,e){return!!(i&&e.startCC<i.endCC&&e.endCC>i.startCC)}function D1(i,e){if(i){const t=i.start+e;i.start=i.startPTS=t,i.endPTS=t+i.duration}}function ZA(i,e){const t=e.fragments;for(let s=0,n=t.length;s<n;s++)D1(t[s],i);e.fragmentHint&&D1(e.fragmentHint,i),e.alignedSliding=!0}function Xk(i,e){i&&(JA(e,i),!e.alignedSliding&&i&&Oh(e,i),!e.alignedSliding&&i&&!e.skippedSegments&&YA(i,e,!1))}function JA(i,e){if(!Qk(e,i))return;const t=Math.min(e.endCC,i.endCC),s=Fc(e.fragments,t),n=Fc(i.fragments,t);if(!s||!n)return;wt.log(`Aligning playlist at start of dicontinuity sequence ${t}`);const r=s.start-n.start;ZA(r,i)}function Oh(i,e){if(!i.hasProgramDateTime||!e.hasProgramDateTime)return;const t=i.fragments,s=e.fragments;if(!t.length||!s.length)return;let n,r;const o=Math.min(e.endCC,i.endCC);e.startCC<o&&i.startCC<o&&(n=Fc(s,o),r=Fc(t,o)),(!n||!r)&&(n=s[Math.floor(s.length/2)],r=Fc(t,n.cc)||t[Math.floor(t.length/2)]);const c=n.programDateTime,d=r.programDateTime;if(!c||!d)return;const u=(d-c)/1e3-(r.start-n.start);ZA(u,i)}const Wk={toString:function(i){let e="";const t=i.length;for(let s=0;s<t;s++)e+=`[${i.start(s).toFixed(3)}-${i.end(s).toFixed(3)}]`;return e}},pe={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class F0 extends jA{constructor(e,t,s,n,r){super(n,e.logger),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=pe.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.buffering=!0,this.loadingParts=!1,this.loopSn=void 0,this.onMediaSeeking=()=>{const{config:o,fragCurrent:c,media:d,mediaBuffer:u,state:f}=this,m=d?d.currentTime:0,p=at.bufferInfo(u||d,m,o.maxBufferHole);if(this.log(`media seeking to ${Fe(m)?m.toFixed(3):m}, state: ${f}`),this.state===pe.ENDED)this.resetLoadingState();else if(c){const v=o.maxFragLookUpTolerance,S=c.start-v,y=c.start+c.duration+v;if(!p.len||y<p.start||S>p.end){const E=m>y;(m<S||E)&&(E&&c.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),c.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}if(d){this.fragmentTracker.removeFragmentsInRange(m,1/0,this.playlistType,!0);const v=this.lastCurrentTime;if(m>v&&(this.lastCurrentTime=m),!this.loadingParts){const S=Math.max(p.end,m),y=this.shouldLoadParts(this.getLevelDetails(),S);y&&(this.log(`LL-Part loading ON after seeking to ${m.toFixed(2)} with buffer @${S.toFixed(2)}`),this.loadingParts=y)}}!this.hls.hasEnoughToStart&&!p.len&&(this.log(`setting startPosition to ${m} because of seek before start`),this.nextLoadPosition=this.startPosition=m),this.tickImmediate()},this.onMediaEnded=()=>{this.log("setting startPosition to 0 because media ended"),this.startPosition=this.lastCurrentTime=0},this.playlistType=r,this.hls=e,this.fragmentLoader=new Ik(e.config),this.keyLoader=s,this.fragmentTracker=t,this.config=e.config,this.decrypter=new k0(e.config)}registerListeners(){const{hls:e}=this;e.on(w.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(w.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(w.MANIFEST_LOADING,this.onManifestLoading,this),e.on(w.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(w.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(w.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(w.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(w.MANIFEST_LOADING,this.onManifestLoading,this),e.off(w.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(w.ERROR,this.onError,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){if(this.state===pe.STOPPED)return;this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const e=this.fragCurrent;e!=null&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=pe.STOPPED}get startPositionValue(){const{nextLoadPosition:e,startPosition:t}=this;return t===-1&&e?e:t}get bufferingEnabled(){return this.buffering}pauseBuffering(){this.buffering=!1}resumeBuffering(){this.buffering=!0}get inFlightFrag(){return{frag:this.fragCurrent,state:this.state}}_streamEnded(e,t){if(t.live||!this.media)return!1;const s=e.end||0,n=this.config.timelineOffset||0;if(s<=n)return!1;const r=e.buffered;this.config.maxBufferHole&&r&&r.length>1&&(e=at.bufferedInfo(r,e.start,0));const o=e.nextStart;if(o&&o>n&&o<t.edge||this.media.currentTime<e.start)return!1;const d=t.partList;if(d!=null&&d.length){const f=d[d.length-1];return at.isBuffered(this.media,f.start+f.duration/2)}const u=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(u)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null){var e;return(e=this.levelLastLoaded)==null?void 0:e.details}}get timelineOffset(){const e=this.config.timelineOffset;if(e){var t;return((t=this.getLevelDetails())==null?void 0:t.appliedTimelineOffset)||e}return 0}onMediaAttached(e,t){const s=this.media=this.mediaBuffer=t.media;s.removeEventListener("seeking",this.onMediaSeeking),s.removeEventListener("ended",this.onMediaEnded),s.addEventListener("seeking",this.onMediaSeeking),s.addEventListener("ended",this.onMediaEnded);const n=this.config;this.levels&&n.autoStartLoad&&this.state===pe.STOPPED&&this.startLoad(n.startPosition)}onMediaDetaching(e,t){const s=!!t.transferMedia,n=this.media;if(n!==null){if(n.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),n.removeEventListener("seeking",this.onMediaSeeking),n.removeEventListener("ended",this.onMediaEnded),this.keyLoader&&!s&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loopSn=void 0,s){this.resetLoadingState(),this.resetTransmuxer();return}this.loadingParts=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}}onManifestLoading(){this.initPTS=[],this.levels=this.levelLastLoaded=this.fragCurrent=null,this.lastCurrentTime=this.startPosition=0,this.startFragRequested=!1}onError(e,t){}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset}onHandlerDestroying(){this.stopLoad(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),super.onHandlerDestroying(),this.hls=this.onMediaSeeking=this.onMediaEnded=null}onHandlerDestroyed(){this.state=pe.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,s){this.startFragRequested=!0,this._loadFragForPlayback(e,t,s)}_loadFragForPlayback(e,t,s){const n=r=>{const o=r.frag;if(this.fragContextChanged(o)){this.warn(`${o.type} sn: ${o.sn}${r.part?" part: "+r.part.index:""} of ${this.fragInfo(o,!1,r.part)}) was dropped during download.`),this.fragmentTracker.removeFragment(o);return}o.stats.chunkCount++,this._handleFragmentLoadProgress(r)};this._doFragLoad(e,t,s,n).then(r=>{if(!r)return;const o=this.state,c=r.frag;if(this.fragContextChanged(c)){(o===pe.FRAG_LOADING||!this.fragCurrent&&o===pe.PARSING)&&(this.fragmentTracker.removeFragment(c),this.state=pe.IDLE);return}"payload"in r&&(this.log(`Loaded ${c.type} sn: ${c.sn} of ${this.playlistLabel()} ${c.level}`),this.hls.trigger(w.FRAG_LOADED,r)),this._handleFragmentLoadComplete(r)}).catch(r=>{this.state===pe.STOPPED||this.state===pe.ERROR||(this.warn(`Frag error: ${(r==null?void 0:r.message)||r}`),this.resetFragmentLoading(e))})}clearTrackerIfNeeded(e){var t;const{fragmentTracker:s}=this;if(s.getState(e)===Es.APPENDING){const r=e.type,o=this.getFwdBufferInfo(this.mediaBuffer,r),c=Math.max(e.duration,o?o.len:this.config.maxBufferLength),d=this.backtrackFragment;((d?e.sn-d.sn:0)===1||this.reduceMaxBufferLength(c,e.duration))&&s.removeFragment(e)}else((t=this.mediaBuffer)==null?void 0:t.buffered.length)===0?s.removeAllFragments():s.hasParts(e.type)&&(s.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),s.getState(e)===Es.PARTIAL&&s.removeFragment(e))}checkLiveUpdate(e){if(e.updated&&!e.live){const t=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}waitForLive(e){const t=e.details;return(t==null?void 0:t.live)&&t.type!=="EVENT"&&(this.levelLastLoaded!==e||t.expired)}flushMainBuffer(e,t,s=null){if(!(e-t))return;const n={startOffset:e,endOffset:t,type:s};this.hls.trigger(w.BUFFER_FLUSHING,n)}_loadInitSegment(e,t){this._doFragLoad(e,t).then(s=>{const n=s==null?void 0:s.frag;if(!n||this.fragContextChanged(n)||!this.levels)throw new Error("init load aborted");return s}).then(s=>{const{hls:n}=this,{frag:r,payload:o}=s,c=r.decryptdata;if(o&&o.byteLength>0&&c!=null&&c.key&&c.iv&&tl(c.method)){const d=self.performance.now();return this.decrypter.decrypt(new Uint8Array(o),c.key.buffer,c.iv.buffer,M0(c.method)).catch(u=>{throw n.trigger(w.ERROR,{type:Ke.MEDIA_ERROR,details:se.FRAG_DECRYPT_ERROR,fatal:!1,error:u,reason:u.message,frag:r}),u}).then(u=>{const f=self.performance.now();return n.trigger(w.FRAG_DECRYPTED,{frag:r,payload:u,stats:{tstart:d,tdecrypt:f}}),s.payload=u,this.completeInitSegmentLoad(s)})}return this.completeInitSegmentLoad(s)}).catch(s=>{this.state===pe.STOPPED||this.state===pe.ERROR||(this.warn(s),this.resetFragmentLoading(e))})}completeInitSegmentLoad(e){const{levels:t}=this;if(!t)throw new Error("init load aborted, missing levels");const s=e.frag.stats;this.state!==pe.STOPPED&&(this.state=pe.IDLE),e.frag.data=new Uint8Array(e.payload),s.parsing.start=s.buffering.start=self.performance.now(),s.parsing.end=s.buffering.end=self.performance.now(),this.tick()}fragContextChanged(e){const{fragCurrent:t}=this;return!e||!t||e.sn!==t.sn||e.level!==t.level}fragBufferedComplete(e,t){const s=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.fragInfo(e,!1,t)} > buffer:${s?Wk.toString(at.getBuffered(s)):"(detached)"})`),Ds(e)){var n;if(e.type!==ze.SUBTITLE){const o=e.elementaryStreams;if(!Object.keys(o).some(c=>!!o[c])){this.state=pe.IDLE;return}}const r=(n=this.levels)==null?void 0:n[e.level];r!=null&&r.fragmentError&&(this.log(`Resetting level fragment error count of ${r.fragmentError} on frag buffered`),r.fragmentError=0)}this.state=pe.IDLE}_handleFragmentLoadComplete(e){const{transmuxer:t}=this;if(!t)return;const{frag:s,part:n,partsLoaded:r}=e,o=!r||r.length===0||r.some(d=>!d),c=new N0(s.level,s.sn,s.stats.chunkCount+1,0,n?n.index:-1,!o);t.flush(c)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t,s=null,n){var r;this.fragCurrent=e;const o=t==null?void 0:t.details;if(!this.levels||!o)throw new Error(`frag load aborted, missing level${o?"":" detail"}s`);let c=null;e.encrypted&&!((r=e.decryptdata)!=null&&r.key)?(this.log(`Loading key for ${e.sn} of [${o.startSN}-${o.endSN}], ${this.playlistLabel()} ${e.level}`),this.state=pe.KEY_LOADING,this.fragCurrent=e,c=this.keyLoader.load(e).then(m=>{if(!this.fragContextChanged(m.frag))return this.hls.trigger(w.KEY_LOADED,m),this.state===pe.KEY_LOADING&&(this.state=pe.IDLE),m}),this.hls.trigger(w.KEY_LOADING,{frag:e}),this.fragCurrent===null&&(c=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING")))):e.encrypted||(c=this.keyLoader.loadClear(e,o.encryptedFragments),c&&this.log("[eme] blocking frag load until media-keys acquired"));const d=this.fragPrevious;if(Ds(e)&&(!d||e.sn!==d.sn)){const m=this.shouldLoadParts(t.details,e.end);m!==this.loadingParts&&(this.log(`LL-Part loading ${m?"ON":"OFF"} loading sn ${d==null?void 0:d.sn}->${e.sn}`),this.loadingParts=m)}if(s=Math.max(e.start,s||0),this.loadingParts&&Ds(e)){const m=o.partList;if(m&&n){s>e.end&&o.fragmentHint&&(e=o.fragmentHint);const p=this.getNextPart(m,e,s);if(p>-1){const v=m[p];e=this.fragCurrent=v.fragment,this.log(`Loading ${e.type} sn: ${e.sn} part: ${v.index} (${p}/${m.length-1}) of ${this.fragInfo(e,!1,v)}) cc: ${e.cc} [${o.startSN}-${o.endSN}], target: ${parseFloat(s.toFixed(3))}`),this.nextLoadPosition=v.start+v.duration,this.state=pe.FRAG_LOADING;let S;return c?S=c.then(y=>!y||this.fragContextChanged(y.frag)?null:this.doFragPartsLoad(e,v,t,n)).catch(y=>this.handleFragLoadError(y)):S=this.doFragPartsLoad(e,v,t,n).catch(y=>this.handleFragLoadError(y)),this.hls.trigger(w.FRAG_LOADING,{frag:e,part:v,targetBufferTime:s}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):S}else if(!e.url||this.loadedEndOfParts(m,s))return Promise.resolve(null)}}if(Ds(e)&&this.loadingParts)this.log(`LL-Part loading OFF after next part miss @${s.toFixed(2)}`),this.loadingParts=!1;else if(!e.url)return Promise.resolve(null);this.log(`Loading ${e.type} sn: ${e.sn} of ${this.fragInfo(e,!1)}) cc: ${e.cc} ${o?"["+o.startSN+"-"+o.endSN+"]":""}, target: ${parseFloat(s.toFixed(3))}`),Fe(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=pe.FRAG_LOADING;const u=this.config.progressive;let f;return u&&c?f=c.then(m=>!m||this.fragContextChanged(m==null?void 0:m.frag)?null:this.fragmentLoader.load(e,n)).catch(m=>this.handleFragLoadError(m)):f=Promise.all([this.fragmentLoader.load(e,u?n:void 0),c]).then(([m])=>(!u&&m&&n&&n(m),m)).catch(m=>this.handleFragLoadError(m)),this.hls.trigger(w.FRAG_LOADING,{frag:e,targetBufferTime:s}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):f}doFragPartsLoad(e,t,s,n){return new Promise((r,o)=>{var c;const d=[],u=(c=s.details)==null?void 0:c.partList,f=m=>{this.fragmentLoader.loadPart(e,m,n).then(p=>{d[m.index]=p;const v=p.part;this.hls.trigger(w.FRAG_LOADED,p);const S=O1(s.details,e.sn,m.index+1)||XA(u,e.sn,m.index+1);if(S)f(S);else return r({frag:e,part:v,partsLoaded:d})}).catch(o)};f(t)})}handleFragLoadError(e){if("data"in e){const t=e.data;e.data&&t.details===se.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):this.hls.trigger(w.ERROR,t)}else this.hls.trigger(w.ERROR,{type:Ke.OTHER_ERROR,details:se.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const t=this.getCurrentContext(e);if(!t||this.state!==pe.PARSING){!this.fragCurrent&&this.state!==pe.STOPPED&&this.state!==pe.ERROR&&(this.state=pe.IDLE);return}const{frag:s,part:n,level:r}=t,o=self.performance.now();s.stats.parsing.end=o,n&&(n.stats.parsing.end=o);const c=this.getLevelDetails(),u=c&&s.sn>c.endSN||this.shouldLoadParts(c,s.end);u!==this.loadingParts&&(this.log(`LL-Part loading ${u?"ON":"OFF"} after parsing segment ending @${s.end.toFixed(2)}`),this.loadingParts=u),this.updateLevelTiming(s,n,r,e.partial)}shouldLoadParts(e,t){if(this.config.lowLatencyMode){if(!e)return this.loadingParts;if(e!=null&&e.partList){var s;const r=e.partList[0],o=r.end+(((s=e.fragmentHint)==null?void 0:s.duration)||0);if(t>=o){var n;if((this.hls.hasEnoughToStart?((n=this.media)==null?void 0:n.currentTime)||this.lastCurrentTime:this.getLoadPosition())>r.start-r.fragment.duration)return!0}}}return!1}getCurrentContext(e){const{levels:t,fragCurrent:s}=this,{level:n,sn:r,part:o}=e;if(!(t!=null&&t[n]))return this.warn(`Levels object was unset while buffering fragment ${r} of ${this.playlistLabel()} ${n}. The current chunk will not be buffered.`),null;const c=t[n],d=c.details,u=o>-1?O1(d,r,o):null,f=u?u.fragment:QA(d,r,s);return f?(s&&s!==f&&(f.stats=s.stats),{frag:f,part:u,level:c}):null}bufferFragmentData(e,t,s,n,r){var o;if(!e||this.state!==pe.PARSING)return;const{data1:c,data2:d}=e;let u=c;if(c&&d&&(u=Xi(c,d)),!((o=u)!=null&&o.length))return;const f={type:e.type,frag:t,part:s,chunkMeta:n,parent:t.type,data:u};if(this.hls.trigger(w.BUFFER_APPENDING,f),e.dropped&&e.independent&&!s){if(r)return;this.flushBufferGap(t)}}flushBufferGap(e){const t=this.media;if(!t)return;if(!at.isBuffered(t,t.currentTime)){this.flushMainBuffer(0,e.start);return}const s=t.currentTime,n=at.bufferInfo(t,s,0),r=e.duration,o=Math.min(this.config.maxFragLookUpTolerance*2,r*.25),c=Math.max(Math.min(e.start-o,n.end-o),s+o);e.start-c>o&&this.flushMainBuffer(c,e.start)}getFwdBufferInfo(e,t){var s;const n=this.getLoadPosition();if(!Fe(n))return null;const o=this.lastCurrentTime>n||(s=this.media)!=null&&s.paused?0:this.config.maxBufferHole;return this.getFwdBufferInfoAtPos(e,n,t,o)}getFwdBufferInfoAtPos(e,t,s,n){const r=at.bufferInfo(e,t,n);if(r.len===0&&r.nextStart!==void 0){const o=this.fragmentTracker.getBufferedFrag(t,s);if(o&&(r.nextStart<=o.end||o.gap)){const c=Math.max(Math.min(r.nextStart,o.end)-t,n);return at.bufferInfo(e,t,c)}}return r}getMaxBufferLength(e){const{config:t}=this;let s;return e?s=Math.max(8*t.maxBufferSize/e,t.maxBufferLength):s=t.maxBufferLength,Math.min(s,t.maxMaxBufferLength)}reduceMaxBufferLength(e,t){const s=this.config,n=Math.max(Math.min(e-t,s.maxBufferLength),t),r=Math.max(e-t*3,s.maxMaxBufferLength/2,n);return r>=n?(s.maxMaxBufferLength=r,this.warn(`Reduce max buffer length to ${r}s`),!0):!1}getAppendedFrag(e,t=ze.MAIN){var s;const n=(s=this.fragmentTracker)==null?void 0:s.getAppendedFrag(e,t);return n&&"fragment"in n?n.fragment:n}getNextFragment(e,t){const s=t.fragments,n=s.length;if(!n)return null;const{config:r}=this,o=s[0].start,c=r.lowLatencyMode&&!!t.partList;let d=null;if(t.live){const m=r.initialLiveManifestSize;if(n<m)return this.warn(`Not enough fragments to start playback (have: ${n}, need: ${m})`),null;if(!t.PTSKnown&&!this.startFragRequested&&this.startPosition===-1||e<o){var u;c&&!this.loadingParts&&(this.log("LL-Part loading ON for initial live fragment"),this.loadingParts=!0),d=this.getInitialLiveFragment(t);const p=this.hls.startPosition,v=this.hls.liveSyncPosition,S=d?(p!==-1&&p>=o?p:v)||d.start:e;this.log(`Setting startPosition to ${S} to match start frag at live edge. mainStart: ${p} liveSyncPosition: ${v} frag.start: ${(u=d)==null?void 0:u.start}`),this.startPosition=this.nextLoadPosition=S}}else e<=o&&(d=s[0]);if(!d){const m=this.loadingParts?t.partEnd:t.fragmentEnd;d=this.getFragmentAtPosition(e,m,t)}let f=this.filterReplacedPrimary(d,t);if(!f&&d){const m=d.sn-t.startSN;f=this.filterReplacedPrimary(s[m+1]||null,t)}return this.mapToInitFragWhenRequired(f)}isLoopLoading(e,t){const s=this.fragmentTracker.getState(e);return(s===Es.OK||s===Es.PARTIAL&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,s,n,r){let o=null;if(e.gap&&(o=this.getNextFragment(this.nextLoadPosition,t),o&&!o.gap&&s.nextStart)){const c=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,s.nextStart,n,0);if(c!==null&&s.len+c.len>=r){const d=o.sn;return this.loopSn!==d&&(this.log(`buffer full after gaps in "${n}" playlist starting at sn: ${d}`),this.loopSn=d),null}}return this.loopSn=void 0,o}get primaryPrefetch(){if(_1(this.hls.config)){var e,t;if((e=this.hls.interstitialsManager)==null||(t=e.playingItem)==null?void 0:t.event)return!0}return!1}filterReplacedPrimary(e,t){if(!e)return e;if(_1(this.hls.config)&&e.type!==ze.SUBTITLE){const s=this.hls.interstitialsManager,n=s==null?void 0:s.bufferingItem;if(n){const o=n.event;if(o){if(o.appendInPlace||Math.abs(e.start-n.start)>1||n.start===0)return null}else if(e.end<=n.start&&(t==null?void 0:t.live)===!1||e.start>n.end&&n.nextEvent&&(n.nextEvent.appendInPlace||e.start-n.end>1))return null}const r=s==null?void 0:s.playerQueue;if(r)for(let o=r.length;o--;){const c=r[o].interstitial;if(c.appendInPlace&&e.start>=c.startTime&&e.end<=c.resumeTime)return null}}return e}mapToInitFragWhenRequired(e){return e!=null&&e.initSegment&&!(e!=null&&e.initSegment.data)&&!this.bitrateTest?e.initSegment:e}getNextPart(e,t,s){let n=-1,r=!1,o=!0;for(let c=0,d=e.length;c<d;c++){const u=e[c];if(o=o&&!u.independent,n>-1&&s<u.start)break;const f=u.loaded;f?n=-1:(r||u.independent||o)&&u.fragment===t&&(n=c),r=f}return n}loadedEndOfParts(e,t){const s=e[e.length-1];return s&&t>s.start&&s.loaded}getInitialLiveFragment(e){const t=e.fragments,s=this.fragPrevious;let n=null;if(s){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${s.programDateTime}`),n=fk(t,s.endProgramDateTime,this.config.maxFragLookUpTolerance)),!n){const r=s.sn+1;if(r>=e.startSN&&r<=e.endSN){const o=t[r-e.startSN];s.cc===o.cc&&(n=o,this.log(`Live playlist, switching playlist, load frag with next SN: ${n.sn}`))}n||(n=BA(e,s.cc,s.end),n&&this.log(`Live playlist, switching playlist, load frag with same CC: ${n.sn}`))}}else{const r=this.hls.liveSyncPosition;r!==null&&(n=this.getFragmentAtPosition(r,this.bitrateTest?e.fragmentEnd:e.edge,e))}return n}getFragmentAtPosition(e,t,s){const{config:n}=this;let{fragPrevious:r}=this,{fragments:o,endSN:c}=s;const{fragmentHint:d}=s,{maxFragLookUpTolerance:u}=n,f=s.partList,m=!!(this.loadingParts&&f!=null&&f.length&&d);m&&d&&!this.bitrateTest&&f[f.length-1].fragment.sn===d.sn&&(o=o.concat(d),c=d.sn);let p;if(e<t){var v;const y=e<this.lastCurrentTime||e>t-u||(v=this.media)!=null&&v.paused||!this.startFragRequested?0:u;p=so(r,o,e,y)}else p=o[o.length-1];if(p){const S=p.sn-s.startSN,y=this.fragmentTracker.getState(p);if((y===Es.OK||y===Es.PARTIAL&&p.gap)&&(r=p),r&&p.sn===r.sn&&(!m||f[0].fragment.sn>p.sn||!s.live&&!m)&&r&&p.level===r.level){const A=o[S+1];p.sn<c&&this.fragmentTracker.getState(A)!==Es.OK?p=A:p=null}}return p}alignPlaylists(e,t,s){const n=e.fragments.length;if(!n)return this.warn("No fragments in live playlist"),0;const r=e.fragmentStart,o=!t,c=e.alignedSliding&&Fe(r);if(o||!c&&!r){Xk(s,e);const d=e.fragmentStart;return this.log(`Live playlist sliding: ${d.toFixed(2)} start-sn: ${t?t.startSN:"na"}->${e.startSN} fragments: ${n}`),d}return r}waitForCdnTuneIn(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,e.partTarget*3)}setStartPosition(e,t){let s=this.startPosition;s<t&&(s=-1);const n=this.timelineOffset;if(s===-1){const r=this.startTimeOffset!==null,o=r?this.startTimeOffset:e.startTimeOffset;o!==null&&Fe(o)?(s=t+o,o<0&&(s+=e.edge),s=Math.min(Math.max(t,s),t+e.totalduration),this.log(`Setting startPosition to ${s} for start time offset ${o} found in ${r?"multivariant":"media"} playlist`),this.startPosition=s):e.live?(s=this.hls.liveSyncPosition||t,this.log(`Setting startPosition to -1 to start at live edge ${s}`),this.startPosition=-1):(this.log("setting startPosition to 0 by default"),this.startPosition=s=0),this.lastCurrentTime=s+n}this.nextLoadPosition=s+n}getLoadPosition(){var e;const{media:t}=this;let s=0;return(e=this.hls)!=null&&e.hasEnoughToStart&&t?s=t.currentTime:this.nextLoadPosition>=0&&(s=this.nextLoadPosition),s}handleFragLoadAborted(e,t){this.transmuxer&&e.type===this.playlistType&&Ds(e)&&e.stats.aborted&&(this.warn(`Fragment ${e.sn}${t?" part "+t.index:""} of ${this.playlistLabel()} ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){(!this.fragCurrent||!this.fragContextChanged(e)&&this.state!==pe.FRAG_LOADING_WAITING_RETRY)&&(this.state=pe.IDLE)}onFragmentOrKeyLoadError(e,t){if(t.chunkMeta&&!t.frag){const S=this.getCurrentContext(t.chunkMeta);S&&(t.frag=S.frag)}const s=t.frag;if(!s||s.type!==e||!this.levels)return;if(this.fragContextChanged(s)){var n;this.warn(`Frag load error must match current frag to retry ${s.url} > ${(n=this.fragCurrent)==null?void 0:n.url}`);return}const r=t.details===se.FRAG_GAP;r&&this.fragmentTracker.fragBuffered(s,!0);const o=t.errorAction,{action:c,flags:d,retryCount:u=0,retryConfig:f}=o||{},m=!!o&&!!f,p=m&&c===zs.RetryRequest,v=m&&!o.resolved&&d===sn.MoveAllAlternatesMatchingHost;if(!p&&v&&Ds(s)&&!s.endList)this.resetFragmentErrors(e),this.treatAsGap(s),o.resolved=!0;else if((p||v)&&u<f.maxNumRetry){this.resetStartWhenNotLoaded(this.levelLastLoaded);const S=P0(f,u);this.warn(`Fragment ${s.sn} of ${e} ${s.level} errored with ${t.details}, retrying loading ${u+1}/${f.maxNumRetry} in ${S}ms`),o.resolved=!0,this.retryDate=self.performance.now()+S,this.state=pe.FRAG_LOADING_WAITING_RETRY}else if(f&&o)if(this.resetFragmentErrors(e),u<f.maxNumRetry)!r&&c!==zs.RemoveAlternatePermanently&&(o.resolved=!0);else{this.warn(`${t.details} reached or exceeded max retry (${u})`);return}else c===zs.SendAlternateToPenaltyBox?this.state=pe.WAITING_LEVEL:this.state=pe.ERROR;this.tickImmediate()}reduceLengthAndFlushBuffer(e){if(this.state===pe.PARSING||this.state===pe.PARSED){const t=e.frag,s=e.parent,n=this.getFwdBufferInfo(this.mediaBuffer,s),r=n&&n.len>.5;r&&this.reduceMaxBufferLength(n.len,(t==null?void 0:t.duration)||10);const o=!r;return o&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${s} buffer`),t&&(this.fragmentTracker.removeFragment(t),this.nextLoadPosition=t.start),this.resetLoadingState(),o}return!1}resetFragmentErrors(e){e===ze.AUDIO&&(this.fragCurrent=null),this.hls.hasEnoughToStart||(this.startFragRequested=!1),this.state!==pe.STOPPED&&(this.state=pe.IDLE)}afterBufferFlushed(e,t,s){if(!e)return;const n=at.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,n,s),this.state===pe.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state!==pe.STOPPED&&(this.state=pe.IDLE)}resetStartWhenNotLoaded(e){if(!this.hls.hasEnoughToStart){this.startFragRequested=!1;const t=e?e.details:null;t!=null&&t.live?(this.log("resetting startPosition for live start"),this.startPosition=-1,this.setStartPosition(t,t.fragmentStart),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){this.warn(`The loading context changed while buffering fragment ${e.sn} of ${this.playlistLabel()} ${e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,t,s,n){const r=s.details;if(!r){this.warn("level.details undefined");return}if(!Object.keys(e.elementaryStreams).reduce((d,u)=>{const f=e.elementaryStreams[u];if(f){const m=f.endPTS-f.startPTS;if(m<=0)return this.warn(`Could not parse fragment ${e.sn} ${u} duration reliably (${m})`),d||!1;const p=n?0:KA(r,e,f.startPTS,f.endPTS,f.startDTS,f.endDTS);return this.hls.trigger(w.LEVEL_PTS_UPDATED,{details:r,level:s,drift:p,type:u,frag:e,start:f.startPTS,end:f.endPTS}),!0}return d},!1)){var c;if(s.fragmentError===0&&this.treatAsGap(e,s),((c=this.transmuxer)==null?void 0:c.error)===null){const d=new Error(`Found no media in fragment ${e.sn} of ${this.playlistLabel()} ${e.level} resetting transmuxer to fallback to playlist timing`);if(this.warn(d.message),this.hls.trigger(w.ERROR,{type:Ke.MEDIA_ERROR,details:se.FRAG_PARSING_ERROR,fatal:!1,error:d,frag:e,reason:`Found no media in msn ${e.sn} of ${this.playlistLabel()} "${s.url}"`}),!this.hls)return;this.resetTransmuxer()}}this.state=pe.PARSED,this.log(`Parsed ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.fragInfo(e,!1,t)})`),this.hls.trigger(w.FRAG_PARSED,{frag:e,part:t})}playlistLabel(){return this.playlistType===ze.MAIN?"level":"track"}fragInfo(e,t=!0,s){var n,r;return`${this.playlistLabel()} ${e.level} (${s?"part":"frag"}:[${((n=t&&!s?e.startPTS:(s||e).start)!=null?n:NaN).toFixed(3)}-${((r=t&&!s?e.endPTS:(s||e).end)!=null?r:NaN).toFixed(3)}]${s&&e.type==="main"?"INDEPENDENT="+(s.independent?"YES":"NO"):""}`}treatAsGap(e,t){t&&t.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)}resetTransmuxer(){var e;(e=this.transmuxer)==null||e.reset()}recoverWorkerError(e){e.event==="demuxerWorker"&&(this.fragmentTracker.removeAllFragments(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState())}set state(e){const t=this._state;t!==e&&(this._state=e,this.log(`${t}->${e}`))}get state(){return this._state}}function _1(i){return!!i.interstitialsController&&i.enableInterstitialPlayback!==!1}class eI{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:t}=this;let s;if(e.length)e.length===1?s=e[0]:s=Zk(e,t);else return new Uint8Array(0);return this.reset(),s}reset(){this.chunks.length=0,this.dataLength=0}}function Zk(i,e){const t=new Uint8Array(e);let s=0;for(let n=0;n<i.length;n++){const r=i[n];t.set(r,s),s+=r.length}return t}var Fg={exports:{}},P1;function Jk(){return P1||(P1=1,function(i){var e=Object.prototype.hasOwnProperty,t="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(t=!1));function n(d,u,f){this.fn=d,this.context=u,this.once=f||!1}function r(d,u,f,m,p){if(typeof f!="function")throw new TypeError("The listener must be a function");var v=new n(f,m||d,p),S=t?t+u:u;return d._events[S]?d._events[S].fn?d._events[S]=[d._events[S],v]:d._events[S].push(v):(d._events[S]=v,d._eventsCount++),d}function o(d,u){--d._eventsCount===0?d._events=new s:delete d._events[u]}function c(){this._events=new s,this._eventsCount=0}c.prototype.eventNames=function(){var u=[],f,m;if(this._eventsCount===0)return u;for(m in f=this._events)e.call(f,m)&&u.push(t?m.slice(1):m);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(f)):u},c.prototype.listeners=function(u){var f=t?t+u:u,m=this._events[f];if(!m)return[];if(m.fn)return[m.fn];for(var p=0,v=m.length,S=new Array(v);p<v;p++)S[p]=m[p].fn;return S},c.prototype.listenerCount=function(u){var f=t?t+u:u,m=this._events[f];return m?m.fn?1:m.length:0},c.prototype.emit=function(u,f,m,p,v,S){var y=t?t+u:u;if(!this._events[y])return!1;var E=this._events[y],A=arguments.length,R,I;if(E.fn){switch(E.once&&this.removeListener(u,E.fn,void 0,!0),A){case 1:return E.fn.call(E.context),!0;case 2:return E.fn.call(E.context,f),!0;case 3:return E.fn.call(E.context,f,m),!0;case 4:return E.fn.call(E.context,f,m,p),!0;case 5:return E.fn.call(E.context,f,m,p,v),!0;case 6:return E.fn.call(E.context,f,m,p,v,S),!0}for(I=1,R=new Array(A-1);I<A;I++)R[I-1]=arguments[I];E.fn.apply(E.context,R)}else{var C=E.length,L;for(I=0;I<C;I++)switch(E[I].once&&this.removeListener(u,E[I].fn,void 0,!0),A){case 1:E[I].fn.call(E[I].context);break;case 2:E[I].fn.call(E[I].context,f);break;case 3:E[I].fn.call(E[I].context,f,m);break;case 4:E[I].fn.call(E[I].context,f,m,p);break;default:if(!R)for(L=1,R=new Array(A-1);L<A;L++)R[L-1]=arguments[L];E[I].fn.apply(E[I].context,R)}}return!0},c.prototype.on=function(u,f,m){return r(this,u,f,m,!1)},c.prototype.once=function(u,f,m){return r(this,u,f,m,!0)},c.prototype.removeListener=function(u,f,m,p){var v=t?t+u:u;if(!this._events[v])return this;if(!f)return o(this,v),this;var S=this._events[v];if(S.fn)S.fn===f&&(!p||S.once)&&(!m||S.context===m)&&o(this,v);else{for(var y=0,E=[],A=S.length;y<A;y++)(S[y].fn!==f||p&&!S[y].once||m&&S[y].context!==m)&&E.push(S[y]);E.length?this._events[v]=E.length===1?E[0]:E:o(this,v)}return this},c.prototype.removeAllListeners=function(u){var f;return u?(f=t?t+u:u,this._events[f]&&o(this,f)):(this._events=new s,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=t,c.EventEmitter=c,i.exports=c}(Fg)),Fg.exports}var eN=Jk(),B0=O2(eN);const Wc="1.6.4",Sl={};function tN(){return typeof __HLS_WORKER_BUNDLE__=="function"}function sN(){const i=Sl[Wc];if(i)return i.clientCount++,i;const e=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),t=self.URL.createObjectURL(e),n={worker:new self.Worker(t),objectURL:t,clientCount:1};return Sl[Wc]=n,n}function iN(i){const e=Sl[i];if(e)return e.clientCount++,e;const t=new self.URL(i,self.location.href).href,n={worker:new self.Worker(t),scriptURL:t,clientCount:1};return Sl[i]=n,n}function nN(i){const e=Sl[i||Wc];if(e&&e.clientCount--===1){const{worker:s,objectURL:n}=e;delete Sl[i||Wc],n&&self.URL.revokeObjectURL(n),s.terminate()}}function tI(i,e){return e+10<=i.length&&i[e]===51&&i[e+1]===68&&i[e+2]===73&&i[e+3]<255&&i[e+4]<255&&i[e+6]<128&&i[e+7]<128&&i[e+8]<128&&i[e+9]<128}function j0(i,e){return e+10<=i.length&&i[e]===73&&i[e+1]===68&&i[e+2]===51&&i[e+3]<255&&i[e+4]<255&&i[e+6]<128&&i[e+7]<128&&i[e+8]<128&&i[e+9]<128}function Xh(i,e){let t=0;return t=(i[e]&127)<<21,t|=(i[e+1]&127)<<14,t|=(i[e+2]&127)<<7,t|=i[e+3]&127,t}function Zc(i,e){const t=e;let s=0;for(;j0(i,e);){s+=10;const n=Xh(i,e+6);s+=n,tI(i,e+10)&&(s+=10),e+=s}if(s>0)return i.subarray(t,t+s)}function rN(i,e,t,s){const n=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],r=e[t+2],o=r>>2&15;if(o>12){const v=new Error(`invalid ADTS sampling index:${o}`);i.emit(w.ERROR,w.ERROR,{type:Ke.MEDIA_ERROR,details:se.FRAG_PARSING_ERROR,fatal:!0,error:v,reason:v.message});return}const c=(r>>6&3)+1,d=e[t+3]>>6&3|(r&1)<<2,u="mp4a.40."+c,f=n[o];let m=o;(c===5||c===29)&&(m-=3);const p=[c<<3|(m&14)>>1,(m&1)<<7|d<<3];return wt.log(`manifest codec:${s}, parsed codec:${u}, channels:${d}, rate:${f} (ADTS object type:${c} sampling index:${o})`),{config:p,samplerate:f,channelCount:d,codec:u,parsedCodec:u,manifestCodec:s}}function sI(i,e){return i[e]===255&&(i[e+1]&246)===240}function iI(i,e){return i[e+1]&1?7:9}function V0(i,e){return(i[e+3]&3)<<11|i[e+4]<<3|(i[e+5]&224)>>>5}function aN(i,e){return e+5<i.length}function Dh(i,e){return e+1<i.length&&sI(i,e)}function oN(i,e){return aN(i,e)&&sI(i,e)&&V0(i,e)<=i.length-e}function lN(i,e){if(Dh(i,e)){const t=iI(i,e);if(e+t>=i.length)return!1;const s=V0(i,e);if(s<=t)return!1;const n=e+s;return n===i.length||Dh(i,n)}return!1}function nI(i,e,t,s,n){if(!i.samplerate){const r=rN(e,t,s,n);if(!r)return;Ft(i,r)}}function rI(i){return 1024*9e4/i}function cN(i,e){const t=iI(i,e);if(e+t<=i.length){const s=V0(i,e)-t;if(s>0)return{headerLength:t,frameLength:s}}}function aI(i,e,t,s,n){const r=rI(i.samplerate),o=s+n*r,c=cN(e,t);let d;if(c){const{frameLength:m,headerLength:p}=c,v=p+m,S=Math.max(0,t+v-e.length);S?(d=new Uint8Array(v-p),d.set(e.subarray(t+p,e.length),0)):d=e.subarray(t+p,t+v);const y={unit:d,pts:o};return S||i.samples.push(y),{sample:y,length:v,missing:S}}const u=e.length-t;return d=new Uint8Array(u),d.set(e.subarray(t,e.length),0),{sample:{unit:d,pts:o},length:u,missing:-1}}function uN(i,e){return j0(i,e)&&Xh(i,e+6)+10<=i.length-e}function dN(i){return i instanceof ArrayBuffer?i:i.byteOffset==0&&i.byteLength==i.buffer.byteLength?i.buffer:new Uint8Array(i).buffer}function Bg(i,e=0,t=1/0){return hN(i,e,t,Uint8Array)}function hN(i,e,t,s){const n=fN(i);let r=1;"BYTES_PER_ELEMENT"in s&&(r=s.BYTES_PER_ELEMENT);const o=mN(i)?i.byteOffset:0,c=(o+i.byteLength)/r,d=(o+e)/r,u=Math.floor(Math.max(0,Math.min(d,c))),f=Math.floor(Math.min(u+Math.max(t,0),c));return new s(n,u,f-u)}function fN(i){return i instanceof ArrayBuffer?i:i.buffer}function mN(i){return i&&i.buffer instanceof ArrayBuffer&&i.byteLength!==void 0&&i.byteOffset!==void 0}function gN(i){const e={key:i.type,description:"",data:"",mimeType:null,pictureType:null},t=3;if(i.size<2)return;if(i.data[0]!==t){console.log("Ignore frame with unrecognized character encoding");return}const s=i.data.subarray(1).indexOf(0);if(s===-1)return;const n=Ci(Bg(i.data,1,s)),r=i.data[2+s],o=i.data.subarray(3+s).indexOf(0);if(o===-1)return;const c=Ci(Bg(i.data,3+s,o));let d;return n==="-->"?d=Ci(Bg(i.data,4+s+o)):d=dN(i.data.subarray(4+s+o)),e.mimeType=n,e.pictureType=r,e.description=c,e.data=d,e}function pN(i){if(i.size<2)return;const e=Ci(i.data,!0),t=new Uint8Array(i.data.subarray(e.length+1));return{key:i.type,info:e,data:t.buffer}}function yN(i){if(i.size<2)return;if(i.type==="TXXX"){let t=1;const s=Ci(i.data.subarray(t),!0);t+=s.length+1;const n=Ci(i.data.subarray(t));return{key:i.type,info:s,data:n}}const e=Ci(i.data.subarray(1));return{key:i.type,info:"",data:e}}function vN(i){if(i.type==="WXXX"){if(i.size<2)return;let t=1;const s=Ci(i.data.subarray(t),!0);t+=s.length+1;const n=Ci(i.data.subarray(t));return{key:i.type,info:s,data:n}}const e=Ci(i.data);return{key:i.type,info:"",data:e}}function SN(i){return i.type==="PRIV"?pN(i):i.type[0]==="W"?vN(i):i.type==="APIC"?gN(i):yN(i)}function xN(i){const e=String.fromCharCode(i[0],i[1],i[2],i[3]),t=Xh(i,4),s=10;return{type:e,size:t,data:i.subarray(s,s+t)}}const $d=10,TN=10;function oI(i){let e=0;const t=[];for(;j0(i,e);){const s=Xh(i,e+6);i[e+5]>>6&1&&(e+=$d),e+=$d;const n=e+s;for(;e+TN<n;){const r=xN(i.subarray(e)),o=SN(r);o&&t.push(o),e+=r.size+$d}tI(i,e)&&(e+=$d)}return t}function lI(i){return i&&i.key==="PRIV"&&i.info==="com.apple.streaming.transportStreamTimestamp"}function EN(i){if(i.data.byteLength===8){const e=new Uint8Array(i.data),t=e[3]&1;let s=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return s/=45,t&&(s+=4772185884e-2),Math.round(s)}}function $0(i){const e=oI(i);for(let t=0;t<e.length;t++){const s=e[t];if(lI(s))return EN(s)}}let Ii=function(i){return i.audioId3="org.id3",i.dateRange="com.apple.quicktime.HLS",i.emsg="https://aomedia.org/emsg/ID3",i.misbklv="urn:misb:KLV:bin:1910.1",i}({});function wn(i="",e=9e4){return{type:i,id:-1,pid:-1,inputTimeScale:e,sequenceNumber:-1,samples:[],dropped:0}}class G0{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,t,s,n){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,s){}demux(e,t){this.cachedData&&(e=Xi(this.cachedData,e),this.cachedData=null);let s=Zc(e,0),n=s?s.length:0,r;const o=this._audioTrack,c=this._id3Track,d=s?$0(s):void 0,u=e.length;for((this.basePTS===null||this.frameIndex===0&&Fe(d))&&(this.basePTS=bN(d,t,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),s&&s.length>0&&c.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:s,type:Ii.audioId3,duration:Number.POSITIVE_INFINITY});n<u;){if(this.canParse(e,n)){const f=this.appendFrame(o,e,n);f?(this.frameIndex++,this.lastPTS=f.sample.pts,n+=f.length,r=n):n=u}else uN(e,n)?(s=Zc(e,n),c.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:s,type:Ii.audioId3,duration:Number.POSITIVE_INFINITY}),n+=s.length,r=n):n++;if(n===u&&r!==u){const f=e.slice(r);this.cachedData?this.cachedData=Xi(this.cachedData,f):this.cachedData=f}}return{audioTrack:o,videoTrack:wn(),id3Track:c,textTrack:wn()}}demuxSampleAes(e,t,s){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){const t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:wn(),id3Track:this._id3Track,textTrack:wn()}}destroy(){this.cachedData=null,this._audioTrack=this._id3Track=void 0}}const bN=(i,e,t)=>{if(Fe(i))return i*90;const s=t?t.baseTime*9e4/t.timescale:0;return e*9e4+s};let Gd=null;const AN=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],IN=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],RN=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],LN=[0,1,1,4];function cI(i,e,t,s,n){if(t+24>e.length)return;const r=uI(e,t);if(r&&t+r.frameLength<=e.length){const o=r.samplesPerFrame*9e4/r.sampleRate,c=s+n*o,d={unit:e.subarray(t,t+r.frameLength),pts:c,dts:c};return i.config=[],i.channelCount=r.channelCount,i.samplerate=r.sampleRate,i.samples.push(d),{sample:d,length:r.frameLength,missing:0}}}function uI(i,e){const t=i[e+1]>>3&3,s=i[e+1]>>1&3,n=i[e+2]>>4&15,r=i[e+2]>>2&3;if(t!==1&&n!==0&&n!==15&&r!==3){const o=i[e+2]>>1&1,c=i[e+3]>>6,d=t===3?3-s:s===3?3:4,u=AN[d*14+n-1]*1e3,m=IN[(t===3?0:t===2?1:2)*3+r],p=c===3?1:2,v=RN[t][s],S=LN[s],y=v*8*S,E=Math.floor(v*u/m+o)*S;if(Gd===null){const I=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Gd=I?parseInt(I[1]):0}return!!Gd&&Gd<=87&&s===2&&u>=224e3&&c===0&&(i[e+3]=i[e+3]|128),{sampleRate:m,channelCount:p,frameLength:E,samplesPerFrame:y}}}function H0(i,e){return i[e]===255&&(i[e+1]&224)===224&&(i[e+1]&6)!==0}function dI(i,e){return e+1<i.length&&H0(i,e)}function wN(i,e){return H0(i,e)&&4<=i.length-e}function hI(i,e){if(e+1<i.length&&H0(i,e)){const s=uI(i,e);let n=4;s!=null&&s.frameLength&&(n=s.frameLength);const r=e+n;return r===i.length||dI(i,r)}return!1}class CN extends G0{constructor(e,t){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}resetInitSegment(e,t,s,n){super.resetInitSegment(e,t,s,n),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:n,inputTimeScale:9e4,dropped:0}}static probe(e,t){if(!e)return!1;const s=Zc(e,0);let n=(s==null?void 0:s.length)||0;if(hI(e,n))return!1;for(let r=e.length;n<r;n++)if(lN(e,n))return t.log("ADTS sync word found !"),!0;return!1}canParse(e,t){return oN(e,t)}appendFrame(e,t,s){nI(e,this.observer,t,s,e.manifestCodec);const n=aI(e,t,s,this.basePTS,this.frameIndex);if(n&&n.missing===0)return n}}const fI=(i,e)=>{let t=0,s=5;e+=s;const n=new Uint32Array(1),r=new Uint32Array(1),o=new Uint8Array(1);for(;s>0;){o[0]=i[e];const c=Math.min(s,8),d=8-c;r[0]=4278190080>>>24+d<<d,n[0]=(o[0]&r[0])>>d,t=t?t<<c|n[0]:n[0],e+=1,s-=c}return t};class ON extends G0{constructor(e){super(),this.observer=void 0,this.observer=e}resetInitSegment(e,t,s,n){super.resetInitSegment(e,t,s,n),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:t,duration:n,inputTimeScale:9e4,dropped:0}}canParse(e,t){return t+64<e.length}appendFrame(e,t,s){const n=mI(e,t,s,this.basePTS,this.frameIndex);if(n!==-1)return{sample:e.samples[e.samples.length-1],length:n,missing:0}}static probe(e){if(!e)return!1;const t=Zc(e,0);if(!t)return!1;const s=t.length;return e[s]===11&&e[s+1]===119&&$0(t)!==void 0&&fI(e,s)<16}}function mI(i,e,t,s,n){if(t+8>e.length||e[t]!==11||e[t+1]!==119)return-1;const r=e[t+4]>>6;if(r>=3)return-1;const c=[48e3,44100,32e3][r],d=e[t+4]&63,f=[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][d*3+r]*2;if(t+f>e.length)return-1;const m=e[t+6]>>5;let p=0;m===2?p+=2:(m&1&&m!==1&&(p+=2),m&4&&(p+=2));const v=(e[t+6]<<8|e[t+7])>>12-p&1,y=[2,1,2,3,3,4,4,5][m]+v,E=e[t+5]>>3,A=e[t+5]&7,R=new Uint8Array([r<<6|E<<1|A>>2,(A&3)<<6|m<<3|v<<2|d>>4,d<<4&224]),I=1536/c*9e4,C=s+n*I,L=e.subarray(t,t+f);return i.config=R,i.channelCount=y,i.samplerate=c,i.samples.push({unit:L,pts:C}),f}class DN extends G0{resetInitSegment(e,t,s,n){super.resetInitSegment(e,t,s,n),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:n,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const t=Zc(e,0);let s=(t==null?void 0:t.length)||0;if(t&&e[s]===11&&e[s+1]===119&&$0(t)!==void 0&&fI(e,s)<=16)return!1;for(let n=e.length;s<n;s++)if(hI(e,s))return wt.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,t){return wN(e,t)}appendFrame(e,t,s){if(this.basePTS!==null)return cI(e,t,s,this.basePTS,this.frameIndex)}}const _N=/\/emsg[-/]ID3/i;class PN{constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}resetTimeStamp(){}resetInitSegment(e,t,s,n){const r=this.videoTrack=wn("video",1),o=this.audioTrack=wn("audio",1),c=this.txtTrack=wn("text",1);if(this.id3Track=wn("id3",1),this.timeOffset=0,!(e!=null&&e.byteLength))return;const d=LA(e);if(d.video){const{id:u,timescale:f,codec:m,supplemental:p}=d.video;r.id=u,r.timescale=c.timescale=f,r.codec=m,r.supplemental=p}if(d.audio){const{id:u,timescale:f,codec:m}=d.audio;o.id=u,o.timescale=f,o.codec=m}c.id=AA.text,r.sampleDuration=0,r.duration=o.duration=n}resetContiguity(){this.remainderData=null}static probe(e){return N2(e)}demux(e,t){this.timeOffset=t;let s=e;const n=this.videoTrack,r=this.txtTrack;if(this.config.progressive){this.remainderData&&(s=Xi(this.remainderData,e));const c=$2(s);this.remainderData=c.remainder,n.samples=c.valid||new Uint8Array}else n.samples=s;const o=this.extractID3Track(n,t);return r.samples=e1(t,n),{videoTrack:n,audioTrack:this.audioTrack,id3Track:o,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,t=this.videoTrack,s=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;const n=this.extractID3Track(t,this.timeOffset);return s.samples=e1(e,t),{videoTrack:t,audioTrack:wn(),id3Track:n,textTrack:wn()}}extractID3Track(e,t){const s=this.id3Track;if(e.samples.length){const n=ct(e.samples,["emsg"]);n&&n.forEach(r=>{const o=H2(r);if(_N.test(o.schemeIdUri)){const c=k1(o,t);let d=o.eventDuration===4294967295?Number.POSITIVE_INFINITY:o.eventDuration/o.timeScale;d<=.001&&(d=Number.POSITIVE_INFINITY);const u=o.payload;s.samples.push({data:u,len:u.byteLength,dts:c,pts:c,type:Ii.emsg,duration:d})}else if(this.config.enableEmsgKLVMetadata&&o.schemeIdUri.startsWith("urn:misb:KLV:bin:1910.1")){const c=k1(o,t);s.samples.push({data:o.payload,len:o.payload.byteLength,dts:c,pts:c,type:Ii.misbklv,duration:Number.POSITIVE_INFINITY})}})}return s}demuxSampleAes(e,t,s){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){this.config=null,this.remainderData=null,this.videoTrack=this.audioTrack=this.id3Track=this.txtTrack=void 0}}function k1(i,e){return Fe(i.presentationTime)?i.presentationTime/i.timeScale:e+i.presentationTimeDelta/i.timeScale}class kN{constructor(e,t,s){this.keyData=void 0,this.decrypter=void 0,this.keyData=s,this.decrypter=new k0(t,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer,ua.cbc)}decryptAacSample(e,t,s){const n=e[t].unit;if(n.length<=16)return;const r=n.subarray(16,n.length-n.length%16),o=r.buffer.slice(r.byteOffset,r.byteOffset+r.length);this.decryptBuffer(o).then(c=>{const d=new Uint8Array(c);n.set(d,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,s)})}decryptAacSamples(e,t,s){for(;;t++){if(t>=e.length){s();return}if(!(e[t].unit.length<32)&&(this.decryptAacSample(e,t,s),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){const t=Math.floor((e.length-48)/160)*16+16,s=new Int8Array(t);let n=0;for(let r=32;r<e.length-16;r+=160,n+=16)s.set(e.subarray(r,r+16),n);return s}getAvcDecryptedUnit(e,t){const s=new Uint8Array(t);let n=0;for(let r=32;r<e.length-16;r+=160,n+=16)e.set(s.subarray(n,n+16),r);return e}decryptAvcSample(e,t,s,n,r){const o=CA(r.data),c=this.getAvcEncryptedData(o);this.decryptBuffer(c.buffer).then(d=>{r.data=this.getAvcDecryptedUnit(o,d),this.decrypter.isSync()||this.decryptAvcSamples(e,t,s+1,n)})}decryptAvcSamples(e,t,s,n){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,s=0){if(t>=e.length){n();return}const r=e[t].units;for(;!(s>=r.length);s++){const o=r[s];if(!(o.data.length<=48||o.type!==1&&o.type!==5)&&(this.decryptAvcSample(e,t,s,n,o),!this.decrypter.isSync()))return}}}}class gI{constructor(){this.VideoSample=null}createVideoSample(e,t,s){return{key:e,frame:!1,pts:t,dts:s,units:[],length:0}}getLastNalUnit(e){var t;let s=this.VideoSample,n;if((!s||s.units.length===0)&&(s=e[e.length-1]),(t=s)!=null&&t.units){const r=s.units;n=r[r.length-1]}return n}pushAccessUnit(e,t){if(e.units.length&&e.frame){if(e.pts===void 0){const s=t.samples,n=s.length;if(n){const r=s[n-1];e.pts=r.pts,e.dts=r.dts}else{t.dropped++;return}}t.samples.push(e)}}parseNALu(e,t,s){const n=t.byteLength;let r=e.naluState||0;const o=r,c=[];let d=0,u,f,m,p=-1,v=0;for(r===-1&&(p=0,v=this.getNALuType(t,0),r=0,d=1);d<n;){if(u=t[d++],!r){r=u?0:1;continue}if(r===1){r=u?0:2;continue}if(!u)r=3;else if(u===1){if(f=d-r-1,p>=0){const S={data:t.subarray(p,f),type:v};c.push(S)}else{const S=this.getLastNalUnit(e.samples);S&&(o&&d<=4-o&&S.state&&(S.data=S.data.subarray(0,S.data.byteLength-o)),f>0&&(S.data=Xi(S.data,t.subarray(0,f)),S.state=0))}d<n?(m=this.getNALuType(t,d),p=d,v=m,r=0):r=-1}else r=0}if(p>=0&&r>=0){const S={data:t.subarray(p,n),type:v,state:r};c.push(S)}if(c.length===0){const S=this.getLastNalUnit(e.samples);S&&(S.data=Xi(S.data,t))}return e.naluState=r,c}}class Bc{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,t=this.bytesAvailable,s=e.byteLength-t,n=new Uint8Array(4),r=Math.min(4,t);if(r===0)throw new Error("no bytes available");n.set(e.subarray(s,s+r)),this.word=new DataView(n.buffer).getUint32(0),this.bitsAvailable=r*8,this.bytesAvailable-=r}skipBits(e){let t;e=Math.min(e,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,t=e>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let t=Math.min(this.bitsAvailable,e);const s=this.word>>>32-t;if(e>32&&wt.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return t=e-t,t>0&&this.bitsAvailable?s<<t|this.readBits(t):s}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if((this.word&2147483648>>>e)!==0)return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}}class N1 extends gI{parsePES(e,t,s,n){const r=this.parseNALu(e,s.data,n);let o=this.VideoSample,c,d=!1;s.data=null,o&&r.length&&!e.audFound&&(this.pushAccessUnit(o,e),o=this.VideoSample=this.createVideoSample(!1,s.pts,s.dts)),r.forEach(u=>{var f,m;switch(u.type){case 1:{let y=!1;c=!0;const E=u.data;if(d&&E.length>4){const A=this.readSliceType(E);(A===2||A===4||A===7||A===9)&&(y=!0)}if(y){var p;(p=o)!=null&&p.frame&&!o.key&&(this.pushAccessUnit(o,e),o=this.VideoSample=null)}o||(o=this.VideoSample=this.createVideoSample(!0,s.pts,s.dts)),o.frame=!0,o.key=y;break}case 5:c=!0,(f=o)!=null&&f.frame&&!o.key&&(this.pushAccessUnit(o,e),o=this.VideoSample=null),o||(o=this.VideoSample=this.createVideoSample(!0,s.pts,s.dts)),o.key=!0,o.frame=!0;break;case 6:{c=!0,_0(u.data,1,s.pts,t.samples);break}case 7:{var v,S;c=!0,d=!0;const y=u.data,E=this.readSPS(y);if(!e.sps||e.width!==E.width||e.height!==E.height||((v=e.pixelRatio)==null?void 0:v[0])!==E.pixelRatio[0]||((S=e.pixelRatio)==null?void 0:S[1])!==E.pixelRatio[1]){e.width=E.width,e.height=E.height,e.pixelRatio=E.pixelRatio,e.sps=[y];const A=y.subarray(1,4);let R="avc1.";for(let I=0;I<3;I++){let C=A[I].toString(16);C.length<2&&(C="0"+C),R+=C}e.codec=R}break}case 8:c=!0,e.pps=[u.data];break;case 9:c=!0,e.audFound=!0,(m=o)!=null&&m.frame&&(this.pushAccessUnit(o,e),o=null),o||(o=this.VideoSample=this.createVideoSample(!1,s.pts,s.dts));break;case 12:c=!0;break;default:c=!1;break}o&&c&&o.units.push(u)}),n&&o&&(this.pushAccessUnit(o,e),this.VideoSample=null)}getNALuType(e,t){return e[t]&31}readSliceType(e){const t=new Bc(e);return t.readUByte(),t.readUEG(),t.readUEG()}skipScalingList(e,t){let s=8,n=8,r;for(let o=0;o<e;o++)n!==0&&(r=t.readEG(),n=(s+r+256)%256),s=n===0?s:n}readSPS(e){const t=new Bc(e);let s=0,n=0,r=0,o=0,c,d,u;const f=t.readUByte.bind(t),m=t.readBits.bind(t),p=t.readUEG.bind(t),v=t.readBoolean.bind(t),S=t.skipBits.bind(t),y=t.skipEG.bind(t),E=t.skipUEG.bind(t),A=this.skipScalingList.bind(this);f();const R=f();if(m(5),S(3),f(),E(),R===100||R===110||R===122||R===244||R===44||R===83||R===86||R===118||R===128){const M=p();if(M===3&&S(1),E(),E(),S(1),v())for(d=M!==3?8:12,u=0;u<d;u++)v()&&(u<6?A(16,t):A(64,t))}E();const I=p();if(I===0)p();else if(I===1)for(S(1),y(),y(),c=p(),u=0;u<c;u++)y();E(),S(1);const C=p(),L=p(),D=m(1);D===0&&S(1),S(1),v()&&(s=p(),n=p(),r=p(),o=p());let _=[1,1];if(v()&&v())switch(f()){case 1:_=[1,1];break;case 2:_=[12,11];break;case 3:_=[10,11];break;case 4:_=[16,11];break;case 5:_=[40,33];break;case 6:_=[24,11];break;case 7:_=[20,11];break;case 8:_=[32,11];break;case 9:_=[80,33];break;case 10:_=[18,11];break;case 11:_=[15,11];break;case 12:_=[64,33];break;case 13:_=[160,99];break;case 14:_=[4,3];break;case 15:_=[3,2];break;case 16:_=[2,1];break;case 255:{_=[f()<<8|f(),f()<<8|f()];break}}return{width:Math.ceil((C+1)*16-s*2-n*2),height:(2-D)*(L+1)*16-(D?2:4)*(r+o),pixelRatio:_}}}class M1 extends gI{constructor(...e){super(...e),this.initVPS=null}parsePES(e,t,s,n){const r=this.parseNALu(e,s.data,n);let o=this.VideoSample,c,d=!1;s.data=null,o&&r.length&&!e.audFound&&(this.pushAccessUnit(o,e),o=this.VideoSample=this.createVideoSample(!1,s.pts,s.dts)),r.forEach(u=>{var f,m;switch(u.type){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:o||(o=this.VideoSample=this.createVideoSample(!1,s.pts,s.dts)),o.frame=!0,c=!0;break;case 16:case 17:case 18:case 21:if(c=!0,d){var p;(p=o)!=null&&p.frame&&!o.key&&(this.pushAccessUnit(o,e),o=this.VideoSample=null)}o||(o=this.VideoSample=this.createVideoSample(!0,s.pts,s.dts)),o.key=!0,o.frame=!0;break;case 19:case 20:c=!0,(f=o)!=null&&f.frame&&!o.key&&(this.pushAccessUnit(o,e),o=this.VideoSample=null),o||(o=this.VideoSample=this.createVideoSample(!0,s.pts,s.dts)),o.key=!0,o.frame=!0;break;case 39:c=!0,_0(u.data,2,s.pts,t.samples);break;case 32:c=!0,e.vps||(typeof e.params!="object"&&(e.params={}),e.params=Ft(e.params,this.readVPS(u.data)),this.initVPS=u.data),e.vps=[u.data];break;case 33:if(c=!0,d=!0,e.vps!==void 0&&e.vps[0]!==this.initVPS&&e.sps!==void 0&&!this.matchSPS(e.sps[0],u.data)&&(this.initVPS=e.vps[0],e.sps=e.pps=void 0),!e.sps){const v=this.readSPS(u.data);e.width=v.width,e.height=v.height,e.pixelRatio=v.pixelRatio,e.codec=v.codecString,e.sps=[],typeof e.params!="object"&&(e.params={});for(const S in v.params)e.params[S]=v.params[S]}this.pushParameterSet(e.sps,u.data,e.vps),o||(o=this.VideoSample=this.createVideoSample(!0,s.pts,s.dts)),o.key=!0;break;case 34:if(c=!0,typeof e.params=="object"){if(!e.pps){e.pps=[];const v=this.readPPS(u.data);for(const S in v)e.params[S]=v[S]}this.pushParameterSet(e.pps,u.data,e.vps)}break;case 35:c=!0,e.audFound=!0,(m=o)!=null&&m.frame&&(this.pushAccessUnit(o,e),o=null),o||(o=this.VideoSample=this.createVideoSample(!1,s.pts,s.dts));break;default:c=!1;break}o&&c&&o.units.push(u)}),n&&o&&(this.pushAccessUnit(o,e),this.VideoSample=null)}pushParameterSet(e,t,s){(s&&s[0]===this.initVPS||!s&&!e.length)&&e.push(t)}getNALuType(e,t){return(e[t]&126)>>>1}ebsp2rbsp(e){const t=new Uint8Array(e.byteLength);let s=0;for(let n=0;n<e.byteLength;n++)n>=2&&e[n]===3&&e[n-1]===0&&e[n-2]===0||(t[s]=e[n],s++);return new Uint8Array(t.buffer,0,s)}pushAccessUnit(e,t){super.pushAccessUnit(e,t),this.initVPS&&(this.initVPS=null)}readVPS(e){const t=new Bc(e);t.readUByte(),t.readUByte(),t.readBits(4),t.skipBits(2),t.readBits(6);const s=t.readBits(3),n=t.readBoolean();return{numTemporalLayers:s+1,temporalIdNested:n}}readSPS(e){const t=new Bc(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.readBits(4);const s=t.readBits(3);t.readBoolean();const n=t.readBits(2),r=t.readBoolean(),o=t.readBits(5),c=t.readUByte(),d=t.readUByte(),u=t.readUByte(),f=t.readUByte(),m=t.readUByte(),p=t.readUByte(),v=t.readUByte(),S=t.readUByte(),y=t.readUByte(),E=t.readUByte(),A=t.readUByte(),R=[],I=[];for(let W=0;W<s;W++)R.push(t.readBoolean()),I.push(t.readBoolean());if(s>0)for(let W=s;W<8;W++)t.readBits(2);for(let W=0;W<s;W++)R[W]&&(t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte()),I[W]&&t.readUByte();t.readUEG();const C=t.readUEG();C==3&&t.skipBits(1);const L=t.readUEG(),D=t.readUEG(),_=t.readBoolean();let M=0,U=0,F=0,z=0;_&&(M+=t.readUEG(),U+=t.readUEG(),F+=t.readUEG(),z+=t.readUEG());const V=t.readUEG(),ae=t.readUEG(),G=t.readUEG(),Z=t.readBoolean();for(let W=Z?0:s;W<=s;W++)t.skipUEG(),t.skipUEG(),t.skipUEG();if(t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.readBoolean()&&t.readBoolean())for(let j=0;j<4;j++)for(let ne=0;ne<(j===3?2:6);ne++)if(!t.readBoolean())t.readUEG();else{const Ie=Math.min(64,1<<4+(j<<1));j>1&&t.readEG();for(let Ue=0;Ue<Ie;Ue++)t.readEG()}t.readBoolean(),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.skipUEG(),t.skipUEG(),t.readBoolean());const re=t.readUEG();let J=0;for(let W=0;W<re;W++){let j=!1;if(W!==0&&(j=t.readBoolean()),j){W===re&&t.readUEG(),t.readBoolean(),t.readUEG();let ne=0;for(let ge=0;ge<=J;ge++){const Ie=t.readBoolean();let Ue=!1;Ie||(Ue=t.readBoolean()),(Ie||Ue)&&ne++}J=ne}else{const ne=t.readUEG(),ge=t.readUEG();J=ne+ge;for(let Ie=0;Ie<ne;Ie++)t.readUEG(),t.readBoolean();for(let Ie=0;Ie<ge;Ie++)t.readUEG(),t.readBoolean()}}if(t.readBoolean()){const W=t.readUEG();for(let j=0;j<W;j++){for(let ne=0;ne<G+4;ne++)t.readBits(1);t.readBits(1)}}let K=0,le=1,H=1,ue=!0,xe=1,fe=0;t.readBoolean(),t.readBoolean();let We=!1;if(t.readBoolean()){if(t.readBoolean()){const Ve=t.readUByte(),it=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],xt=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];Ve>0&&Ve<16?(le=it[Ve-1],H=xt[Ve-1]):Ve===255&&(le=t.readBits(16),H=t.readBits(16))}if(t.readBoolean()&&t.readBoolean(),t.readBoolean()&&(t.readBits(3),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.readUByte(),t.readUByte())),t.readBoolean()&&(t.readUEG(),t.readUEG()),t.readBoolean(),t.readBoolean(),t.readBoolean(),We=t.readBoolean(),We&&(M+=t.readUEG(),U+=t.readUEG(),F+=t.readUEG(),z+=t.readUEG()),t.readBoolean()&&(xe=t.readBits(32),fe=t.readBits(32),t.readBoolean()&&t.readUEG(),t.readBoolean())){const xt=t.readBoolean(),Rt=t.readBoolean();let Dt=!1;(xt||Rt)&&(Dt=t.readBoolean(),Dt&&(t.readUByte(),t.readBits(5),t.readBoolean(),t.readBits(5)),t.readBits(4),t.readBits(4),Dt&&t.readBits(4),t.readBits(5),t.readBits(5),t.readBits(5));for(let bt=0;bt<=s;bt++){ue=t.readBoolean();const $t=ue||t.readBoolean();let St=!1;$t?t.readEG():St=t.readBoolean();const _s=St?1:t.readUEG()+1;if(xt)for(let hs=0;hs<_s;hs++)t.readUEG(),t.readUEG(),Dt&&(t.readUEG(),t.readUEG()),t.skipBits(1);if(Rt)for(let hs=0;hs<_s;hs++)t.readUEG(),t.readUEG(),Dt&&(t.readUEG(),t.readUEG()),t.skipBits(1)}}t.readBoolean()&&(t.readBoolean(),t.readBoolean(),t.readBoolean(),K=t.readUEG())}let Be=L,lt=D;if(_||We){let W=1,j=1;C===1?W=j=2:C==2&&(W=2),Be=L-W*U-W*M,lt=D-j*z-j*F}const Ee=n?["A","B","C"][n]:"",Ne=c<<24|d<<16|u<<8|f;let Me=0;for(let W=0;W<32;W++)Me=(Me|(Ne>>W&1)<<31-W)>>>0;let Qe=Me.toString(16);return o===1&&Qe==="2"&&(Qe="6"),{codecString:`hvc1.${Ee}${o}.${Qe}.${r?"H":"L"}${A}.B0`,params:{general_tier_flag:r,general_profile_idc:o,general_profile_space:n,general_profile_compatibility_flags:[c,d,u,f],general_constraint_indicator_flags:[m,p,v,S,y,E],general_level_idc:A,bit_depth:V+8,bit_depth_luma_minus8:V,bit_depth_chroma_minus8:ae,min_spatial_segmentation_idc:K,chroma_format_idc:C,frame_rate:{fixed:ue,fps:fe/xe}},width:Be,height:lt,pixelRatio:[le,H]}}readPPS(e){const t=new Bc(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.skipUEG(),t.skipUEG(),t.skipBits(2),t.skipBits(3),t.skipBits(2),t.skipUEG(),t.skipUEG(),t.skipEG(),t.skipBits(2),t.readBoolean()&&t.skipUEG(),t.skipEG(),t.skipEG(),t.skipBits(4);const n=t.readBoolean(),r=t.readBoolean();let o=1;return r&&n?o=0:r?o=3:n&&(o=2),{parallelismType:o}}matchSPS(e,t){return String.fromCharCode.apply(null,e).substr(3)===String.fromCharCode.apply(null,t).substr(3)}}const Os=188;class Qr{constructor(e,t,s,n){this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=e,this.config=t,this.typeSupported=s,this.logger=n,this.videoParser=null}static probe(e,t){const s=Qr.syncOffset(e);return s>0&&t.warn(`MPEG2-TS detected but first sync word found @ offset ${s}`),s!==-1}static syncOffset(e){const t=e.length;let s=Math.min(Os*5,t-Os)+1,n=0;for(;n<s;){let r=!1,o=-1,c=0;for(let d=n;d<t;d+=Os)if(e[d]===71&&(t-d===Os||e[d+Os]===71)){if(c++,o===-1&&(o=d,o!==0&&(s=Math.min(o+Os*99,e.length-Os)+1)),r||(r=Gp(e,d)===0),r&&c>1&&(o===0&&c>2||d+Os>s))return o}else{if(c)return-1;break}n++}return-1}static createTrack(e,t){return{container:e==="video"||e==="audio"?"video/mp2t":void 0,type:e,id:AA[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:e==="audio"?t:void 0}}resetInitSegment(e,t,s,n){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=Qr.createTrack("video"),this._videoTrack.duration=n,this._audioTrack=Qr.createTrack("audio",n),this._id3Track=Qr.createTrack("id3"),this._txtTrack=Qr.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=s}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_videoTrack:t,_id3Track:s}=this;e&&(e.pesData=null),t&&(t.pesData=null),s&&(s.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(e,t,s=!1,n=!1){s||(this.sampleAes=null);let r;const o=this._videoTrack,c=this._audioTrack,d=this._id3Track,u=this._txtTrack;let f=o.pid,m=o.pesData,p=c.pid,v=d.pid,S=c.pesData,y=d.pesData,E=null,A=this.pmtParsed,R=this._pmtId,I=e.length;if(this.remainderData&&(e=Xi(this.remainderData,e),I=e.length,this.remainderData=null),I<Os&&!n)return this.remainderData=e,{audioTrack:c,videoTrack:o,id3Track:d,textTrack:u};const C=Math.max(0,Qr.syncOffset(e));I-=(I-C)%Os,I<e.byteLength&&!n&&(this.remainderData=new Uint8Array(e.buffer,I,e.buffer.byteLength-I));let L=0;for(let _=C;_<I;_+=Os)if(e[_]===71){const M=!!(e[_+1]&64),U=Gp(e,_),F=(e[_+3]&48)>>4;let z;if(F>1){if(z=_+5+e[_+4],z===_+Os)continue}else z=_+4;switch(U){case f:if(M){if(m&&(r=Xo(m,this.logger))){if(this.videoParser===null)switch(o.segmentCodec){case"avc":this.videoParser=new N1;break;case"hevc":this.videoParser=new M1;break}this.videoParser!==null&&this.videoParser.parsePES(o,u,r,!1)}m={data:[],size:0}}m&&(m.data.push(e.subarray(z,_+Os)),m.size+=_+Os-z);break;case p:if(M){if(S&&(r=Xo(S,this.logger)))switch(c.segmentCodec){case"aac":this.parseAACPES(c,r);break;case"mp3":this.parseMPEGPES(c,r);break;case"ac3":this.parseAC3PES(c,r);break}S={data:[],size:0}}S&&(S.data.push(e.subarray(z,_+Os)),S.size+=_+Os-z);break;case v:M&&(y&&(r=Xo(y,this.logger))&&this.parseID3PES(d,r),y={data:[],size:0}),y&&(y.data.push(e.subarray(z,_+Os)),y.size+=_+Os-z);break;case 0:M&&(z+=e[z]+1),R=this._pmtId=NN(e,z);break;case R:{M&&(z+=e[z]+1);const V=MN(e,z,this.typeSupported,s,this.observer,this.logger);f=V.videoPid,f>0&&(o.pid=f,o.segmentCodec=V.segmentVideoCodec),p=V.audioPid,p>0&&(c.pid=p,c.segmentCodec=V.segmentAudioCodec),v=V.id3Pid,v>0&&(d.pid=v),E!==null&&!A&&(this.logger.warn(`MPEG-TS PMT found at ${_} after unknown PID '${E}'. Backtracking to sync byte @${C} to parse all TS packets.`),E=null,_=C-188),A=this.pmtParsed=!0;break}case 17:case 8191:break;default:E=U;break}}else L++;L>0&&Hp(this.observer,new Error(`Found ${L} TS packet/s that do not start with 0x47`),void 0,this.logger),o.pesData=m,c.pesData=S,d.pesData=y;const D={audioTrack:c,videoTrack:o,id3Track:d,textTrack:u};return n&&this.extractRemainingSamples(D),D}flush(){const{remainderData:e}=this;this.remainderData=null;let t;return e?t=this.demux(e,-1,!1,!0):t={videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t}extractRemainingSamples(e){const{audioTrack:t,videoTrack:s,id3Track:n,textTrack:r}=e,o=s.pesData,c=t.pesData,d=n.pesData;let u;if(o&&(u=Xo(o,this.logger))){if(this.videoParser===null)switch(s.segmentCodec){case"avc":this.videoParser=new N1;break;case"hevc":this.videoParser=new M1;break}this.videoParser!==null&&(this.videoParser.parsePES(s,r,u,!0),s.pesData=null)}else s.pesData=o;if(c&&(u=Xo(c,this.logger))){switch(t.segmentCodec){case"aac":this.parseAACPES(t,u);break;case"mp3":this.parseMPEGPES(t,u);break;case"ac3":this.parseAC3PES(t,u);break}t.pesData=null}else c!=null&&c.size&&this.logger.log("last AAC PES packet truncated,might overlap between fragments"),t.pesData=c;d&&(u=Xo(d,this.logger))?(this.parseID3PES(n,u),n.pesData=null):n.pesData=d}demuxSampleAes(e,t,s){const n=this.demux(e,s,!0,!this.config.progressive),r=this.sampleAes=new kN(this.observer,this.config,t);return this.decrypt(n,r)}decrypt(e,t){return new Promise(s=>{const{audioTrack:n,videoTrack:r}=e;n.samples&&n.segmentCodec==="aac"?t.decryptAacSamples(n.samples,0,()=>{r.samples?t.decryptAvcSamples(r.samples,0,0,()=>{s(e)}):s(e)}):r.samples&&t.decryptAvcSamples(r.samples,0,0,()=>{s(e)})})}destroy(){this.observer&&this.observer.removeAllListeners(),this.config=this.logger=this.observer=null,this.aacOverFlow=this.videoParser=this.remainderData=this.sampleAes=null,this._videoTrack=this._audioTrack=this._id3Track=this._txtTrack=void 0}parseAACPES(e,t){let s=0;const n=this.aacOverFlow;let r=t.data;if(n){this.aacOverFlow=null;const m=n.missing,p=n.sample.unit.byteLength;if(m===-1)r=Xi(n.sample.unit,r);else{const v=p-m;n.sample.unit.set(r.subarray(0,m),v),e.samples.push(n.sample),s=n.missing}}let o,c;for(o=s,c=r.length;o<c-1&&!Dh(r,o);o++);if(o!==s){let m;const p=o<c-1;if(p?m=`AAC PES did not start with ADTS header,offset:${o}`:m="No ADTS header found in AAC PES",Hp(this.observer,new Error(m),p,this.logger),!p)return}nI(e,this.observer,r,o,this.audioCodec);let d;if(t.pts!==void 0)d=t.pts;else if(n){const m=rI(e.samplerate);d=n.sample.pts+m}else{this.logger.warn("[tsdemuxer]: AAC PES unknown PTS");return}let u=0,f;for(;o<c;)if(f=aI(e,r,o,d,u),o+=f.length,f.missing){this.aacOverFlow=f;break}else for(u++;o<c-1&&!Dh(r,o);o++);}parseMPEGPES(e,t){const s=t.data,n=s.length;let r=0,o=0;const c=t.pts;if(c===void 0){this.logger.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;o<n;)if(dI(s,o)){const d=cI(e,s,o,c,r);if(d)o+=d.length,r++;else break}else o++}parseAC3PES(e,t){{const s=t.data,n=t.pts;if(n===void 0){this.logger.warn("[tsdemuxer]: AC3 PES unknown PTS");return}const r=s.length;let o=0,c=0,d;for(;c<r&&(d=mI(e,s,c,n,o++))>0;)c+=d}}parseID3PES(e,t){if(t.pts===void 0){this.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");return}const s=Ft({},t,{type:this._videoTrack?Ii.emsg:Ii.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(s)}}function Gp(i,e){return((i[e+1]&31)<<8)+i[e+2]}function NN(i,e){return(i[e+10]&31)<<8|i[e+11]}function MN(i,e,t,s,n,r){const o={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},c=(i[e+1]&15)<<8|i[e+2],d=e+3+c-4,u=(i[e+10]&15)<<8|i[e+11];for(e+=12+u;e<d;){const f=Gp(i,e),m=(i[e+3]&15)<<8|i[e+4];switch(i[e]){case 207:if(!s){jg("ADTS AAC",r);break}case 15:o.audioPid===-1&&(o.audioPid=f);break;case 21:o.id3Pid===-1&&(o.id3Pid=f);break;case 219:if(!s){jg("H.264",r);break}case 27:o.videoPid===-1&&(o.videoPid=f);break;case 3:case 4:!t.mpeg&&!t.mp3?r.log("MPEG audio found, not supported in this browser"):o.audioPid===-1&&(o.audioPid=f,o.segmentAudioCodec="mp3");break;case 193:if(!s){jg("AC-3",r);break}case 129:t.ac3?o.audioPid===-1&&(o.audioPid=f,o.segmentAudioCodec="ac3"):r.log("AC-3 audio found, not supported in this browser");break;case 6:if(o.audioPid===-1&&m>0){let p=e+5,v=m;for(;v>2;){switch(i[p]){case 106:t.ac3!==!0?r.log("AC-3 audio found, not supported in this browser for now"):(o.audioPid=f,o.segmentAudioCodec="ac3");break}const y=i[p+1]+2;p+=y,v-=y}}break;case 194:case 135:return Hp(n,new Error("Unsupported EC-3 in M2TS found"),void 0,r),o;case 36:o.videoPid===-1&&(o.videoPid=f,o.segmentVideoCodec="hevc",r.log("HEVC in M2TS found"));break}e+=m+5}return o}function Hp(i,e,t,s){s.warn(`parsing error: ${e.message}`),i.emit(w.ERROR,w.ERROR,{type:Ke.MEDIA_ERROR,details:se.FRAG_PARSING_ERROR,fatal:!1,levelRetry:t,error:e,reason:e.message})}function jg(i,e){e.log(`${i} with AES-128-CBC encryption found in unencrypted stream`)}function Xo(i,e){let t=0,s,n,r,o,c;const d=i.data;if(!i||i.size===0)return null;for(;d[0].length<19&&d.length>1;)d[0]=Xi(d[0],d[1]),d.splice(1,1);if(s=d[0],(s[0]<<16)+(s[1]<<8)+s[2]===1){if(n=(s[4]<<8)+s[5],n&&n>i.size-6)return null;const f=s[7];f&192&&(o=(s[9]&14)*536870912+(s[10]&255)*4194304+(s[11]&254)*16384+(s[12]&255)*128+(s[13]&254)/2,f&64?(c=(s[14]&14)*536870912+(s[15]&255)*4194304+(s[16]&254)*16384+(s[17]&255)*128+(s[18]&254)/2,o-c>60*9e4&&(e.warn(`${Math.round((o-c)/9e4)}s delta between PTS and DTS, align them`),o=c)):c=o),r=s[8];let m=r+9;if(i.size<=m)return null;i.size-=m;const p=new Uint8Array(i.size);for(let v=0,S=d.length;v<S;v++){s=d[v];let y=s.byteLength;if(m)if(m>y){m-=y;continue}else s=s.subarray(m),y-=m,m=0;p.set(s,t),t+=y}return n&&(n-=r+3),{data:p,pts:o,dts:c,len:n}}return null}class UN{static getSilentFrame(e,t){switch(e){case"mp4a.40.2":if(t===1)return new Uint8Array([0,200,0,128,35,128]);if(t===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(t===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(t===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(t===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(t===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(t===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}const zr=Math.pow(2,32)-1;class ee{static init(){ee.types={avc1:[],avcC:[],hvc1:[],hvcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let e;for(e in ee.types)ee.types.hasOwnProperty(e)&&(ee.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);const t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),s=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);ee.HDLR_TYPES={video:t,audio:s};const n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),r=new Uint8Array([0,0,0,0,0,0,0,0]);ee.STTS=ee.STSC=ee.STCO=r,ee.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),ee.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),ee.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),ee.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const o=new Uint8Array([105,115,111,109]),c=new Uint8Array([97,118,99,49]),d=new Uint8Array([0,0,0,1]);ee.FTYP=ee.box(ee.types.ftyp,o,d,o,c),ee.DINF=ee.box(ee.types.dinf,ee.box(ee.types.dref,n))}static box(e,...t){let s=8,n=t.length;const r=n;for(;n--;)s+=t[n].byteLength;const o=new Uint8Array(s);for(o[0]=s>>24&255,o[1]=s>>16&255,o[2]=s>>8&255,o[3]=s&255,o.set(e,4),n=0,s=8;n<r;n++)o.set(t[n],s),s+=t[n].byteLength;return o}static hdlr(e){return ee.box(ee.types.hdlr,ee.HDLR_TYPES[e])}static mdat(e){return ee.box(ee.types.mdat,e)}static mdhd(e,t){t*=e;const s=Math.floor(t/(zr+1)),n=Math.floor(t%(zr+1));return ee.box(ee.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,s>>24,s>>16&255,s>>8&255,s&255,n>>24,n>>16&255,n>>8&255,n&255,85,196,0,0]))}static mdia(e){return ee.box(ee.types.mdia,ee.mdhd(e.timescale||0,e.duration||0),ee.hdlr(e.type),ee.minf(e))}static mfhd(e){return ee.box(ee.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,e&255]))}static minf(e){return e.type==="audio"?ee.box(ee.types.minf,ee.box(ee.types.smhd,ee.SMHD),ee.DINF,ee.stbl(e)):ee.box(ee.types.minf,ee.box(ee.types.vmhd,ee.VMHD),ee.DINF,ee.stbl(e))}static moof(e,t,s){return ee.box(ee.types.moof,ee.mfhd(e),ee.traf(s,t))}static moov(e){let t=e.length;const s=[];for(;t--;)s[t]=ee.trak(e[t]);return ee.box.apply(null,[ee.types.moov,ee.mvhd(e[0].timescale||0,e[0].duration||0)].concat(s).concat(ee.mvex(e)))}static mvex(e){let t=e.length;const s=[];for(;t--;)s[t]=ee.trex(e[t]);return ee.box.apply(null,[ee.types.mvex,...s])}static mvhd(e,t){t*=e;const s=Math.floor(t/(zr+1)),n=Math.floor(t%(zr+1)),r=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,s>>24,s>>16&255,s>>8&255,s&255,n>>24,n>>16&255,n>>8&255,n&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return ee.box(ee.types.mvhd,r)}static sdtp(e){const t=e.samples||[],s=new Uint8Array(4+t.length);let n,r;for(n=0;n<t.length;n++)r=t[n].flags,s[n+4]=r.dependsOn<<4|r.isDependedOn<<2|r.hasRedundancy;return ee.box(ee.types.sdtp,s)}static stbl(e){return ee.box(ee.types.stbl,ee.stsd(e),ee.box(ee.types.stts,ee.STTS),ee.box(ee.types.stsc,ee.STSC),ee.box(ee.types.stsz,ee.STSZ),ee.box(ee.types.stco,ee.STCO))}static avc1(e){let t=[],s=[],n,r,o;for(n=0;n<e.sps.length;n++)r=e.sps[n],o=r.byteLength,t.push(o>>>8&255),t.push(o&255),t=t.concat(Array.prototype.slice.call(r));for(n=0;n<e.pps.length;n++)r=e.pps[n],o=r.byteLength,s.push(o>>>8&255),s.push(o&255),s=s.concat(Array.prototype.slice.call(r));const c=ee.box(ee.types.avcC,new Uint8Array([1,t[3],t[4],t[5],255,224|e.sps.length].concat(t).concat([e.pps.length]).concat(s))),d=e.width,u=e.height,f=e.pixelRatio[0],m=e.pixelRatio[1];return ee.box(ee.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,d>>8&255,d&255,u>>8&255,u&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),c,ee.box(ee.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),ee.box(ee.types.pasp,new Uint8Array([f>>24,f>>16&255,f>>8&255,f&255,m>>24,m>>16&255,m>>8&255,m&255])))}static esds(e){const t=e.config;return new Uint8Array([0,0,0,0,3,25,0,1,0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2,...t,6,1,2])}static audioStsd(e){const t=e.samplerate||0;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount||0,0,16,0,0,0,0,t>>8&255,t&255,0,0])}static mp4a(e){return ee.box(ee.types.mp4a,ee.audioStsd(e),ee.box(ee.types.esds,ee.esds(e)))}static mp3(e){return ee.box(ee.types[".mp3"],ee.audioStsd(e))}static ac3(e){return ee.box(ee.types["ac-3"],ee.audioStsd(e),ee.box(ee.types.dac3,e.config))}static stsd(e){const{segmentCodec:t}=e;if(e.type==="audio"){if(t==="aac")return ee.box(ee.types.stsd,ee.STSD,ee.mp4a(e));if(t==="ac3"&&e.config)return ee.box(ee.types.stsd,ee.STSD,ee.ac3(e));if(t==="mp3"&&e.codec==="mp3")return ee.box(ee.types.stsd,ee.STSD,ee.mp3(e))}else if(e.pps&&e.sps){if(t==="avc")return ee.box(ee.types.stsd,ee.STSD,ee.avc1(e));if(t==="hevc"&&e.vps)return ee.box(ee.types.stsd,ee.STSD,ee.hvc1(e))}else throw new Error("video track missing pps or sps");throw new Error(`unsupported ${e.type} segment codec (${t}/${e.codec})`)}static tkhd(e){const t=e.id,s=(e.duration||0)*(e.timescale||0),n=e.width||0,r=e.height||0,o=Math.floor(s/(zr+1)),c=Math.floor(s%(zr+1));return ee.box(ee.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,0,0,0,0,o>>24,o>>16&255,o>>8&255,o&255,c>>24,c>>16&255,c>>8&255,c&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,n>>8&255,n&255,0,0,r>>8&255,r&255,0,0]))}static traf(e,t){const s=ee.sdtp(e),n=e.id,r=Math.floor(t/(zr+1)),o=Math.floor(t%(zr+1));return ee.box(ee.types.traf,ee.box(ee.types.tfhd,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,n&255])),ee.box(ee.types.tfdt,new Uint8Array([1,0,0,0,r>>24,r>>16&255,r>>8&255,r&255,o>>24,o>>16&255,o>>8&255,o&255])),ee.trun(e,s.length+16+20+8+16+8+8),s)}static trak(e){return e.duration=e.duration||4294967295,ee.box(ee.types.trak,ee.tkhd(e),ee.mdia(e))}static trex(e){const t=e.id;return ee.box(ee.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,t){const s=e.samples||[],n=s.length,r=12+16*n,o=new Uint8Array(r);let c,d,u,f,m,p;for(t+=8+r,o.set([e.type==="video"?1:0,0,15,1,n>>>24&255,n>>>16&255,n>>>8&255,n&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255],0),c=0;c<n;c++)d=s[c],u=d.duration,f=d.size,m=d.flags,p=d.cts,o.set([u>>>24&255,u>>>16&255,u>>>8&255,u&255,f>>>24&255,f>>>16&255,f>>>8&255,f&255,m.isLeading<<2|m.dependsOn,m.isDependedOn<<6|m.hasRedundancy<<4|m.paddingValue<<1|m.isNonSync,m.degradPrio&61440,m.degradPrio&15,p>>>24&255,p>>>16&255,p>>>8&255,p&255],12+16*c);return ee.box(ee.types.trun,o)}static initSegment(e){ee.types||ee.init();const t=ee.moov(e);return Xi(ee.FTYP,t)}static hvc1(e){const t=e.params,s=[e.vps,e.sps,e.pps],n=4,r=new Uint8Array([1,t.general_profile_space<<6|(t.general_tier_flag?32:0)|t.general_profile_idc,t.general_profile_compatibility_flags[0],t.general_profile_compatibility_flags[1],t.general_profile_compatibility_flags[2],t.general_profile_compatibility_flags[3],t.general_constraint_indicator_flags[0],t.general_constraint_indicator_flags[1],t.general_constraint_indicator_flags[2],t.general_constraint_indicator_flags[3],t.general_constraint_indicator_flags[4],t.general_constraint_indicator_flags[5],t.general_level_idc,240|t.min_spatial_segmentation_idc>>8,255&t.min_spatial_segmentation_idc,252|t.parallelismType,252|t.chroma_format_idc,248|t.bit_depth_luma_minus8,248|t.bit_depth_chroma_minus8,0,parseInt(t.frame_rate.fps),n-1|t.temporal_id_nested<<2|t.num_temporal_layers<<3|(t.frame_rate.fixed?64:0),s.length]);let o=r.length;for(let S=0;S<s.length;S+=1){o+=3;for(let y=0;y<s[S].length;y+=1)o+=2+s[S][y].length}const c=new Uint8Array(o);c.set(r,0),o=r.length;const d=s.length-1;for(let S=0;S<s.length;S+=1){c.set(new Uint8Array([32+S|(S===d?128:0),0,s[S].length]),o),o+=3;for(let y=0;y<s[S].length;y+=1)c.set(new Uint8Array([s[S][y].length>>8,s[S][y].length&255]),o),o+=2,c.set(s[S][y],o),o+=s[S][y].length}const u=ee.box(ee.types.hvcC,c),f=e.width,m=e.height,p=e.pixelRatio[0],v=e.pixelRatio[1];return ee.box(ee.types.hvc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,f>>8&255,f&255,m>>8&255,m&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),u,ee.box(ee.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),ee.box(ee.types.pasp,new Uint8Array([p>>24,p>>16&255,p>>8&255,p&255,v>>24,v>>16&255,v>>8&255,v&255])))}}ee.types=void 0;ee.HDLR_TYPES=void 0;ee.STTS=void 0;ee.STSC=void 0;ee.STCO=void 0;ee.STSZ=void 0;ee.VMHD=void 0;ee.SMHD=void 0;ee.STSD=void 0;ee.FTYP=void 0;ee.DINF=void 0;const pI=9e4;function z0(i,e,t=1,s=!1){const n=i*e*t;return s?Math.round(n):n}function FN(i,e,t=1,s=!1){return z0(i,e,1/t,s)}function Pc(i,e=!1){return z0(i,1e3,1/pI,e)}function BN(i,e=1){return z0(i,pI,1/e)}const jN=10*1e3,VN=1024,$N=1152,GN=1536;let Wo=null,Vg=null;function U1(i,e,t,s){return{duration:e,size:t,cts:s,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:i?2:1,isNonSync:i?0:1}}}class oh{constructor(e,t,s,n){if(this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=e,this.config=t,this.typeSupported=s,this.logger=n,this.ISGenerated=!1,Wo===null){const o=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Wo=o?parseInt(o[1]):0}if(Vg===null){const r=navigator.userAgent.match(/Safari\/(\d+)/i);Vg=r?parseInt(r[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(e){this.logger.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=e}resetNextTimestamp(){this.logger.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){this.logger.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(e){let t=!1;const s=e[0].pts,n=e.reduce((r,o)=>{let c=o.pts,d=c-r;return d<-4294967296&&(t=!0,c=Hi(c,s),d=c-r),d>0?r:c},s);return t&&this.logger.debug("PTS rollover detected"),n}remux(e,t,s,n,r,o,c,d){let u,f,m,p,v,S,y=r,E=r;const A=e.pid>-1,R=t.pid>-1,I=t.samples.length,C=e.samples.length>0,L=c&&I>0||I>1;if((!A||C)&&(!R||L)||this.ISGenerated||c){if(this.ISGenerated){var _,M,U,F;const G=this.videoTrackConfig;(G&&(t.width!==G.width||t.height!==G.height||((_=t.pixelRatio)==null?void 0:_[0])!==((M=G.pixelRatio)==null?void 0:M[0])||((U=t.pixelRatio)==null?void 0:U[1])!==((F=G.pixelRatio)==null?void 0:F[1]))||!G&&L||this.nextAudioPts===null&&C)&&this.resetInitSegment()}this.ISGenerated||(m=this.generateIS(e,t,r,o));const z=this.isVideoContiguous;let V=-1,ae;if(L&&(V=HN(t.samples),!z&&this.config.forceKeyFrameOnDiscontinuity))if(S=!0,V>0){this.logger.warn(`[mp4-remuxer]: Dropped ${V} out of ${I} video samples due to a missing keyframe`);const G=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(V),t.dropped+=V,E+=(t.samples[0].pts-G)/t.inputTimeScale,ae=E}else V===-1&&(this.logger.warn(`[mp4-remuxer]: No keyframe found out of ${I} video samples`),S=!1);if(this.ISGenerated){if(C&&L){const G=this.getVideoStartPts(t.samples),B=(Hi(e.samples[0].pts,G)-G)/t.inputTimeScale;y+=Math.max(0,B),E+=Math.max(0,-B)}if(C){if(e.samplerate||(this.logger.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),m=this.generateIS(e,t,r,o)),f=this.remuxAudio(e,y,this.isAudioContiguous,o,R||L||d===ze.AUDIO?E:void 0),L){const G=f?f.endPTS-f.startPTS:0;t.inputTimeScale||(this.logger.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),m=this.generateIS(e,t,r,o)),u=this.remuxVideo(t,E,z,G)}}else L&&(u=this.remuxVideo(t,E,z,0));u&&(u.firstKeyFrame=V,u.independent=V!==-1,u.firstKeyFramePTS=ae)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(s.samples.length&&(v=yI(s,r,this._initPTS,this._initDTS)),n.samples.length&&(p=vI(n,r,this._initPTS))),{audio:f,video:u,initSegment:m,independent:S,text:p,id3:v}}generateIS(e,t,s,n){const r=e.samples,o=t.samples,c=this.typeSupported,d={},u=this._initPTS;let f=!u||n,m="audio/mp4",p,v,S,y;if(f&&(p=v=1/0),e.config&&r.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":c.mpeg?(m="audio/mpeg",e.codec=""):c.mp3&&(e.codec="mp3");break;case"ac3":e.codec="ac-3";break}d.audio={id:"audio",container:m,codec:e.codec,initSegment:e.segmentCodec==="mp3"&&c.mpeg?new Uint8Array(0):ee.initSegment([e]),metadata:{channelCount:e.channelCount}},f&&(y=e.id,S=e.inputTimeScale,!u||S!==u.timescale?p=v=r[0].pts-Math.round(S*s):f=!1)}if(t.sps&&t.pps&&o.length){if(t.timescale=t.inputTimeScale,d.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:ee.initSegment([t]),metadata:{width:t.width,height:t.height}},f)if(y=t.id,S=t.inputTimeScale,!u||S!==u.timescale){const E=this.getVideoStartPts(o),A=Math.round(S*s);v=Math.min(v,Hi(o[0].dts,E)-A),p=Math.min(p,E-A)}else f=!1;this.videoTrackConfig={width:t.width,height:t.height,pixelRatio:t.pixelRatio}}if(Object.keys(d).length)return this.ISGenerated=!0,f?(this._initPTS={baseTime:p,timescale:S},this._initDTS={baseTime:v,timescale:S}):p=S=void 0,{tracks:d,initPTS:p,timescale:S,trackId:y}}remuxVideo(e,t,s,n){const r=e.inputTimeScale,o=e.samples,c=[],d=o.length,u=this._initPTS;let f=this.nextAvcDts,m=8,p=this.videoSampleDuration,v,S,y=Number.POSITIVE_INFINITY,E=Number.NEGATIVE_INFINITY,A=!1;if(!s||f===null){const J=t*r,N=o[0].pts-Hi(o[0].dts,o[0].pts);Wo&&f!==null&&Math.abs(J-N-f)<15e3?s=!0:f=J-N}const R=u.baseTime*r/u.timescale;for(let J=0;J<d;J++){const N=o[J];N.pts=Hi(N.pts-R,f),N.dts=Hi(N.dts-R,f),N.dts<o[J>0?J-1:J].dts&&(A=!0)}A&&o.sort(function(J,N){const K=J.dts-N.dts,le=J.pts-N.pts;return K||le}),v=o[0].dts,S=o[o.length-1].dts;const I=S-v,C=I?Math.round(I/(d-1)):p||e.inputTimeScale/30;if(s){const J=v-f,N=J>C,K=J<-1;if((N||K)&&(N?this.logger.warn(`${(e.segmentCodec||"").toUpperCase()}: ${Pc(J,!0)} ms (${J}dts) hole between fragments detected at ${t.toFixed(3)}`):this.logger.warn(`${(e.segmentCodec||"").toUpperCase()}: ${Pc(-J,!0)} ms (${J}dts) overlapping between fragments detected at ${t.toFixed(3)}`),!K||f>=o[0].pts||Wo)){v=f;const le=o[0].pts-J;if(N)o[0].dts=v,o[0].pts=le;else{let H=!0;for(let ue=0;ue<o.length&&!(o[ue].dts>le&&H);ue++){const xe=o[ue].pts;if(o[ue].dts-=J,o[ue].pts-=J,ue<o.length-1){const fe=o[ue+1].pts,We=o[ue].pts,de=fe<=We,Be=fe<=xe;H=de==Be}}}this.logger.log(`Video: Initial PTS/DTS adjusted: ${Pc(le,!0)}/${Pc(v,!0)}, delta: ${Pc(J,!0)} ms`)}}v=Math.max(0,v);let L=0,D=0,_=v;for(let J=0;J<d;J++){const N=o[J],K=N.units,le=K.length;let H=0;for(let ue=0;ue<le;ue++)H+=K[ue].data.length;D+=H,L+=le,N.length=H,N.dts<_?(N.dts=_,_+=C/4|0||1):_=N.dts,y=Math.min(N.pts,y),E=Math.max(N.pts,E)}S=o[d-1].dts;const M=D+4*L+8;let U;try{U=new Uint8Array(M)}catch(J){this.observer.emit(w.ERROR,w.ERROR,{type:Ke.MUX_ERROR,details:se.REMUX_ALLOC_ERROR,fatal:!1,error:J,bytes:M,reason:`fail allocating video mdat ${M}`});return}const F=new DataView(U.buffer);F.setUint32(0,M),U.set(ee.types.mdat,4);let z=!1,V=Number.POSITIVE_INFINITY,ae=Number.POSITIVE_INFINITY,G=Number.NEGATIVE_INFINITY,Z=Number.NEGATIVE_INFINITY;for(let J=0;J<d;J++){const N=o[J],K=N.units;let le=0;for(let xe=0,fe=K.length;xe<fe;xe++){const We=K[xe],de=We.data,Be=We.data.byteLength;F.setUint32(m,Be),m+=4,U.set(de,m),m+=Be,le+=4+Be}let H;if(J<d-1)p=o[J+1].dts-N.dts,H=o[J+1].pts-N.pts;else{const xe=this.config,fe=J>0?N.dts-o[J-1].dts:C;if(H=J>0?N.pts-o[J-1].pts:C,xe.stretchShortVideoTrack&&this.nextAudioPts!==null){const We=Math.floor(xe.maxBufferHole*r),de=(n?y+n*r:this.nextAudioPts)-N.pts;de>We?(p=de-fe,p<0?p=fe:z=!0,this.logger.log(`[mp4-remuxer]: It is approximately ${de/90} ms to the next segment; using duration ${p/90} ms for the last video frame.`)):p=fe}else p=fe}const ue=Math.round(N.pts-N.dts);V=Math.min(V,p),G=Math.max(G,p),ae=Math.min(ae,H),Z=Math.max(Z,H),c.push(U1(N.key,p,le,ue))}if(c.length){if(Wo){if(Wo<70){const J=c[0].flags;J.dependsOn=2,J.isNonSync=0}}else if(Vg&&Z-ae<G-V&&C/G<.025&&c[0].cts===0){this.logger.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let J=v;for(let N=0,K=c.length;N<K;N++){const le=J+c[N].duration,H=J+c[N].cts;if(N<K-1){const ue=le+c[N+1].cts;c[N].duration=ue-H}else c[N].duration=N?c[N-1].duration:C;c[N].cts=0,J=le}}}p=z||!p?C:p,this.nextAvcDts=f=S+p,this.videoSampleDuration=p,this.isVideoContiguous=!0;const re={data1:ee.moof(e.sequenceNumber++,v,Ft(e,{samples:c})),data2:U,startPTS:y/r,endPTS:(E+p)/r,startDTS:v/r,endDTS:f/r,type:"video",hasAudio:!1,hasVideo:!0,nb:c.length,dropped:e.dropped};return e.samples=[],e.dropped=0,re}getSamplesPerFrame(e){switch(e.segmentCodec){case"mp3":return $N;case"ac3":return GN;default:return VN}}remuxAudio(e,t,s,n,r){const o=e.inputTimeScale,c=e.samplerate?e.samplerate:o,d=o/c,u=this.getSamplesPerFrame(e),f=u*d,m=this._initPTS,p=e.segmentCodec==="mp3"&&this.typeSupported.mpeg,v=[],S=r!==void 0;let y=e.samples,E=p?0:8,A=this.nextAudioPts||-1;const R=t*o,I=m.baseTime*o/m.timescale;if(this.isAudioContiguous=s=s||y.length&&A>0&&(n&&Math.abs(R-A)<9e3||Math.abs(Hi(y[0].pts-I,R)-A)<20*f),y.forEach(function(B){B.pts=Hi(B.pts-I,R)}),!s||A<0){if(y=y.filter(B=>B.pts>=0),!y.length)return;r===0?A=0:n&&!S?A=Math.max(0,R):A=y[0].pts}if(e.segmentCodec==="aac"){const B=this.config.maxAudioFramesDrift;for(let Q=0,re=A;Q<y.length;Q++){const J=y[Q],N=J.pts,K=N-re,le=Math.abs(1e3*K/o);if(K<=-B*f&&S)Q===0&&(this.logger.warn(`Audio frame @ ${(N/o).toFixed(3)}s overlaps nextAudioPts by ${Math.round(1e3*K/o)} ms.`),this.nextAudioPts=A=re=N);else if(K>=B*f&&le<jN&&S){let H=Math.round(K/f);re=N-H*f,re<0&&(H--,re+=f),Q===0&&(this.nextAudioPts=A=re),this.logger.warn(`[mp4-remuxer]: Injecting ${H} audio frame @ ${(re/o).toFixed(3)}s due to ${Math.round(1e3*K/o)} ms gap.`);for(let ue=0;ue<H;ue++){const xe=Math.max(re,0);let fe=UN.getSilentFrame(e.parsedCodec||e.manifestCodec||e.codec,e.channelCount);fe||(this.logger.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),fe=J.unit.subarray()),y.splice(Q,0,{unit:fe,pts:xe}),re+=f,Q++}}J.pts=re,re+=f}}let C=null,L=null,D,_=0,M=y.length;for(;M--;)_+=y[M].unit.byteLength;for(let B=0,Q=y.length;B<Q;B++){const re=y[B],J=re.unit;let N=re.pts;if(L!==null){const le=v[B-1];le.duration=Math.round((N-L)/d)}else if(s&&e.segmentCodec==="aac"&&(N=A),C=N,_>0){_+=E;try{D=new Uint8Array(_)}catch(le){this.observer.emit(w.ERROR,w.ERROR,{type:Ke.MUX_ERROR,details:se.REMUX_ALLOC_ERROR,fatal:!1,error:le,bytes:_,reason:`fail allocating audio mdat ${_}`});return}p||(new DataView(D.buffer).setUint32(0,_),D.set(ee.types.mdat,4))}else return;D.set(J,E);const K=J.byteLength;E+=K,v.push(U1(!0,u,K,0)),L=N}const U=v.length;if(!U)return;const F=v[v.length-1];this.nextAudioPts=A=L+d*F.duration;const z=p?new Uint8Array(0):ee.moof(e.sequenceNumber++,C/d,Ft({},e,{samples:v}));e.samples=[];const V=C/o,ae=A/o,Z={data1:z,data2:D,startPTS:V,endPTS:ae,startDTS:V,endDTS:ae,type:"audio",hasAudio:!0,hasVideo:!1,nb:U};return this.isAudioContiguous=!0,Z}}function Hi(i,e){let t;if(e===null)return i;for(e<i?t=-8589934592:t=8589934592;Math.abs(i-e)>4294967296;)i+=t;return i}function HN(i){for(let e=0;e<i.length;e++)if(i[e].key)return e;return-1}function yI(i,e,t,s){const n=i.samples.length;if(!n)return;const r=i.inputTimeScale;for(let c=0;c<n;c++){const d=i.samples[c];d.pts=Hi(d.pts-t.baseTime*r/t.timescale,e*r)/r,d.dts=Hi(d.dts-s.baseTime*r/s.timescale,e*r)/r}const o=i.samples;return i.samples=[],{samples:o}}function vI(i,e,t){const s=i.samples.length;if(!s)return;const n=i.inputTimeScale;for(let o=0;o<s;o++){const c=i.samples[o];c.pts=Hi(c.pts-t.baseTime*n/t.timescale,e*n)/n}i.samples.sort((o,c)=>o.pts-c.pts);const r=i.samples;return i.samples=[],{samples:r}}class zN{constructor(e,t,s,n){this.logger=void 0,this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null,this.isVideoContiguous=!1,this.logger=n}destroy(){}resetTimeStamp(e){this.initPTS=e,this.lastEndTime=null}resetNextTimestamp(){this.isVideoContiguous=!1,this.lastEndTime=null}resetInitSegment(e,t,s,n){this.audioCodec=t,this.videoCodec=s,this.generateInitSegment(B2(e,n)),this.emitInitSegment=!0}generateInitSegment(e){let{audioCodec:t,videoCodec:s}=this;if(!(e!=null&&e.byteLength)){this.initTracks=void 0,this.initData=void 0;return}const n=this.initData=LA(e);n.audio&&(t=F1(n.audio,zt.AUDIO,this.logger)),n.video&&(s=F1(n.video,zt.VIDEO,this.logger));const r={};n.audio&&n.video?r.audiovideo={container:"video/mp4",codec:t+","+s,supplemental:n.video.supplemental,initSegment:e,id:"main"}:n.audio?r.audio={container:"audio/mp4",codec:t,initSegment:e,id:"audio"}:n.video?r.video={container:"video/mp4",codec:s,supplemental:n.video.supplemental,initSegment:e,id:"main"}:this.logger.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=r}remux(e,t,s,n,r,o){var c,d;let{initPTS:u,lastEndTime:f}=this;const m={audio:void 0,video:void 0,text:n,id3:s,initSegment:void 0};Fe(f)||(f=this.lastEndTime=r||0);const p=t.samples;if(!(p!=null&&p.length))return m;const v={initPTS:void 0,timescale:void 0,trackId:void 0};let S=this.initData;if((c=S)!=null&&c.length||(this.generateInitSegment(p),S=this.initData),!((d=S)!=null&&d.length))return this.logger.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),m;this.emitInitSegment&&(v.tracks=this.initTracks,this.emitInitSegment=!1);const y=j2(p,S,this.logger),E=S.audio?y[S.audio.id]:null,A=S.video?y[S.video.id]:null,R=Hd(A,1/0),I=Hd(E,1/0),C=Hd(A,0,!0),L=Hd(E,0,!0);let D,_=r,M=0;if(E&&(!A||!u&&I<R||u&&u.trackId===S.audio.id)?(v.trackId=S.audio.id,D=E,M=L-I):A&&(v.trackId=S.video.id,D=A,M=C-R),D){const B=D.timescale;_=D.start/B,v.timescale=B,u||(v.initPTS=D.start-r*B,this.initPTS=u={baseTime:v.initPTS,timescale:B,trackId:v.trackId})}(o||!u)&&(KN(u,_,r,M)||v.timescale!==u.timescale)&&(v.initPTS=_-r,u&&u.timescale===1&&this.logger.warn(`Adjusting initPTS @${r} from ${u.baseTime/u.timescale} to ${v.initPTS}`),this.initPTS=u={baseTime:v.initPTS,timescale:1});const U=e?_-u.baseTime/u.timescale:f;V2(S,p,u.baseTime/u.timescale);const F=U+M;M>0?this.lastEndTime=F:(this.logger.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const z=!!S.audio,V=!!S.video;let ae="";z&&(ae+="audio"),V&&(ae+="video");const G={data1:p,startPTS:U,startDTS:U,endPTS:F,endDTS:F,type:ae,hasAudio:z,hasVideo:V,nb:1,dropped:0};m.audio=z&&!V?G:void 0,m.video=V?G:void 0;const Z=A==null?void 0:A.sampleCount;if(Z){const B=A.keyFrameIndex,Q=B!==-1;G.nb=Z,G.dropped=B===0||this.isVideoContiguous?0:Q?B:Z,G.independent=Q,G.firstKeyFrame=B,Q&&A.keyFrameStart&&(G.firstKeyFramePTS=A.keyFrameStart-u.baseTime/u.timescale),this.isVideoContiguous||(m.independent=Q),this.isVideoContiguous||(this.isVideoContiguous=Q),G.dropped&&this.logger.warn(`fmp4 does not start with IDR: firstIDR ${B}/${Z} dropped: ${G.dropped} pts: ${G.firstKeyFramePTS||"NA"}`)}return m.initSegment=v,m.id3=yI(s,r,u,u),n.samples.length&&(m.text=vI(n,r,u)),m}}function Hd(i,e,t=!1){return(i==null?void 0:i.start)!==void 0?(i.start+(t?i.duration:0))/i.timescale:e}function KN(i,e,t,s){if(i===null)return!0;const n=Math.max(s,1),r=e-i.baseTime/i.timescale;return Math.abs(r-t)>n}function F1(i,e,t){const s=i==null?void 0:i.codec;return s&&s.length>4?s:e===zt.AUDIO?s==="ec-3"||s==="ac-3"||s==="alac"?s:s==="fLaC"||s==="Opus"?Ah(s,!1):(t.warn(`Unhandled audio codec "${s}" in mp4 MAP`),s||"mp4a"):(t.warn(`Unhandled video codec "${s}" in mp4 MAP`),s||"avc1")}let or;try{or=self.performance.now.bind(self.performance)}catch{or=Date.now}const lh=[{demux:PN,remux:zN},{demux:Qr,remux:oh},{demux:CN,remux:oh},{demux:DN,remux:oh}];lh.splice(2,0,{demux:ON,remux:oh});class B1{constructor(e,t,s,n,r,o){this.asyncResult=!1,this.logger=void 0,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=s,this.id=r,this.logger=o}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,s,n){const r=s.transmuxing;r.executeStart=or();let o=new Uint8Array(e);const{currentTransmuxState:c,transmuxConfig:d}=this;n&&(this.currentTransmuxState=n);const{contiguous:u,discontinuity:f,trackSwitch:m,accurateTimeOffset:p,timeOffset:v,initSegmentChange:S}=n||c,{audioCodec:y,videoCodec:E,defaultInitPts:A,duration:R,initSegmentData:I}=d,C=YN(o,t);if(C&&tl(C.method)){const M=this.getDecrypter(),U=M0(C.method);if(M.isSync()){let F=M.softwareDecrypt(o,C.key.buffer,C.iv.buffer,U);if(s.part>-1){const V=M.flush();F=V&&V.buffer}if(!F)return r.executeEnd=or(),$g(s);o=new Uint8Array(F)}else return this.asyncResult=!0,this.decryptionPromise=M.webCryptoDecrypt(o,C.key.buffer,C.iv.buffer,U).then(F=>{const z=this.push(F,null,s);return this.decryptionPromise=null,z}),this.decryptionPromise}const L=this.needsProbing(f,m);if(L){const M=this.configureTransmuxer(o);if(M)return this.logger.warn(`[transmuxer] ${M.message}`),this.observer.emit(w.ERROR,w.ERROR,{type:Ke.MEDIA_ERROR,details:se.FRAG_PARSING_ERROR,fatal:!1,error:M,reason:M.message}),r.executeEnd=or(),$g(s)}(f||m||S||L)&&this.resetInitSegment(I,y,E,R,t),(f||S||L)&&this.resetInitialTimestamp(A),u||this.resetContiguity();const D=this.transmux(o,C,v,p,s);this.asyncResult=Jc(D);const _=this.currentTransmuxState;return _.contiguous=!0,_.discontinuity=!1,_.trackSwitch=!1,r.executeEnd=or(),D}flush(e){const t=e.transmuxing;t.executeStart=or();const{decrypter:s,currentTransmuxState:n,decryptionPromise:r}=this;if(r)return this.asyncResult=!0,r.then(()=>this.flush(e));const o=[],{timeOffset:c}=n;if(s){const m=s.flush();m&&o.push(this.push(m.buffer,null,e))}const{demuxer:d,remuxer:u}=this;if(!d||!u){t.executeEnd=or();const m=[$g(e)];return this.asyncResult?Promise.resolve(m):m}const f=d.flush(c);return Jc(f)?(this.asyncResult=!0,f.then(m=>(this.flushRemux(o,m,e),o))):(this.flushRemux(o,f,e),this.asyncResult?Promise.resolve(o):o)}flushRemux(e,t,s){const{audioTrack:n,videoTrack:r,id3Track:o,textTrack:c}=t,{accurateTimeOffset:d,timeOffset:u}=this.currentTransmuxState;this.logger.log(`[transmuxer.ts]: Flushed ${this.id} sn: ${s.sn}${s.part>-1?" part: "+s.part:""} of ${this.id===ze.MAIN?"level":"track"} ${s.level}`);const f=this.remuxer.remux(n,r,o,c,u,d,!0,this.id);e.push({remuxResult:f,chunkMeta:s}),s.transmuxing.executeEnd=or()}resetInitialTimestamp(e){const{demuxer:t,remuxer:s}=this;!t||!s||(t.resetTimeStamp(e),s.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:t}=this;!e||!t||(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,s,n,r){const{demuxer:o,remuxer:c}=this;!o||!c||(o.resetInitSegment(e,t,s,n),c.resetInitSegment(e,t,s,r))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,s,n,r){let o;return t&&t.method==="SAMPLE-AES"?o=this.transmuxSampleAes(e,t,s,n,r):o=this.transmuxUnencrypted(e,s,n,r),o}transmuxUnencrypted(e,t,s,n){const{audioTrack:r,videoTrack:o,id3Track:c,textTrack:d}=this.demuxer.demux(e,t,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(r,o,c,d,t,s,!1,this.id),chunkMeta:n}}transmuxSampleAes(e,t,s,n,r){return this.demuxer.demuxSampleAes(e,t,s).then(o=>({remuxResult:this.remuxer.remux(o.audioTrack,o.videoTrack,o.id3Track,o.textTrack,s,n,!1,this.id),chunkMeta:r}))}configureTransmuxer(e){const{config:t,observer:s,typeSupported:n}=this;let r;for(let m=0,p=lh.length;m<p;m++){var o;if((o=lh[m].demux)!=null&&o.probe(e,this.logger)){r=lh[m];break}}if(!r)return new Error("Failed to find demuxer by probing fragment data");const c=this.demuxer,d=this.remuxer,u=r.remux,f=r.demux;(!d||!(d instanceof u))&&(this.remuxer=new u(s,t,n,this.logger)),(!c||!(c instanceof f))&&(this.demuxer=new f(s,t,n,this.logger),this.probe=f.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new k0(this.config)),e}}function YN(i,e){let t=null;return i.byteLength>0&&(e==null?void 0:e.key)!=null&&e.iv!==null&&e.method!=null&&(t=e),t}const $g=i=>({remuxResult:{},chunkMeta:i});function Jc(i){return"then"in i&&i.then instanceof Function}class qN{constructor(e,t,s,n,r){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=s,this.duration=n,this.defaultInitPts=r||null}}class QN{constructor(e,t,s,n,r,o){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=s,this.trackSwitch=n,this.timeOffset=r,this.initSegmentChange=o}}let j1=0;class SI{constructor(e,t,s,n){this.error=null,this.hls=void 0,this.id=void 0,this.instanceNo=j1++,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.onWorkerMessage=d=>{const u=d.data,f=this.hls;if(!(!f||!(u!=null&&u.event)||u.instanceNo!==this.instanceNo))switch(u.event){case"init":{var m;const p=(m=this.workerContext)==null?void 0:m.objectURL;p&&self.URL.revokeObjectURL(p);break}case"transmuxComplete":{this.handleTransmuxComplete(u.data);break}case"flush":{this.onFlush(u.data);break}case"workerLog":{f.logger[u.data.logType]&&f.logger[u.data.logType](u.data.message);break}default:{u.data=u.data||{},u.data.frag=this.frag,u.data.part=this.part,u.data.id=this.id,f.trigger(u.event,u.data);break}}},this.onWorkerError=d=>{if(!this.hls)return;const u=new Error(`${d.message}  (${d.filename}:${d.lineno})`);this.hls.config.enableWorker=!1,this.hls.logger.warn(`Error in "${this.id}" Web Worker, fallback to inline`),this.hls.trigger(w.ERROR,{type:Ke.OTHER_ERROR,details:se.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:u})};const r=e.config;this.hls=e,this.id=t,this.useWorker=!!r.enableWorker,this.onTransmuxComplete=s,this.onFlush=n;const o=(d,u)=>{u=u||{},u.frag=this.frag||void 0,d===w.ERROR&&(u=u,u.parent=this.id,u.part=this.part,this.error=u.error),this.hls.trigger(d,u)};this.observer=new B0,this.observer.on(w.FRAG_DECRYPTED,o),this.observer.on(w.ERROR,o);const c=s1(r.preferManagedMediaSource);if(this.useWorker&&typeof Worker<"u"){const d=this.hls.logger;if(r.workerPath||tN()){try{r.workerPath?(d.log(`loading Web Worker ${r.workerPath} for "${t}"`),this.workerContext=iN(r.workerPath)):(d.log(`injecting Web Worker for "${t}"`),this.workerContext=sN());const{worker:f}=this.workerContext;f.addEventListener("message",this.onWorkerMessage),f.addEventListener("error",this.onWorkerError),f.postMessage({instanceNo:this.instanceNo,cmd:"init",typeSupported:c,id:t,config:es(r)})}catch(f){d.warn(`Error setting up "${t}" Web Worker, fallback to inline`,f),this.terminateWorker(),this.error=null,this.transmuxer=new B1(this.observer,c,r,"",t,e.logger)}return}}this.transmuxer=new B1(this.observer,c,r,"",t,e.logger)}reset(){if(this.frag=null,this.part=null,this.workerContext){const e=this.instanceNo;this.instanceNo=j1++;const t=this.hls.config,s=s1(t.preferManagedMediaSource);this.workerContext.worker.postMessage({instanceNo:this.instanceNo,cmd:"reset",resetNo:e,typeSupported:s,id:this.id,config:es(t)})}}terminateWorker(){if(this.workerContext){const{worker:e}=this.workerContext;this.workerContext=null,e.removeEventListener("message",this.onWorkerMessage),e.removeEventListener("error",this.onWorkerError),nN(this.hls.config.workerPath)}}destroy(){if(this.workerContext)this.terminateWorker(),this.onWorkerMessage=this.onWorkerError=null;else{const t=this.transmuxer;t&&(t.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.part=null,this.observer=null,this.hls=null}push(e,t,s,n,r,o,c,d,u,f){var m,p;u.transmuxing.start=self.performance.now();const{instanceNo:v,transmuxer:S}=this,y=o?o.start:r.start,E=r.decryptdata,A=this.frag,R=!(A&&r.cc===A.cc),I=!(A&&u.level===A.level),C=A?u.sn-A.sn:-1,L=this.part?u.part-this.part.index:-1,D=C===0&&u.id>1&&u.id===(A==null?void 0:A.stats.chunkCount),_=!I&&(C===1||C===0&&(L===1||D&&L<=0)),M=self.performance.now();(I||C||r.stats.parsing.start===0)&&(r.stats.parsing.start=M),o&&(L||!_)&&(o.stats.parsing.start=M);const U=!(A&&((m=r.initSegment)==null?void 0:m.url)===((p=A.initSegment)==null?void 0:p.url)),F=new QN(R,_,d,I,y,U);if(!_||R||U){this.hls.logger.log(`[transmuxer-interface]: Starting new transmux session for ${r.type} sn: ${u.sn}${u.part>-1?" part: "+u.part:""} ${this.id===ze.MAIN?"level":"track"}: ${u.level} id: ${u.id}
        discontinuity: ${R}
        trackSwitch: ${I}
        contiguous: ${_}
        accurateTimeOffset: ${d}
        timeOffset: ${y}
        initSegmentChange: ${U}`);const z=new qN(s,n,t,c,f);this.configureTransmuxer(z)}if(this.frag=r,this.part=o,this.workerContext)this.workerContext.worker.postMessage({instanceNo:v,cmd:"demux",data:e,decryptdata:E,chunkMeta:u,state:F},e instanceof ArrayBuffer?[e]:[]);else if(S){const z=S.push(e,E,u,F);Jc(z)?z.then(V=>{this.handleTransmuxComplete(V)}).catch(V=>{this.transmuxerError(V,u,"transmuxer-interface push error")}):this.handleTransmuxComplete(z)}}flush(e){e.transmuxing.start=self.performance.now();const{instanceNo:t,transmuxer:s}=this;if(this.workerContext)this.workerContext.worker.postMessage({instanceNo:t,cmd:"flush",chunkMeta:e});else if(s){const n=s.flush(e);Jc(n)?n.then(r=>{this.handleFlushResult(r,e)}).catch(r=>{this.transmuxerError(r,e,"transmuxer-interface flush error")}):this.handleFlushResult(n,e)}}transmuxerError(e,t,s){this.hls&&(this.error=e,this.hls.trigger(w.ERROR,{type:Ke.MEDIA_ERROR,details:se.FRAG_PARSING_ERROR,chunkMeta:t,frag:this.frag||void 0,part:this.part||void 0,fatal:!1,error:e,err:e,reason:s}))}handleFlushResult(e,t){e.forEach(s=>{this.handleTransmuxComplete(s)}),this.onFlush(t)}configureTransmuxer(e){const{instanceNo:t,transmuxer:s}=this;this.workerContext?this.workerContext.worker.postMessage({instanceNo:t,cmd:"configure",config:e}):s&&s.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}const V1=100;class XN extends F0{constructor(e,t,s){super(e,t,s,"audio-stream-controller",ze.AUDIO),this.mainAnchor=null,this.mainFragLoading=null,this.audioOnly=!1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.resetItem()}resetItem(){this.mainDetails=this.mainAnchor=this.mainFragLoading=this.bufferedTrack=this.switchingTrack=this.waitingData=this.cachedTrackLoadedData=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(w.LEVEL_LOADED,this.onLevelLoaded,this),e.on(w.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(w.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(w.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(w.BUFFER_RESET,this.onBufferReset,this),e.on(w.BUFFER_CREATED,this.onBufferCreated,this),e.on(w.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(w.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(w.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(w.FRAG_LOADING,this.onFragLoading,this),e.on(w.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){const{hls:e}=this;e&&(super.unregisterListeners(),e.off(w.LEVEL_LOADED,this.onLevelLoaded,this),e.off(w.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(w.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(w.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(w.BUFFER_RESET,this.onBufferReset,this),e.off(w.BUFFER_CREATED,this.onBufferCreated,this),e.off(w.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(w.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(w.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(w.FRAG_LOADING,this.onFragLoading,this),e.off(w.FRAG_BUFFERED,this.onFragBuffered,this))}onInitPtsFound(e,{frag:t,id:s,initPTS:n,timescale:r}){if(s===ze.MAIN){const o=t.cc,c=this.fragCurrent;if(this.initPTS[o]={baseTime:n,timescale:r},this.log(`InitPTS for cc: ${o} found from main: ${n}/${r}`),this.mainAnchor=t,this.state===pe.WAITING_INIT_PTS){const d=this.waitingData;(!d&&!this.loadingParts||d&&d.frag.cc!==o)&&this.syncWithAnchor(t,d==null?void 0:d.frag)}else!this.hls.hasEnoughToStart&&c&&c.cc!==o?(c.abortRequests(),this.syncWithAnchor(t,c)):this.state===pe.IDLE&&this.tick()}}getLoadPosition(){return!this.startFragRequested&&this.nextLoadPosition>=0?this.nextLoadPosition:super.getLoadPosition()}syncWithAnchor(e,t){var s;const n=((s=this.mainFragLoading)==null?void 0:s.frag)||null;if(t&&(n==null?void 0:n.cc)===t.cc)return;const r=(n||e).cc,o=this.getLevelDetails(),c=this.getLoadPosition(),d=BA(o,r,c);d&&(this.log(`Waiting fragment cc (${t==null?void 0:t.cc}) cancelled because video is at cc ${e.cc}`),this.startFragRequested=!1,this.nextLoadPosition=d.start,this.resetLoadingState(),this.state===pe.IDLE&&this.doTickIdle())}startLoad(e,t){if(!this.levels){this.startPosition=e,this.state=pe.STOPPED;return}const s=this.lastCurrentTime;this.stopLoad(),this.setInterval(V1),s>0&&e===-1?(this.log(`Override startPosition with lastCurrentTime @${s.toFixed(3)}`),e=s,this.state=pe.IDLE):this.state=pe.WAITING_TRACK,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}doTick(){switch(this.state){case pe.IDLE:this.doTickIdle();break;case pe.WAITING_TRACK:{const{levels:t,trackId:s}=this,n=t==null?void 0:t[s],r=n==null?void 0:n.details;if(r&&!this.waitForLive(n)){if(this.waitForCdnTuneIn(r))break;this.state=pe.WAITING_INIT_PTS}break}case pe.FRAG_LOADING_WAITING_RETRY:{var e;const t=performance.now(),s=this.retryDate;if(!s||t>=s||(e=this.media)!=null&&e.seeking){const{levels:n,trackId:r}=this;this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded((n==null?void 0:n[r])||null),this.state=pe.IDLE}break}case pe.WAITING_INIT_PTS:{const t=this.waitingData;if(t){const{frag:s,part:n,cache:r,complete:o}=t,c=this.mainAnchor;if(this.initPTS[s.cc]!==void 0){this.waitingData=null,this.state=pe.FRAG_LOADING;const d=r.flush().buffer,u={frag:s,part:n,payload:d,networkDetails:null};this._handleFragmentLoadProgress(u),o&&super._handleFragmentLoadComplete(u)}else c&&c.cc!==t.frag.cc&&this.syncWithAnchor(c,t.frag)}else this.state=pe.IDLE}}this.onTickEnd()}resetLoadingState(){const e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null),super.resetLoadingState()}onTickEnd(){const{media:e}=this;e!=null&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){var e;const{hls:t,levels:s,media:n,trackId:r}=this,o=t.config;if(!this.buffering||!n&&!this.primaryPrefetch&&(this.startFragRequested||!o.startFragPrefetch)||!(s!=null&&s[r]))return;const c=s[r],d=c.details;if(!d||this.waitForLive(c)||this.waitForCdnTuneIn(d)){this.state=pe.WAITING_TRACK,this.startFragRequested=!1;return}const u=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&u&&(this.bufferFlushed=!1,this.afterBufferFlushed(u,zt.AUDIO,ze.AUDIO));const f=this.getFwdBufferInfo(u,ze.AUDIO);if(f===null)return;if(!this.switchingTrack&&this._streamEnded(f,d)){t.trigger(w.BUFFER_EOS,{type:"audio"}),this.state=pe.ENDED;return}const m=f.len,p=t.maxBufferLength,v=d.fragments,S=v[0].start,y=this.getLoadPosition(),E=this.flushing?y:f.end;if(this.switchingTrack&&n){const I=y;d.PTSKnown&&I<S&&(f.end>S||f.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),n.currentTime=S+.05)}if(m>=p&&!this.switchingTrack&&E<v[v.length-1].start)return;let A=this.getNextFragment(E,d);if(A&&this.isLoopLoading(A,E)&&(A=this.getNextFragmentLoopLoading(A,d,f,ze.MAIN,p)),!A){this.bufferFlushed=!0;return}let R=((e=this.mainFragLoading)==null?void 0:e.frag)||null;if(!this.audioOnly&&this.startFragRequested&&R&&Ds(A)&&!A.endList&&(!d.live||!this.loadingParts&&E<this.hls.liveSyncPosition)&&(this.fragmentTracker.getState(R)===Es.OK&&(this.mainFragLoading=R=null),R&&Ds(R))){if(A.start>R.end){const C=this.fragmentTracker.getFragAtPos(E,ze.MAIN);C&&C.end>R.end&&(R=C,this.mainFragLoading={frag:C,targetBufferTime:null})}if(A.start>R.end)return}this.loadFragment(A,c,E)}onMediaDetaching(e,t){this.bufferFlushed=this.flushing=!1,super.onMediaDetaching(e,t)}onAudioTracksUpdated(e,{audioTracks:t}){this.resetTransmuxer(),this.levels=t.map(s=>new qc(s))}onAudioTrackSwitching(e,t){const s=!!t.url;this.trackId=t.id;const{fragCurrent:n}=this;n&&(n.abortRequests(),this.removeUnbufferedFrags(n.start)),this.resetLoadingState(),s?(this.switchingTrack=t,this.flushAudioIfNeeded(t),this.state!==pe.STOPPED&&(this.setInterval(V1),this.state=pe.IDLE,this.tick())):(this.resetTransmuxer(),this.switchingTrack=null,this.bufferedTrack=t,this.clearInterval())}onManifestLoading(){super.onManifestLoading(),this.bufferFlushed=this.flushing=this.audioOnly=!1,this.resetItem(),this.trackId=-1}onLevelLoaded(e,t){this.mainDetails=t.details;const s=this.cachedTrackLoadedData;s&&(this.cachedTrackLoadedData=null,this.onAudioTrackLoaded(w.AUDIO_TRACK_LOADED,s))}onAudioTrackLoaded(e,t){var s;const{levels:n}=this,{details:r,id:o,groupId:c,track:d}=t;if(!n){this.warn(`Audio tracks reset while loading track ${o} "${d.name}" of "${c}"`);return}const u=this.mainDetails;if(!u||r.endCC>u.endCC||u.expired){this.cachedTrackLoadedData=t,this.state!==pe.STOPPED&&(this.state=pe.WAITING_TRACK);return}this.cachedTrackLoadedData=null,this.log(`Audio track ${o} "${d.name}" of "${c}" loaded [${r.startSN},${r.endSN}]${r.lastPartSn?`[part-${r.lastPartSn}-${r.lastPartIndex}]`:""},duration:${r.totalduration}`);const f=n[o];let m=0;if(r.live||(s=f.details)!=null&&s.live){if(this.checkLiveUpdate(r),r.deltaUpdateFailed)return;if(f.details){var p;m=this.alignPlaylists(r,f.details,(p=this.levelLastLoaded)==null?void 0:p.details)}r.alignedSliding||(JA(r,u),r.alignedSliding||Oh(r,u),m=r.fragmentStart)}f.details=r,this.levelLastLoaded=f,this.startFragRequested||this.setStartPosition(u,m),this.hls.trigger(w.AUDIO_TRACK_UPDATED,{details:r,id:o,groupId:t.groupId}),this.state===pe.WAITING_TRACK&&!this.waitForCdnTuneIn(r)&&(this.state=pe.IDLE),this.tick()}_handleFragmentLoadProgress(e){var t;const s=e.frag,{part:n,payload:r}=e,{config:o,trackId:c,levels:d}=this;if(!d){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${s.sn} of level ${s.level} will not be buffered`);return}const u=d[c];if(!u){this.warn("Audio track is undefined on fragment load progress");return}const f=u.details;if(!f){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(s.start);return}const m=o.defaultAudioCodec||u.audioCodec||"mp4a.40.2";let p=this.transmuxer;p||(p=this.transmuxer=new SI(this.hls,ze.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const v=this.initPTS[s.cc],S=(t=s.initSegment)==null?void 0:t.data;if(v!==void 0){const E=n?n.index:-1,A=E!==-1,R=new N0(s.level,s.sn,s.stats.chunkCount,r.byteLength,E,A);p.push(r,S,m,"",s,n,f.totalduration,!1,R,v)}else{this.log(`Unknown video PTS for cc ${s.cc}, waiting for video PTS before demuxing audio frag ${s.sn} of [${f.startSN} ,${f.endSN}],track ${c}`);const{cache:y}=this.waitingData=this.waitingData||{frag:s,part:n,cache:new eI,complete:!1};y.push(new Uint8Array(r)),this.state!==pe.STOPPED&&(this.state=pe.WAITING_INIT_PTS)}}_handleFragmentLoadComplete(e){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=null}onBufferCreated(e,t){this.bufferFlushed=this.flushing=!1;const s=t.tracks.audio;s&&(this.mediaBuffer=s.buffer||null)}onFragLoading(e,t){!this.audioOnly&&t.frag.type===ze.MAIN&&Ds(t.frag)&&(this.mainFragLoading=t,this.state===pe.IDLE&&this.tick())}onFragBuffered(e,t){const{frag:s,part:n}=t;if(s.type!==ze.AUDIO){!this.audioOnly&&s.type===ze.MAIN&&!s.elementaryStreams.video&&!s.elementaryStreams.audiovideo&&(this.audioOnly=!0,this.mainFragLoading=null);return}if(this.fragContextChanged(s)){this.warn(`Fragment ${s.sn}${n?" p: "+n.index:""} of level ${s.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if(Ds(s)){this.fragPrevious=s;const r=this.switchingTrack;r&&(this.bufferedTrack=r,this.switchingTrack=null,this.hls.trigger(w.AUDIO_TRACK_SWITCHED,_t({},r)))}this.fragBufferedComplete(s,n),this.media&&this.tick()}onError(e,t){var s;if(t.fatal){this.state=pe.ERROR;return}switch(t.details){case se.FRAG_GAP:case se.FRAG_PARSING_ERROR:case se.FRAG_DECRYPT_ERROR:case se.FRAG_LOAD_ERROR:case se.FRAG_LOAD_TIMEOUT:case se.KEY_LOAD_ERROR:case se.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(ze.AUDIO,t);break;case se.AUDIO_TRACK_LOAD_ERROR:case se.AUDIO_TRACK_LOAD_TIMEOUT:case se.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===pe.WAITING_TRACK&&((s=t.context)==null?void 0:s.type)===gt.AUDIO_TRACK&&(this.state=pe.IDLE);break;case se.BUFFER_ADD_CODEC_ERROR:case se.BUFFER_APPEND_ERROR:if(t.parent!=="audio")return;this.resetLoadingState();break;case se.BUFFER_FULL_ERROR:if(t.parent!=="audio")return;this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case se.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onBufferFlushing(e,{type:t}){t!==zt.VIDEO&&(this.flushing=!0)}onBufferFlushed(e,{type:t}){if(t!==zt.VIDEO){this.flushing=!1,this.bufferFlushed=!0,this.state===pe.ENDED&&(this.state=pe.IDLE);const s=this.mediaBuffer||this.media;s&&(this.afterBufferFlushed(s,t,ze.AUDIO),this.tick())}}_handleTransmuxComplete(e){var t;const s="audio",{hls:n}=this,{remuxResult:r,chunkMeta:o}=e,c=this.getCurrentContext(o);if(!c){this.resetWhenMissingContext(o);return}const{frag:d,part:u,level:f}=c,{details:m}=f,{audio:p,text:v,id3:S,initSegment:y}=r;if(this.fragContextChanged(d)||!m){this.fragmentTracker.removeFragment(d);return}if(this.state=pe.PARSING,this.switchingTrack&&p&&this.completeAudioSwitch(this.switchingTrack),y!=null&&y.tracks){const E=d.initSegment||d;this._bufferInitSegment(f,y.tracks,E,o),n.trigger(w.FRAG_PARSING_INIT_SEGMENT,{frag:E,id:s,tracks:y.tracks})}if(p){const{startPTS:E,endPTS:A,startDTS:R,endDTS:I}=p;u&&(u.elementaryStreams[zt.AUDIO]={startPTS:E,endPTS:A,startDTS:R,endDTS:I}),d.setElementaryStreamInfo(zt.AUDIO,E,A,R,I),this.bufferFragmentData(p,d,u,o)}if(S!=null&&(t=S.samples)!=null&&t.length){const E=Ft({id:s,frag:d,details:m},S);n.trigger(w.FRAG_PARSING_METADATA,E)}if(v){const E=Ft({id:s,frag:d,details:m},v);n.trigger(w.FRAG_PARSING_USERDATA,E)}}_bufferInitSegment(e,t,s,n){if(this.state!==pe.PARSING||(t.video&&delete t.video,t.audiovideo&&delete t.audiovideo,!t.audio))return;const r=t.audio;r.id=ze.AUDIO;const o=e.audioCodec;this.log(`Init audio buffer, container:${r.container}, codecs[level/parsed]=[${o}/${r.codec}]`),o&&o.split(",").length===1&&(r.levelCodec=o),this.hls.trigger(w.BUFFER_CODECS,t);const c=r.initSegment;if(c!=null&&c.byteLength){const d={type:"audio",frag:s,part:null,chunkMeta:n,parent:s.type,data:c};this.hls.trigger(w.BUFFER_APPENDING,d)}this.tickImmediate()}loadFragment(e,t,s){const n=this.fragmentTracker.getState(e);if(this.switchingTrack||n===Es.NOT_LOADED||n===Es.PARTIAL){var r;if(!Ds(e))this._loadInitSegment(e,t);else if((r=t.details)!=null&&r.live&&!this.initPTS[e.cc]){this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=pe.WAITING_INIT_PTS;const o=this.mainDetails;o&&o.fragmentStart!==t.details.fragmentStart&&Oh(t.details,o)}else super.loadFragment(e,t,s)}else this.clearTrackerIfNeeded(e)}flushAudioIfNeeded(e){if(this.media&&this.bufferedTrack){const{name:t,lang:s,assocLang:n,characteristics:r,audioCodec:o,channels:c}=this.bufferedTrack;Ja({name:t,lang:s,assocLang:n,characteristics:r,audioCodec:o,channels:c},e,Ba)||(Rh(e.url,this.hls)?(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null):this.bufferedTrack=e)}}completeAudioSwitch(e){const{hls:t}=this;this.flushAudioIfNeeded(e),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(w.AUDIO_TRACK_SWITCHED,_t({},e))}}class K0 extends gr{constructor(e,t){super(t,e.logger),this.hls=void 0,this.canLoad=!1,this.timer=-1,this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){this.timer!==-1&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t,s){const n=t==null?void 0:t.renditionReports;if(n){let r=-1;for(let o=0;o<n.length;o++){const c=n[o];let d;try{d=new self.URL(c.URI,t.url).href}catch(u){this.warn(`Could not construct new URL for Rendition Report: ${u}`),d=c.URI||""}if(d===e){r=o;break}else d===e.substring(0,d.length)&&(r=o)}if(r!==-1){const o=n[r],c=parseInt(o["LAST-MSN"])||(t==null?void 0:t.lastPartSn);let d=parseInt(o["LAST-PART"])||(t==null?void 0:t.lastPartIndex);if(this.hls.config.lowLatencyMode){const f=Math.min(t.age-t.partTarget,t.targetduration);d>=0&&f>t.partTarget&&(d+=1)}const u=s&&n1(s);return new r1(c,d>=0?d:void 0,u)}}}loadPlaylist(e){this.clearTimer()}loadingPlaylist(e,t){this.clearTimer()}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}getUrlWithDirectives(e,t){if(t)try{return t.addDirectives(e)}catch(s){this.warn(`Could not construct new URL with HLS Delivery Directives: ${s}`)}return e}playlistLoaded(e,t,s){const{details:n,stats:r}=t,o=self.performance.now(),c=r.loading.first?Math.max(0,o-r.loading.first):0;n.advancedDateTime=Date.now()-c;const d=this.hls.config.timelineOffset;if(d!==n.appliedTimelineOffset){const f=Math.max(d||0,0);n.appliedTimelineOffset=f,n.fragments.forEach(m=>{m.start=m.playlistOffset+f})}if(n.live||s!=null&&s.live){const f="levelInfo"in t?t.levelInfo:t.track;if(n.reloaded(s),s&&n.fragments.length>0){zk(s,n);const R=n.playlistParsingError;if(R){this.warn(R);const I=this.hls;if(!I.config.ignorePlaylistParsingErrors){var u;const{networkDetails:C}=t;I.trigger(w.ERROR,{type:Ke.NETWORK_ERROR,details:se.LEVEL_PARSING_ERROR,fatal:!1,url:n.url,error:R,reason:R.message,level:t.level||void 0,parent:(u=n.fragments[0])==null?void 0:u.type,networkDetails:C,stats:r});return}n.playlistParsingError=null}}n.requestScheduled===-1&&(n.requestScheduled=r.loading.start);const m=this.hls.mainForwardBufferInfo,p=m?m.end-m.len:0,v=(n.edge-p)*1e3,S=qA(n,v);if(n.requestScheduled+S<o?n.requestScheduled=o:n.requestScheduled+=S,this.log(`live playlist ${e} ${n.advanced?"REFRESHED "+n.lastPartSn+"-"+n.lastPartIndex:n.updated?"UPDATED":"MISSED"}`),!this.canLoad||!n.live)return;let y,E,A;if(n.canBlockReload&&n.endSN&&n.advanced){const R=this.hls.config.lowLatencyMode,I=n.lastPartSn,C=n.endSN,L=n.lastPartIndex,D=L!==-1,_=I===C;D?_?(E=C+1,A=R?0:L):(E=I,A=R?L+1:n.maxPartIndex):E=C+1;const M=n.age,U=M+n.ageHeader;let F=Math.min(U-n.partTarget,n.targetduration*1.5);if(F>0){if(U>n.targetduration*3)this.log(`Playlist last advanced ${M.toFixed(2)}s ago. Omitting segment and part directives.`),E=void 0,A=void 0;else if(s!=null&&s.tuneInGoal&&U-n.partTarget>s.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${s.tuneInGoal} to: ${F} with playlist age: ${n.age}`),F=0;else{const z=Math.floor(F/n.targetduration);if(E+=z,A!==void 0){const V=Math.round(F%n.targetduration/n.partTarget);A+=V}this.log(`CDN Tune-in age: ${n.ageHeader}s last advanced ${M.toFixed(2)}s goal: ${F} skip sn ${z} to part ${A}`)}n.tuneInGoal=F}if(y=this.getDeliveryDirectives(n,t.deliveryDirectives,E,A),R||!_){n.requestScheduled=o,this.loadingPlaylist(f,y);return}}else(n.canBlockReload||n.canSkipUntil)&&(y=this.getDeliveryDirectives(n,t.deliveryDirectives,E,A));y&&E!==void 0&&n.canBlockReload&&(n.requestScheduled=r.loading.first+Math.max(S-c*2,S/2)),this.scheduleLoading(f,y,n)}else this.clearTimer()}scheduleLoading(e,t,s){const n=s||e.details;if(!n){this.loadingPlaylist(e,t);return}const r=self.performance.now(),o=n.requestScheduled;if(r>=o){this.loadingPlaylist(e,t);return}const c=o-r;this.log(`reload live playlist ${e.name||e.bitrate+"bps"} in ${Math.round(c)} ms`),this.clearTimer(),this.timer=self.setTimeout(()=>this.loadingPlaylist(e,t),c)}getDeliveryDirectives(e,t,s,n){let r=n1(e);return t!=null&&t.skip&&e.deltaUpdateFailed&&(s=t.msn,n=t.part,r=rh.No),new r1(s,n,r)}checkRetry(e){const t=e.details,s=Lh(e),n=e.errorAction,{action:r,retryCount:o=0,retryConfig:c}=n||{},d=!!n&&!!c&&(r===zs.RetryRequest||!n.resolved&&r===zs.SendAlternateToPenaltyBox);if(d){var u;if(o>=c.maxNumRetry)return!1;if(s&&(u=e.context)!=null&&u.deliveryDirectives)this.warn(`Retrying playlist loading ${o+1}/${c.maxNumRetry} after "${t}" without delivery-directives`),this.loadPlaylist();else{const f=P0(c,o);this.clearTimer(),this.timer=self.setTimeout(()=>this.loadPlaylist(),f),this.warn(`Retrying playlist loading ${o+1}/${c.maxNumRetry} after "${t}" in ${f}ms`)}e.levelRetry=!0,n.resolved=!0}return d}}function xI(i,e){if(i.length!==e.length)return!1;for(let t=0;t<i.length;t++)if(!eu(i[t].attrs,e[t].attrs))return!1;return!0}function eu(i,e,t){const s=i["STABLE-RENDITION-ID"];return s&&!t?s===e["STABLE-RENDITION-ID"]:!(t||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some(n=>i[n]!==e[n])}function zp(i,e){return e.label.toLowerCase()===i.name.toLowerCase()&&(!e.language||e.language.toLowerCase()===(i.lang||"").toLowerCase())}class WN extends K0{constructor(e){super(e,"audio-track-controller"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(w.MANIFEST_LOADING,this.onManifestLoading,this),e.on(w.MANIFEST_PARSED,this.onManifestParsed,this),e.on(w.LEVEL_LOADING,this.onLevelLoading,this),e.on(w.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(w.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(w.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(w.MANIFEST_LOADING,this.onManifestLoading,this),e.off(w.MANIFEST_PARSED,this.onManifestParsed,this),e.off(w.LEVEL_LOADING,this.onLevelLoading,this),e.off(w.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(w.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(w.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){const{id:s,groupId:n,details:r}=t,o=this.tracksInGroup[s];if(!o||o.groupId!==n){this.warn(`Audio track with id:${s} and group:${n} not found in active group ${o==null?void 0:o.groupId}`);return}const c=o.details;o.details=t.details,this.log(`Audio track ${s} "${o.name}" lang:${o.lang} group:${n} loaded [${r.startSN}-${r.endSN}]`),s===this.trackId&&this.playlistLoaded(s,t,c)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const s=t.audioGroups||null,n=this.groupIds;let r=this.currentTrack;if(!s||(n==null?void 0:n.length)!==(s==null?void 0:s.length)||s!=null&&s.some(c=>(n==null?void 0:n.indexOf(c))===-1)){this.groupIds=s,this.trackId=-1,this.currentTrack=null;const c=this.tracks.filter(p=>!s||s.indexOf(p.groupId)!==-1);if(c.length)this.selectDefaultTrack&&!c.some(p=>p.default)&&(this.selectDefaultTrack=!1),c.forEach((p,v)=>{p.id=v});else if(!r&&!this.tracksInGroup.length)return;this.tracksInGroup=c;const d=this.hls.config.audioPreference;if(!r&&d){const p=On(d,c,Ba);if(p>-1)r=c[p];else{const v=On(d,this.tracks);r=this.tracks[v]}}let u=this.findTrackId(r);u===-1&&r&&(u=this.findTrackId(null));const f={audioTracks:c};this.log(`Updating audio tracks, ${c.length} track(s) found in group(s): ${s==null?void 0:s.join(",")}`),this.hls.trigger(w.AUDIO_TRACKS_UPDATED,f);const m=this.trackId;if(u!==-1&&m===-1)this.setAudioTrack(u);else if(c.length&&m===-1){var o;const p=new Error(`No audio track selected for current audio group-ID(s): ${(o=this.groupIds)==null?void 0:o.join(",")} track count: ${c.length}`);this.warn(p.message),this.hls.trigger(w.ERROR,{type:Ke.MEDIA_ERROR,details:se.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:p})}}}onError(e,t){t.fatal||!t.context||t.context.type===gt.AUDIO_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&this.checkRetry(t)}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioOption(e){const t=this.hls;if(t.config.audioPreference=e,e){const s=this.allAudioTracks;if(this.selectDefaultTrack=!1,s.length){const n=this.currentTrack;if(n&&Ja(e,n,Ba))return n;const r=On(e,this.tracksInGroup,Ba);if(r>-1){const o=this.tracksInGroup[r];return this.setAudioTrack(r),o}else if(n){let o=t.loadLevel;o===-1&&(o=t.firstAutoLevel);const c=dk(e,t.levels,s,o,Ba);if(c===-1)return null;t.nextLoadLevel=c}if(e.channels||e.audioCodec){const o=On(e,s);if(o>-1)return s[o]}}}return null}setAudioTrack(e){const t=this.tracksInGroup;if(e<0||e>=t.length){this.warn(`Invalid audio track id: ${e}`);return}this.selectDefaultTrack=!1;const s=this.currentTrack,n=t[e],r=n.details&&!n.details.live;if(e===this.trackId&&n===s&&r||(this.log(`Switching to audio-track ${e} "${n.name}" lang:${n.lang} group:${n.groupId} channels:${n.channels}`),this.trackId=e,this.currentTrack=n,this.hls.trigger(w.AUDIO_TRACK_SWITCHING,_t({},n)),r))return;const o=this.switchParams(n.url,s==null?void 0:s.details,n.details);this.loadPlaylist(o)}findTrackId(e){const t=this.tracksInGroup;for(let s=0;s<t.length;s++){const n=t[s];if(!(this.selectDefaultTrack&&!n.default)&&(!e||Ja(e,n,Ba)))return s}if(e){const{name:s,lang:n,assocLang:r,characteristics:o,audioCodec:c,channels:d}=e;for(let u=0;u<t.length;u++){const f=t[u];if(Ja({name:s,lang:n,assocLang:r,characteristics:o,audioCodec:c,channels:d},f,Ba))return u}for(let u=0;u<t.length;u++){const f=t[u];if(eu(e.attrs,f.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return u}for(let u=0;u<t.length;u++){const f=t[u];if(eu(e.attrs,f.attrs,["LANGUAGE"]))return u}}return-1}loadPlaylist(e){super.loadPlaylist();const t=this.currentTrack;this.shouldLoadPlaylist(t)&&Rh(t.url,this.hls)&&this.scheduleLoading(t,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const s=e.id,n=e.groupId,r=this.getUrlWithDirectives(e.url,t),o=e.details,c=o==null?void 0:o.age;this.log(`Loading audio-track ${s} "${e.name}" lang:${e.lang} group:${n}${(t==null?void 0:t.msn)!==void 0?" at sn "+t.msn+" part "+t.part:""}${c&&o.live?" age "+c.toFixed(1)+(o.type&&" "+o.type||""):""} ${r}`),this.hls.trigger(w.AUDIO_TRACK_LOADING,{url:r,id:s,groupId:n,deliveryDirectives:t||null,track:e})}}class ZN{constructor(e){this.tracks=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.tracks=e}destroy(){this.tracks=this.queues=null}append(e,t,s){if(this.queues===null||this.tracks===null)return;const n=this.queues[t];n.push(e),n.length===1&&!s&&this.executeNext(t)}appendBlocker(e){return new Promise(t=>{const s={label:"async-blocker",execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.append(s,e)})}prependBlocker(e){return new Promise(t=>{if(this.queues){const s={label:"async-blocker-prepend",execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.queues[e].unshift(s)}})}removeBlockers(){this.queues!==null&&[this.queues.video,this.queues.audio,this.queues.audiovideo].forEach(e=>{var t;const s=(t=e[0])==null?void 0:t.label;(s==="async-blocker"||s==="async-blocker-prepend")&&(e[0].execute(),e.splice(0,1))})}unblockAudio(e){if(this.queues===null)return;this.queues.audio[0]===e&&this.shiftAndExecuteNext("audio")}executeNext(e){if(this.queues===null||this.tracks===null)return;const t=this.queues[e];if(t.length){const n=t[0];try{n.execute()}catch(r){var s;if(n.onError(r),this.queues===null||this.tracks===null)return;const o=(s=this.tracks[e])==null?void 0:s.buffer;o!=null&&o.updating||this.shiftAndExecuteNext(e)}}}shiftAndExecuteNext(e){this.queues!==null&&(this.queues[e].shift(),this.executeNext(e))}current(e){var t;return((t=this.queues)==null?void 0:t[e][0])||null}toString(){const{queues:e,tracks:t}=this;return e===null||t===null?"<destroyed>":`
${this.list("video")}
${this.list("audio")}
${this.list("audiovideo")}}`}list(e){var t,s;return(t=this.queues)!=null&&t[e]||(s=this.tracks)!=null&&s[e]?`${e}: (${this.listSbInfo(e)}) ${this.listOps(e)}`:""}listSbInfo(e){var t;const s=(t=this.tracks)==null?void 0:t[e],n=s==null?void 0:s.buffer;return n?`SourceBuffer${n.updating?" updating":""}${s.ended?" ended":""}${s.ending?" ending":""}`:"none"}listOps(e){var t;return((t=this.queues)==null?void 0:t[e].map(s=>s.label).join(", "))||""}}const $1=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/,TI="HlsJsTrackRemovedError";class JN extends Error{constructor(e){super(e),this.name=TI}}class eM extends gr{constructor(e,t){super("buffer-controller",e.logger),this.hls=void 0,this.fragmentTracker=void 0,this.details=null,this._objectUrl=null,this.operationQueue=null,this.bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.blockedAudioAppend=null,this.lastVideoAppendEnd=0,this.appendSource=void 0,this.transferData=void 0,this.overrides=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.sourceBuffers=[[null,null],[null,null]],this._onEndStreaming=s=>{var n;this.hls&&((n=this.mediaSource)==null?void 0:n.readyState)==="open"&&this.hls.pauseBuffering()},this._onStartStreaming=s=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=s=>{const{media:n,mediaSource:r}=this;s&&this.log("Media source opened"),!(!n||!r)&&(r.removeEventListener("sourceopen",this._onMediaSourceOpen),n.removeEventListener("emptied",this._onMediaEmptied),this.updateDuration(),this.hls.trigger(w.MEDIA_ATTACHED,{media:n,mediaSource:r}),this.mediaSource!==null&&this.checkPendingTracks())},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:s,_objectUrl:n}=this;s!==n&&this.error(`Media element src was set while attaching MediaSource (${n} > ${s})`)},this.hls=e,this.fragmentTracker=t,this.appendSource=C2(ca(e.config.preferManagedMediaSource)),this.initTracks(),this.registerListeners()}hasSourceTypes(){return Object.keys(this.tracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.transferData=this.overrides=void 0,this.operationQueue&&(this.operationQueue.destroy(),this.operationQueue=null),this.hls=this.fragmentTracker=null,this._onMediaSourceOpen=this._onMediaSourceClose=null,this._onMediaSourceEnded=null,this._onStartStreaming=this._onEndStreaming=null}registerListeners(){const{hls:e}=this;e.on(w.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(w.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(w.MANIFEST_LOADING,this.onManifestLoading,this),e.on(w.MANIFEST_PARSED,this.onManifestParsed,this),e.on(w.BUFFER_RESET,this.onBufferReset,this),e.on(w.BUFFER_APPENDING,this.onBufferAppending,this),e.on(w.BUFFER_CODECS,this.onBufferCodecs,this),e.on(w.BUFFER_EOS,this.onBufferEos,this),e.on(w.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(w.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(w.FRAG_PARSED,this.onFragParsed,this),e.on(w.FRAG_CHANGED,this.onFragChanged,this),e.on(w.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(w.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(w.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(w.MANIFEST_LOADING,this.onManifestLoading,this),e.off(w.MANIFEST_PARSED,this.onManifestParsed,this),e.off(w.BUFFER_RESET,this.onBufferReset,this),e.off(w.BUFFER_APPENDING,this.onBufferAppending,this),e.off(w.BUFFER_CODECS,this.onBufferCodecs,this),e.off(w.BUFFER_EOS,this.onBufferEos,this),e.off(w.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(w.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(w.FRAG_PARSED,this.onFragParsed,this),e.off(w.FRAG_CHANGED,this.onFragChanged,this),e.off(w.ERROR,this.onError,this)}transferMedia(){const{media:e,mediaSource:t}=this;if(!e)return null;const s={};if(this.operationQueue){const r=this.isUpdating();r||this.operationQueue.removeBlockers();const o=this.isQueued();(r||o)&&this.warn(`Transfering MediaSource with${o?" operations in queue":""}${r?" updating SourceBuffer(s)":""} ${this.operationQueue}`),this.operationQueue.destroy()}const n=this.transferData;return!this.sourceBufferCount&&n&&n.mediaSource===t?Ft(s,n.tracks):this.sourceBuffers.forEach(r=>{const[o]=r;o&&(s[o]=Ft({},this.tracks[o]),this.removeBuffer(o)),r[0]=r[1]=null}),{media:e,mediaSource:t,tracks:s}}initTracks(){const e={};this.sourceBuffers=[[null,null],[null,null]],this.tracks=e,this.resetQueue(),this.resetAppendErrors(),this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.lastVideoAppendEnd=0}onManifestLoading(){this.bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,t){var s;let n=2;(t.audio&&!t.video||!t.altAudio)&&(n=1),this.bufferCodecEventsTotal=n,this.log(`${n} bufferCodec event(s) expected.`),(s=this.transferData)!=null&&s.mediaSource&&this.sourceBufferCount&&n&&this.bufferCreated()}onMediaAttaching(e,t){const s=this.media=t.media,n=ca(this.appendSource);if(this.transferData=this.overrides=void 0,s&&n){const r=!!t.mediaSource;(r||t.overrides)&&(this.transferData=t,this.overrides=t.overrides);const o=this.mediaSource=t.mediaSource||new n;if(this.assignMediaSource(o),r)this._objectUrl=s.src,this.attachTransferred();else{const c=this._objectUrl=self.URL.createObjectURL(o);if(this.appendSource)try{s.removeAttribute("src");const d=self.ManagedMediaSource;s.disableRemotePlayback=s.disableRemotePlayback||d&&o instanceof d,G1(s),tM(s,c),s.load()}catch{s.src=c}else s.src=c}s.addEventListener("emptied",this._onMediaEmptied)}}assignMediaSource(e){var t,s;this.log(`${((t=this.transferData)==null?void 0:t.mediaSource)===e?"transferred":"created"} media source: ${(s=e.constructor)==null?void 0:s.name}`),e.addEventListener("sourceopen",this._onMediaSourceOpen),e.addEventListener("sourceended",this._onMediaSourceEnded),e.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(e.addEventListener("startstreaming",this._onStartStreaming),e.addEventListener("endstreaming",this._onEndStreaming))}attachTransferred(){const e=this.media,t=this.transferData;if(!t||!e)return;const s=this.tracks,n=t.tracks,r=n?Object.keys(n):null,o=r?r.length:0,c=()=>{this.media&&this.mediaSourceOpenOrEnded&&this._onMediaSourceOpen()};if(n&&r&&o){if(!this.tracksReady){this.hls.config.startFragPrefetch=!0,this.log("attachTransferred: waiting for SourceBuffer track info");return}if(this.log(`attachTransferred: (bufferCodecEventsTotal ${this.bufferCodecEventsTotal})
required tracks: ${es(s,(d,u)=>d==="initSegment"?void 0:u)};
transfer tracks: ${es(n,(d,u)=>d==="initSegment"?void 0:u)}}`),!TA(n,s)){t.mediaSource=null,t.tracks=void 0;const d=e.currentTime,u=this.details,f=Math.max(d,(u==null?void 0:u.fragments[0].start)||0);if(f-d>1){this.log(`attachTransferred: waiting for playback to reach new tracks start time ${d} -> ${f}`);return}this.warn(`attachTransferred: resetting MediaSource for incompatible tracks ("${Object.keys(n)}"->"${Object.keys(s)}") start time: ${f} currentTime: ${d}`),this.onMediaDetaching(w.MEDIA_DETACHING,{}),this.onMediaAttaching(w.MEDIA_ATTACHING,t),e.currentTime=f;return}this.transferData=void 0,r.forEach(d=>{const u=d,f=n[u];if(f){const m=f.buffer;if(m){const p=this.fragmentTracker,v=f.id;if(p.hasFragments(v)||p.hasParts(v)){const E=at.getBuffered(m);p.detectEvictedFragments(u,E,v,null,!0)}const S=Gg(u),y=[u,m];this.sourceBuffers[S]=y,m.updating&&this.operationQueue&&this.operationQueue.prependBlocker(u),this.trackSourceBuffer(u,f)}}}),c(),this.bufferCreated()}else this.log("attachTransferred: MediaSource w/o SourceBuffers"),c()}get mediaSourceOpenOrEnded(){var e;const t=(e=this.mediaSource)==null?void 0:e.readyState;return t==="open"||t==="ended"}onMediaDetaching(e,t){const s=!!t.transferMedia;this.transferData=this.overrides=void 0;const{media:n,mediaSource:r,_objectUrl:o}=this;if(r){if(this.log(`media source ${s?"transferring":"detaching"}`),s)this.sourceBuffers.forEach(([c])=>{c&&this.removeBuffer(c)}),this.resetQueue();else{if(this.mediaSourceOpenOrEnded){const c=r.readyState==="open";try{const d=r.sourceBuffers;for(let u=d.length;u--;)c&&d[u].abort(),r.removeSourceBuffer(d[u]);c&&r.endOfStream()}catch(d){this.warn(`onMediaDetaching: ${d.message} while calling endOfStream`)}}this.sourceBufferCount&&this.onBufferReset()}r.removeEventListener("sourceopen",this._onMediaSourceOpen),r.removeEventListener("sourceended",this._onMediaSourceEnded),r.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(r.removeEventListener("startstreaming",this._onStartStreaming),r.removeEventListener("endstreaming",this._onEndStreaming)),this.mediaSource=null,this._objectUrl=null}n&&(n.removeEventListener("emptied",this._onMediaEmptied),s||(o&&self.URL.revokeObjectURL(o),this.mediaSrc===o?(n.removeAttribute("src"),this.appendSource&&G1(n),n.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.media=null),this.hls.trigger(w.MEDIA_DETACHED,t)}onBufferReset(){this.sourceBuffers.forEach(([e])=>{e&&this.resetBuffer(e)}),this.initTracks()}resetBuffer(e){var t;const s=(t=this.tracks[e])==null?void 0:t.buffer;if(this.removeBuffer(e),s)try{var n;(n=this.mediaSource)!=null&&n.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(s)}catch(r){this.warn(`onBufferReset ${e}`,r)}delete this.tracks[e]}removeBuffer(e){this.removeBufferListeners(e),this.sourceBuffers[Gg(e)]=[null,null];const t=this.tracks[e];t&&(t.buffer=void 0)}resetQueue(){this.operationQueue&&this.operationQueue.destroy(),this.operationQueue=new ZN(this.tracks)}onBufferCodecs(e,t){const s=this.tracks,n=Object.keys(t);this.log(`BUFFER_CODECS: "${n}" (current SB count ${this.sourceBufferCount})`);const r="audiovideo"in t&&(s.audio||s.video)||s.audiovideo&&("audio"in t||"video"in t),o=!r&&this.sourceBufferCount&&this.media&&n.some(c=>!s[c]);if(r||o){this.warn(`Unsupported transition between "${Object.keys(s)}" and "${n}" SourceBuffers`);return}n.forEach(c=>{var d,u,f;const m=t[c],{id:p,codec:v,levelCodec:S,container:y,metadata:E,supplemental:A}=m;let R=s[c];const I=(d=this.transferData)==null||(u=d.tracks)==null?void 0:u[c],C=I!=null&&I.buffer?I:R,L=(C==null?void 0:C.pendingCodec)||(C==null?void 0:C.codec),D=C==null?void 0:C.levelCodec;R||(R=s[c]={buffer:void 0,listeners:[],codec:v,supplemental:A,container:y,levelCodec:S,metadata:E,id:p});const _=nh(L,D),M=_==null?void 0:_.replace($1,"$1");let U=nh(v,S);const F=(f=U)==null?void 0:f.replace($1,"$1");U&&_&&M!==F&&(c.slice(0,5)==="audio"&&(U=Ah(U,this.appendSource)),this.log(`switching codec ${L} to ${U}`),U!==(R.pendingCodec||R.codec)&&(R.pendingCodec=U),R.container=y,this.appendChangeType(c,y,U))}),(this.tracksReady||this.sourceBufferCount)&&(t.tracks=this.sourceBufferTracks),!this.sourceBufferCount&&this.mediaSourceOpenOrEnded&&this.checkPendingTracks()}get sourceBufferTracks(){return Object.keys(this.tracks).reduce((e,t)=>{const s=this.tracks[t];return e[t]={id:s.id,container:s.container,codec:s.codec,levelCodec:s.levelCodec},e},{})}appendChangeType(e,t,s){const n=`${t};codecs=${s}`,r={label:`change-type=${n}`,execute:()=>{const o=this.tracks[e];if(o){const c=o.buffer;c!=null&&c.changeType&&(this.log(`changing ${e} sourceBuffer type to ${n}`),c.changeType(n),o.codec=s,o.container=t)}this.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:o=>{this.warn(`Failed to change ${e} SourceBuffer type`,o)}};this.append(r,e,this.isPending(this.tracks[e]))}blockAudio(e){var t;const s=e.start,n=s+e.duration*.05;if(((t=this.fragmentTracker.getAppendedFrag(s,ze.MAIN))==null?void 0:t.gap)===!0)return;const o={label:"block-audio",execute:()=>{var c;const d=this.tracks.video;(this.lastVideoAppendEnd>n||d!=null&&d.buffer&&at.isBuffered(d.buffer,n)||((c=this.fragmentTracker.getAppendedFrag(n,ze.MAIN))==null?void 0:c.gap)===!0)&&(this.blockedAudioAppend=null,this.shiftAndExecuteNext("audio"))},onStart:()=>{},onComplete:()=>{},onError:c=>{this.warn("Error executing block-audio operation",c)}};this.blockedAudioAppend={op:o,frag:e},this.append(o,"audio",!0)}unblockAudio(){const{blockedAudioAppend:e,operationQueue:t}=this;e&&t&&(this.blockedAudioAppend=null,t.unblockAudio(e.op))}onBufferAppending(e,t){const{tracks:s}=this,{data:n,type:r,parent:o,frag:c,part:d,chunkMeta:u}=t,f=u.buffering[r],m=c.sn,p=self.performance.now();f.start=p;const v=c.stats.buffering,S=d?d.stats.buffering:null;v.start===0&&(v.start=p),S&&S.start===0&&(S.start=p);const y=s.audio;let E=!1;r==="audio"&&(y==null?void 0:y.container)==="audio/mpeg"&&(E=!this.lastMpegAudioChunk||u.id===1||this.lastMpegAudioChunk.sn!==u.sn,this.lastMpegAudioChunk=u);const A=this.tracks.video,R=A==null?void 0:A.buffer;if(R&&m!=="initSegment"){const L=d||c,D=this.blockedAudioAppend;if(r==="audio"&&o!=="main"&&!this.blockedAudioAppend){const M=L.start+L.duration*.05,U=R.buffered,F=this.currentOp("video");!U.length&&!F?this.blockAudio(L):!F&&!at.isBuffered(R,M)&&this.lastVideoAppendEnd<M&&this.blockAudio(L)}else if(r==="video"){const _=L.end;if(D){const M=D.frag.start;(_>M||_<this.lastVideoAppendEnd||at.isBuffered(R,M))&&this.unblockAudio()}this.lastVideoAppendEnd=_}}const I=(d||c).start,C={label:`append-${r}`,execute:()=>{if(f.executeStart=self.performance.now(),E){const L=this.tracks[r];if(L){const D=L.buffer;if(D){const _=I-D.timestampOffset;Math.abs(_)>=.1&&(this.log(`Updating audio SourceBuffer timestampOffset to ${I} (delta: ${_}) sn: ${m})`),D.timestampOffset=I)}}}this.appendExecutor(n,r)},onStart:()=>{},onComplete:()=>{const L=self.performance.now();f.executeEnd=f.end=L,v.first===0&&(v.first=L),S&&S.first===0&&(S.first=L);const D={};this.sourceBuffers.forEach(([_,M])=>{_&&(D[_]=at.getBuffered(M))}),this.appendErrors[r]=0,r==="audio"||r==="video"?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(w.BUFFER_APPENDED,{type:r,frag:c,part:d,chunkMeta:u,parent:c.type,timeRanges:D})},onError:L=>{var D;const _={type:Ke.MEDIA_ERROR,parent:c.type,details:se.BUFFER_APPEND_ERROR,sourceBufferName:r,frag:c,part:d,chunkMeta:u,error:L,err:L,fatal:!1},M=(D=this.media)==null?void 0:D.error;if(L.code===DOMException.QUOTA_EXCEEDED_ERR)_.details=se.BUFFER_FULL_ERROR;else if(L.code===DOMException.INVALID_STATE_ERR&&this.mediaSourceOpenOrEnded&&!M)_.errorAction=Qc(!0);else if(L.name===TI&&this.sourceBufferCount===0)_.errorAction=Qc(!0);else{const U=++this.appendErrors[r];this.warn(`Failed ${U}/${this.hls.config.appendErrorMaxRetry} times to append segment in "${r}" sourceBuffer (${M||"no media error"})`),(U>=this.hls.config.appendErrorMaxRetry||M)&&(_.fatal=!0)}this.hls.trigger(w.ERROR,_)}};this.append(C,r,this.isPending(this.tracks[r]))}getFlushOp(e,t,s){return this.log(`queuing "${e}" remove ${t}-${s}`),{label:"remove",execute:()=>{this.removeExecutor(e,t,s)},onStart:()=>{},onComplete:()=>{this.hls.trigger(w.BUFFER_FLUSHED,{type:e})},onError:n=>{this.warn(`Failed to remove ${t}-${s} from "${e}" SourceBuffer`,n)}}}onBufferFlushing(e,t){const{type:s,startOffset:n,endOffset:r}=t;s?this.append(this.getFlushOp(s,n,r),s):this.sourceBuffers.forEach(([o])=>{o&&this.append(this.getFlushOp(o,n,r),o)})}onFragParsed(e,t){const{frag:s,part:n}=t,r=[],o=n?n.elementaryStreams:s.elementaryStreams;o[zt.AUDIOVIDEO]?r.push("audiovideo"):(o[zt.AUDIO]&&r.push("audio"),o[zt.VIDEO]&&r.push("video"));const c=()=>{const d=self.performance.now();s.stats.buffering.end=d,n&&(n.stats.buffering.end=d);const u=n?n.stats:s.stats;this.hls.trigger(w.FRAG_BUFFERED,{frag:s,part:n,stats:u,id:s.type})};r.length===0&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${s.type} level: ${s.level} sn: ${s.sn}`),this.blockBuffers(c,r).catch(d=>{this.warn(`Fragment buffered callback ${d}`),this.stepOperationQueue(this.sourceBufferTypes)})}onFragChanged(e,t){this.trimBuffers()}get bufferedToEnd(){return this.sourceBufferCount>0&&!this.sourceBuffers.some(([e])=>{var t,s;return e&&(!((t=this.tracks[e])!=null&&t.ended)||((s=this.tracks[e])==null?void 0:s.ending))})}onBufferEos(e,t){var s;this.sourceBuffers.forEach(([o])=>{if(o){const c=this.tracks[o];(!t.type||t.type===o)&&(c.ending=!0,c.ended||(c.ended=!0,this.log(`${o} buffer reached EOS`)))}});const n=((s=this.overrides)==null?void 0:s.endOfStream)!==!1;this.sourceBufferCount>0&&!this.sourceBuffers.some(([o])=>{var c;return o&&!((c=this.tracks[o])!=null&&c.ended)})&&(n?(this.log("Queueing EOS"),this.blockUntilOpen(()=>{this.tracksEnded();const{mediaSource:o}=this;if(!o||o.readyState!=="open"){o&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${o.readyState}`);return}this.log("Calling mediaSource.endOfStream()"),o.endOfStream(),this.hls.trigger(w.BUFFERED_TO_END,void 0)})):(this.tracksEnded(),this.hls.trigger(w.BUFFERED_TO_END,void 0)))}tracksEnded(){this.sourceBuffers.forEach(([e])=>{if(e!==null){const t=this.tracks[e];t&&(t.ending=!1)}})}onLevelUpdated(e,{details:t}){t.fragments.length&&(this.details=t,this.updateDuration())}updateDuration(){const e=this.getDurationAndRange();e&&this.blockUntilOpen(()=>this.updateMediaSource(e))}onError(e,t){if(t.details===se.BUFFER_APPEND_ERROR&&t.frag){var s;const n=(s=t.errorAction)==null?void 0:s.nextAutoLevel;Fe(n)&&n!==t.frag.level&&this.resetAppendErrors()}}resetAppendErrors(){this.appendErrors={audio:0,video:0,audiovideo:0}}trimBuffers(){const{hls:e,details:t,media:s}=this;if(!s||t===null||!this.sourceBufferCount)return;const n=e.config,r=s.currentTime,o=t.levelTargetDuration,c=t.live&&n.liveBackBufferLength!==null?n.liveBackBufferLength:n.backBufferLength;if(Fe(c)&&c>=0){const d=Math.max(c,o),u=Math.floor(r/o)*o-d;this.flushBackBuffer(r,o,u)}if(Fe(n.frontBufferFlushThreshold)&&n.frontBufferFlushThreshold>0){const d=Math.max(n.maxBufferLength,n.frontBufferFlushThreshold),u=Math.max(d,o),f=Math.floor(r/o)*o+u;this.flushFrontBuffer(r,o,f)}}flushBackBuffer(e,t,s){this.sourceBuffers.forEach(([n,r])=>{if(r){const c=at.getBuffered(r);if(c.length>0&&s>c.start(0)){var o;this.hls.trigger(w.BACK_BUFFER_REACHED,{bufferEnd:s});const d=this.tracks[n];if((o=this.details)!=null&&o.live)this.hls.trigger(w.LIVE_BACK_BUFFER_REACHED,{bufferEnd:s});else if(d!=null&&d.ended){this.log(`Cannot flush ${n} back buffer while SourceBuffer is in ended state`);return}this.hls.trigger(w.BUFFER_FLUSHING,{startOffset:0,endOffset:s,type:n})}}})}flushFrontBuffer(e,t,s){this.sourceBuffers.forEach(([n,r])=>{if(r){const o=at.getBuffered(r),c=o.length;if(c<2)return;const d=o.start(c-1),u=o.end(c-1);if(s>d||e>=d&&e<=u)return;this.hls.trigger(w.BUFFER_FLUSHING,{startOffset:d,endOffset:1/0,type:n})}})}getDurationAndRange(){var e;const{details:t,mediaSource:s}=this;if(!t||!this.media||(s==null?void 0:s.readyState)!=="open")return null;const n=t.edge;if(t.live&&this.hls.config.liveDurationInfinity){if(t.fragments.length&&t.live&&s.setLiveSeekableRange){const u=Math.max(0,t.fragmentStart),f=Math.max(u,n);return{duration:1/0,start:u,end:f}}return{duration:1/0}}const r=(e=this.overrides)==null?void 0:e.duration;if(r)return Fe(r)?{duration:r}:null;const o=this.media.duration,c=Fe(s.duration)?s.duration:0;return n>c&&n>o||!Fe(o)?{duration:n}:null}updateMediaSource({duration:e,start:t,end:s}){const n=this.mediaSource;!this.media||!n||n.readyState!=="open"||(n.duration!==e&&(Fe(e)&&this.log(`Updating MediaSource duration to ${e.toFixed(3)}`),n.duration=e),t!==void 0&&s!==void 0&&(this.log(`MediaSource duration is set to ${n.duration}. Setting seekable range to ${t}-${s}.`),n.setLiveSeekableRange(t,s)))}get tracksReady(){const e=this.pendingTrackCount;return e>0&&(e>=this.bufferCodecEventsTotal||this.isPending(this.tracks.audiovideo))}checkPendingTracks(){const{bufferCodecEventsTotal:e,pendingTrackCount:t,tracks:s}=this;if(this.log(`checkPendingTracks (pending: ${t} codec events expected: ${e}) ${es(s)}`),this.tracksReady){var n;const r=(n=this.transferData)==null?void 0:n.tracks;r&&Object.keys(r).length?this.attachTransferred():this.createSourceBuffers()}}bufferCreated(){if(this.sourceBufferCount){const e={};this.sourceBuffers.forEach(([t,s])=>{if(t){const n=this.tracks[t];e[t]={buffer:s,container:n.container,codec:n.codec,supplemental:n.supplemental,levelCodec:n.levelCodec,id:n.id,metadata:n.metadata}}}),this.hls.trigger(w.BUFFER_CREATED,{tracks:e}),this.log(`SourceBuffers created. Running queue: ${this.operationQueue}`),this.sourceBuffers.forEach(([t])=>{this.executeNext(t)})}else{const e=new Error("could not create source buffer for media codec(s)");this.hls.trigger(w.ERROR,{type:Ke.MEDIA_ERROR,details:se.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:e,reason:e.message})}}createSourceBuffers(){const{tracks:e,sourceBuffers:t,mediaSource:s}=this;if(!s)throw new Error("createSourceBuffers called when mediaSource was null");for(const r in e){const o=r,c=e[o];if(this.isPending(c)){const d=this.getTrackCodec(c,o),u=`${c.container};codecs=${d}`;c.codec=d,this.log(`creating sourceBuffer(${u})${this.currentOp(o)?" Queued":""} ${es(c)}`);try{const f=s.addSourceBuffer(u),m=Gg(o),p=[o,f];t[m]=p,c.buffer=f}catch(f){var n;this.error(`error while trying to add sourceBuffer: ${f.message}`),this.shiftAndExecuteNext(o),(n=this.operationQueue)==null||n.removeBlockers(),delete this.tracks[o],this.hls.trigger(w.ERROR,{type:Ke.MEDIA_ERROR,details:se.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:f,sourceBufferName:o,mimeType:u,parent:c.id});return}this.trackSourceBuffer(o,c)}}this.bufferCreated()}getTrackCodec(e,t){const s=e.supplemental;let n=e.codec;s&&(t==="video"||t==="audiovideo")&&Up(s,"video")&&(n=W2(n,s));const r=nh(n,e.levelCodec);return r?t.slice(0,5)==="audio"?Ah(r,this.appendSource):r:""}trackSourceBuffer(e,t){const s=t.buffer;if(!s)return;const n=this.getTrackCodec(t,e);this.tracks[e]={buffer:s,codec:n,container:t.container,levelCodec:t.levelCodec,supplemental:t.supplemental,metadata:t.metadata,id:t.id,listeners:[]},this.removeBufferListeners(e),this.addBufferListener(e,"updatestart",this.onSBUpdateStart),this.addBufferListener(e,"updateend",this.onSBUpdateEnd),this.addBufferListener(e,"error",this.onSBUpdateError),this.appendSource&&this.addBufferListener(e,"bufferedchange",(r,o)=>{const c=o.removedRanges;c!=null&&c.length&&this.hls.trigger(w.BUFFER_FLUSHED,{type:r})})}get mediaSrc(){var e,t;const s=((e=this.media)==null||(t=e.querySelector)==null?void 0:t.call(e,"source"))||this.media;return s==null?void 0:s.src}onSBUpdateStart(e){const t=this.currentOp(e);t&&t.onStart()}onSBUpdateEnd(e){var t;if(((t=this.mediaSource)==null?void 0:t.readyState)==="closed"){this.resetBuffer(e);return}const s=this.currentOp(e);s&&(s.onComplete(),this.shiftAndExecuteNext(e))}onSBUpdateError(e,t){var s;const n=new Error(`${e} SourceBuffer error. MediaSource readyState: ${(s=this.mediaSource)==null?void 0:s.readyState}`);this.error(`${n}`,t),this.hls.trigger(w.ERROR,{type:Ke.MEDIA_ERROR,details:se.BUFFER_APPENDING_ERROR,sourceBufferName:e,error:n,fatal:!1});const r=this.currentOp(e);r&&r.onError(n)}removeExecutor(e,t,s){const{media:n,mediaSource:r}=this,o=this.tracks[e],c=o==null?void 0:o.buffer;if(!n||!r||!c){this.warn(`Attempting to remove from the ${e} SourceBuffer, but it does not exist`),this.shiftAndExecuteNext(e);return}const d=Fe(n.duration)?n.duration:1/0,u=Fe(r.duration)?r.duration:1/0,f=Math.max(0,t),m=Math.min(s,d,u);m>f&&(!o.ending||o.ended)?(o.ended=!1,this.log(`Removing [${f},${m}] from the ${e} SourceBuffer`),c.remove(f,m)):this.shiftAndExecuteNext(e)}appendExecutor(e,t){const s=this.tracks[t],n=s==null?void 0:s.buffer;if(!n)throw new JN(`Attempting to append to the ${t} SourceBuffer, but it does not exist`);s.ending=!1,s.ended=!1,n.appendBuffer(e)}blockUntilOpen(e){if(this.isUpdating()||this.isQueued())this.blockBuffers(e).catch(t=>{this.warn(`SourceBuffer blocked callback ${t}`),this.stepOperationQueue(this.sourceBufferTypes)});else try{e()}catch(t){this.warn(`Callback run without blocking ${this.operationQueue} ${t}`)}}isUpdating(){return this.sourceBuffers.some(([e,t])=>e&&t.updating)}isQueued(){return this.sourceBuffers.some(([e])=>e&&!!this.currentOp(e))}isPending(e){return!!e&&!e.buffer}blockBuffers(e,t=this.sourceBufferTypes){if(!t.length)return this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);const{operationQueue:s}=this,n=t.map(o=>this.appendBlocker(o));return t.length>1&&!!this.blockedAudioAppend&&this.unblockAudio(),Promise.all(n).then(o=>{s===this.operationQueue&&(e(),this.stepOperationQueue(this.sourceBufferTypes))})}stepOperationQueue(e){e.forEach(t=>{var s;const n=(s=this.tracks[t])==null?void 0:s.buffer;!n||n.updating||this.shiftAndExecuteNext(t)})}append(e,t,s){this.operationQueue&&this.operationQueue.append(e,t,s)}appendBlocker(e){if(this.operationQueue)return this.operationQueue.appendBlocker(e)}currentOp(e){return this.operationQueue?this.operationQueue.current(e):null}executeNext(e){e&&this.operationQueue&&this.operationQueue.executeNext(e)}shiftAndExecuteNext(e){this.operationQueue&&this.operationQueue.shiftAndExecuteNext(e)}get pendingTrackCount(){return Object.keys(this.tracks).reduce((e,t)=>e+(this.isPending(this.tracks[t])?1:0),0)}get sourceBufferCount(){return this.sourceBuffers.reduce((e,[t])=>e+(t?1:0),0)}get sourceBufferTypes(){return this.sourceBuffers.map(([e])=>e).filter(e=>!!e)}addBufferListener(e,t,s){const n=this.tracks[e];if(!n)return;const r=n.buffer;if(!r)return;const o=s.bind(this,e);n.listeners.push({event:t,listener:o}),r.addEventListener(t,o)}removeBufferListeners(e){const t=this.tracks[e];if(!t)return;const s=t.buffer;s&&(t.listeners.forEach(n=>{s.removeEventListener(n.event,n.listener)}),t.listeners.length=0)}}function G1(i){const e=i.querySelectorAll("source");[].slice.call(e).forEach(t=>{i.removeChild(t)})}function tM(i,e){const t=self.document.createElement("source");t.type="video/mp4",t.src=e,i.appendChild(t)}function Gg(i){return i==="audio"?1:0}class Y0{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on(w.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(w.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(w.MANIFEST_PARSED,this.onManifestParsed,this),e.on(w.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(w.BUFFER_CODECS,this.onBufferCodecs,this),e.on(w.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off(w.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(w.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(w.MANIFEST_PARSED,this.onManifestParsed,this),e.off(w.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(w.BUFFER_CODECS,this.onBufferCodecs,this),e.off(w.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){const s=this.hls.levels[t.droppedLevel];this.isLevelAllowed(s)&&this.restrictedLevels.push({bitrate:s.bitrate,height:s.height,width:s.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(e,t){const s=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,s.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onLevelsUpdated(e,t){this.timer&&Fe(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping(),this.media=null}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0){this.clientRect=null;return}const e=this.hls.levels;if(e.length){const t=this.hls,s=this.getMaxLevel(e.length-1);s!==this.autoLevelCapping&&t.logger.log(`Setting autoLevelCapping to ${s}: ${e[s].height}p@${e[s].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),t.autoLevelCapping=s,t.autoLevelEnabled&&t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(e){const t=this.hls.levels;if(!t.length)return-1;const s=t.filter((n,r)=>this.isLevelAllowed(n)&&r<=e);return this.clientRect=null,Y0.getMaxLevelByMediaSize(s,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,t={width:0,height:0};if(e){const s=e.getBoundingClientRect();t.width=s.width,t.height=s.height,!t.width&&!t.height&&(t.width=s.right-s.left||e.width||0,t.height=s.bottom-s.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch{}return Math.min(e,this.hls.config.maxDevicePixelRatio)}isLevelAllowed(e){return!this.restrictedLevels.some(s=>e.bitrate===s.bitrate&&e.width===s.width&&e.height===s.height)}static getMaxLevelByMediaSize(e,t,s){if(!(e!=null&&e.length))return-1;const n=(c,d)=>d?c.width!==d.width||c.height!==d.height:!0;let r=e.length-1;const o=Math.max(t,s);for(let c=0;c<e.length;c+=1){const d=e[c];if((d.width>=o||d.height>=o)&&n(d,e[c+1])){r=c;break}}return r}}const sM={MANIFEST:"m",AUDIO:"a",VIDEO:"v",MUXED:"av",INIT:"i",CAPTION:"c",TIMED_TEXT:"tt",KEY:"k",OTHER:"o"},ci=sM,iM={HLS:"h"},nM=iM,rM="CMCD-Object",aM="CMCD-Request",oM="CMCD-Session",lM="CMCD-Status",Mc={OBJECT:rM,REQUEST:aM,SESSION:oM,STATUS:lM},cM={[Mc.OBJECT]:["br","d","ot","tb"],[Mc.REQUEST]:["bl","dl","mtp","nor","nrr","su"],[Mc.SESSION]:["cid","pr","sf","sid","st","v"],[Mc.STATUS]:["bs","rtp"]};class xl{constructor(e,t){Array.isArray(e)&&(e=e.map(s=>s instanceof xl?s:new xl(s))),this.value=e,this.params=t}}const uM="Dict";function dM(i){return Array.isArray(i)?JSON.stringify(i):i instanceof Map?"Map{}":i instanceof Set?"Set{}":typeof i=="object"?JSON.stringify(i):String(i)}function hM(i,e,t,s){return new Error(`failed to ${i} "${dM(e)}" as ${t}`,{cause:s})}function Pn(i,e,t){return hM("serialize",i,e,t)}class EI{constructor(e){this.description=e}}const H1="Bare Item",fM="Boolean";function mM(i){if(typeof i!="boolean")throw Pn(i,fM);return i?"?1":"?0"}function gM(i){return btoa(String.fromCharCode(...i))}const pM="Byte Sequence";function yM(i){if(ArrayBuffer.isView(i)===!1)throw Pn(i,pM);return`:${gM(i)}:`}const vM="Integer";function SM(i){return i<-999999999999999||999999999999999<i}function bI(i){if(SM(i))throw Pn(i,vM);return i.toString()}function xM(i){return`@${bI(i.getTime()/1e3)}`}function AI(i,e){if(i<0)return-AI(-i,e);const t=Math.pow(10,e);if(Math.abs(i*t%1-.5)<Number.EPSILON){const n=Math.floor(i*t);return(n%2===0?n:n+1)/t}else return Math.round(i*t)/t}const TM="Decimal";function EM(i){const e=AI(i,3);if(Math.floor(Math.abs(e)).toString().length>12)throw Pn(i,TM);const t=e.toString();return t.includes(".")?t:`${t}.0`}const bM="String",AM=/[\x00-\x1f\x7f]+/;function IM(i){if(AM.test(i))throw Pn(i,bM);return`"${i.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}function RM(i){return i.description||i.toString().slice(7,-1)}const LM="Token";function z1(i){const e=RM(i);if(/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(e)===!1)throw Pn(e,LM);return e}function Kp(i){switch(typeof i){case"number":if(!Fe(i))throw Pn(i,H1);return Number.isInteger(i)?bI(i):EM(i);case"string":return IM(i);case"symbol":return z1(i);case"boolean":return mM(i);case"object":if(i instanceof Date)return xM(i);if(i instanceof Uint8Array)return yM(i);if(i instanceof EI)return z1(i);default:throw Pn(i,H1)}}const wM="Key";function Yp(i){if(/^[a-z*][a-z0-9\-_.*]*$/.test(i)===!1)throw Pn(i,wM);return i}function q0(i){return i==null?"":Object.entries(i).map(([e,t])=>t===!0?`;${Yp(e)}`:`;${Yp(e)}=${Kp(t)}`).join("")}function II(i){return i instanceof xl?`${Kp(i.value)}${q0(i.params)}`:Kp(i)}function CM(i){return`(${i.value.map(II).join(" ")})${q0(i.params)}`}function OM(i,e={whitespace:!0}){if(typeof i!="object")throw Pn(i,uM);const t=i instanceof Map?i.entries():Object.entries(i),s=e!=null&&e.whitespace?" ":"";return Array.from(t).map(([n,r])=>{r instanceof xl||(r=new xl(r));let o=Yp(n);return r.value===!0?o+=q0(r.params):(o+="=",Array.isArray(r.value)?o+=CM(r):o+=II(r)),o}).join(`,${s}`)}function DM(i,e){return OM(i,e)}function _M(i){return i==="ot"||i==="sf"||i==="st"}function PM(i){return typeof i=="number"?Fe(i):i!=null&&i!==""&&i!==!1}function kM(i,e){const t=new URL(i),s=new URL(e);if(t.origin!==s.origin)return i;const n=t.pathname.split("/").slice(1),r=s.pathname.split("/").slice(1,-1);for(;n[0]===r[0];)n.shift(),r.shift();for(;r.length;)r.shift(),n.unshift("..");return n.join("/")}const ch=i=>Math.round(i),NM=(i,e)=>(e!=null&&e.baseUrl&&(i=kM(i,e.baseUrl)),encodeURIComponent(i)),zd=i=>ch(i/100)*100,MM={br:ch,d:ch,bl:zd,dl:zd,mtp:zd,nor:NM,rtp:zd,tb:ch};function UM(i,e){const t={};if(i==null||typeof i!="object")return t;const s=Object.keys(i).sort(),n=Ft({},MM,e==null?void 0:e.formatters),r=e==null?void 0:e.filter;return s.forEach(o=>{if(r!=null&&r(o))return;let c=i[o];const d=n[o];d&&(c=d(c,e)),!(o==="v"&&c===1)&&(o=="pr"&&c===1||PM(c)&&(_M(o)&&typeof c=="string"&&(c=new EI(c)),t[o]=c))}),t}function RI(i,e={}){return i?DM(UM(i,e),Ft({whitespace:!1},e)):""}function FM(i,e={}){const t={};if(!i)return t;const s=Object.entries(i),n=Object.entries(cM).concat(Object.entries((e==null?void 0:e.customHeaderMap)||{})),r=s.reduce((o,c)=>{var d,u;const[f,m]=c,p=((d=n.find(v=>v[1].includes(f)))===null||d===void 0?void 0:d[0])||Mc.REQUEST;return(u=o[p])!==null&&u!==void 0||(o[p]={}),o[p][f]=m,o},{});return Object.entries(r).reduce((o,[c,d])=>(o[c]=RI(d,e),o),t)}function BM(i,e,t){return Ft(i,FM(e,t))}const jM="CMCD";function VM(i,e={}){if(!i)return"";const t=RI(i,e);return`${jM}=${encodeURIComponent(t)}`}const K1=/CMCD=[^&#]+/;function $M(i,e,t){const s=VM(e,t);if(!s)return i;if(K1.test(i))return i.replace(K1,s);const n=i.includes("?")?"&":"?";return`${i}${n}${s}`}class GM{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=n=>{try{this.apply(n,{ot:ci.MANIFEST,su:!this.initialized})}catch(r){this.hls.logger.warn("Could not generate manifest CMCD data.",r)}},this.applyFragmentData=n=>{try{const{frag:r,part:o}=n,c=this.hls.levels[r.level],d=this.getObjectType(r),u={d:(o||r).duration*1e3,ot:d};(d===ci.VIDEO||d===ci.AUDIO||d==ci.MUXED)&&(u.br=c.bitrate/1e3,u.tb=this.getTopBandwidth(d)/1e3,u.bl=this.getBufferLength(d));const f=o?this.getNextPart(o):this.getNextFrag(r);f!=null&&f.url&&f.url!==r.url&&(u.nor=f.url),this.apply(n,u)}catch(r){this.hls.logger.warn("Could not generate segment CMCD data.",r)}},this.hls=e;const t=this.config=e.config,{cmcd:s}=t;s!=null&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=s.sessionId||e.sessionId,this.cid=s.contentId,this.useHeaders=s.useHeaders===!0,this.includeKeys=s.includeKeys,this.registerListeners())}registerListeners(){const e=this.hls;e.on(w.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(w.MEDIA_DETACHED,this.onMediaDetached,this),e.on(w.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off(w.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(w.MEDIA_DETACHED,this.onMediaDetached,this),e.off(w.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=this.media=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,t){var s,n;this.audioBuffer=(s=t.tracks.audio)==null?void 0:s.buffer,this.videoBuffer=(n=t.tracks.video)==null?void 0:n.buffer}createData(){var e;return{v:1,sf:nM.HLS,sid:this.sid,cid:this.cid,pr:(e=this.media)==null?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,t={}){Ft(t,this.createData());const s=t.ot===ci.INIT||t.ot===ci.VIDEO||t.ot===ci.MUXED;this.starved&&s&&(t.bs=!0,t.su=!0,this.starved=!1),t.su==null&&(t.su=this.buffering);const{includeKeys:n}=this;n&&(t=Object.keys(t).reduce((o,c)=>(n.includes(c)&&(o[c]=t[c]),o),{}));const r={baseUrl:e.url};this.useHeaders?(e.headers||(e.headers={}),BM(e.headers,t,r)):e.url=$M(e.url,t,r)}getNextFrag(e){var t;const s=(t=this.hls.levels[e.level])==null?void 0:t.details;if(s){const n=e.sn-s.startSN;return s.fragments[n+1]}}getNextPart(e){var t,s;const{index:n,fragment:r}=e,o=(t=this.hls.levels[r.level])==null||(s=t.details)==null?void 0:s.partList;if(o){const{sn:c}=r;for(let d=o.length-1;d>=0;d--){const u=o[d];if(u.index===n&&u.fragment.sn===c)return o[d+1]}}}getObjectType(e){const{type:t}=e;if(t==="subtitle")return ci.TIMED_TEXT;if(e.sn==="initSegment")return ci.INIT;if(t==="audio")return ci.AUDIO;if(t==="main")return this.hls.audioTracks.length?ci.VIDEO:ci.MUXED}getTopBandwidth(e){let t=0,s;const n=this.hls;if(e===ci.AUDIO)s=n.audioTracks;else{const r=n.maxAutoLevel,o=r>-1?r+1:n.levels.length;s=n.levels.slice(0,o)}return s.forEach(r=>{r.bitrate>t&&(t=r.bitrate)}),t>0?t:NaN}getBufferLength(e){const t=this.media,s=e===ci.AUDIO?this.audioBuffer:this.videoBuffer;return!s||!t?NaN:at.bufferInfo(s,t.currentTime,this.config.maxBufferHole).len*1e3}createPlaylistLoader(){const{pLoader:e}=this.config,t=this.applyPlaylistData,s=e||this.config.loader;return class{constructor(r){this.loader=void 0,this.loader=new s(r)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(r,o,c){t(r),this.loader.load(r,o,c)}}}createFragmentLoader(){const{fLoader:e}=this.config,t=this.applyFragmentData,s=e||this.config.loader;return class{constructor(r){this.loader=void 0,this.loader=new s(r)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(r,o,c){t(r),this.loader.load(r,o,c)}}}}const HM=3e5;class zM extends gr{constructor(e){super("content-steering",e.logger),this.hls=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this._pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(w.MANIFEST_LOADING,this.onManifestLoading,this),e.on(w.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(w.MANIFEST_PARSED,this.onManifestParsed,this),e.on(w.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;e&&(e.off(w.MANIFEST_LOADING,this.onManifestLoading,this),e.off(w.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(w.MANIFEST_PARSED,this.onManifestParsed,this),e.off(w.ERROR,this.onError,this))}pathways(){return(this.levels||[]).reduce((e,t)=>(e.indexOf(t.pathwayId)===-1&&e.push(t.pathwayId),e),[])}get pathwayPriority(){return this._pathwayPriority}set pathwayPriority(e){this.updatePathwayPriority(e)}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const e=this.timeToLoad*1e3-(performance.now()-this.updated);if(e>0){this.scheduleRefresh(this.uri,e);return}}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){this.reloadTimer!==-1&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const t=this.levels;t&&(this.levels=t.filter(s=>s!==e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){const{contentSteering:s}=t;s!==null&&(this.pathwayId=s.pathwayId,this.uri=s.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){const{errorAction:s}=t;if((s==null?void 0:s.action)===zs.SendAlternateToPenaltyBox&&s.flags===sn.MoveAllAlternatesMatchingHost){const n=this.levels;let r=this._pathwayPriority,o=this.pathwayId;if(t.context){const{groupId:c,pathwayId:d,type:u}=t.context;c&&n?o=this.getPathwayForGroupId(c,u,o):d&&(o=d)}o in this.penalizedPathways||(this.penalizedPathways[o]=performance.now()),!r&&n&&(r=this.pathways()),r&&r.length>1&&(this.updatePathwayPriority(r),s.resolved=this.pathwayId!==o),s.resolved||this.warn(`Could not resolve ${t.details} ("${t.error.message}") with content-steering for Pathway: ${o} levels: ${n&&n.length} priorities: ${es(r)} penalized: ${es(this.penalizedPathways)}`)}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(t.length===0){const s=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${s}"`),t=this.getLevelsForPathway(s),this.pathwayId=s}return t.length!==e.length&&this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),t}getLevelsForPathway(e){return this.levels===null?[]:this.levels.filter(t=>e===t.pathwayId)}updatePathwayPriority(e){this._pathwayPriority=e;let t;const s=this.penalizedPathways,n=performance.now();Object.keys(s).forEach(r=>{n-s[r]>HM&&delete s[r]});for(let r=0;r<e.length;r++){const o=e[r];if(o in s)continue;if(o===this.pathwayId)return;const c=this.hls.nextLoadLevel,d=this.hls.levels[c];if(t=this.getLevelsForPathway(o),t.length>0){this.log(`Setting Pathway to "${o}"`),this.pathwayId=o,WA(t),this.hls.trigger(w.LEVELS_UPDATED,{levels:t});const u=this.hls.levels[c];d&&u&&this.levels&&(u.attrs["STABLE-VARIANT-ID"]!==d.attrs["STABLE-VARIANT-ID"]&&u.bitrate!==d.bitrate&&this.log(`Unstable Pathways change from bitrate ${d.bitrate} to ${u.bitrate}`),this.hls.nextLoadLevel=c);break}}}getPathwayForGroupId(e,t,s){const n=this.getLevelsForPathway(s).concat(this.levels||[]);for(let r=0;r<n.length;r++)if(t===gt.AUDIO_TRACK&&n[r].hasAudioGroup(e)||t===gt.SUBTITLE_TRACK&&n[r].hasSubtitleGroup(e))return n[r].pathwayId;return s}clonePathways(e){const t=this.levels;if(!t)return;const s={},n={};e.forEach(r=>{const{ID:o,"BASE-ID":c,"URI-REPLACEMENT":d}=r;if(t.some(f=>f.pathwayId===o))return;const u=this.getLevelsForPathway(c).map(f=>{const m=new is(f.attrs);m["PATHWAY-ID"]=o;const p=m.AUDIO&&`${m.AUDIO}_clone_${o}`,v=m.SUBTITLES&&`${m.SUBTITLES}_clone_${o}`;p&&(s[m.AUDIO]=p,m.AUDIO=p),v&&(n[m.SUBTITLES]=v,m.SUBTITLES=v);const S=LI(f.uri,m["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",d),y=new qc({attrs:m,audioCodec:f.audioCodec,bitrate:f.bitrate,height:f.height,name:f.name,url:S,videoCodec:f.videoCodec,width:f.width});if(f.audioGroups)for(let E=1;E<f.audioGroups.length;E++)y.addGroupId("audio",`${f.audioGroups[E]}_clone_${o}`);if(f.subtitleGroups)for(let E=1;E<f.subtitleGroups.length;E++)y.addGroupId("text",`${f.subtitleGroups[E]}_clone_${o}`);return y});t.push(...u),Y1(this.audioTracks,s,d,o),Y1(this.subtitleTracks,n,d,o)})}loadSteeringManifest(e){const t=this.hls.config,s=t.loader;this.loader&&this.loader.destroy(),this.loader=new s(t);let n;try{n=new self.URL(e)}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${e}`);return}if(n.protocol!=="data:"){const f=(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate)|0;n.searchParams.set("_HLS_pathway",this.pathwayId),n.searchParams.set("_HLS_throughput",""+f)}const r={responseType:"json",url:n.href},o=t.steeringManifestLoadPolicy.default,c=o.errorRetry||o.timeoutRetry||{},d={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:c.maxNumRetry||0,retryDelay:c.retryDelayMs||0,maxRetryDelay:c.maxRetryDelayMs||0},u={onSuccess:(f,m,p,v)=>{this.log(`Loaded steering manifest: "${n}"`);const S=f.data;if((S==null?void 0:S.VERSION)!==1){this.log(`Steering VERSION ${S.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=S.TTL;const{"RELOAD-URI":y,"PATHWAY-CLONES":E,"PATHWAY-PRIORITY":A}=S;if(y)try{this.uri=new self.URL(y,n).href}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${y}`);return}this.scheduleRefresh(this.uri||p.url),E&&this.clonePathways(E);const R={steeringManifest:S,url:n.toString()};this.hls.trigger(w.STEERING_MANIFEST_LOADED,R),A&&this.updatePathwayPriority(A)},onError:(f,m,p,v)=>{if(this.log(`Error loading steering manifest: ${f.code} ${f.text} (${m.url})`),this.stopLoad(),f.code===410){this.enabled=!1,this.log(`Steering manifest ${m.url} no longer available`);return}let S=this.timeToLoad*1e3;if(f.code===429){const y=this.loader;if(typeof(y==null?void 0:y.getResponseHeader)=="function"){const E=y.getResponseHeader("Retry-After");E&&(S=parseFloat(E)*1e3)}this.log(`Steering manifest ${m.url} rate limited`);return}this.scheduleRefresh(this.uri||m.url,S)},onTimeout:(f,m,p)=>{this.log(`Timeout loading steering manifest (${m.url})`),this.scheduleRefresh(this.uri||m.url)}};this.log(`Requesting steering manifest: ${n}`),this.loader.load(r,d,u)}scheduleRefresh(e,t=this.timeToLoad*1e3){this.clearTimeout(),this.reloadTimer=self.setTimeout(()=>{var s;const n=(s=this.hls)==null?void 0:s.media;if(n&&!n.ended){this.loadSteeringManifest(e);return}this.scheduleRefresh(e,this.timeToLoad*1e3)},t)}}function Y1(i,e,t,s){i&&Object.keys(e).forEach(n=>{const r=i.filter(o=>o.groupId===n).map(o=>{const c=Ft({},o);return c.details=void 0,c.attrs=new is(c.attrs),c.url=c.attrs.URI=LI(o.url,o.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",t),c.groupId=c.attrs["GROUP-ID"]=e[n],c.attrs["PATHWAY-ID"]=s,c});i.push(...r)})}function LI(i,e,t,s){const{HOST:n,PARAMS:r,[t]:o}=s;let c;e&&(c=o==null?void 0:o[e],c&&(i=c));const d=new self.URL(i);return n&&!c&&(d.host=n),r&&Object.keys(r).sort().forEach(u=>{u&&d.searchParams.set(u,r[u])}),d.href}function wi(i,e,t){zi(i,e,t),i.addEventListener(e,t)}function zi(i,e,t){i.removeEventListener(e,t)}class sl extends gr{constructor(e){super("eme",e.logger),this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.mediaKeys=null,this.setMediaKeysQueue=sl.CDMCleanupPromise?[sl.CDMCleanupPromise]:[],this.onMediaEncrypted=t=>{const{initDataType:s,initData:n}=t,r=`"${t.type}" event: init data type: "${s}"`;if(this.debug(r),n!==null){if(!this.keyFormatPromise){let o=Object.keys(this.keySystemAccessPromises);o.length||(o=Nc(this.config));const c=o.map(jd).filter(d=>!!d);this.keyFormatPromise=this.getKeyFormatPromise(c)}this.keyFormatPromise.then(o=>{const c=ah(o);let d,u;if(s==="sinf"){if(c!==Pt.FAIRPLAY){this.warn(`Ignoring unexpected "${t.type}" event with init data type: "${s}" for selected key-system ${c}`);return}const S=Ss(new Uint8Array(n));try{const y=U0(JSON.parse(S).sinf),E=wA(y);if(!E)throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");d=new Uint8Array(E.subarray(8,24)),u=Pt.FAIRPLAY}catch(y){this.warn(`${r} Failed to parse sinf: ${y}`);return}}else{if(c!==Pt.WIDEVINE&&c!==Pt.PLAYREADY){this.warn(`Ignoring unexpected "${t.type}" event with init data type: "${s}" for selected key-system ${c}`);return}const S=Y2(n),y=S.filter(A=>!!A.systemId&&Ng(A.systemId)===c);y.length>1&&this.warn(`${r} Using first of ${y.length} pssh found for selected key-system ${c}`);const E=y[0];if(!E){S.length===0||S.some(A=>!A.systemId)?this.warn(`${r} contains incomplete or invalid pssh data`):this.log(`ignoring ${r} for ${S.map(A=>Ng(A.systemId)).join(",")} pssh data in favor of playlist keys`);return}if(u=Ng(E.systemId),E.version===0&&E.data)if(u===Pt.WIDEVINE){const A=E.data.length-22;d=new Uint8Array(E.data.subarray(A,A+16))}else u===Pt.PLAYREADY&&(d=HA(E.data))}if(!u||!d)return;const f=An.hexDump(d),{keyIdToKeySessionPromise:m,mediaKeySessions:p}=this;let v=m[f];for(let S=0;S<p.length;S++){const y=p[S],E=y.decryptdata;if(!E.keyId)continue;const A=An.hexDump(E.keyId);if(f===A||E.uri.replace(/-/g,"").indexOf(f)!==-1){if(v=m[A],E.pssh)break;delete m[A],E.pssh=new Uint8Array(n),E.keyId=d,v=m[f]=v.then(()=>this.generateRequestWithPreferredKeySession(y,s,n,"encrypted-event-key-match")),v.catch(R=>this.handleError(R));break}}if(!v){if(u!==c){this.log(`Ignoring "${t.type}" event with ${u} init data for selected key-system ${c}`);return}v=m[f]=this.getKeySystemSelectionPromise([u]).then(({keySystem:S,mediaKeys:y})=>{var E;this.throwIfDestroyed();const A=new Xc("ISO-23001-7",f,(E=jd(S))!=null?E:"");return A.pssh=new Uint8Array(n),A.keyId=d,this.attemptSetMediaKeys(S,y).then(()=>{this.throwIfDestroyed();const R=this.createMediaKeySessionContext({decryptdata:A,keySystem:S,mediaKeys:y});return this.generateRequestWithPreferredKeySession(R,s,n,"encrypted-event-no-match")})}),v.catch(S=>this.handleError(S))}})}},this.onWaitingForKey=t=>{this.log(`"${t.type}" event`)},this.hls=e,this.config=e.config,this.registerListeners()}destroy(){this.onDestroying(),this.onMediaDetached();const e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.config=this.keyIdToKeySessionPromise=null,this.onMediaEncrypted=this.onWaitingForKey=null}registerListeners(){this.hls.on(w.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(w.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(w.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(w.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.on(w.DESTROYING,this.onDestroying,this)}unregisterListeners(){this.hls.off(w.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(w.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(w.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(w.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.off(w.DESTROYING,this.onDestroying,this)}getLicenseServerUrl(e){const{drmSystems:t,widevineLicenseUrl:s}=this.config,n=t[e];if(n)return n.licenseUrl;if(e===Pt.WIDEVINE&&s)return s}getLicenseServerUrlOrThrow(e){const t=this.getLicenseServerUrl(e);if(t===void 0)throw new Error(`no license server URL configured for key-system "${e}"`);return t}getServerCertificateUrl(e){const{drmSystems:t}=this.config,s=t[e];if(s)return s.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){const t=this.hls.levels,s=(o,c,d)=>!!o&&d.indexOf(o)===c,n=t.map(o=>o.audioCodec).filter(s),r=t.map(o=>o.videoCodec).filter(s);return n.length+r.length===0&&r.push("avc1.42e01e"),new Promise((o,c)=>{const d=u=>{const f=u.shift();this.getMediaKeysPromise(f,n,r).then(m=>o({keySystem:f,mediaKeys:m})).catch(m=>{u.length?d(u):m instanceof Vi?c(m):c(new Vi({type:Ke.KEY_SYSTEM_ERROR,details:se.KEY_SYSTEM_NO_ACCESS,error:m,fatal:!0},m.message))})};d(e)})}requestMediaKeySystemAccess(e,t){const{requestMediaKeySystemAccessFunc:s}=this.config;if(typeof s!="function"){let n=`Configured requestMediaKeySystemAccess is not a function ${s}`;return GA===null&&self.location.protocol==="http:"&&(n=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(n))}return s(e,t)}getMediaKeysPromise(e,t,s){const n=Uk(e,t,s,this.config.drmSystemOptions),r=this.keySystemAccessPromises[e];let o=r==null?void 0:r.keySystemAccess;if(!o){this.log(`Requesting encrypted media "${e}" key-system access with config: ${es(n)}`),o=this.requestMediaKeySystemAccess(e,n);const c=this.keySystemAccessPromises[e]={keySystemAccess:o};return o.catch(d=>{this.log(`Failed to obtain access to key-system "${e}": ${d}`)}),o.then(d=>{this.log(`Access for key-system "${d.keySystem}" obtained`);const u=this.fetchServerCertificate(e);return this.log(`Create media-keys for "${e}"`),c.mediaKeys=d.createMediaKeys().then(f=>(this.log(`Media-keys created for "${e}"`),c.hasMediaKeys=!0,u.then(m=>m?this.setMediaKeysServerCertificate(f,e,m):f))),c.mediaKeys.catch(f=>{this.error(`Failed to create media-keys for "${e}"}: ${f}`)}),c.mediaKeys})}return o.then(()=>r.mediaKeys)}createMediaKeySessionContext({decryptdata:e,keySystem:t,mediaKeys:s}){this.log(`Creating key-system session "${t}" keyId: ${An.hexDump(e.keyId||[])}`);const n=s.createSession(),r={decryptdata:e,keySystem:t,mediaKeys:s,mediaKeysSession:n,keyStatus:"status-pending"};return this.mediaKeySessions.push(r),r}renewKeySession(e){const t=e.decryptdata;if(t.pssh){const s=this.createMediaKeySessionContext(e),n=this.getKeyIdString(t),r="cenc";this.keyIdToKeySessionPromise[n]=this.generateRequestWithPreferredKeySession(s,r,t.pssh.buffer,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}getKeyIdString(e){if(!e)throw new Error("Could not read keyId of undefined decryptdata");if(e.keyId===null)throw new Error("keyId is null");return An.hexDump(e.keyId)}updateKeySession(e,t){var s;const n=e.mediaKeysSession;return this.log(`Updating key-session "${n.sessionId}" for keyID ${An.hexDump(((s=e.decryptdata)==null?void 0:s.keyId)||[])}
      } (data length: ${t&&t.byteLength})`),n.update(t)}getSelectedKeySystemFormats(){return Object.keys(this.keySystemAccessPromises).map(e=>({keySystem:e,hasMediaKeys:this.keySystemAccessPromises[e].hasMediaKeys})).filter(({hasMediaKeys:e})=>!!e).map(({keySystem:e})=>jd(e)).filter(e=>!!e)}getKeySystemAccess(e){return this.getKeySystemSelectionPromise(e).then(({keySystem:t,mediaKeys:s})=>this.attemptSetMediaKeys(t,s))}selectKeySystem(e){return new Promise((t,s)=>this.getKeySystemSelectionPromise(e).then(({keySystem:n})=>{const r=jd(n);r?t(r):s(new Error(`Unable to find format for key-system "${n}"`))}).catch(s))}selectKeySystemFormat(e){const t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${t.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise}getKeyFormatPromise(e){const t=Nc(this.config),s=e.map(ah).filter(n=>!!n&&t.indexOf(n)!==-1);return this.selectKeySystem(s)}loadKey(e){const t=e.keyInfo.decryptdata,s=this.getKeyIdString(t),n=`(keyId: ${s} format: "${t.keyFormat}" method: ${t.method} uri: ${t.uri})`;this.log(`Starting session for key ${n}`);let r=this.keyIdToKeySessionPromise[s];return r||(r=this.getKeySystemForKeyPromise(t).then(({keySystem:c,mediaKeys:d})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${n}`),this.attemptSetMediaKeys(c,d).then(()=>(this.throwIfDestroyed(),this.createMediaKeySessionContext({keySystem:c,mediaKeys:d,decryptdata:t}))))),(this.keyIdToKeySessionPromise[s]=r.then(c=>{const d="cenc",u=t.pssh?t.pssh.buffer:null;return this.generateRequestWithPreferredKeySession(c,d,u,"playlist-key")})).catch(c=>this.handleError(c))),r}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(e){this.hls&&(this.error(e.message),e instanceof Vi?this.hls.trigger(w.ERROR,e.data):this.hls.trigger(w.ERROR,{type:Ke.KEY_SYSTEM_ERROR,details:se.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0}))}getKeySystemForKeyPromise(e){const t=this.getKeyIdString(e),s=this.keyIdToKeySessionPromise[t];if(!s){const n=ah(e.keyFormat),r=n?[n]:Nc(this.config);return this.attemptKeySystemAccess(r)}return s}getKeySystemSelectionPromise(e){if(e.length||(e=Nc(this.config)),e.length===0)throw new Vi({type:Ke.KEY_SYSTEM_ERROR,details:se.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${es({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}attemptSetMediaKeys(e,t){if(this.mediaKeys===t)return Promise.resolve();const s=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);const n=Promise.all(s).then(()=>{if(!this.media)throw this.mediaKeys=null,new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(t)});return this.mediaKeys=t,this.setMediaKeysQueue.push(n),n.then(()=>{this.log(`Media-keys set for "${e}"`),s.push(n),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(r=>s.indexOf(r)===-1)})}generateRequestWithPreferredKeySession(e,t,s,n){var r,o;const c=(r=this.config.drmSystems)==null||(o=r[e.keySystem])==null?void 0:o.generateRequest;if(c)try{const S=c.call(this.hls,t,s,e);if(!S)throw new Error("Invalid response from configured generateRequest filter");t=S.initDataType,s=S.initData?S.initData:null,e.decryptdata.pssh=s?new Uint8Array(s):null}catch(S){var d;if(this.warn(S.message),(d=this.hls)!=null&&d.config.debug)throw S}if(s===null)return this.log(`Skipping key-session request for "${n}" (no initData)`),Promise.resolve(e);const u=this.getKeyIdString(e.decryptdata);this.log(`Generating key-session request for "${n}": ${u} (init data type: ${t} length: ${s?s.byteLength:null})`);const f=new B0,m=e._onmessage=S=>{const y=e.mediaKeysSession;if(!y){f.emit("error",new Error("invalid state"));return}const{messageType:E,message:A}=S;this.log(`"${E}" message event for session "${y.sessionId}" message size: ${A.byteLength}`),E==="license-request"||E==="license-renewal"?this.renewLicense(e,A).catch(R=>{f.eventNames().length?f.emit("error",R):this.handleError(R)}):E==="license-release"?e.keySystem===Pt.FAIRPLAY&&(this.updateKeySession(e,jp("acknowledged")),this.removeSession(e)):this.warn(`unhandled media key message type "${E}"`)},p=e._onkeystatuseschange=S=>{if(!e.mediaKeysSession){f.emit("error",new Error("invalid state"));return}this.onKeyStatusChange(e);const E=e.keyStatus;f.emit("keyStatus",E),E==="expired"&&(this.warn(`${e.keySystem} expired for key ${u}`),this.renewKeySession(e))};wi(e.mediaKeysSession,"message",m),wi(e.mediaKeysSession,"keystatuseschange",p);const v=new Promise((S,y)=>{f.on("error",y),f.on("keyStatus",E=>{E.startsWith("usable")?S():E==="output-restricted"?y(new Vi({type:Ke.KEY_SYSTEM_ERROR,details:se.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):E==="internal-error"?y(new Vi({type:Ke.KEY_SYSTEM_ERROR,details:se.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${E}"`)):E==="expired"?y(new Error("key expired while generating request")):this.warn(`unhandled key status change "${E}"`)})});return e.mediaKeysSession.generateRequest(t,s).then(()=>{var S;this.log(`Request generated for key-session "${(S=e.mediaKeysSession)==null?void 0:S.sessionId}" keyId: ${u}`)}).catch(S=>{throw new Vi({type:Ke.KEY_SYSTEM_ERROR,details:se.KEY_SYSTEM_NO_SESSION,error:S,fatal:!1},`Error generating key-session request: ${S}`)}).then(()=>v).catch(S=>{throw f.removeAllListeners(),this.removeSession(e),S}).then(()=>(f.removeAllListeners(),e))}onKeyStatusChange(e){e.mediaKeysSession.keyStatuses.forEach((t,s)=>{if(typeof s=="string"&&typeof t=="object"){const n=s;s=t,t=n}this.log(`key status change "${t}" for keyStatuses keyId: ${An.hexDump("buffer"in s?new Uint8Array(s.buffer,s.byteOffset,s.byteLength):new Uint8Array(s))} session keyId: ${An.hexDump(new Uint8Array(e.decryptdata.keyId||[]))} uri: ${e.decryptdata.uri}`),e.keyStatus=t})}fetchServerCertificate(e){const t=this.config,s=t.loader,n=new s(t),r=this.getServerCertificateUrl(e);return r?(this.log(`Fetching server certificate for "${e}"`),new Promise((o,c)=>{const d={responseType:"arraybuffer",url:r},u=t.certLoadPolicy.default,f={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},m={onSuccess:(p,v,S,y)=>{o(p.data)},onError:(p,v,S,y)=>{c(new Vi({type:Ke.KEY_SYSTEM_ERROR,details:se.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:S,response:_t({url:d.url,data:void 0},p)},`"${e}" certificate request failed (${r}). Status: ${p.code} (${p.text})`))},onTimeout:(p,v,S)=>{c(new Vi({type:Ke.KEY_SYSTEM_ERROR,details:se.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:S,response:{url:d.url,data:void 0}},`"${e}" certificate request timed out (${r})`))},onAbort:(p,v,S)=>{c(new Error("aborted"))}};n.load(d,f,m)})):Promise.resolve()}setMediaKeysServerCertificate(e,t,s){return new Promise((n,r)=>{e.setServerCertificate(s).then(o=>{this.log(`setServerCertificate ${o?"success":"not supported by CDM"} (${s==null?void 0:s.byteLength}) on "${t}"`),n(e)}).catch(o=>{r(new Vi({type:Ke.KEY_SYSTEM_ERROR,details:se.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:o,fatal:!0},o.message))})})}renewLicense(e,t){return this.requestLicense(e,new Uint8Array(t)).then(s=>this.updateKeySession(e,new Uint8Array(s)).catch(n=>{throw new Vi({type:Ke.KEY_SYSTEM_ERROR,details:se.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:n,fatal:!0},n.message)}))}unpackPlayReadyKeyMessage(e,t){const s=String.fromCharCode.apply(null,new Uint16Array(t.buffer));if(!s.includes("PlayReadyKeyMessage"))return e.setRequestHeader("Content-Type","text/xml; charset=utf-8"),t;const n=new DOMParser().parseFromString(s,"application/xml"),r=n.querySelectorAll("HttpHeader");if(r.length>0){let f;for(let m=0,p=r.length;m<p;m++){var o,c;f=r[m];const v=(o=f.querySelector("name"))==null?void 0:o.textContent,S=(c=f.querySelector("value"))==null?void 0:c.textContent;v&&S&&e.setRequestHeader(v,S)}}const d=n.querySelector("Challenge"),u=d==null?void 0:d.textContent;if(!u)throw new Error("Cannot find <Challenge> in key message");return jp(atob(u))}setupLicenseXHR(e,t,s,n){const r=this.config.licenseXhrSetup;return r?Promise.resolve().then(()=>{if(!s.decryptdata)throw new Error("Key removed");return r.call(this.hls,e,t,s,n)}).catch(o=>{if(!s.decryptdata)throw o;return e.open("POST",t,!0),r.call(this.hls,e,t,s,n)}).then(o=>(e.readyState||e.open("POST",t,!0),{xhr:e,licenseChallenge:o||n})):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:n}))}requestLicense(e,t){const s=this.config.keyLoadPolicy.default;return new Promise((n,r)=>{const o=this.getLicenseServerUrlOrThrow(e.keySystem);this.log(`Sending license request to URL: ${o}`);const c=new XMLHttpRequest;c.responseType="arraybuffer",c.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return r(new Error("invalid state"));if(c.readyState===4)if(c.status===200){this._requestLicenseFailureCount=0;let d=c.response;this.log(`License received ${d instanceof ArrayBuffer?d.byteLength:d}`);const u=this.config.licenseResponseCallback;if(u)try{d=u.call(this.hls,c,o,e)}catch(f){this.error(f)}n(d)}else{const d=s.errorRetry,u=d?d.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>u||c.status>=400&&c.status<500)r(new Vi({type:Ke.KEY_SYSTEM_ERROR,details:se.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:c,response:{url:o,data:void 0,code:c.status,text:c.statusText}},`License Request XHR failed (${o}). Status: ${c.status} (${c.statusText})`));else{const f=u-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${f} attempts left`),this.requestLicense(e,t).then(n,r)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=c,this.setupLicenseXHR(c,o,e,t).then(({xhr:d,licenseChallenge:u})=>{e.keySystem==Pt.PLAYREADY&&(u=this.unpackPlayReadyKeyMessage(d,u)),d.send(u)})})}onDestroying(){this.unregisterListeners(),this._clear()}onMediaAttached(e,t){if(!this.config.emeEnabled)return;const s=t.media;this.media=s,wi(s,"encrypted",this.onMediaEncrypted),wi(s,"waitingforkey",this.onWaitingForKey)}onMediaDetached(){const e=this.media;e&&(zi(e,"encrypted",this.onMediaEncrypted),zi(e,"waitingforkey",this.onWaitingForKey),this.media=null,this.mediaKeys=null)}_clear(){var e;if(this._requestLicenseFailureCount=0,this.keyIdToKeySessionPromise={},!this.mediaKeys&&!this.mediaKeySessions.length)return;const t=this.media,s=this.mediaKeySessions.slice();this.mediaKeySessions=[],this.mediaKeys=null,Xc.clearKeyUriToKeyIdMap();const n=s.length;sl.CDMCleanupPromise=Promise.all(s.map(r=>this.removeSession(r)).concat(t==null||(e=t.setMediaKeys(null))==null?void 0:e.catch(r=>{var o;this.log(`Could not clear media keys: ${r}`),(o=this.hls)==null||o.trigger(w.ERROR,{type:Ke.OTHER_ERROR,details:se.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR,fatal:!1,error:new Error(`Could not clear media keys: ${r}`)})}))).catch(r=>{var o;this.log(`Could not close sessions and clear media keys: ${r}`),(o=this.hls)==null||o.trigger(w.ERROR,{type:Ke.OTHER_ERROR,details:se.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close sessions and clear media keys: ${r}`)})}).then(()=>{n&&this.log("finished closing key sessions and clearing media keys")})}onManifestLoading(){this.keyFormatPromise=null}onManifestLoaded(e,{sessionKeys:t}){if(!(!t||!this.config.emeEnabled)&&!this.keyFormatPromise){const s=t.reduce((n,r)=>(n.indexOf(r.keyFormat)===-1&&n.push(r.keyFormat),n),[]);this.log(`Selecting key-system from session-keys ${s.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(s)}}removeSession(e){const{mediaKeysSession:t,licenseXhr:s}=e;if(t){this.log(`Remove licenses and keys and close session ${t.sessionId}`),e._onmessage&&(t.removeEventListener("message",e._onmessage),e._onmessage=void 0),e._onkeystatuseschange&&(t.removeEventListener("keystatuseschange",e._onkeystatuseschange),e._onkeystatuseschange=void 0),s&&s.readyState!==XMLHttpRequest.DONE&&s.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;const n=this.mediaKeySessions.indexOf(e);n>-1&&this.mediaKeySessions.splice(n,1);const{drmSystemOptions:r}=this.config;return(Bk(r)?new Promise((c,d)=>{self.setTimeout(()=>d(new Error("MediaKeySession.remove() timeout")),8e3),t.remove().then(c)}):Promise.resolve()).catch(c=>{var d;this.log(`Could not remove session: ${c}`),(d=this.hls)==null||d.trigger(w.ERROR,{type:Ke.OTHER_ERROR,details:se.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR,fatal:!1,error:new Error(`Could not remove session: ${c}`)})}).then(()=>t.close()).catch(c=>{var d;this.log(`Could not close session: ${c}`),(d=this.hls)==null||d.trigger(w.ERROR,{type:Ke.OTHER_ERROR,details:se.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close session: ${c}`)})})}}}sl.CDMCleanupPromise=void 0;class Vi extends Error{constructor(e,t){super(t),this.data=void 0,e.error||(e.error=new Error(t)),this.data=e,e.err=e.error}}class KM{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(w.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.on(w.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListeners(){this.hls.off(w.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.off(w.MEDIA_DETACHING,this.onMediaDetaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){const s=this.hls.config;if(s.capLevelOnFPSDrop){const n=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=n,n&&typeof n.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),s.fpsDroppedMonitoringPeriod)}}onMediaDetaching(){this.media=null}checkFPS(e,t,s){const n=performance.now();if(t){if(this.lastTime){const r=n-this.lastTime,o=s-this.lastDroppedFrames,c=t-this.lastDecodedFrames,d=1e3*o/r,u=this.hls;if(u.trigger(w.FPS_DROP,{currentDropped:o,currentDecoded:c,totalDroppedFrames:s}),d>0&&o>u.config.fpsDroppedMonitoringThreshold*c){let f=u.currentLevel;u.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+f),f>0&&(u.autoLevelCapping===-1||u.autoLevelCapping>=f)&&(f=f-1,u.trigger(w.FPS_DROP_LEVEL_CAPPING,{level:f,droppedLevel:u.currentLevel}),u.autoLevelCapping=f,this.streamController.nextLevelSwitch())}}this.lastTime=n,this.lastDroppedFrames=s,this.lastDecodedFrames=t}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}function wI(i,e){let t;try{t=new Event("addtrack")}catch{t=document.createEvent("Event"),t.initEvent("addtrack",!1,!1)}t.track=i,e.dispatchEvent(t)}function CI(i,e){const t=i.mode;if(t==="disabled"&&(i.mode="hidden"),i.cues&&!i.cues.getCueById(e.id))try{if(i.addCue(e),!i.cues.getCueById(e.id))throw new Error(`addCue is failed for: ${e}`)}catch(s){wt.debug(`[texttrack-utils]: ${s}`);try{const n=new self.TextTrackCue(e.startTime,e.endTime,e.text);n.id=e.id,i.addCue(n)}catch(n){wt.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${n}`)}}t==="disabled"&&(i.mode=t)}function Jo(i,e){const t=i.mode;if(t==="disabled"&&(i.mode="hidden"),i.cues)for(let s=i.cues.length;s--;)e&&i.cues[s].removeEventListener("enter",e),i.removeCue(i.cues[s]);t==="disabled"&&(i.mode=t)}function qp(i,e,t,s){const n=i.mode;if(n==="disabled"&&(i.mode="hidden"),i.cues&&i.cues.length>0){const r=qM(i.cues,e,t);for(let o=0;o<r.length;o++)(!s||s(r[o]))&&i.removeCue(r[o])}n==="disabled"&&(i.mode=n)}function YM(i,e){if(e<=i[0].startTime)return 0;const t=i.length-1;if(e>i[t].endTime)return-1;let s=0,n=t,r;for(;s<=n;)if(r=Math.floor((n+s)/2),e<i[r].startTime)n=r-1;else if(e>i[r].startTime&&s<t)s=r+1;else return r;return i[s].startTime-e<e-i[n].startTime?s:n}function qM(i,e,t){const s=[],n=YM(i,e);if(n>-1)for(let r=n,o=i.length;r<o;r++){const c=i[r];if(c.startTime>=e&&c.endTime<=t)s.push(c);else if(c.startTime>t)return s}return s}function uh(i){const e=[];for(let t=0;t<i.length;t++){const s=i[t];(s.kind==="subtitles"||s.kind==="captions")&&s.label&&e.push(i[t])}return e}class QM extends K0{constructor(e){super(e,"subtitle-track-controller"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let t=null;const s=uh(this.media.textTracks);for(let r=0;r<s.length;r++)if(s[r].mode==="hidden")t=s[r];else if(s[r].mode==="showing"){t=s[r];break}const n=this.findTrackForTextTrack(t);this.subtitleTrack!==n&&this.setSubtitleTrack(n)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:e}=this;e.on(w.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(w.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(w.MANIFEST_LOADING,this.onManifestLoading,this),e.on(w.MANIFEST_PARSED,this.onManifestParsed,this),e.on(w.LEVEL_LOADING,this.onLevelLoading,this),e.on(w.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(w.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(w.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(w.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(w.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(w.MANIFEST_LOADING,this.onManifestLoading,this),e.off(w.MANIFEST_PARSED,this.onManifestParsed,this),e.off(w.LEVEL_LOADING,this.onLevelLoading,this),e.off(w.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(w.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(w.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,e)}onMediaDetaching(e,t){const s=this.media;if(!s)return;const n=!!t.transferMedia;if(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||s.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),this.subtitleTrack=-1,this.media=null,n)return;uh(s.textTracks).forEach(o=>{Jo(o)})}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){const{id:s,groupId:n,details:r}=t,o=this.tracksInGroup[s];if(!o||o.groupId!==n){this.warn(`Subtitle track with id:${s} and group:${n} not found in active group ${o==null?void 0:o.groupId}`);return}const c=o.details;o.details=t.details,this.log(`Subtitle track ${s} "${o.name}" lang:${o.lang} group:${n} loaded [${r.startSN}-${r.endSN}]`),s===this.trackId&&this.playlistLoaded(s,t,c)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const s=t.subtitleGroups||null,n=this.groupIds;let r=this.currentTrack;if(!s||(n==null?void 0:n.length)!==(s==null?void 0:s.length)||s!=null&&s.some(o=>(n==null?void 0:n.indexOf(o))===-1)){this.groupIds=s,this.trackId=-1,this.currentTrack=null;const o=this.tracks.filter(f=>!s||s.indexOf(f.groupId)!==-1);if(o.length)this.selectDefaultTrack&&!o.some(f=>f.default)&&(this.selectDefaultTrack=!1),o.forEach((f,m)=>{f.id=m});else if(!r&&!this.tracksInGroup.length)return;this.tracksInGroup=o;const c=this.hls.config.subtitlePreference;if(!r&&c){this.selectDefaultTrack=!1;const f=On(c,o);if(f>-1)r=o[f];else{const m=On(c,this.tracks);r=this.tracks[m]}}let d=this.findTrackId(r);d===-1&&r&&(d=this.findTrackId(null));const u={subtitleTracks:o};this.log(`Updating subtitle tracks, ${o.length} track(s) found in "${s==null?void 0:s.join(",")}" group-id`),this.hls.trigger(w.SUBTITLE_TRACKS_UPDATED,u),d!==-1&&this.trackId===-1&&this.setSubtitleTrack(d)}}findTrackId(e){const t=this.tracksInGroup,s=this.selectDefaultTrack;for(let n=0;n<t.length;n++){const r=t[n];if(!(s&&!r.default||!s&&!e)&&(!e||Ja(r,e)))return n}if(e){for(let n=0;n<t.length;n++){const r=t[n];if(eu(e.attrs,r.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return n}for(let n=0;n<t.length;n++){const r=t[n];if(eu(e.attrs,r.attrs,["LANGUAGE"]))return n}}return-1}findTrackForTextTrack(e){if(e){const t=this.tracksInGroup;for(let s=0;s<t.length;s++){const n=t[s];if(zp(n,e))return s}}return-1}onError(e,t){t.fatal||!t.context||t.context.type===gt.SUBTITLE_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&this.checkRetry(t)}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1,this.setSubtitleTrack(e)}setSubtitleOption(e){if(this.hls.config.subtitlePreference=e,e){if(e.id===-1)return this.setSubtitleTrack(-1),null;const t=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,t.length){const s=this.currentTrack;if(s&&Ja(e,s))return s;const n=On(e,this.tracksInGroup);if(n>-1){const r=this.tracksInGroup[n];return this.setSubtitleTrack(n),r}else{if(s)return null;{const r=On(e,t);if(r>-1)return t[r]}}}}return null}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentTrack)&&this.scheduleLoading(this.currentTrack,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const s=e.id,n=e.groupId,r=this.getUrlWithDirectives(e.url,t),o=e.details,c=o==null?void 0:o.age;this.log(`Loading subtitle ${s} "${e.name}" lang:${e.lang} group:${n}${(t==null?void 0:t.msn)!==void 0?" at sn "+t.msn+" part "+t.part:""}${c&&o.live?" age "+c.toFixed(1)+(o.type&&" "+o.type||""):""} ${r}`),this.hls.trigger(w.SUBTITLE_TRACK_LOADING,{url:r,id:s,groupId:n,deliveryDirectives:t||null,track:e})}toggleTrackModes(){const{media:e}=this;if(!e)return;const t=uh(e.textTracks),s=this.currentTrack;let n;if(s&&(n=t.filter(r=>zp(s,r))[0],n||this.warn(`Unable to find subtitle TextTrack with name "${s.name}" and language "${s.lang}"`)),[].slice.call(t).forEach(r=>{r.mode!=="disabled"&&r!==n&&(r.mode="disabled")}),n){const r=this.subtitleDisplay?"showing":"hidden";n.mode!==r&&(n.mode=r)}}setSubtitleTrack(e){const t=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=e;return}if(e<-1||e>=t.length||!Fe(e)){this.warn(`Invalid subtitle track id: ${e}`);return}this.selectDefaultTrack=!1;const s=this.currentTrack,n=t[e]||null;if(this.trackId=e,this.currentTrack=n,this.toggleTrackModes(),!n){this.hls.trigger(w.SUBTITLE_TRACK_SWITCH,{id:e});return}const r=!!n.details&&!n.details.live;if(e===this.trackId&&n===s&&r)return;this.log(`Switching to subtitle-track ${e}`+(n?` "${n.name}" lang:${n.lang} group:${n.groupId}`:""));const{id:o,groupId:c="",name:d,type:u,url:f}=n;this.hls.trigger(w.SUBTITLE_TRACK_SWITCH,{id:o,groupId:c,name:d,type:u,url:f});const m=this.switchParams(n.url,s==null?void 0:s.details,n.details);this.loadPlaylist(m)}}function XM(){try{return crypto.randomUUID()}catch{try{const e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}catch{let t=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,n=>{const r=(t+Math.random()*16)%16|0;return t=Math.floor(t/16),(n=="x"?r:r&3|8).toString(16)})}}}function jc(i){let e=5381,t=i.length;for(;t;)e=e*33^i.charCodeAt(--t);return(e>>>0).toString()}const il=.025;let _h=function(i){return i[i.Point=0]="Point",i[i.Range=1]="Range",i}({});function WM(i,e,t){return`${i.identifier}-${t+1}-${jc(e)}`}class ZM{constructor(e,t){this.base=void 0,this._duration=null,this._timelineStart=null,this.appendInPlaceDisabled=void 0,this.appendInPlaceStarted=void 0,this.dateRange=void 0,this.hasPlayed=!1,this.cumulativeDuration=0,this.resumeOffset=NaN,this.playoutLimit=NaN,this.restrictions={skip:!1,jump:!1},this.snapOptions={out:!1,in:!1},this.assetList=[],this.assetListLoader=void 0,this.assetListResponse=null,this.resumeAnchor=void 0,this.error=void 0,this.resetOnResume=void 0,this.base=t,this.dateRange=e,this.setDateRange(e)}setDateRange(e){this.dateRange=e,this.resumeOffset=e.attr.optionalFloat("X-RESUME-OFFSET",this.resumeOffset),this.playoutLimit=e.attr.optionalFloat("X-PLAYOUT-LIMIT",this.playoutLimit),this.restrictions=e.attr.enumeratedStringList("X-RESTRICT",this.restrictions),this.snapOptions=e.attr.enumeratedStringList("X-SNAP",this.snapOptions)}reset(){var e;this.appendInPlaceStarted=!1,(e=this.assetListLoader)==null||e.destroy(),this.assetListLoader=void 0,this.supplementsPrimary||(this.assetListResponse=null,this.assetList=[],this._duration=null)}isAssetPastPlayoutLimit(e){var t;if(e>0&&e>=this.assetList.length)return!0;const s=this.playoutLimit;return e<=0||isNaN(s)?!1:s===0?!0:(((t=this.assetList[e])==null?void 0:t.startOffset)||0)>s}findAssetIndex(e){return this.assetList.indexOf(e)}get identifier(){return this.dateRange.id}get startDate(){return this.dateRange.startDate}get startTime(){const e=this.dateRange.startTime;if(this.snapOptions.out){const t=this.dateRange.tagAnchor;if(t)return Hg(e,t)}return e}get startOffset(){return this.cue.pre?0:this.startTime}get startIsAligned(){if(this.startTime===0||this.snapOptions.out)return!0;const e=this.dateRange.tagAnchor;if(e){const t=this.dateRange.startTime,s=Hg(t,e);return t-s<.1}return!1}get resumptionOffset(){const e=this.resumeOffset,t=Fe(e)?e:this.duration;return this.cumulativeDuration+t}get resumeTime(){const e=this.startOffset+this.resumptionOffset;if(this.snapOptions.in){const t=this.resumeAnchor;if(t)return Hg(e,t)}return e}get appendInPlace(){return this.appendInPlaceStarted?!0:this.appendInPlaceDisabled?!1:!!(!this.cue.once&&!this.cue.pre&&this.startIsAligned&&(isNaN(this.playoutLimit)&&isNaN(this.resumeOffset)||this.resumeOffset&&this.duration&&Math.abs(this.resumeOffset-this.duration)<il))}set appendInPlace(e){if(this.appendInPlaceStarted){this.resetOnResume=!e;return}this.appendInPlaceDisabled=!e}get timelineStart(){return this._timelineStart!==null?this._timelineStart:this.startTime}set timelineStart(e){this._timelineStart=e}get duration(){const e=this.playoutLimit;let t;return this._duration!==null?t=this._duration:this.dateRange.duration?t=this.dateRange.duration:t=this.dateRange.plannedDuration||0,!isNaN(e)&&e<t&&(t=e),t}set duration(e){this._duration=e}get cue(){return this.dateRange.cue}get timelineOccupancy(){return this.dateRange.attr["X-TIMELINE-OCCUPIES"]==="RANGE"?_h.Range:_h.Point}get supplementsPrimary(){return this.dateRange.attr["X-TIMELINE-STYLE"]==="PRIMARY"}get contentMayVary(){return this.dateRange.attr["X-CONTENT-MAY-VARY"]!=="NO"}get assetUrl(){return this.dateRange.attr["X-ASSET-URI"]}get assetListUrl(){return this.dateRange.attr["X-ASSET-LIST"]}get baseUrl(){return this.base.url}get assetListLoaded(){return this.assetList.length>0||this.assetListResponse!==null}toString(){return JM(this)}}function Hg(i,e){return i-e.start<e.duration/2&&!(Math.abs(i-(e.start+e.duration))<il)?e.start:e.start+e.duration}function OI(i,e,t){const s=new self.URL(i,t);return s.protocol!=="data:"&&s.searchParams.set("_HLS_primary_id",e),s}function zg(i,e){for(;(t=i.assetList[++e])!=null&&t.error;)var t;return e}function JM(i){return`["${i.identifier}" ${i.cue.pre?"<pre>":i.cue.post?"<post>":""}${i.timelineStart.toFixed(2)}-${i.resumeTime.toFixed(2)}]`}function Zo(i){const e=i.timelineStart,t=i.duration||0;return`["${i.identifier}" ${e.toFixed(2)}-${(e+t).toFixed(2)}]`}class eU{constructor(e,t,s,n){this.hls=void 0,this.interstitial=void 0,this.assetItem=void 0,this.tracks=null,this.hasDetails=!1,this.mediaAttached=null,this._currentTime=void 0,this._bufferedEosTime=void 0,this.checkPlayout=()=>{this.reachedPlayout(this.currentTime)&&this.hls.trigger(w.PLAYOUT_LIMIT_REACHED,{})};const r=this.hls=new e(t);this.interstitial=s,this.assetItem=n;let o=n.uri;try{o=OI(o,t.primarySessionId).href}catch{}r.loadSource(o);const c=()=>{this.hasDetails=!0};r.once(w.LEVEL_LOADED,c),r.once(w.AUDIO_TRACK_LOADED,c),r.once(w.SUBTITLE_TRACK_LOADED,c),r.on(w.MEDIA_ATTACHING,(d,{media:u})=>{this.removeMediaListeners(),this.mediaAttached=u,this.interstitial.playoutLimit&&(u.addEventListener("timeupdate",this.checkPlayout),this.appendInPlace&&r.on(w.BUFFER_APPENDED,()=>{const m=this.bufferedEnd;this.reachedPlayout(m)&&(this._bufferedEosTime=m,r.trigger(w.BUFFERED_TO_END,void 0))}))})}get appendInPlace(){var e;return((e=this.interstitial)==null?void 0:e.appendInPlace)||!1}bufferedInPlaceToEnd(e){var t;if(!this.appendInPlace)return!1;if((t=this.hls)!=null&&t.bufferedToEnd)return!0;if(!e||!this._bufferedEosTime)return!1;const s=this.timelineOffset,n=at.bufferInfo(e,s,0);return this.getAssetTime(n.end)>=this._bufferedEosTime-.02}reachedPlayout(e){const s=this.interstitial.playoutLimit;return this.startOffset+e>=s}get destroyed(){var e;return!((e=this.hls)!=null&&e.userConfig)}get assetId(){return this.assetItem.identifier}get interstitialId(){return this.assetItem.parentIdentifier}get media(){var e;return((e=this.hls)==null?void 0:e.media)||null}get bufferedEnd(){const e=this.media||this.mediaAttached;if(!e)return this._bufferedEosTime?this._bufferedEosTime:this.currentTime;const t=at.bufferInfo(e,e.currentTime,.001);return this.getAssetTime(t.end)}get currentTime(){const e=this.media||this.mediaAttached;return e?this.getAssetTime(e.currentTime):this._currentTime||0}get duration(){const e=this.assetItem.duration;return e||0}get remaining(){const e=this.duration;return e?Math.max(0,e-this.currentTime):0}get startOffset(){return this.assetItem.startOffset}get timelineOffset(){var e;return((e=this.hls)==null?void 0:e.config.timelineOffset)||0}set timelineOffset(e){const t=this.timelineOffset;if(e!==t){const s=e-t;if(Math.abs(s)>1/9e4){if(this.hasDetails)throw new Error("Cannot set timelineOffset after playlists are loaded");this.hls.config.timelineOffset=e}}}getAssetTime(e){const t=this.timelineOffset,s=this.duration;return Math.min(Math.max(0,e-t),s)}removeMediaListeners(){const e=this.mediaAttached;e&&(this._currentTime=e.currentTime,this.bufferSnapShot(),e.removeEventListener("timeupdate",this.checkPlayout))}bufferSnapShot(){if(this.mediaAttached){var e;(e=this.hls)!=null&&e.bufferedToEnd&&(this._bufferedEosTime=this.bufferedEnd)}}destroy(){this.removeMediaListeners(),this.hls.destroy(),this.hls=this.interstitial=null,this.tracks=this.mediaAttached=this.checkPlayout=null}attachMedia(e){this.hls.attachMedia(e)}detachMedia(){this.removeMediaListeners(),this.mediaAttached=null,this.hls.detachMedia()}resumeBuffering(){this.hls.resumeBuffering()}pauseBuffering(){this.hls.pauseBuffering()}transferMedia(){return this.bufferSnapShot(),this.hls.transferMedia()}resetDetails(){const e=this.hls;if(this.hasDetails){e.stopLoad();const t=s=>delete s.details;e.levels.forEach(t),e.allAudioTracks.forEach(t),e.allSubtitleTracks.forEach(t),this.hasDetails=!1}}on(e,t,s){this.hls.on(e,t)}once(e,t,s){this.hls.once(e,t)}off(e,t,s){this.hls.off(e,t)}toString(){var e;return`HlsAssetPlayer: ${Zo(this.assetItem)} ${(e=this.hls)==null?void 0:e.sessionId} ${this.appendInPlace?"append-in-place":""}`}}const q1=.033;class tU extends gr{constructor(e,t){super("interstitials-sched",t),this.onScheduleUpdate=void 0,this.eventMap={},this.events=null,this.items=null,this.durations={primary:0,playout:0,integrated:0},this.onScheduleUpdate=e}destroy(){this.reset(),this.onScheduleUpdate=null}reset(){this.eventMap={},this.setDurations(0,0,0),this.events&&this.events.forEach(e=>e.reset()),this.events=this.items=null}resetErrorsInRange(e,t){return this.events?this.events.reduce((s,n)=>e<=n.startOffset&&t>n.startOffset?(delete n.error,s+1):s,0):0}get duration(){const e=this.items;return e?e[e.length-1].end:0}get length(){return this.items?this.items.length:0}getEvent(e){return e&&this.eventMap[e]||null}hasEvent(e){return e in this.eventMap}findItemIndex(e,t){if(e.event)return this.findEventIndex(e.event.identifier);let s=-1;e.nextEvent?s=this.findEventIndex(e.nextEvent.identifier)-1:e.previousEvent&&(s=this.findEventIndex(e.previousEvent.identifier)+1);const n=this.items;if(n)for(n[s]||(t===void 0&&(t=e.start),s=this.findItemIndexAtTime(t));s>=0&&(r=n[s])!=null&&r.event;){var r;s--}return s}findItemIndexAtTime(e,t){const s=this.items;if(s)for(let n=0;n<s.length;n++){let r=s[n];if(t&&t!=="primary"&&(r=r[t]),e===r.start||e>r.start&&e<r.end)return n}return-1}findJumpRestrictedIndex(e,t){const s=this.items;if(s)for(let n=e;n<=t&&s[n];n++){const r=s[n].event;if(r!=null&&r.restrictions.jump&&!r.appendInPlace)return n}return-1}findEventIndex(e){const t=this.items;if(t)for(let n=t.length;n--;){var s;if(((s=t[n].event)==null?void 0:s.identifier)===e)return n}return-1}findAssetIndex(e,t){const s=e.assetList,n=s.length;if(n>1)for(let r=0;r<n;r++){const o=s[r];if(!o.error){const c=o.timelineStart;if(t===c||t>c&&t<c+(o.duration||0))return r}}return 0}get assetIdAtEnd(){var e,t;const s=(e=this.items)==null||(t=e[this.length-1])==null?void 0:t.event;if(s){const n=s.assetList,r=n[n.length-1];if(r)return r.identifier}return null}parseInterstitialDateRanges(e,t){const s=e.main.details,{dateRanges:n}=s,r=this.events,o=this.parseDateRanges(n,{url:s.url},t),c=Object.keys(n),d=r?r.filter(u=>!c.includes(u.identifier)):[];o.length&&o.sort((u,f)=>{const m=u.cue.pre,p=u.cue.post,v=f.cue.pre,S=f.cue.post;if(m&&!v)return-1;if(v&&!m||p&&!S)return 1;if(S&&!p)return-1;if(!m&&!v&&!p&&!S){const y=u.startTime,E=f.startTime;if(y!==E)return y-E}return u.dateRange.tagOrder-f.dateRange.tagOrder}),this.events=o,d.forEach(u=>{this.removeEvent(u)}),this.updateSchedule(e,d)}updateSchedule(e,t=[]){const s=this.events||[];if(s.length||t.length||this.length<2){const n=this.items,r=this.parseSchedule(s,e);(t.length||(n==null?void 0:n.length)!==r.length||r.some((c,d)=>Math.abs(c.playout.start-n[d].playout.start)>.005||Math.abs(c.playout.end-n[d].playout.end)>.005))&&(this.items=r,this.onScheduleUpdate(t,n))}}parseDateRanges(e,t,s){const n=[],r=Object.keys(e);for(let o=0;o<r.length;o++){const c=r[o],d=e[c];if(d.isInterstitial){let u=this.eventMap[c];u?u.setDateRange(d):(u=new ZM(d,t),this.eventMap[c]=u,s===!1&&(u.appendInPlace=s)),n.push(u)}}return n}parseSchedule(e,t){const s=[],n=t.main.details,r=n.live?1/0:n.edge;let o=0;if(e=e.filter(d=>!d.error&&!(d.cue.once&&d.hasPlayed)),e.length){this.resolveOffsets(e,t);let d=0,u=0;if(e.forEach((f,m)=>{const p=f.cue.pre,v=f.cue.post,S=e[m-1]||null,y=f.appendInPlace,E=v?r:f.startOffset,A=f.duration,R=f.timelineOccupancy===_h.Range?A:0,I=f.resumptionOffset,C=(S==null?void 0:S.startTime)===E,L=E+f.cumulativeDuration;let D=y?L+A:E+I;if(p||!v&&E<=0){const M=u;u+=R,f.timelineStart=L;const U=o;o+=A,s.push({event:f,start:L,end:D,playout:{start:U,end:o},integrated:{start:M,end:u}})}else if(E<=r){if(!C){const F=E-d;if(F>q1){const z=d,V=u;u+=F;const ae=o;o+=F;const G={previousEvent:e[m-1]||null,nextEvent:f,start:z,end:z+F,playout:{start:ae,end:o},integrated:{start:V,end:u}};s.push(G)}else F>0&&S&&(S.cumulativeDuration+=F,s[s.length-1].end=E)}v&&(D=L),f.timelineStart=L;const M=u;u+=R;const U=o;o+=A,s.push({event:f,start:L,end:D,playout:{start:U,end:o},integrated:{start:M,end:u}})}else return;const _=f.resumeTime;v||_>r?d=r:d=_}),d<r){var c;const f=d,m=u,p=r-d;u+=p;const v=o;o+=p,s.push({previousEvent:((c=s[s.length-1])==null?void 0:c.event)||null,nextEvent:null,start:d,end:f+p,playout:{start:v,end:o},integrated:{start:m,end:u}})}this.setDurations(r,o,u)}else s.push({previousEvent:null,nextEvent:null,start:0,end:r,playout:{start:0,end:r},integrated:{start:0,end:r}}),this.setDurations(r,r,r);return s}setDurations(e,t,s){this.durations={primary:e,playout:t,integrated:s}}resolveOffsets(e,t){const s=t.main.details,n=s.live?1/0:s.edge;let r=0,o=-1;e.forEach((c,d)=>{const u=c.cue.pre,f=c.cue.post,m=u?0:f?n:c.startTime;this.updateAssetDurations(c),o===m?c.cumulativeDuration=r:(r=0,o=m),!f&&c.snapOptions.in&&(c.resumeAnchor=so(null,s.fragments,c.startOffset+c.resumptionOffset,0,0)||void 0),c.appendInPlace&&!c.appendInPlaceStarted&&(this.primaryCanResumeInPlaceAt(c,t)||(c.appendInPlace=!1)),!c.appendInPlace&&d+1<e.length&&e[d+1].startTime-e[d].resumeTime<q1&&(e[d+1].appendInPlace=!1,e[d+1].appendInPlace&&this.warn(`Could not change append strategy for abutting event ${c}`));const v=Fe(c.resumeOffset)?c.resumeOffset:c.duration;r+=v})}primaryCanResumeInPlaceAt(e,t){const s=e.resumeTime,n=e.startTime+e.resumptionOffset;return Math.abs(s-n)>il?(this.log(`"${e.identifier}" resumption ${s} not aligned with estimated timeline end ${n}`),!1):t?!Object.keys(t).some(o=>{const c=t[o].details,d=c.edge;if(s>=d)return this.log(`"${e.identifier}" resumption ${s} past ${o} playlist end ${d}`),!1;const u=so(null,c.fragments,s);if(!u)return this.log(`"${e.identifier}" resumption ${s} does not align with any fragments in ${o} playlist (${c.fragStart}-${c.fragmentEnd})`),!0;const f=o==="audio"?.175:0;return Math.abs(u.start-s)<il+f||Math.abs(u.end-s)<il+f?!1:(this.log(`"${e.identifier}" resumption ${s} not aligned with ${o} fragment bounds (${u.start}-${u.end} sn: ${u.sn} cc: ${u.cc})`),!0)}):(this.log(`"${e.identifier}" resumption ${s} can not be aligned with media (none selected)`),!1)}updateAssetDurations(e){if(!e.assetListLoaded)return;const t=e.timelineStart;let s=0,n=!1,r=!1;e.assetList.forEach((o,c)=>{const d=t+s;o.startOffset=s,o.timelineStart=d,n||(n=o.duration===null),r||(r=!!o.error);const u=o.error?0:o.duration||0;s+=u}),n&&!r?e.duration=Math.max(s,e.duration):e.duration=s}removeEvent(e){e.reset(),delete this.eventMap[e.identifier]}}function Kr(i){return`[${i.event?'"'+i.event.identifier+'"':"primary"}: ${i.start.toFixed(2)}-${i.end.toFixed(2)}]`}class sU{constructor(e){this.hls=void 0,this.hls=e}destroy(){this.hls=null}loadAssetList(e,t){const s=e.assetListUrl;let n;try{n=OI(s,this.hls.sessionId,e.baseUrl)}catch(p){const v=this.assignAssetListError(e,se.ASSET_LIST_LOAD_ERROR,p,s);this.hls.trigger(w.ERROR,v);return}t&&n.protocol!=="data:"&&n.searchParams.set("_HLS_start_offset",""+t);const r=this.hls.config,o=r.loader,c=new o(r),d={responseType:"json",url:n.href},u=r.interstitialAssetListLoadPolicy.default,f={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},m={onSuccess:(p,v,S,y)=>{const E=p.data,A=E==null?void 0:E.ASSETS;if(!Array.isArray(A)){const R=this.assignAssetListError(e,se.ASSET_LIST_PARSING_ERROR,new Error("Invalid interstitial asset list"),S.url,v,y);this.hls.trigger(w.ERROR,R);return}e.assetListResponse=E,this.hls.trigger(w.ASSET_LIST_LOADED,{event:e,assetListResponse:E,networkDetails:y})},onError:(p,v,S,y)=>{const E=this.assignAssetListError(e,se.ASSET_LIST_LOAD_ERROR,new Error(`Error loading X-ASSET-LIST: HTTP status ${p.code} ${p.text} (${v.url})`),v.url,y,S);this.hls.trigger(w.ERROR,E)},onTimeout:(p,v,S)=>{const y=this.assignAssetListError(e,se.ASSET_LIST_LOAD_TIMEOUT,new Error(`Timeout loading X-ASSET-LIST (${v.url})`),v.url,p,S);this.hls.trigger(w.ERROR,y)}};return c.load(d,f,m),this.hls.trigger(w.ASSET_LIST_LOADING,{event:e}),c}assignAssetListError(e,t,s,n,r,o){return e.error=s,{type:Ke.NETWORK_ERROR,details:t,fatal:!1,interstitial:e,url:n,error:s,networkDetails:o,stats:r}}}function Q1(i){i==null||i.play().catch(()=>{})}class iU extends gr{constructor(e,t){super("interstitials",e.logger),this.HlsPlayerClass=void 0,this.hls=void 0,this.assetListLoader=void 0,this.mediaSelection=null,this.altSelection=null,this.media=null,this.detachedData=null,this.requiredTracks=null,this.manager=null,this.playerQueue=[],this.bufferedPos=-1,this.timelinePos=-1,this.schedule=void 0,this.playingItem=null,this.bufferingItem=null,this.waitingItem=null,this.endedItem=null,this.playingAsset=null,this.endedAsset=null,this.bufferingAsset=null,this.shouldPlay=!1,this.onPlay=()=>{this.shouldPlay=!0},this.onPause=()=>{this.shouldPlay=!1},this.onSeeking=()=>{const s=this.currentTime;if(s===void 0||this.playbackDisabled)return;const n=s-this.timelinePos;if(Math.abs(n)<1/7056e5)return;const o=n<=-.01;this.timelinePos=s,this.bufferedPos=s;const c=this.playingItem;if(!c){this.checkBuffer();return}if(o&&this.schedule.resetErrorsInRange(s,s-n)&&this.updateSchedule(),this.checkBuffer(),o&&s<c.start||s>=c.end){var d;const p=this.schedule.findItemIndexAtTime(this.timelinePos);if(!this.isInterstitial(c)&&(d=this.media)!=null&&d.paused&&(this.shouldPlay=!1),!o){const v=this.findItemIndex(c);if(p>v){const S=this.schedule.findJumpRestrictedIndex(v+1,p);if(S>v){this.setSchedulePosition(S);return}}}this.setSchedulePosition(p);return}const u=this.playingAsset;if(!u){if(this.playingLastItem&&this.isInterstitial(c)){const p=c.event.assetList[0];p&&(this.endedItem=this.playingItem,this.playingItem=null,this.setScheduleToAssetAtTime(s,p))}return}const f=u.timelineStart,m=u.duration||0;(o&&s<f||s>=f+m)&&this.setScheduleToAssetAtTime(s,u)},this.onTimeupdate=()=>{const s=this.currentTime;if(s===void 0||this.playbackDisabled)return;if(s>this.timelinePos)this.timelinePos=s,s>this.bufferedPos&&this.checkBuffer();else return;const n=this.playingItem;if(!n||this.playingLastItem)return;if(s>=n.end){this.timelinePos=n.end;const c=this.findItemIndex(n);this.setSchedulePosition(c+1)}const r=this.playingAsset;if(!r)return;const o=r.timelineStart+(r.duration||0);s>=o&&this.setScheduleToAssetAtTime(s,r)},this.onScheduleUpdate=(s,n)=>{const r=this.schedule,o=this.playingItem,c=r.events||[],d=r.items||[],u=r.durations,f=s.map(S=>S.identifier),m=!!(c.length||f.length);(m||n)&&this.log(`INTERSTITIALS_UPDATED (${c.length}): ${c}
Schedule: ${d.map(S=>Kr(S))} pos: ${this.timelinePos}`),f.length&&this.log(`Removed events ${f}`),this.playerQueue.forEach(S=>{if(S.interstitial.appendInPlace){const y=S.assetItem.timelineStart,E=S.timelineOffset-y;if(E)try{S.timelineOffset=y}catch(A){Math.abs(E)>il&&this.warn(`${A} ("${S.assetId}" ${S.timelineOffset}->${y})`)}}});let p=null;if(o){const S=this.updateItem(o,this.timelinePos);this.itemsMatch(o,S)&&(this.playingItem=S,this.waitingItem=this.endedItem=null,p=()=>this.trimInPlace(S,o))}else this.waitingItem=this.updateItem(this.waitingItem),this.endedItem=this.updateItem(this.endedItem);const v=this.bufferingItem;if(v){const S=this.updateItem(v,this.bufferedPos);this.itemsMatch(v,S)?(this.bufferingItem=S,p||(p=()=>this.trimInPlace(S,v))):v.event&&(this.bufferingItem=this.playingItem,this.clearInterstitial(v.event,null))}if(s.forEach(S=>{S.assetList.forEach(y=>{this.clearAssetPlayer(y.identifier,null)})}),m||n){if(this.hls.trigger(w.INTERSTITIALS_UPDATED,{events:c.slice(0),schedule:d.slice(0),durations:u,removedIds:f}),this.isInterstitial(o)&&f.includes(o.event.identifier)){this.warn(`Interstitial "${o.event.identifier}" removed while playing`),this.primaryFallback(o.event);return}p&&p(),this.checkBuffer()}},this.hls=e,this.HlsPlayerClass=t,this.assetListLoader=new sU(e),this.schedule=new tU(this.onScheduleUpdate,e.logger),this.registerListeners()}registerListeners(){const e=this.hls;e.on(w.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(w.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(w.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(w.MANIFEST_LOADING,this.onManifestLoading,this),e.on(w.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(w.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(w.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.on(w.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(w.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.on(w.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.on(w.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.on(w.BUFFER_APPENDED,this.onBufferAppended,this),e.on(w.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(w.BUFFERED_TO_END,this.onBufferedToEnd,this),e.on(w.MEDIA_ENDED,this.onMediaEnded,this),e.on(w.ERROR,this.onError,this),e.on(w.DESTROYING,this.onDestroying,this)}unregisterListeners(){const e=this.hls;e&&(e.off(w.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(w.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(w.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(w.MANIFEST_LOADING,this.onManifestLoading,this),e.off(w.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(w.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(w.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.off(w.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(w.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.off(w.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.off(w.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.off(w.BUFFER_CODECS,this.onBufferCodecs,this),e.off(w.BUFFER_APPENDED,this.onBufferAppended,this),e.off(w.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(w.BUFFERED_TO_END,this.onBufferedToEnd,this),e.off(w.MEDIA_ENDED,this.onMediaEnded,this),e.off(w.ERROR,this.onError,this),e.off(w.DESTROYING,this.onDestroying,this))}startLoad(){this.resumeBuffering()}stopLoad(){this.pauseBuffering()}resumeBuffering(){var e;(e=this.getBufferingPlayer())==null||e.resumeBuffering()}pauseBuffering(){var e;(e=this.getBufferingPlayer())==null||e.pauseBuffering()}destroy(){this.unregisterListeners(),this.stopLoad(),this.assetListLoader&&this.assetListLoader.destroy(),this.emptyPlayerQueue(),this.clearScheduleState(),this.schedule&&this.schedule.destroy(),this.media=this.detachedData=this.mediaSelection=this.requiredTracks=this.altSelection=this.manager=null,this.hls=this.HlsPlayerClass=this.schedule=this.log=null,this.assetListLoader=null,this.onPlay=this.onPause=this.onSeeking=this.onTimeupdate=null,this.onScheduleUpdate=null}onDestroying(){const e=this.primaryMedia||this.media;e&&this.removeMediaListeners(e)}removeMediaListeners(e){zi(e,"play",this.onPlay),zi(e,"pause",this.onPause),zi(e,"seeking",this.onSeeking),zi(e,"timeupdate",this.onTimeupdate)}onMediaAttaching(e,t){const s=this.media=t.media;wi(s,"seeking",this.onSeeking),wi(s,"timeupdate",this.onTimeupdate),wi(s,"play",this.onPlay),wi(s,"pause",this.onPause)}onMediaAttached(e,t){const s=this.effectivePlayingItem,n=this.detachedData;if(this.detachedData=null,s===null)this.checkStart();else if(!n){this.clearScheduleState();const r=this.findItemIndex(s);this.setSchedulePosition(r)}}clearScheduleState(){this.playingItem=this.bufferingItem=this.waitingItem=this.endedItem=this.playingAsset=this.endedAsset=this.bufferingAsset=null}onMediaDetaching(e,t){const s=!!t.transferMedia,n=this.media;if(this.media=null,!s&&(n&&this.removeMediaListeners(n),this.detachedData)){const r=this.getBufferingPlayer();r&&(this.playingAsset=this.endedAsset=this.bufferingAsset=this.bufferingItem=this.waitingItem=this.detachedData=null,r.detachMedia()),this.shouldPlay=!1}}get interstitialsManager(){if(!this.manager){if(!this.hls)return null;const e=this,t=()=>e.bufferingItem||e.waitingItem,s=m=>m&&e.getAssetPlayer(m.identifier),n=(m,p,v,S,y)=>{if(m){let E=m[p].start;const A=m.event;if(A){if(p==="playout"||A.timelineOccupancy!==_h.Point){const R=s(v);(R==null?void 0:R.interstitial)===A&&(E+=R.assetItem.startOffset+R[y])}}else{const R=S==="bufferedPos"?o():e[S];E+=R-m.start}return E}return 0},r=(m,p)=>{if(m!==0&&p!=="primary"&&e.schedule.length){var v;const S=e.schedule.findItemIndexAtTime(m),y=(v=e.schedule.items)==null?void 0:v[S];if(y){const E=y[p].start-y.start;return m+E}}return m},o=()=>{const m=e.bufferedPos;return m===Number.MAX_VALUE?c("primary"):Math.max(m,0)},c=m=>{var p;return(p=e.primaryDetails)!=null&&p.live?e.primaryDetails.edge:e.schedule.durations[m]},d=(m,p)=>{var v,S;const y=e.effectivePlayingItem;if(y!=null&&(v=y.event)!=null&&v.restrictions.skip)return;e.log(`seek to ${m} "${p}"`);const E=e.effectivePlayingItem,A=e.schedule.findItemIndexAtTime(m,p),R=(S=e.schedule.items)==null?void 0:S[A],I=e.getBufferingPlayer(),C=I==null?void 0:I.interstitial,L=C==null?void 0:C.appendInPlace,D=E&&e.itemsMatch(E,R);if(E&&(L||D)){const M=s(e.playingAsset),U=(M==null?void 0:M.media)||e.primaryMedia;if(U){const F=p==="primary"?U.currentTime:n(E,p,e.playingAsset,"timelinePos","currentTime"),z=m-F,V=(L?F:U.currentTime)+z;if(V>=0&&(!M||L||V<=M.duration)){U.currentTime=V;return}}}if(R){let M=m;if(p!=="primary"){const F=R[p].start,z=m-F;M=R.start+z}const U=!e.isInterstitial(R);if((!e.isInterstitial(E)||E.event.appendInPlace)&&(U||R.event.appendInPlace)){const F=e.media||(L?I==null?void 0:I.media:null);F&&(F.currentTime=M)}else if(E){const F=e.findItemIndex(E);if(A>F){const V=e.schedule.findJumpRestrictedIndex(F+1,A);if(V>F){e.setSchedulePosition(V);return}}let z=0;if(U)e.timelinePos=M,e.checkBuffer();else{var _;const V=R==null||(_=R.event)==null?void 0:_.assetList;if(V){const ae=m-(R[p]||R).start;for(let G=V.length;G--;){const Z=V[G];if(Z.duration&&ae>=Z.startOffset&&ae<Z.startOffset+Z.duration){z=G;break}}}}e.setSchedulePosition(A,z)}}},u=()=>{const m=e.effectivePlayingItem;if(e.isInterstitial(m))return m;const p=t();return e.isInterstitial(p)?p:null},f={get currentTime(){const m=u(),p=e.effectivePlayingItem;return p&&p===m?n(p,"playout",e.effectivePlayingAsset,"timelinePos","currentTime")-p.playout.start:0},set currentTime(m){const p=u(),v=e.effectivePlayingItem;v&&v===p&&d(m+v.playout.start,"playout")},get duration(){const m=u();return m?m.playout.end-m.playout.start:0},get assetPlayers(){var m;const p=(m=u())==null?void 0:m.event.assetList;return p?p.map(v=>e.getAssetPlayer(v.identifier)):[]},get playingIndex(){var m;const p=(m=u())==null?void 0:m.event;return p&&e.effectivePlayingAsset?p.findAssetIndex(e.effectivePlayingAsset):-1},get scheduleItem(){return u()}};this.manager={get events(){var m,p;return((m=e.schedule)==null||(p=m.events)==null?void 0:p.slice(0))||[]},get schedule(){var m,p;return((m=e.schedule)==null||(p=m.items)==null?void 0:p.slice(0))||[]},get interstitialPlayer(){return u()?f:null},get playerQueue(){return e.playerQueue.slice(0)},get bufferingAsset(){return e.bufferingAsset},get bufferingItem(){return t()},get bufferingIndex(){const m=t();return e.findItemIndex(m)},get playingAsset(){return e.effectivePlayingAsset},get playingItem(){return e.effectivePlayingItem},get playingIndex(){const m=e.effectivePlayingItem;return e.findItemIndex(m)},primary:{get bufferedEnd(){return o()},get currentTime(){const m=e.timelinePos;return m>0?m:0},set currentTime(m){d(m,"primary")},get duration(){return c("primary")},get seekableStart(){var m;return((m=e.primaryDetails)==null?void 0:m.fragmentStart)||0}},integrated:{get bufferedEnd(){return n(t(),"integrated",e.bufferingAsset,"bufferedPos","bufferedEnd")},get currentTime(){return n(e.effectivePlayingItem,"integrated",e.effectivePlayingAsset,"timelinePos","currentTime")},set currentTime(m){d(m,"integrated")},get duration(){return c("integrated")},get seekableStart(){var m;return r(((m=e.primaryDetails)==null?void 0:m.fragmentStart)||0,"integrated")}},skip:()=>{const m=e.effectivePlayingItem,p=m==null?void 0:m.event;if(p&&!p.restrictions.skip){const v=e.findItemIndex(m);if(p.appendInPlace){const S=m.playout.start+m.event.duration;d(S+.001,"playout")}else e.advanceAfterAssetEnded(p,v,1/0)}}}}return this.manager}get effectivePlayingItem(){return this.waitingItem||this.playingItem||this.endedItem}get effectivePlayingAsset(){return this.playingAsset||this.endedAsset}get playingLastItem(){var e;const t=this.playingItem,s=(e=this.schedule)==null?void 0:e.items;return!this.playbackStarted||!t||!s?!1:this.findItemIndex(t)===s.length-1}get playbackStarted(){return this.effectivePlayingItem!==null}get currentTime(){var e,t,s;if(this.mediaSelection===null)return;const n=this.waitingItem||this.playingItem;if(this.isInterstitial(n)&&!n.event.appendInPlace)return;let r=this.media;!r&&(e=this.bufferingItem)!=null&&(t=e.event)!=null&&t.appendInPlace&&(r=this.primaryMedia);const o=(s=r)==null?void 0:s.currentTime;if(!(o===void 0||!Fe(o)))return o}get primaryMedia(){var e;return this.media||((e=this.detachedData)==null?void 0:e.media)||null}isInterstitial(e){return!!(e!=null&&e.event)}retreiveMediaSource(e,t){const s=this.getAssetPlayer(e);s&&this.transferMediaFromPlayer(s,t)}transferMediaFromPlayer(e,t){const s=e.interstitial.appendInPlace,n=e.media;if(s&&n===this.primaryMedia){if(this.bufferingAsset=null,(!t||this.isInterstitial(t)&&!t.event.appendInPlace)&&t&&n){this.detachedData={media:n};return}const r=e.transferMedia();this.log(`transfer MediaSource from ${e} ${es(r)}`),this.detachedData=r}else t&&n&&(this.shouldPlay||(this.shouldPlay=!n.paused))}transferMediaTo(e,t){var s,n;if(e.media===t)return;let r=null;const o=this.hls,c=e!==o,d=c&&e.interstitial.appendInPlace,u=(s=this.detachedData)==null?void 0:s.mediaSource;let f;if(o.media)d&&(r=o.transferMedia(),this.detachedData=r),f="Primary";else if(u){const v=this.getBufferingPlayer();v?(r=v.transferMedia(),f=`${v}`):f="detached MediaSource"}else f="detached media";if(!r){if(u)r=this.detachedData,this.log(`using detachedData: MediaSource ${es(r)}`);else if(!this.detachedData||o.media===t){const v=this.playerQueue;v.length>1&&v.forEach(S=>{if(c&&S.interstitial.appendInPlace!==d){const y=S.interstitial;this.clearInterstitial(S.interstitial,null),y.appendInPlace=!1,y.appendInPlace&&this.warn(`Could not change append strategy for queued assets ${y}`)}}),this.hls.detachMedia(),this.detachedData={media:t}}}const m=r&&"mediaSource"in r&&((n=r.mediaSource)==null?void 0:n.readyState)!=="closed",p=m&&r?r:t;if(this.log(`${m?"transfering MediaSource":"attaching media"} to ${c?e:"Primary"} from ${f}`),p===r){const v=c&&e.assetId===this.schedule.assetIdAtEnd;p.overrides={duration:this.schedule.duration,endOfStream:!c||v,cueRemoval:!c}}e.attachMedia(p)}onInterstitialCueEnter(){this.onTimeupdate()}checkStart(){const e=this.schedule,t=e.events;if(!t||this.playbackDisabled||!this.media)return;this.bufferedPos===-1&&(this.bufferedPos=0);const s=this.timelinePos,n=this.effectivePlayingItem;if(s===-1){const r=this.hls.startPosition;if(this.timelinePos=r,t.length&&t[0].cue.pre){const o=e.findEventIndex(t[0].identifier);this.setSchedulePosition(o)}else if(r>=0||!this.primaryLive){const o=this.timelinePos=r>0?r:0,c=e.findItemIndexAtTime(o);this.setSchedulePosition(c)}}else if(n&&!this.playingItem){const r=e.findItemIndex(n);this.setSchedulePosition(r)}}advanceAfterAssetEnded(e,t,s){const n=zg(e,s);if(!e.isAssetPastPlayoutLimit(n))this.setSchedulePosition(t,n);else{const r=this.schedule.items;if(r){const o=t+1,c=r.length;if(o>=c){this.setSchedulePosition(-1);return}const d=e.resumeTime;this.timelinePos<d&&(this.timelinePos=d,this.checkBuffer()),this.setSchedulePosition(o)}}}setScheduleToAssetAtTime(e,t){const s=this.schedule,n=t.parentIdentifier,r=s.getEvent(n);if(r){const o=s.findEventIndex(n),c=s.findAssetIndex(r,e);this.advanceAfterAssetEnded(r,o,c-1)}}setSchedulePosition(e,t){const s=this.schedule.items;if(!s||this.playbackDisabled)return;this.log(`setSchedulePosition ${e}, ${t}`);const n=e>=0?s[e]:null,r=this.playingItem,o=this.playingLastItem;if(this.isInterstitial(r)){var c;const u=r.event,f=this.playingAsset,m=f==null?void 0:f.identifier,p=m?this.getAssetPlayer(m):null;if(p&&m&&(!this.eventItemsMatch(r,n)||t!==void 0&&m!==((c=u.assetList)==null?void 0:c[t].identifier))){var d;const v=u.findAssetIndex(f);this.log(`INTERSTITIAL_ASSET_ENDED ${v+1}/${u.assetList.length} ${Zo(f)}`),this.endedAsset=f,this.playingAsset=null,this.hls.trigger(w.INTERSTITIAL_ASSET_ENDED,{asset:f,assetListIndex:v,event:u,schedule:s.slice(0),scheduleIndex:e,player:p}),this.retreiveMediaSource(m,n),p.media&&!((d=this.detachedData)!=null&&d.mediaSource)&&p.detachMedia()}if(!this.eventItemsMatch(r,n)&&(this.endedItem=r,this.playingItem=null,this.log(`INTERSTITIAL_ENDED ${u} ${Kr(r)}`),u.hasPlayed=!0,this.hls.trigger(w.INTERSTITIAL_ENDED,{event:u,schedule:s.slice(0),scheduleIndex:e}),u.cue.once)){this.updateSchedule();const v=this.schedule.items;if(n&&v){const S=this.schedule.findItemIndex(n);this.advanceSchedule(S,v,t,r,o)}return}}this.advanceSchedule(e,s,t,r,o)}advanceSchedule(e,t,s,n,r){const o=e>=0?t[e]:null,c=this.primaryMedia,d=this.playerQueue;if(d.length&&d.forEach(u=>{const f=u.interstitial,m=this.schedule.findEventIndex(f.identifier);(m<e||m>e+1)&&this.clearInterstitial(f,o)}),this.isInterstitial(o)){this.timelinePos=Math.min(Math.max(this.timelinePos,o.start),o.end);const u=o.event;if(s===void 0){s=this.schedule.findAssetIndex(u,this.timelinePos);const v=zg(u,s-1);if(u.isAssetPastPlayoutLimit(v)){this.advanceAfterAssetEnded(u,e,s);return}s=v}const f=this.waitingItem;this.assetsBuffered(o,c)||this.setBufferingItem(o);let m=this.preloadAssets(u,s);if(this.eventItemsMatch(o,f||n)||(this.waitingItem=o,this.log(`INTERSTITIAL_STARTED ${Kr(o)} ${u.appendInPlace?"append in place":""}`),this.hls.trigger(w.INTERSTITIAL_STARTED,{event:u,schedule:t.slice(0),scheduleIndex:e})),!u.assetListLoaded){this.log(`Waiting for ASSET-LIST to complete loading ${u}`);return}if(u.assetListLoader&&(u.assetListLoader.destroy(),u.assetListLoader=void 0),!c){this.log(`Waiting for attachMedia to start Interstitial ${u}`);return}this.waitingItem=this.endedItem=null,this.playingItem=o;const p=u.assetList[s];if(!p){const v=t[e+1],S=this.media;v&&S&&!this.isInterstitial(v)&&S.currentTime<v.start&&(S.currentTime=this.timelinePos=v.start),this.advanceAfterAssetEnded(u,e,s||0);return}if(m||(m=this.getAssetPlayer(p.identifier)),m===null||m.destroyed){const v=u.assetList.length;this.warn(`asset ${s+1}/${v} player destroyed ${u}`),m=this.createAssetPlayer(u,p,s)}if(!this.eventItemsMatch(o,this.bufferingItem)&&u.appendInPlace&&this.isAssetBuffered(p))return;this.startAssetPlayer(m,s,t,e,c),this.shouldPlay&&Q1(m.media)}else o!==null?(this.resumePrimary(o,e,n),this.shouldPlay&&Q1(this.hls.media)):r&&this.isInterstitial(n)&&(this.endedItem=null,this.playingItem=n,n.event.appendInPlace||this.attachPrimary(this.schedule.durations.primary,null))}get playbackDisabled(){return this.hls.config.enableInterstitialPlayback===!1}get primaryDetails(){var e,t;return(e=this.mediaSelection)==null||(t=e.main)==null?void 0:t.details}get primaryLive(){var e;return!!((e=this.primaryDetails)!=null&&e.live)}resumePrimary(e,t,s){var n;if(this.playingItem=e,this.playingAsset=this.endedAsset=null,this.waitingItem=this.endedItem=null,this.bufferedToItem(e),this.log(`resuming ${Kr(e)}`),!((n=this.detachedData)!=null&&n.mediaSource)){let o=this.timelinePos;(o<e.start||o>=e.end)&&(o=this.getPrimaryResumption(e,t),this.timelinePos=o),this.attachPrimary(o,e)}if(!s)return;const r=this.schedule.items;r&&(this.log(`INTERSTITIALS_PRIMARY_RESUMED ${Kr(e)}`),this.hls.trigger(w.INTERSTITIALS_PRIMARY_RESUMED,{schedule:r.slice(0),scheduleIndex:t}),this.checkBuffer())}getPrimaryResumption(e,t){const s=e.start;if(this.primaryLive){const n=this.primaryDetails;if(t===0)return this.hls.startPosition;if(n&&(s<n.fragmentStart||s>n.edge))return this.hls.liveSyncPosition||-1}return s}isAssetBuffered(e){const t=this.getAssetPlayer(e.identifier);return t!=null&&t.hls?t.hls.bufferedToEnd:at.bufferInfo(this.primaryMedia,this.timelinePos,0).end+1>=e.timelineStart+(e.duration||0)}attachPrimary(e,t,s){t?this.setBufferingItem(t):this.bufferingItem=this.playingItem,this.bufferingAsset=null;const n=this.primaryMedia;if(!n)return;const r=this.hls;r.media?this.checkBuffer():(this.transferMediaTo(r,n),s&&this.startLoadingPrimaryAt(e,s)),s||(this.timelinePos=e,this.startLoadingPrimaryAt(e,s))}startLoadingPrimaryAt(e,t){var s;const n=this.hls;!n.loadingEnabled||!n.media||Math.abs((((s=n.mainForwardBufferInfo)==null?void 0:s.start)||n.media.currentTime)-e)>.5?n.startLoad(e,t):n.bufferingEnabled||n.resumeBuffering()}onManifestLoading(){this.stopLoad(),this.schedule.reset(),this.emptyPlayerQueue(),this.clearScheduleState(),this.shouldPlay=!1,this.bufferedPos=this.timelinePos=-1,this.mediaSelection=this.altSelection=this.manager=this.requiredTracks=null,this.hls.off(w.BUFFER_CODECS,this.onBufferCodecs,this),this.hls.on(w.BUFFER_CODECS,this.onBufferCodecs,this)}onLevelUpdated(e,t){if(t.level===-1)return;const s=this.hls.levels[t.level],n=_t(_t({},this.mediaSelection||this.altSelection),{},{main:s});this.mediaSelection=n,this.schedule.parseInterstitialDateRanges(n,this.hls.config.interstitialAppendInPlace),!this.effectivePlayingItem&&this.schedule.items&&this.checkStart()}onAudioTrackUpdated(e,t){const s=this.hls.audioTracks[t.id],n=this.mediaSelection;if(!n){this.altSelection=_t(_t({},this.altSelection),{},{audio:s});return}const r=_t(_t({},n),{},{audio:s});this.mediaSelection=r}onSubtitleTrackUpdated(e,t){const s=this.hls.subtitleTracks[t.id],n=this.mediaSelection;if(!n){this.altSelection=_t(_t({},this.altSelection),{},{subtitles:s});return}const r=_t(_t({},n),{},{subtitles:s});this.mediaSelection=r}onAudioTrackSwitching(e,t){const s=o1(t);this.playerQueue.forEach(n=>n.hls.setAudioOption(t)||n.hls.setAudioOption(s))}onSubtitleTrackSwitch(e,t){const s=o1(t);this.playerQueue.forEach(n=>n.hls.setSubtitleOption(t)||t.id!==-1&&n.hls.setSubtitleOption(s))}onBufferCodecs(e,t){const s=t.tracks;s&&(this.requiredTracks=s)}onBufferAppended(e,t){this.checkBuffer()}onBufferFlushed(e,t){const s=this.playingItem;if(s&&!this.itemsMatch(s,this.bufferingItem)&&!this.isInterstitial(s)){const n=this.timelinePos;this.bufferedPos=n,this.checkBuffer()}}onBufferedToEnd(e){const t=this.schedule.events;if(this.bufferedPos<Number.MAX_VALUE&&t){for(let n=0;n<t.length;n++){const r=t[n];if(r.cue.post){var s;const o=this.schedule.findEventIndex(r.identifier),c=(s=this.schedule.items)==null?void 0:s[o];this.isInterstitial(c)&&this.eventItemsMatch(c,this.bufferingItem)&&this.bufferedToItem(c,0);break}}this.bufferedPos=Number.MAX_VALUE}}onMediaEnded(e){const t=this.playingItem;if(!this.playingLastItem&&t){const s=this.findItemIndex(t);this.setSchedulePosition(s+1)}else this.shouldPlay=!1}updateItem(e,t){const s=this.schedule.items;if(e&&s){const n=this.findItemIndex(e,t);return s[n]||null}return null}trimInPlace(e,t){if(this.isInterstitial(e)&&e.event.appendInPlace&&t.end-e.end>.25){e.event.assetList.forEach((r,o)=>{e.event.isAssetPastPlayoutLimit(o)&&this.clearAssetPlayer(r.identifier,null)});const s=e.end+.25,n=at.bufferInfo(this.primaryMedia,s,0);(n.end>s||(n.nextStart||0)>s)&&(this.attachPrimary(s,null),this.flushFrontBuffer(s))}}itemsMatch(e,t){return!!t&&(e===t||e.event&&t.event&&this.eventItemsMatch(e,t)||!e.event&&!t.event&&this.findItemIndex(e)===this.findItemIndex(t))}eventItemsMatch(e,t){var s;return!!t&&(e===t||e.event.identifier===((s=t.event)==null?void 0:s.identifier))}findItemIndex(e,t){return e?this.schedule.findItemIndex(e,t):-1}updateSchedule(){const e=this.mediaSelection;e&&this.schedule.updateSchedule(e,[])}checkBuffer(e){const t=this.schedule.items;if(!t)return;const s=at.bufferInfo(this.primaryMedia,this.timelinePos,0);e&&(this.bufferedPos=this.timelinePos),e||(e=s.len<1),this.updateBufferedPos(s.end,t,e)}updateBufferedPos(e,t,s){const n=this.schedule,r=this.bufferingItem;if(this.bufferedPos>e)return;if(t.length===1&&this.itemsMatch(t[0],r)){this.bufferedPos=e;return}const o=this.playingItem,c=this.findItemIndex(o);let d=n.findItemIndexAtTime(e);if(this.bufferedPos<e){var u,f;const m=this.findItemIndex(r),p=Math.min(m+1,t.length-1),v=t[p];if((d===-1&&r&&e>=r.end||(u=v.event)!=null&&u.appendInPlace&&e+.01>=v.start)&&(d=p),p-c>1&&(r==null||(f=r.event)==null?void 0:f.appendInPlace)===!1)return;if(this.bufferedPos=e,d>m&&d>c)this.bufferedToItem(v);else{const S=this.primaryDetails;this.primaryLive&&S&&e>S.edge-S.targetduration&&v.start<S.edge+this.hls.config.interstitialLiveLookAhead&&this.isInterstitial(v)&&this.preloadAssets(v.event,0)}}else s&&o&&!this.itemsMatch(o,r)&&(d===c?this.bufferedToItem(o):d===c+1&&this.bufferedToItem(t[d]))}assetsBuffered(e,t){return e.event.assetList.length===0?!1:!e.event.assetList.some(n=>{const r=this.getAssetPlayer(n.identifier);return!(r!=null&&r.bufferedInPlaceToEnd(t))})}setBufferingItem(e){const t=this.bufferingItem,s=this.schedule;if(this.itemsMatch(e,t))this.bufferingItem!==e&&(this.bufferingItem=e);else{const{items:n,events:r}=s;if(!n||!r)return t;const o=this.isInterstitial(e),c=this.getBufferingPlayer();this.bufferingItem=e,this.bufferedPos=Math.max(e.start,Math.min(e.end,this.timelinePos));const d=c?c.remaining:t?t.end-this.timelinePos:0;this.log(`INTERSTITIALS_BUFFERED_TO_BOUNDARY ${Kr(e)}`+(t?` (${d.toFixed(2)} remaining)`:"")),this.playbackDisabled||(o?e.event.assetList.forEach(u=>{const f=this.getAssetPlayer(u.identifier);f&&f.resumeBuffering()}):(this.hls.resumeBuffering(),this.playerQueue.forEach(u=>u.pauseBuffering()))),this.hls.trigger(w.INTERSTITIALS_BUFFERED_TO_BOUNDARY,{events:r.slice(0),schedule:n.slice(0),bufferingIndex:this.findItemIndex(e),playingIndex:this.findItemIndex(this.playingItem)})}return t}bufferedToItem(e,t=0){const s=this.setBufferingItem(e);if(!this.playbackDisabled){if(this.isInterstitial(e))this.bufferedToEvent(e,t);else if(s!==null){this.bufferingAsset=null;const n=this.detachedData;n?n.mediaSource?this.attachPrimary(e.start,e,!0):this.preloadPrimary(e):this.preloadPrimary(e)}}}preloadPrimary(e){const t=this.findItemIndex(e),s=this.getPrimaryResumption(e,t);this.startLoadingPrimaryAt(s)}bufferedToEvent(e,t){const s=e.event,n=s.assetList.length===0&&!s.assetListLoader,r=s.cue.once;if(n||!r){const o=this.preloadAssets(s,t);if(o!=null&&o.interstitial.appendInPlace){const c=s.assetList[t],d=this.primaryMedia;c&&d&&this.bufferAssetPlayer(o,d)}}}preloadAssets(e,t){const s=e.assetUrl,n=e.assetList.length,r=n===0&&!e.assetListLoader,o=e.cue.once;if(r){const d=e.timelineStart;if(e.appendInPlace){var c;const p=this.playingItem;!this.isInterstitial(p)&&(p==null||(c=p.nextEvent)==null?void 0:c.identifier)===e.identifier&&this.flushFrontBuffer(d+.25)}let u,f=0;if(!this.playingItem&&this.primaryLive&&(f=this.hls.startPosition,f===-1&&(f=this.hls.liveSyncPosition||0)),f&&!(e.cue.pre||e.cue.post)){const p=f-d;p>0&&(u=Math.round(p*1e3)/1e3)}if(this.log(`Load interstitial asset ${t+1}/${s?1:n} ${e}${u?` live-start: ${f} start-offset: ${u}`:""}`),s)return this.createAsset(e,0,0,d,e.duration,s);const m=this.assetListLoader.loadAssetList(e,u);m&&(e.assetListLoader=m)}else if(!o&&n){for(let d=t;d<n;d++){const u=e.assetList[d],f=this.getAssetPlayerQueueIndex(u.identifier);(f===-1||this.playerQueue[f].destroyed)&&!u.error&&this.createAssetPlayer(e,u,d)}return this.getAssetPlayer(e.assetList[t].identifier)}return null}flushFrontBuffer(e){const t=this.requiredTracks;if(!t)return;this.log(`Removing front buffer starting at ${e}`),Object.keys(t).forEach(n=>{this.hls.trigger(w.BUFFER_FLUSHING,{startOffset:e,endOffset:1/0,type:n})})}getAssetPlayerQueueIndex(e){const t=this.playerQueue;for(let s=0;s<t.length;s++)if(e===t[s].assetId)return s;return-1}getAssetPlayer(e){const t=this.getAssetPlayerQueueIndex(e);return this.playerQueue[t]||null}getBufferingPlayer(){const{playerQueue:e,primaryMedia:t}=this;if(t){for(let s=0;s<e.length;s++)if(e[s].media===t)return e[s]}return null}createAsset(e,t,s,n,r,o){const c={parentIdentifier:e.identifier,identifier:WM(e,o,t),duration:r,startOffset:s,timelineStart:n,uri:o};return this.createAssetPlayer(e,c,t)}createAssetPlayer(e,t,s){const n=this.hls,r=n.userConfig;let o=r.videoPreference;const c=n.loadLevelObj||n.levels[n.currentLevel];(o||c)&&(o=Ft({},o),c.videoCodec&&(o.videoCodec=c.videoCodec),c.videoRange&&(o.allowedVideoRanges=[c.videoRange]));const d=n.audioTracks[n.audioTrack],u=n.subtitleTracks[n.subtitleTrack];let f=0;if(this.primaryLive||e.appendInPlace){const I=this.timelinePos-t.timelineStart;if(I>1){const C=t.duration;C&&I<C&&(f=I)}}const m=t.identifier,p=_t(_t({},r),{},{autoStartLoad:!0,startFragPrefetch:!0,primarySessionId:n.sessionId,assetPlayerId:m,abrEwmaDefaultEstimate:n.bandwidthEstimate,interstitialsController:void 0,startPosition:f,liveDurationInfinity:!1,testBandwidth:!1,videoPreference:o,audioPreference:d||r.audioPreference,subtitlePreference:u||r.subtitlePreference});e.appendInPlace&&(e.appendInPlaceStarted=!0,t.timelineStart&&(p.timelineOffset=t.timelineStart));const v=p.cmcd;v!=null&&v.sessionId&&v.contentId&&(p.cmcd=Ft({},v,{contentId:jc(t.uri)})),this.getAssetPlayer(m)&&this.warn(`Duplicate date range identifier ${e} and asset ${m}`);const S=new eU(this.HlsPlayerClass,p,e,t);this.playerQueue.push(S),e.assetList[s]=t;const y=I=>{if(I.live){const D=new Error(`Interstitials MUST be VOD assets ${e}`),_={fatal:!0,type:Ke.OTHER_ERROR,details:se.INTERSTITIAL_ASSET_ITEM_ERROR,error:D};this.handleAssetItemError(_,e,this.schedule.findEventIndex(e.identifier),s,D.message);return}const C=I.edge-I.fragmentStart,L=t.duration;(L===null||C>L)&&(this.log(`Interstitial asset "${m}" duration change ${L} > ${C}`),t.duration=C,this.updateSchedule())};S.on(w.LEVEL_UPDATED,(I,{details:C})=>y(C)),S.on(w.LEVEL_PTS_UPDATED,(I,{details:C})=>y(C));const E=(I,C)=>{const L=this.getAssetPlayer(m);if(L&&C.tracks){L.off(w.BUFFER_CODECS,E),L.tracks=C.tracks;const D=this.primaryMedia;this.bufferingAsset===L.assetItem&&D&&!L.media&&this.bufferAssetPlayer(L,D)}};S.on(w.BUFFER_CODECS,E);const A=()=>{var I;const C=this.getAssetPlayer(m);if(this.log(`buffered to end of asset ${C}`),!C)return;const L=this.schedule.findEventIndex(e.identifier),D=(I=this.schedule.items)==null?void 0:I[L];if(this.isInterstitial(D)){const M=e.findAssetIndex(t),U=zg(e,M);if(!e.isAssetPastPlayoutLimit(U))this.bufferedToItem(D,U);else{var _;const F=(_=this.schedule.items)==null?void 0:_[L+1];F&&this.bufferedToItem(F)}}};S.on(w.BUFFERED_TO_END,A);const R=I=>()=>{if(!this.getAssetPlayer(m))return;this.shouldPlay=!0;const L=this.schedule.findEventIndex(e.identifier);this.advanceAfterAssetEnded(e,L,I)};return S.once(w.MEDIA_ENDED,R(s)),S.once(w.PLAYOUT_LIMIT_REACHED,R(1/0)),S.on(w.ERROR,(I,C)=>{const L=this.getAssetPlayer(m);if(C.details===se.BUFFER_STALLED_ERROR){if(L!=null&&L.media){const D=L.currentTime,_=L.duration-D;D&&e.appendInPlace&&_/L.media.playbackRate<.5?(this.log(`Advancing buffer past end of asset ${m} ${e} at ${L.media.currentTime}`),A()):(this.warn(`Stalled at ${D} of ${D+_} in asset ${m} ${e}`),this.onTimeupdate(),this.checkBuffer(!0))}return}this.handleAssetItemError(C,e,this.schedule.findEventIndex(e.identifier),s,`Asset player error ${C.error} ${e}`)}),S.on(w.DESTROYING,()=>{if(!this.getAssetPlayer(m))return;const C=new Error(`Asset player destroyed unexpectedly ${m}`),L={fatal:!0,type:Ke.OTHER_ERROR,details:se.INTERSTITIAL_ASSET_ITEM_ERROR,error:C};this.handleAssetItemError(L,e,this.schedule.findEventIndex(e.identifier),s,C.message)}),this.log(`INTERSTITIAL_ASSET_PLAYER_CREATED ${Zo(t)}`),this.hls.trigger(w.INTERSTITIAL_ASSET_PLAYER_CREATED,{asset:t,assetListIndex:s,event:e,player:S}),S}clearInterstitial(e,t){e.assetList.forEach(s=>{this.clearAssetPlayer(s.identifier,t)}),e.reset()}resetAssetPlayer(e){const t=this.getAssetPlayerQueueIndex(e);if(t!==-1){this.log(`reset asset player "${e}" after error`);const s=this.playerQueue[t];this.transferMediaFromPlayer(s,null),s.resetDetails()}}clearAssetPlayer(e,t){const s=this.getAssetPlayerQueueIndex(e);if(s!==-1){this.log(`clear asset player "${e}" toSegment: ${t&&Kr(t)}`);const n=this.playerQueue[s];this.transferMediaFromPlayer(n,t),this.playerQueue.splice(s,1),n.destroy()}}emptyPlayerQueue(){let e;for(;e=this.playerQueue.pop();)e.destroy();this.playerQueue=[]}startAssetPlayer(e,t,s,n,r){const{interstitial:o,assetItem:c,assetId:d}=e,u=o.assetList.length,f=this.playingAsset;this.endedAsset=null,this.playingAsset=c,(!f||f.identifier!==d)&&(f&&(this.clearAssetPlayer(f.identifier,s[n]),delete f.error),this.log(`INTERSTITIAL_ASSET_STARTED ${t+1}/${u} ${Zo(c)}`),this.hls.trigger(w.INTERSTITIAL_ASSET_STARTED,{asset:c,assetListIndex:t,event:o,schedule:s.slice(0),scheduleIndex:n,player:e})),this.bufferAssetPlayer(e,r)}bufferAssetPlayer(e,t){var s,n;const{interstitial:r,assetItem:o}=e,c=this.schedule.findEventIndex(r.identifier),d=(s=this.schedule.items)==null?void 0:s[c];if(!d)return;this.setBufferingItem(d),this.bufferingAsset=o;const u=this.getBufferingPlayer();if(u===e)return;const f=r.appendInPlace;if(f&&(u==null?void 0:u.interstitial.appendInPlace)===!1)return;const m=(u==null?void 0:u.tracks)||((n=this.detachedData)==null?void 0:n.tracks)||this.requiredTracks;if(f&&o!==this.playingAsset){if(!e.tracks)return;if(m&&!TA(m,e.tracks)){const p=new Error(`Asset ${Zo(o)} SourceBuffer tracks ('${Object.keys(e.tracks)}') are not compatible with primary content tracks ('${Object.keys(m)}')`),v={fatal:!0,type:Ke.OTHER_ERROR,details:se.INTERSTITIAL_ASSET_ITEM_ERROR,error:p},S=r.findAssetIndex(o);this.handleAssetItemError(v,r,c,S,p.message);return}}this.transferMediaTo(e,t)}handleAssetItemError(e,t,s,n,r){if(e.details===se.BUFFER_STALLED_ERROR)return;const o=t.assetList[n];this.warn(`INTERSTITIAL_ASSET_ERROR ${o&&Zo(o)} ${e.error}`);const c=o==null?void 0:o.identifier,d=this.getAssetPlayerQueueIndex(c),u=this.playerQueue[d]||null,f=this.schedule.items,m=Ft({},e,{fatal:!1,errorAction:Qc(!0),asset:o,assetListIndex:n,event:t,schedule:f,scheduleIndex:s,player:u});if(this.hls.trigger(w.INTERSTITIAL_ASSET_ERROR,m),!e.fatal)return;const p=this.playingAsset,v=new Error(r);if(o&&(this.clearAssetPlayer(c,null),o.error=v),!t.assetList.some(S=>!S.error))t.error=v;else if(t.appendInPlace){for(let S=n;S<t.assetList.length;S++)this.resetAssetPlayer(t.assetList[S].identifier);this.updateSchedule()}t.error?this.primaryFallback(t):p&&p.identifier===c&&this.advanceAfterAssetEnded(t,s,n)}primaryFallback(e){const t=e.timelineStart,s=this.effectivePlayingItem;if(this.updateSchedule(),s){this.log(`Fallback to primary from event "${e.identifier}" start: ${t} pos: ${this.timelinePos} playing: ${s?Kr(s):"<none>"} error: ${e.error}`);let n=this.timelinePos;n===-1&&(n=this.hls.startPosition);const r=this.updateItem(s,n);this.itemsMatch(s,r)&&this.clearInterstitial(e,null),e.appendInPlace&&(this.attachPrimary(t,null),this.flushFrontBuffer(t));const o=this.schedule.findItemIndexAtTime(n);this.setSchedulePosition(o)}else this.checkStart()}onAssetListLoaded(e,t){var s;const n=t.event,r=n.identifier,o=t.assetListResponse.ASSETS;if(!this.schedule.hasEvent(r))return;const c=n.timelineStart,d=n.duration;let u=0;o.forEach((S,y)=>{const E=parseFloat(S.DURATION);this.createAsset(n,y,u,c+u,E,S.URI),u+=E}),n.duration=u,this.log(`Loaded asset-list with duration: ${u} (was: ${d}) ${n}`);const f=this.waitingItem,m=(f==null?void 0:f.event.identifier)===r;this.updateSchedule();const p=(s=this.bufferingItem)==null?void 0:s.event;if(m){var v;const S=this.schedule.findEventIndex(r),y=(v=this.schedule.items)==null?void 0:v[S];if(y){if(!this.playingItem&&this.timelinePos>y.end&&this.schedule.findItemIndexAtTime(this.timelinePos)!==S){n.error=new Error(`Interstitial no longer within playback range ${this.timelinePos} ${n}`),this.primaryFallback(n);return}this.setBufferingItem(y)}this.setSchedulePosition(S)}else if((p==null?void 0:p.identifier)===r&&p.appendInPlace){const S=n.assetList[0],y=this.getAssetPlayer(S.identifier),E=this.primaryMedia;S&&y&&E&&this.bufferAssetPlayer(y,E)}}onError(e,t){switch(t.details){case se.ASSET_LIST_PARSING_ERROR:case se.ASSET_LIST_LOAD_ERROR:case se.ASSET_LIST_LOAD_TIMEOUT:{const s=t.interstitial;s&&this.primaryFallback(s);break}case se.BUFFER_STALLED_ERROR:{this.onTimeupdate(),this.checkBuffer(!0);break}}}}const X1=500;class nU extends F0{constructor(e,t,s){super(e,t,s,"subtitle-stream-controller",ze.SUBTITLE),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(w.LEVEL_LOADED,this.onLevelLoaded,this),e.on(w.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(w.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(w.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(w.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(w.BUFFER_FLUSHING,this.onBufferFlushing,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(w.LEVEL_LOADED,this.onLevelLoaded,this),e.off(w.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(w.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(w.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(w.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(w.BUFFER_FLUSHING,this.onBufferFlushing,this)}startLoad(e,t){this.stopLoad(),this.state=pe.IDLE,this.setInterval(X1),this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}onManifestLoading(){super.onManifestLoading(),this.mainDetails=null}onMediaDetaching(e,t){this.tracksBuffered=[],super.onMediaDetaching(e,t)}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){const{frag:s,success:n}=t;if(Ds(s)&&(this.fragPrevious=s),this.state=pe.IDLE,!n)return;const r=this.tracksBuffered[this.currentTrackId];if(!r)return;let o;const c=s.start;for(let u=0;u<r.length;u++)if(c>=r[u].start&&c<=r[u].end){o=r[u];break}const d=s.start+s.duration;o?o.end=d:(o={start:c,end:d},r.push(o)),this.fragmentTracker.fragBuffered(s),this.fragBufferedComplete(s,null),this.media&&this.tick()}onBufferFlushing(e,t){const{startOffset:s,endOffset:n}=t;if(s===0&&n!==Number.POSITIVE_INFINITY){const r=n-1;if(r<=0)return;t.endOffsetSubtitles=Math.max(0,r),this.tracksBuffered.forEach(o=>{for(let c=0;c<o.length;){if(o[c].end<=r){o.shift();continue}else if(o[c].start<r)o[c].start=r;else break;c++}}),this.fragmentTracker.removeFragmentsInRange(s,r,ze.SUBTITLE)}}onError(e,t){const s=t.frag;(s==null?void 0:s.type)===ze.SUBTITLE&&(t.details===se.FRAG_GAP&&this.fragmentTracker.fragBuffered(s,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==pe.STOPPED&&(this.state=pe.IDLE))}onSubtitleTracksUpdated(e,{subtitleTracks:t}){if(this.levels&&xI(this.levels,t)){this.levels=t.map(s=>new qc(s));return}this.tracksBuffered=[],this.levels=t.map(s=>{const n=new qc(s);return this.tracksBuffered[n.id]=[],n}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,ze.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(e,t){var s;if(this.currentTrackId=t.id,!((s=this.levels)!=null&&s.length)||this.currentTrackId===-1){this.clearInterval();return}const n=this.levels[this.currentTrackId];n!=null&&n.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,n&&this.state!==pe.STOPPED&&this.setInterval(X1)}onSubtitleTrackLoaded(e,t){var s;const{currentTrackId:n,levels:r}=this,{details:o,id:c}=t;if(!r){this.warn(`Subtitle tracks were reset while loading level ${c}`);return}const d=r[c];if(c>=r.length||!d)return;this.log(`Subtitle track ${c} loaded [${o.startSN},${o.endSN}]${o.lastPartSn?`[part-${o.lastPartSn}-${o.lastPartIndex}]`:""},duration:${o.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let u=0;if(o.live||(s=d.details)!=null&&s.live){const m=this.mainDetails;if(o.deltaUpdateFailed||!m)return;const p=m.fragments[0];if(!d.details)o.hasProgramDateTime&&m.hasProgramDateTime?(Oh(o,m),u=o.fragmentStart):p&&(u=p.start,$p(o,u));else{var f;u=this.alignPlaylists(o,d.details,(f=this.levelLastLoaded)==null?void 0:f.details),u===0&&p&&(u=p.start,$p(o,u))}}d.details=o,this.levelLastLoaded=d,c===n&&(this.hls.trigger(w.SUBTITLE_TRACK_UPDATED,{details:o,id:c,groupId:t.groupId}),this.tick(),o.live&&!this.fragCurrent&&this.media&&this.state===pe.IDLE&&(so(null,o.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),d.details=void 0)))}_handleFragmentLoadComplete(e){const{frag:t,payload:s}=e,n=t.decryptdata,r=this.hls;if(!this.fragContextChanged(t)&&s&&s.byteLength>0&&n!=null&&n.key&&n.iv&&tl(n.method)){const o=performance.now();this.decrypter.decrypt(new Uint8Array(s),n.key.buffer,n.iv.buffer,M0(n.method)).catch(c=>{throw r.trigger(w.ERROR,{type:Ke.MEDIA_ERROR,details:se.FRAG_DECRYPT_ERROR,fatal:!1,error:c,reason:c.message,frag:t}),c}).then(c=>{const d=performance.now();r.trigger(w.FRAG_DECRYPTED,{frag:t,payload:c,stats:{tstart:o,tdecrypt:d}})}).catch(c=>{this.warn(`${c.name}: ${c.message}`),this.state=pe.IDLE})}}doTick(){if(!this.media){this.state=pe.IDLE;return}if(this.state===pe.IDLE){const{currentTrackId:e,levels:t}=this,s=t==null?void 0:t[e];if(!s||!t.length||!s.details||this.waitForLive(s))return;const{config:n}=this,r=this.getLoadPosition(),o=at.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],r,n.maxBufferHole),{end:c,len:d}=o,u=s.details,f=this.hls.maxBufferLength+u.levelTargetDuration;if(d>f)return;const m=u.fragments,p=m.length,v=u.edge;let S=null;const y=this.fragPrevious;if(c<v){const R=n.maxFragLookUpTolerance,I=c>v-R?0:R;S=so(y,m,Math.max(m[0].start,c),I),!S&&y&&y.start<m[0].start&&(S=m[0])}else S=m[p-1];if(S=this.filterReplacedPrimary(S,s.details),!S)return;const E=S.sn-u.startSN,A=m[E-1];if(A&&A.cc===S.cc&&this.fragmentTracker.getState(A)===Es.NOT_LOADED&&(S=A),this.fragmentTracker.getState(S)===Es.NOT_LOADED){const R=this.mapToInitFragWhenRequired(S);R&&this.loadFragment(R,s,c)}}}loadFragment(e,t,s){Ds(e)?super.loadFragment(e,t,s):this._loadInitSegment(e,t)}get mediaBufferTimeRanges(){return new rU(this.tracksBuffered[this.currentTrackId]||[])}}class rU{constructor(e){this.buffered=void 0;const t=(s,n,r)=>{if(n=n>>>0,n>r-1)throw new DOMException(`Failed to execute '${s}' on 'TimeRanges': The index provided (${n}) is greater than the maximum bound (${r})`);return e[n][s]};this.buffered={get length(){return e.length},end(s){return t("end",s,e.length)},start(s){return t("start",s,e.length)}}}}const aU={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},DI=i=>String.fromCharCode(aU[i]||i),tn=15,nr=100,oU={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},lU={17:2,18:4,21:6,22:8,23:10,19:13,20:15},cU={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},uU={25:2,26:4,29:6,30:8,31:10,27:13,28:15},dU=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class hU{constructor(){this.time=null,this.verboseLevel=0}log(e,t){if(this.verboseLevel>=e){const s=typeof t=="function"?t():t;wt.log(`${this.time} [${e}] ${s}`)}}}const Fa=function(e){const t=[];for(let s=0;s<e.length;s++)t.push(e[s].toString(16));return t};class _I{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const t=["foreground","underline","italics","background","flash"];for(let s=0;s<t.length;s++){const n=t[s];e.hasOwnProperty(n)&&(this[n]=e[n])}}isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class fU{constructor(){this.uchar=" ",this.penState=new _I}reset(){this.uchar=" ",this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return this.uchar===" "&&this.penState.isDefault()}}class mU{constructor(e){this.chars=[],this.pos=0,this.currPenState=new _I,this.cueStartTime=null,this.logger=void 0;for(let t=0;t<nr;t++)this.chars.push(new fU);this.logger=e}equals(e){for(let t=0;t<nr;t++)if(!this.chars[t].equals(e.chars[t]))return!1;return!0}copy(e){for(let t=0;t<nr;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<nr;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>nr&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=nr)}moveCursor(e){const t=this.pos+e;if(e>1)for(let s=this.pos+1;s<t+1;s++)this.chars[s].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const t=DI(e);if(this.pos>=nr){this.logger.log(0,()=>"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1)}clearFromPos(e){let t;for(t=e;t<nr;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let t=!0;for(let s=0;s<nr;s++){const n=this.chars[s].uchar;n!==" "&&(t=!1),e.push(n)}return t?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}}class Kg{constructor(e){this.rows=[],this.currRow=tn-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let t=0;t<tn;t++)this.rows.push(new mU(e));this.logger=e}reset(){for(let e=0;e<tn;e++)this.rows[e].clear();this.currRow=tn-1}equals(e){let t=!0;for(let s=0;s<tn;s++)if(!this.rows[s].equals(e.rows[s])){t=!1;break}return t}copy(e){for(let t=0;t<tn;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<tn;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(e){this.rows[this.currRow].insertChar(e)}setPen(e){this.rows[this.currRow].setPenStyles(e)}moveCursor(e){this.rows[this.currRow].moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)}setPAC(e){this.logger.log(2,()=>"pacData = "+es(e));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let c=0;c<tn;c++)this.rows[c].clear();const r=this.currRow+1-this.nrRollUpRows,o=this.lastOutputScreen;if(o){const c=o.rows[r].cueStartTime,d=this.logger.time;if(c!==null&&d!==null&&c<d)for(let u=0;u<this.nrRollUpRows;u++)this.rows[t-this.nrRollUpRows+u+1].copy(o.rows[r+u])}}this.currRow=t;const s=this.rows[this.currRow];if(e.indent!==null){const r=e.indent,o=Math.max(r-1,0);s.setCursor(e.indent),e.color=s.chars[o].penState.foreground}const n={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(n)}setBkgData(e){this.logger.log(2,()=>"bkgData = "+es(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());const e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const t=[];let s="",n=-1;for(let r=0;r<tn;r++){const o=this.rows[r].getTextString();o&&(n=r+1,e?t.push("Row "+n+": '"+o+"'"):t.push(o.trim()))}return t.length>0&&(e?s="["+t.join(" | ")+"]":s=t.join(`
`)),s}getTextAndFormat(){return this.rows}}class W1{constructor(e,t,s){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new Kg(s),this.nonDisplayedMemory=new Kg(s),this.lastOutputScreen=new Kg(s),this.currRollUpRow=this.displayedMemory.rows[tn-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=s}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[tn-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,()=>"MODE="+e),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let s=0;s<e.length;s++)this.writeScreen.insertChar(e[s]);const t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>t+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const t={flash:!1};if(t.underline=e%2===1,t.italics=e>=46,t.italics)t.foreground="white";else{const s=Math.floor(e/2)-16,n=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=n[s]}this.logger.log(2,"MIDROW: "+es(t)),this.writeScreen.setPen(t)}outputDataUpdate(e=!1){const t=this.logger.time;t!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=t:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t),this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}class Z1{constructor(e,t,s){this.channels=void 0,this.currentChannel=0,this.cmdHistory=pU(),this.logger=void 0;const n=this.logger=new hU;this.channels=[null,new W1(e,t,n),new W1(e+1,s,n)]}getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){this.logger.time=e;for(let s=0;s<t.length;s+=2){const n=t[s]&127,r=t[s+1]&127;let o=!1,c=null;if(n===0&&r===0)continue;this.logger.log(3,()=>"["+Fa([t[s],t[s+1]])+"] -> ("+Fa([n,r])+")");const d=this.cmdHistory;if(n>=16&&n<=31){if(gU(n,r,d)){Kd(null,null,d),this.logger.log(3,()=>"Repeated command ("+Fa([n,r])+") is dropped");continue}Kd(n,r,this.cmdHistory),o=this.parseCmd(n,r),o||(o=this.parseMidrow(n,r)),o||(o=this.parsePAC(n,r)),o||(o=this.parseBackgroundAttributes(n,r))}else Kd(null,null,d);if(!o&&(c=this.parseChars(n,r),c)){const f=this.currentChannel;f&&f>0?this.channels[f].insertChars(c):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!o&&!c&&this.logger.log(2,()=>"Couldn't parse cleaned data "+Fa([n,r])+" orig: "+Fa([t[s],t[s+1]]))}}parseCmd(e,t){const s=(e===20||e===28||e===21||e===29)&&t>=32&&t<=47,n=(e===23||e===31)&&t>=33&&t<=35;if(!(s||n))return!1;const r=e===20||e===21||e===23?1:2,o=this.channels[r];return e===20||e===21||e===28||e===29?t===32?o.ccRCL():t===33?o.ccBS():t===34?o.ccAOF():t===35?o.ccAON():t===36?o.ccDER():t===37?o.ccRU(2):t===38?o.ccRU(3):t===39?o.ccRU(4):t===40?o.ccFON():t===41?o.ccRDC():t===42?o.ccTR():t===43?o.ccRTD():t===44?o.ccEDM():t===45?o.ccCR():t===46?o.ccENM():t===47&&o.ccEOC():o.ccTO(t-32),this.currentChannel=r,!0}parseMidrow(e,t){let s=0;if((e===17||e===25)&&t>=32&&t<=47){if(e===17?s=1:s=2,s!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const n=this.channels[s];return n?(n.ccMIDROW(t),this.logger.log(3,()=>"MIDROW ("+Fa([e,t])+")"),!0):!1}return!1}parsePAC(e,t){let s;const n=(e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127,r=(e===16||e===24)&&t>=64&&t<=95;if(!(n||r))return!1;const o=e<=23?1:2;t>=64&&t<=95?s=o===1?oU[e]:cU[e]:s=o===1?lU[e]:uU[e];const c=this.channels[o];return c?(c.setPAC(this.interpretPAC(s,t)),this.currentChannel=o,!0):!1}interpretPAC(e,t){let s;const n={color:null,italics:!1,indent:null,underline:!1,row:e};return t>95?s=t-96:s=t-64,n.underline=(s&1)===1,s<=13?n.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(s/2)]:s<=15?(n.italics=!0,n.color="white"):n.indent=Math.floor((s-16)/2)*4,n}parseChars(e,t){let s,n=null,r=null;if(e>=25?(s=2,r=e-8):(s=1,r=e),r>=17&&r<=19){let o;r===17?o=t+80:r===18?o=t+112:o=t+144,this.logger.log(2,()=>"Special char '"+DI(o)+"' in channel "+s),n=[o]}else e>=32&&e<=127&&(n=t===0?[e]:[e,t]);return n&&this.logger.log(3,()=>"Char codes =  "+Fa(n).join(",")),n}parseBackgroundAttributes(e,t){const s=(e===16||e===24)&&t>=32&&t<=47,n=(e===23||e===31)&&t>=45&&t<=47;if(!(s||n))return!1;let r;const o={};e===16||e===24?(r=Math.floor((t-32)/2),o.background=dU[r],t%2===1&&(o.background=o.background+"_semi")):t===45?o.background="transparent":(o.foreground="black",t===47&&(o.underline=!0));const c=e<=23?1:2;return this.channels[c].setBkgData(o),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const t=this.channels[e];t&&t.reset()}Kd(null,null,this.cmdHistory)}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){const s=this.channels[t];s&&s.cueSplitAtTime(e)}}}function Kd(i,e,t){t.a=i,t.b=e}function gU(i,e,t){return t.a===i&&t.b===e}function pU(){return{a:null,b:null}}var Q0=function(){if(Ch!=null&&Ch.VTTCue)return self.VTTCue;const i=["","lr","rl"],e=["start","middle","end","left","right"];function t(c,d){if(typeof d!="string"||!Array.isArray(c))return!1;const u=d.toLowerCase();return~c.indexOf(u)?u:!1}function s(c){return t(i,c)}function n(c){return t(e,c)}function r(c,...d){let u=1;for(;u<arguments.length;u++){const f=arguments[u];for(const m in f)c[m]=f[m]}return c}function o(c,d,u){const f=this,m={enumerable:!0};f.hasBeenReset=!1;let p="",v=!1,S=c,y=d,E=u,A=null,R="",I=!0,C="auto",L="start",D=50,_="middle",M=50,U="middle";Object.defineProperty(f,"id",r({},m,{get:function(){return p},set:function(F){p=""+F}})),Object.defineProperty(f,"pauseOnExit",r({},m,{get:function(){return v},set:function(F){v=!!F}})),Object.defineProperty(f,"startTime",r({},m,{get:function(){return S},set:function(F){if(typeof F!="number")throw new TypeError("Start time must be set to a number.");S=F,this.hasBeenReset=!0}})),Object.defineProperty(f,"endTime",r({},m,{get:function(){return y},set:function(F){if(typeof F!="number")throw new TypeError("End time must be set to a number.");y=F,this.hasBeenReset=!0}})),Object.defineProperty(f,"text",r({},m,{get:function(){return E},set:function(F){E=""+F,this.hasBeenReset=!0}})),Object.defineProperty(f,"region",r({},m,{get:function(){return A},set:function(F){A=F,this.hasBeenReset=!0}})),Object.defineProperty(f,"vertical",r({},m,{get:function(){return R},set:function(F){const z=s(F);if(z===!1)throw new SyntaxError("An invalid or illegal string was specified.");R=z,this.hasBeenReset=!0}})),Object.defineProperty(f,"snapToLines",r({},m,{get:function(){return I},set:function(F){I=!!F,this.hasBeenReset=!0}})),Object.defineProperty(f,"line",r({},m,{get:function(){return C},set:function(F){if(typeof F!="number"&&F!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");C=F,this.hasBeenReset=!0}})),Object.defineProperty(f,"lineAlign",r({},m,{get:function(){return L},set:function(F){const z=n(F);if(!z)throw new SyntaxError("An invalid or illegal string was specified.");L=z,this.hasBeenReset=!0}})),Object.defineProperty(f,"position",r({},m,{get:function(){return D},set:function(F){if(F<0||F>100)throw new Error("Position must be between 0 and 100.");D=F,this.hasBeenReset=!0}})),Object.defineProperty(f,"positionAlign",r({},m,{get:function(){return _},set:function(F){const z=n(F);if(!z)throw new SyntaxError("An invalid or illegal string was specified.");_=z,this.hasBeenReset=!0}})),Object.defineProperty(f,"size",r({},m,{get:function(){return M},set:function(F){if(F<0||F>100)throw new Error("Size must be between 0 and 100.");M=F,this.hasBeenReset=!0}})),Object.defineProperty(f,"align",r({},m,{get:function(){return U},set:function(F){const z=n(F);if(!z)throw new SyntaxError("An invalid or illegal string was specified.");U=z,this.hasBeenReset=!0}})),f.displayState=void 0}return o.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},o}();class yU{decode(e,t){if(!e)return"";if(typeof e!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function PI(i){function e(s,n,r,o){return(s|0)*3600+(n|0)*60+(r|0)+parseFloat(o||0)}const t=i.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return t?parseFloat(t[2])>59?e(t[2],t[3],0,t[4]):e(t[1],t[2],t[3],t[4]):null}let vU=class{constructor(){this.values=Object.create(null)}set(e,t){!this.get(e)&&t!==""&&(this.values[e]=t)}get(e,t,s){return s?this.has(e)?this.values[e]:t[s]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,s){for(let n=0;n<s.length;++n)if(t===s[n]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){const s=parseFloat(t);if(s>=0&&s<=100)return this.set(e,s),!0}return!1}};function kI(i,e,t,s){const n=s?i.split(s):[i];for(const r in n){if(typeof n[r]!="string")continue;const o=n[r].split(t);if(o.length!==2)continue;const c=o[0],d=o[1];e(c,d)}}const Qp=new Q0(0,0,""),Yd=Qp.align==="middle"?"middle":"center";function SU(i,e,t){const s=i;function n(){const c=PI(i);if(c===null)throw new Error("Malformed timestamp: "+s);return i=i.replace(/^[^\sa-zA-Z-]+/,""),c}function r(c,d){const u=new vU;kI(c,function(p,v){let S;switch(p){case"region":for(let y=t.length-1;y>=0;y--)if(t[y].id===v){u.set(p,t[y].region);break}break;case"vertical":u.alt(p,v,["rl","lr"]);break;case"line":S=v.split(","),u.integer(p,S[0]),u.percent(p,S[0])&&u.set("snapToLines",!1),u.alt(p,S[0],["auto"]),S.length===2&&u.alt("lineAlign",S[1],["start",Yd,"end"]);break;case"position":S=v.split(","),u.percent(p,S[0]),S.length===2&&u.alt("positionAlign",S[1],["start",Yd,"end","line-left","line-right","auto"]);break;case"size":u.percent(p,v);break;case"align":u.alt(p,v,["start",Yd,"end","left","right"]);break}},/:/,/\s/),d.region=u.get("region",null),d.vertical=u.get("vertical","");let f=u.get("line","auto");f==="auto"&&Qp.line===-1&&(f=-1),d.line=f,d.lineAlign=u.get("lineAlign","start"),d.snapToLines=u.get("snapToLines",!0),d.size=u.get("size",100),d.align=u.get("align",Yd);let m=u.get("position","auto");m==="auto"&&Qp.position===50&&(m=d.align==="start"||d.align==="left"?0:d.align==="end"||d.align==="right"?100:50),d.position=m}function o(){i=i.replace(/^\s+/,"")}if(o(),e.startTime=n(),o(),i.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+s);i=i.slice(3),o(),e.endTime=n(),o(),r(i,e)}function NI(i){return i.replace(/<br(?: \/)?>/gi,`
`)}class xU{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new yU,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){const t=this;e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));function s(){let r=t.buffer,o=0;for(r=NI(r);o<r.length&&r[o]!=="\r"&&r[o]!==`
`;)++o;const c=r.slice(0,o);return r[o]==="\r"&&++o,r[o]===`
`&&++o,t.buffer=r.slice(o),c}function n(r){kI(r,function(o,c){},/:/)}try{let r="";if(t.state==="INITIAL"){if(!/\r\n|\n/.test(t.buffer))return this;r=s();const c=r.match(/^()?WEBVTT([ \t].*)?$/);if(!(c!=null&&c[0]))throw new Error("Malformed WebVTT signature.");t.state="HEADER"}let o=!1;for(;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(o?o=!1:r=s(),t.state){case"HEADER":/:/.test(r)?n(r):r||(t.state="ID");continue;case"NOTE":r||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(r)){t.state="NOTE";break}if(!r)continue;if(t.cue=new Q0(0,0,""),t.state="CUE",r.indexOf("-->")===-1){t.cue.id=r;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{SU(r,t.cue,t.regionList)}catch{t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{const c=r.indexOf("-->")!==-1;if(!r||c&&(o=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(t.cue===null)continue;t.cue.text&&(t.cue.text+=`
`),t.cue.text+=r}continue;case"BADCUE":r||(t.state="ID")}}}catch{t.state==="CUETEXT"&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state=t.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||e.state==="HEADER")&&(e.buffer+=`

`,e.parse()),e.state==="INITIAL"||e.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}}const TU=/\r\n|\n\r|\n|\r/g,Yg=function(e,t,s=0){return e.slice(s,s+t.length)===t},EU=function(e){let t=parseInt(e.slice(-3));const s=parseInt(e.slice(-6,-4)),n=parseInt(e.slice(-9,-7)),r=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!Fe(t)||!Fe(s)||!Fe(n)||!Fe(r))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return t+=1e3*s,t+=60*1e3*n,t+=60*60*1e3*r,t};function X0(i,e,t){return jc(i.toString())+jc(e.toString())+jc(t)}const bU=function(e,t,s){let n=e[t],r=e[n.prevCC];if(!r||!r.new&&n.new){e.ccOffset=e.presentationOffset=n.start,n.new=!1;return}for(;(o=r)!=null&&o.new;){var o;e.ccOffset+=n.start-r.start,n.new=!1,n=r,r=e[n.prevCC]}e.presentationOffset=s};function AU(i,e,t,s,n,r,o){const c=new xU,d=Ci(new Uint8Array(i)).trim().replace(TU,`
`).split(`
`),u=[],f=e?BN(e.baseTime,e.timescale):0;let m="00:00.000",p=0,v=0,S,y=!0;c.oncue=function(E){const A=t[s];let R=t.ccOffset;const I=(p-f)/9e4;if(A!=null&&A.new&&(v!==void 0?R=t.ccOffset=A.start:bU(t,s,I)),I){if(!e){S=new Error("Missing initPTS for VTT MPEGTS");return}R=I-t.presentationOffset}const C=E.endTime-E.startTime,L=Hi((E.startTime+R-v)*9e4,n*9e4)/9e4;E.startTime=Math.max(L,0),E.endTime=Math.max(L+C,0);const D=E.text.trim();E.text=decodeURIComponent(encodeURIComponent(D)),E.id||(E.id=X0(E.startTime,E.endTime,D)),E.endTime>0&&u.push(E)},c.onparsingerror=function(E){S=E},c.onflush=function(){if(S){o(S);return}r(u)},d.forEach(E=>{if(y)if(Yg(E,"X-TIMESTAMP-MAP=")){y=!1,E.slice(16).split(",").forEach(A=>{Yg(A,"LOCAL:")?m=A.slice(6):Yg(A,"MPEGTS:")&&(p=parseInt(A.slice(7)))});try{v=EU(m)/1e3}catch(A){S=A}return}else E===""&&(y=!1);c.parse(E+`
`)}),c.flush()}const qg="stpp.ttml.im1t",MI=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,UI=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,IU={left:"start",center:"center",right:"end",start:"start",end:"end"};function J1(i,e,t,s){const n=ct(new Uint8Array(i),["mdat"]);if(n.length===0){s(new Error("Could not parse IMSC1 mdat"));return}const r=n.map(c=>Ci(c)),o=FN(e.baseTime,1,e.timescale);try{r.forEach(c=>t(RU(c,o)))}catch(c){s(c)}}function RU(i,e){const n=new DOMParser().parseFromString(i,"text/xml").getElementsByTagName("tt")[0];if(!n)throw new Error("Invalid ttml");const r={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},o=Object.keys(r).reduce((m,p)=>(m[p]=n.getAttribute(`ttp:${p}`)||r[p],m),{}),c=n.getAttribute("xml:space")!=="preserve",d=eE(Qg(n,"styling","style")),u=eE(Qg(n,"layout","region")),f=Qg(n,"body","[begin]");return[].map.call(f,m=>{const p=FI(m,c);if(!p||!m.hasAttribute("begin"))return null;const v=Wg(m.getAttribute("begin"),o),S=Wg(m.getAttribute("dur"),o);let y=Wg(m.getAttribute("end"),o);if(v===null)throw tE(m);if(y===null){if(S===null)throw tE(m);y=v+S}const E=new Q0(v-e,y-e,p);E.id=X0(E.startTime,E.endTime,E.text);const A=u[m.getAttribute("region")],R=d[m.getAttribute("style")],I=LU(A,R,d),{textAlign:C}=I;if(C){const L=IU[C];L&&(E.lineAlign=L),E.align=C}return Ft(E,I),E}).filter(m=>m!==null)}function Qg(i,e,t){const s=i.getElementsByTagName(e)[0];return s?[].slice.call(s.querySelectorAll(t)):[]}function eE(i){return i.reduce((e,t)=>{const s=t.getAttribute("xml:id");return s&&(e[s]=t),e},{})}function FI(i,e){return[].slice.call(i.childNodes).reduce((t,s,n)=>{var r;return s.nodeName==="br"&&n?t+`
`:(r=s.childNodes)!=null&&r.length?FI(s,e):e?t+s.textContent.trim().replace(/\s+/g," "):t+s.textContent},"")}function LU(i,e,t){const s="http://www.w3.org/ns/ttml#styling";let n=null;const r=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],o=i!=null&&i.hasAttribute("style")?i.getAttribute("style"):null;return o&&t.hasOwnProperty(o)&&(n=t[o]),r.reduce((c,d)=>{const u=Xg(e,s,d)||Xg(i,s,d)||Xg(n,s,d);return u&&(c[d]=u),c},{})}function Xg(i,e,t){return i&&i.hasAttributeNS(e,t)?i.getAttributeNS(e,t):null}function tE(i){return new Error(`Could not parse ttml timestamp ${i}`)}function Wg(i,e){if(!i)return null;let t=PI(i);return t===null&&(MI.test(i)?t=wU(i,e):UI.test(i)&&(t=CU(i,e))),t}function wU(i,e){const t=MI.exec(i),s=(t[4]|0)+(t[5]|0)/e.subFrameRate;return(t[1]|0)*3600+(t[2]|0)*60+(t[3]|0)+s/e.frameRate}function CU(i,e){const t=UI.exec(i),s=Number(t[1]);switch(t[2]){case"h":return s*3600;case"m":return s*60;case"ms":return s*1e3;case"f":return s/e.frameRate;case"t":return s/e.tickRate}return s}class qd{constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,s){(this.startTime===null||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=s,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}class OU{constructor(e){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=iE(),this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},e.on(w.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(w.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(w.MANIFEST_LOADING,this.onManifestLoading,this),e.on(w.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(w.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(w.FRAG_LOADING,this.onFragLoading,this),e.on(w.FRAG_LOADED,this.onFragLoaded,this),e.on(w.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(w.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(w.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(w.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(w.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:e}=this;e.off(w.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(w.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(w.MANIFEST_LOADING,this.onManifestLoading,this),e.off(w.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(w.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(w.FRAG_LOADING,this.onFragLoading,this),e.off(w.FRAG_LOADED,this.onFragLoaded,this),e.off(w.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(w.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(w.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(w.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(w.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.media=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){const e=new qd(this,"textTrack1"),t=new qd(this,"textTrack2"),s=new qd(this,"textTrack3"),n=new qd(this,"textTrack4");this.cea608Parser1=new Z1(1,e,t),this.cea608Parser2=new Z1(3,s,n)}addCues(e,t,s,n,r){let o=!1;for(let c=r.length;c--;){const d=r[c],u=DU(d[0],d[1],t,s);if(u>=0&&(d[0]=Math.min(d[0],t),d[1]=Math.max(d[1],s),o=!0,u/(s-t)>.5))return}if(o||r.push([t,s]),this.config.renderTextTracksNatively){const c=this.captionsTracks[e];this.Cues.newCue(c,t,s,n)}else{const c=this.Cues.newCue(null,t,s,n);this.hls.trigger(w.CUES_PARSED,{type:"captions",cues:c,track:e})}}onInitPtsFound(e,{frag:t,id:s,initPTS:n,timescale:r}){const{unparsedVttFrags:o}=this;s===ze.MAIN&&(this.initPTS[t.cc]={baseTime:n,timescale:r}),o.length&&(this.unparsedVttFrags=[],o.forEach(c=>{this.onFragLoaded(w.FRAG_LOADED,c)}))}getExistingTrack(e,t){const{media:s}=this;if(s)for(let n=0;n<s.textTracks.length;n++){const r=s.textTracks[n];if(sE(r,{name:e,lang:t,characteristics:"transcribes-spoken-dialog,describes-music-and-sound"}))return r}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:t,captionsTracks:s,media:n}=this,{label:r,languageCode:o}=t[e],c=this.getExistingTrack(r,o);if(c)s[e]=c,Jo(s[e]),wI(s[e],n);else{const d=this.createTextTrack("captions",r,o);d&&(d[e]=!0,s[e]=d)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const t=this.captionsProperties[e];if(!t)return;const s=t.label,n={_id:e,label:s,kind:"captions",default:t.media?!!t.media.default:!1,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=n,this.hls.trigger(w.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[n]})}createTextTrack(e,t,s){const n=this.media;if(n)return n.addTextTrack(e,t,s)}onMediaAttaching(e,t){this.media=t.media,t.mediaSource||this._cleanTracks()}onMediaDetaching(e,t){const s=!!t.transferMedia;if(this.media=null,s)return;const{captionsTracks:n}=this;Object.keys(n).forEach(r=>{Jo(n[r]),delete n[r]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=iE(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const t=e.textTracks;if(t)for(let s=0;s<t.length;s++)Jo(t[s])}onSubtitleTracksUpdated(e,t){const s=t.subtitleTracks||[],n=s.some(r=>r.textCodec===qg);if(this.config.enableWebVTT||n&&this.config.enableIMSC1){if(xI(this.tracks,s)){this.tracks=s;return}if(this.textTracks=[],this.tracks=s,this.config.renderTextTracksNatively){const o=this.media,c=o?uh(o.textTracks):null;if(this.tracks.forEach((d,u)=>{let f;if(c){let m=null;for(let p=0;p<c.length;p++)if(c[p]&&sE(c[p],d)){m=c[p],c[p]=null;break}m&&(f=m)}if(f)Jo(f);else{const m=BI(d);f=this.createTextTrack(m,d.name,d.lang),f&&(f.mode="disabled")}f&&this.textTracks.push(f)}),c!=null&&c.length){const d=c.filter(u=>u!==null).map(u=>u.label);d.length&&this.hls.logger.warn(`Media element contains unused subtitle tracks: ${d.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const o=this.tracks.map(c=>({label:c.name,kind:c.type.toLowerCase(),default:c.default,subtitleTrack:c}));this.hls.trigger(w.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:o})}}}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach(s=>{const n=/(?:CC|SERVICE)([1-4])/.exec(s.instreamId);if(!n)return;const r=`textTrack${n[1]}`,o=this.captionsProperties[r];o&&(o.label=s.name,s.lang&&(o.languageCode=s.lang),o.media=s)})}closedCaptionsForLevel(e){const t=this.hls.levels[e.level];return t==null?void 0:t.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,t){if(this.enabled&&t.frag.type===ze.MAIN){var s,n;const{cea608Parser1:r,cea608Parser2:o,lastSn:c}=this,{cc:d,sn:u}=t.frag,f=(s=(n=t.part)==null?void 0:n.index)!=null?s:-1;r&&o&&(u!==c+1||u===c&&f!==this.lastPartIndex+1||d!==this.lastCc)&&(r.reset(),o.reset()),this.lastCc=d,this.lastSn=u,this.lastPartIndex=f}}onFragLoaded(e,t){const{frag:s,payload:n}=t;if(s.type===ze.SUBTITLE)if(n.byteLength){const r=s.decryptdata,o="stats"in t;if(r==null||!r.encrypted||o){const c=this.tracks[s.level],d=this.vttCCs;d[s.cc]||(d[s.cc]={start:s.start,prevCC:this.prevCC,new:!0},this.prevCC=s.cc),c&&c.textCodec===qg?this._parseIMSC1(s,n):this._parseVTTs(t)}}else this.hls.trigger(w.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:s,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,t){const s=this.hls;J1(t,this.initPTS[e.cc],n=>{this._appendCues(n,e.level),s.trigger(w.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},n=>{s.logger.log(`Failed to parse IMSC1: ${n}`),s.trigger(w.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:n})})}_parseVTTs(e){var t;const{frag:s,payload:n}=e,{initPTS:r,unparsedVttFrags:o}=this,c=r.length-1;if(!r[s.cc]&&c===-1){o.push(e);return}const d=this.hls,u=(t=s.initSegment)!=null&&t.data?Xi(s.initSegment.data,new Uint8Array(n)).buffer:n;AU(u,this.initPTS[s.cc],this.vttCCs,s.cc,s.start,f=>{this._appendCues(f,s.level),d.trigger(w.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:s})},f=>{const m=f.message==="Missing initPTS for VTT MPEGTS";m?o.push(e):this._fallbackToIMSC1(s,n),d.logger.log(`Failed to parse VTT cue: ${f}`),!(m&&c>s.cc)&&d.trigger(w.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:s,error:f})})}_fallbackToIMSC1(e,t){const s=this.tracks[e.level];s.textCodec||J1(t,this.initPTS[e.cc],()=>{s.textCodec=qg,this._parseIMSC1(e,t)},()=>{s.textCodec="wvtt"})}_appendCues(e,t){const s=this.hls;if(this.config.renderTextTracksNatively){const n=this.textTracks[t];if(!n||n.mode==="disabled")return;e.forEach(r=>CI(n,r))}else{const n=this.tracks[t];if(!n)return;const r=n.default?"default":"subtitles"+t;s.trigger(w.CUES_PARSED,{type:"subtitles",cues:e,track:r})}}onFragDecrypted(e,t){const{frag:s}=t;s.type===ze.SUBTITLE&&this.onFragLoaded(w.FRAG_LOADED,t)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){if(!this.enabled||!this.config.enableCEA708Captions)return;const{frag:s,samples:n}=t;if(!(s.type===ze.MAIN&&this.closedCaptionsForLevel(s)==="NONE"))for(let r=0;r<n.length;r++){const o=n[r].bytes;if(o){this.cea608Parser1||this.initCea608Parsers();const c=this.extractCea608Data(o);this.cea608Parser1.addData(n[r].pts,c[0]),this.cea608Parser2.addData(n[r].pts,c[1])}}}onBufferFlushing(e,{startOffset:t,endOffset:s,endOffsetSubtitles:n,type:r}){const{media:o}=this;if(!(!o||o.currentTime<s)){if(!r||r==="video"){const{captionsTracks:c}=this;Object.keys(c).forEach(d=>qp(c[d],t,s))}if(this.config.renderTextTracksNatively&&t===0&&n!==void 0){const{textTracks:c}=this;Object.keys(c).forEach(d=>qp(c[d],t,n))}}}extractCea608Data(e){const t=[[],[]],s=e[0]&31;let n=2;for(let r=0;r<s;r++){const o=e[n++],c=127&e[n++],d=127&e[n++];if(c===0&&d===0)continue;if((4&o)!==0){const f=3&o;(f===0||f===1)&&(t[f].push(c),t[f].push(d))}}return t}}function BI(i){return i.characteristics&&/transcribes-spoken-dialog/gi.test(i.characteristics)&&/describes-music-and-sound/gi.test(i.characteristics)?"captions":"subtitles"}function sE(i,e){return!!i&&i.kind===BI(e)&&zp(e,i)}function DU(i,e,t,s){return Math.min(e,s)-Math.max(i,t)}function iE(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}const _U=/\s/,PU={newCue(i,e,t,s){const n=[];let r,o,c,d,u;const f=self.VTTCue||self.TextTrackCue;for(let p=0;p<s.rows.length;p++)if(r=s.rows[p],c=!0,d=0,u="",!r.isEmpty()){var m;for(let y=0;y<r.chars.length;y++)_U.test(r.chars[y].uchar)&&c?d++:(u+=r.chars[y].uchar,c=!1);r.cueStartTime=e,e===t&&(t+=1e-4),d>=16?d--:d++;const v=NI(u.trim()),S=X0(e,t,v);i!=null&&(m=i.cues)!=null&&m.getCueById(S)||(o=new f(e,t,v),o.id=S,o.line=p+1,o.align="left",o.position=10+Math.min(80,Math.floor(d*8/32)*10),n.push(o))}return i&&n.length&&(n.sort((p,v)=>p.line==="auto"||v.line==="auto"?0:p.line>8&&v.line>8?v.line-p.line:p.line-v.line),n.forEach(p=>CI(i,p))),n}};function kU(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}const NU=/(\d+)-(\d+)\/(\d+)/;class nE{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||BU,this.controller=new self.AbortController,this.stats=new D0}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,t,s){const n=this.stats;if(n.loading.start)throw new Error("Loader can only be used once.");n.loading.start=self.performance.now();const r=MU(e,this.controller.signal),o=e.responseType==="arraybuffer",c=o?"byteLength":"length",{maxTimeToFirstByteMs:d,maxLoadTimeMs:u}=t.loadPolicy;this.context=e,this.config=t,this.callbacks=s,this.request=this.fetchSetup(e,r),self.clearTimeout(this.requestTimeout),t.timeout=d&&Fe(d)?d:u,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(n,e,this.response))},t.timeout),(Jc(this.request)?this.request.then(self.fetch):self.fetch(this.request)).then(m=>{var p;this.response=this.loader=m;const v=Math.max(self.performance.now(),n.loading.start);if(self.clearTimeout(this.requestTimeout),t.timeout=u,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(n,e,this.response))},u-(v-n.loading.start)),!m.ok){const{status:y,statusText:E}=m;throw new jU(E||"fetch, bad network response",y,m)}n.loading.first=v,n.total=FU(m.headers)||n.total;const S=(p=this.callbacks)==null?void 0:p.onProgress;return S&&Fe(t.highWaterMark)?this.loadProgressively(m,n,e,t.highWaterMark,S):o?m.arrayBuffer():e.responseType==="json"?m.json():m.text()}).then(m=>{var p,v;const S=this.response;if(!S)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),n.loading.end=Math.max(self.performance.now(),n.loading.first);const y=m[c];y&&(n.loaded=n.total=y);const E={url:S.url,data:m,code:S.status},A=(p=this.callbacks)==null?void 0:p.onProgress;A&&!Fe(t.highWaterMark)&&A(n,e,m,S),(v=this.callbacks)==null||v.onSuccess(E,n,e,S)}).catch(m=>{var p;if(self.clearTimeout(this.requestTimeout),n.aborted)return;const v=m&&m.code||0,S=m?m.message:null;(p=this.callbacks)==null||p.onError({code:v,text:S},e,m?m.details:null,n)})}getCacheAge(){let e=null;if(this.response){const t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,t,s,n=0,r){const o=new eI,c=e.body.getReader(),d=()=>c.read().then(u=>{if(u.done)return o.dataLength&&r(t,s,o.flush().buffer,e),Promise.resolve(new ArrayBuffer(0));const f=u.value,m=f.length;return t.loaded+=m,m<n||o.dataLength?(o.push(f),o.dataLength>=n&&r(t,s,o.flush().buffer,e)):r(t,s,f.buffer,e),d()}).catch(()=>Promise.reject());return d()}}function MU(i,e){const t={method:"GET",mode:"cors",credentials:"same-origin",signal:e,headers:new self.Headers(Ft({},i.headers))};return i.rangeEnd&&t.headers.set("Range","bytes="+i.rangeStart+"-"+String(i.rangeEnd-1)),t}function UU(i){const e=NU.exec(i);if(e)return parseInt(e[2])-parseInt(e[1])+1}function FU(i){const e=i.get("Content-Range");if(e){const s=UU(e);if(Fe(s))return s}const t=i.get("Content-Length");if(t)return parseInt(t)}function BU(i,e){return new self.Request(i.url,e)}class jU extends Error{constructor(e,t,s){super(e),this.code=void 0,this.details=void 0,this.code=t,this.details=s}}const VU=/^age:\s*[\d.]+\s*$/im;class jI{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new D0,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,e.readyState!==4&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,s){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=s,this.loadInternal()}loadInternal(){const{config:e,context:t}=this;if(!e||!t)return;const s=this.loader=new self.XMLHttpRequest,n=this.stats;n.loading.first=0,n.loaded=0,n.aborted=!1;const r=this.xhrSetup;r?Promise.resolve().then(()=>{if(!(this.loader!==s||this.stats.aborted))return r(s,t.url)}).catch(o=>{if(!(this.loader!==s||this.stats.aborted))return s.open("GET",t.url,!0),r(s,t.url)}).then(()=>{this.loader!==s||this.stats.aborted||this.openAndSendXhr(s,t,e)}).catch(o=>{var c;(c=this.callbacks)==null||c.onError({code:s.status,text:o.message},t,s,n)}):this.openAndSendXhr(s,t,e)}openAndSendXhr(e,t,s){e.readyState||e.open("GET",t.url,!0);const n=t.headers,{maxTimeToFirstByteMs:r,maxLoadTimeMs:o}=s.loadPolicy;if(n)for(const c in n)e.setRequestHeader(c,n[c]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),s.timeout=r&&Fe(r)?r:o,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),s.timeout),e.send()}readystatechange(){const{context:e,loader:t,stats:s}=this;if(!e||!t)return;const n=t.readyState,r=this.config;if(!s.aborted&&n>=2&&(s.loading.first===0&&(s.loading.first=Math.max(self.performance.now(),s.loading.start),r.timeout!==r.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),r.timeout=r.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),r.loadPolicy.maxLoadTimeMs-(s.loading.first-s.loading.start)))),n===4)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;const u=t.status,f=t.responseType==="text"?t.responseText:null;if(u>=200&&u<300){const S=f??t.response;if(S!=null){var o,c;s.loading.end=Math.max(self.performance.now(),s.loading.first);const y=t.responseType==="arraybuffer"?S.byteLength:S.length;s.loaded=s.total=y,s.bwEstimate=s.total*8e3/(s.loading.end-s.loading.first);const E=(o=this.callbacks)==null?void 0:o.onProgress;E&&E(s,e,S,t);const A={url:t.responseURL,data:S,code:u};(c=this.callbacks)==null||c.onSuccess(A,s,e,t);return}}const m=r.loadPolicy.errorRetry,p=s.retry,v={url:e.url,data:void 0,code:u};if(wh(m,p,!1,v))this.retry(m);else{var d;wt.error(`${u} while loading ${e.url}`),(d=this.callbacks)==null||d.onError({code:u,text:t.statusText},e,t,s)}}}loadtimeout(){if(!this.config)return;const e=this.config.loadPolicy.timeoutRetry,t=this.stats.retry;if(wh(e,t,!0))this.retry(e);else{var s;wt.warn(`timeout while loading ${(s=this.context)==null?void 0:s.url}`);const n=this.callbacks;n&&(this.abortInternal(),n.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:t,stats:s}=this;this.retryDelay=P0(e,s.retry),s.retry++,wt.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${t==null?void 0:t.url}, retrying ${s.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&VU.test(this.loader.getAllResponseHeaders())){const t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}const $U={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},GU=_t(_t({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,maxDevicePixelRatio:Number.POSITIVE_INFINITY,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,startOnSegmentBoundary:!1,maxBufferSize:60*1e3*1e3,maxFragLookUpTolerance:.25,maxBufferHole:.1,detectStallWithCurrentTimeMs:1250,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,nudgeOnVideoHole:!0,liveSyncMode:"edge",liveSyncDurationCount:3,liveSyncOnStallIncrease:1,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,ignorePlaylistParsingErrors:!1,loader:jI,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:hk,bufferController:eM,capLevelController:Y0,errorController:yk,fpsController:KM,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:GA,requireKeySystemAccessOnStart:!1,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableEmsgKLVMetadata:!1,enableID3MetadataCues:!0,enableInterstitialPlayback:!0,interstitialAppendInPlace:!0,interstitialLiveLookAhead:10,useMediaCapabilities:!0,preserveManualLevelOnError:!1,certLoadPolicy:{default:$U},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},interstitialAssetListLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:3e4,timeoutRetry:{maxNumRetry:0,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:0,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},HU()),{},{subtitleStreamController:nU,subtitleTrackController:QM,timelineController:OU,audioStreamController:XN,audioTrackController:WN,emeController:sl,cmcdController:GM,contentSteeringController:zM,interstitialsController:iU});function HU(){return{cueHandler:PU,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function zU(i,e,t){if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(e.liveMaxLatencyDurationCount!==void 0&&(e.liveSyncDurationCount===void 0||e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(e.liveMaxLatencyDuration!==void 0&&(e.liveSyncDuration===void 0||e.liveMaxLatencyDuration<=e.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const s=Xp(i),n=["manifest","level","frag"],r=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return n.forEach(o=>{const c=`${o==="level"?"playlist":o}LoadPolicy`,d=e[c]===void 0,u=[];r.forEach(f=>{const m=`${o}Loading${f}`,p=e[m];if(p!==void 0&&d){u.push(m);const v=s[c].default;switch(e[c]={default:v},f){case"TimeOut":v.maxLoadTimeMs=p,v.maxTimeToFirstByteMs=p;break;case"MaxRetry":v.errorRetry.maxNumRetry=p,v.timeoutRetry.maxNumRetry=p;break;case"RetryDelay":v.errorRetry.retryDelayMs=p,v.timeoutRetry.retryDelayMs=p;break;case"MaxRetryTimeout":v.errorRetry.maxRetryDelayMs=p,v.timeoutRetry.maxRetryDelayMs=p;break}}}),u.length&&t.warn(`hls.js config: "${u.join('", "')}" setting(s) are deprecated, use "${c}": ${es(e[c])}`)}),_t(_t({},s),e)}function Xp(i){return i&&typeof i=="object"?Array.isArray(i)?i.map(Xp):Object.keys(i).reduce((e,t)=>(e[t]=Xp(i[t]),e),{}):i}function KU(i,e){const t=i.loader;t!==nE&&t!==jI?(e.log("[config]: Custom loader detected, cannot enable progressive streaming"),i.progressive=!1):kU()&&(i.loader=nE,i.progressive=!0,i.enableSoftwareAES=!0,e.log("[config]: Progressive streaming enabled, using FetchLoader"))}const dh=2,YU=.1,qU=.05,QU=100;class XU extends jA{constructor(e,t){super("gap-controller",e.logger),this.hls=null,this.fragmentTracker=null,this.media=null,this.mediaSource=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.buffered={},this.lastCurrentTime=0,this.ended=0,this.waiting=0,this.onMediaPlaying=()=>{this.ended=0,this.waiting=0},this.onMediaWaiting=()=>{var s;(s=this.media)!=null&&s.seeking||(this.waiting=self.performance.now(),this.tick())},this.onMediaEnded=()=>{if(this.hls){var s;this.ended=((s=this.media)==null?void 0:s.currentTime)||1,this.hls.trigger(w.MEDIA_ENDED,{stalled:!1})}},this.hls=e,this.fragmentTracker=t,this.registerListeners()}registerListeners(){const{hls:e}=this;e&&(e.on(w.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(w.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(w.BUFFER_APPENDED,this.onBufferAppended,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(w.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(w.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(w.BUFFER_APPENDED,this.onBufferAppended,this))}destroy(){super.destroy(),this.unregisterListeners(),this.media=this.hls=this.fragmentTracker=null,this.mediaSource=void 0}onMediaAttached(e,t){this.setInterval(QU),this.mediaSource=t.mediaSource;const s=this.media=t.media;wi(s,"playing",this.onMediaPlaying),wi(s,"waiting",this.onMediaWaiting),wi(s,"ended",this.onMediaEnded)}onMediaDetaching(e,t){this.clearInterval();const{media:s}=this;s&&(zi(s,"playing",this.onMediaPlaying),zi(s,"waiting",this.onMediaWaiting),zi(s,"ended",this.onMediaEnded),this.media=null),this.mediaSource=void 0}onBufferAppended(e,t){this.buffered=t.timeRanges}get hasBuffered(){return Object.keys(this.buffered).length>0}tick(){var e;if(!((e=this.media)!=null&&e.readyState)||!this.hasBuffered)return;const t=this.media.currentTime;this.poll(t,this.lastCurrentTime),this.lastCurrentTime=t}poll(e,t){var s,n;const r=(s=this.hls)==null?void 0:s.config;if(!r)return;const o=this.media;if(!o)return;const{seeking:c}=o,d=this.seeking&&!c,u=!this.seeking&&c,f=o.paused&&!c||o.ended||o.playbackRate===0;if(this.seeking=c,e!==t){t&&(this.ended=0),this.moved=!0,c||(this.nudgeRetry=0,r.nudgeOnVideoHole&&!f&&e>t&&this.nudgeOnVideoHole(e,t)),this.waiting===0&&this.stallResolved(e);return}if(u||d){d&&this.stallResolved(e);return}if(f){this.nudgeRetry=0,this.stallResolved(e),!this.ended&&o.ended&&this.hls&&(this.ended=e||1,this.hls.trigger(w.MEDIA_ENDED,{stalled:!1}));return}if(!at.getBuffered(o).length){this.nudgeRetry=0;return}const m=at.bufferInfo(o,e,0),p=m.nextStart||0,v=this.fragmentTracker;if(c&&v&&this.hls){const D=rE(this.hls.inFlightFragments,e),_=m.len>dh,M=!p||D||p-e>dh&&!v.getPartialFragment(e);if(_||M)return;this.moved=!1}const S=(n=this.hls)==null?void 0:n.latestLevelDetails;if(!this.moved&&this.stalled!==null&&v){if(!(m.len>0)&&!p)return;const _=Math.max(p,m.start||0)-e,U=!!(S!=null&&S.live)?S.targetduration*2:dh,F=v.getPartialFragment(e);if(_>0&&(_<=U||F)){o.paused||this._trySkipBufferHole(F);return}}const y=r.detectStallWithCurrentTimeMs,E=self.performance.now(),A=this.waiting;let R=this.stalled;if(R===null)if(A>0&&E-A<y)R=this.stalled=A;else{this.stalled=E;return}const I=E-R;if(!c&&(I>=y||A)&&this.hls){var C;if(((C=this.mediaSource)==null?void 0:C.readyState)==="ended"&&!(S!=null&&S.live)&&Math.abs(e-((S==null?void 0:S.edge)||0))<1){if(this.ended)return;this.ended=e||1,this.hls.trigger(w.MEDIA_ENDED,{stalled:!0});return}if(this._reportStall(m),!this.media||!this.hls)return}const L=at.bufferInfo(o,e,r.maxBufferHole);this._tryFixBufferStall(L,I,e)}stallResolved(e){const t=this.stalled;if(t&&this.hls&&(this.stalled=null,this.stallReported)){const s=self.performance.now()-t;this.log(`playback not stuck anymore @${e}, after ${Math.round(s)}ms`),this.stallReported=!1,this.waiting=0,this.hls.trigger(w.STALL_RESOLVED,{})}}nudgeOnVideoHole(e,t){var s;const n=this.buffered.video;if(this.hls&&this.media&&this.fragmentTracker&&(s=this.buffered.audio)!=null&&s.length&&n&&n.length>1&&e>n.end(0)){const r=at.bufferedInfo(at.timeRangesToArray(this.buffered.audio),e,0);if(r.len>1&&t>=r.start){const o=at.timeRangesToArray(n),c=at.bufferedInfo(o,t,0).bufferedIndex;if(c>-1&&c<o.length-1){const d=at.bufferedInfo(o,e,0).bufferedIndex,u=o[c].end,f=o[c+1].start;if((d===-1||d>c)&&f-u<1&&e-u<2){const m=new Error(`nudging playhead to flush pipeline after video hole. currentTime: ${e} hole: ${u} -> ${f} buffered index: ${d}`);this.warn(m.message),this.media.currentTime+=1e-6;const p=this.fragmentTracker.getPartialFragment(e)||void 0,v=at.bufferInfo(this.media,e,0);this.hls.trigger(w.ERROR,{type:Ke.MEDIA_ERROR,details:se.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:m,reason:m.message,frag:p,buffer:v.len,bufferInfo:v})}}}}}_tryFixBufferStall(e,t,s){var n,r;const{fragmentTracker:o,media:c}=this,d=(n=this.hls)==null?void 0:n.config;if(!c||!o||!d)return;const u=(r=this.hls)==null?void 0:r.latestLevelDetails,f=o.getPartialFragment(s);if((f||u!=null&&u.live&&s<u.fragmentStart)&&(this._trySkipBufferHole(f)||!this.media))return;const m=e.buffered,p=this.adjacentTraversal(e,s);(m&&m.length>1&&e.len>d.maxBufferHole||e.nextStart&&(e.nextStart-s<d.maxBufferHole||p))&&(t>d.highBufferWatchdogPeriod*1e3||this.waiting)&&(this.warn("Trying to nudge playhead over buffer-hole"),this._tryNudgeBuffer(e))}adjacentTraversal(e,t){const s=this.fragmentTracker,n=e.nextStart;if(s&&n){const r=s.getFragAtPos(t,ze.MAIN),o=s.getFragAtPos(n,ze.MAIN);if(r&&o)return o.sn-r.sn<2}return!1}_reportStall(e){const{hls:t,media:s,stallReported:n,stalled:r}=this;if(!n&&r!==null&&s&&t){this.stallReported=!0;const o=new Error(`Playback stalling at @${s.currentTime} due to low buffer (${es(e)})`);this.warn(o.message),t.trigger(w.ERROR,{type:Ke.MEDIA_ERROR,details:se.BUFFER_STALLED_ERROR,fatal:!1,error:o,buffer:e.len,bufferInfo:e,stalled:{start:r}})}}_trySkipBufferHole(e){var t;const{fragmentTracker:s,media:n}=this,r=(t=this.hls)==null?void 0:t.config;if(!n||!s||!r)return 0;const o=n.currentTime,c=at.bufferInfo(n,o,0),d=o<c.start?c.start:c.nextStart;if(d&&this.hls){const f=c.len<=r.maxBufferHole,m=c.len>0&&c.len<1&&n.readyState<3,p=d-o;if(p>0&&(f||m)){if(p>r.maxBufferHole){let S=!1;if(o===0){const y=s.getAppendedFrag(0,ze.MAIN);y&&d<y.end&&(S=!0)}if(!S){const y=e||s.getAppendedFrag(o,ze.MAIN);if(y){var u;if(!((u=this.hls.loadLevelObj)!=null&&u.details)||rE(this.hls.inFlightFragments,d))return 0;let A=!1,R=y.end;for(;R<d;){const I=s.getPartialFragment(R);if(I)R+=I.duration;else{A=!0;break}}if(A)return 0}}}const v=Math.max(d+qU,o+YU);if(this.warn(`skipping hole, adjusting currentTime from ${o} to ${v}`),this.moved=!0,n.currentTime=v,!(e!=null&&e.gap)){const S=new Error(`fragment loaded with buffer holes, seeking from ${o} to ${v}`);this.hls.trigger(w.ERROR,{type:Ke.MEDIA_ERROR,details:se.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:S,reason:S.message,frag:e||void 0,buffer:c.len,bufferInfo:c})}return v}}return 0}_tryNudgeBuffer(e){const{hls:t,media:s,nudgeRetry:n}=this,r=t==null?void 0:t.config;if(!s||!r)return 0;const o=s.currentTime;if(this.nudgeRetry++,n<r.nudgeMaxRetry){const c=o+(n+1)*r.nudgeOffset,d=new Error(`Nudging 'currentTime' from ${o} to ${c}`);this.warn(d.message),s.currentTime=c,t.trigger(w.ERROR,{type:Ke.MEDIA_ERROR,details:se.BUFFER_NUDGE_ON_STALL,error:d,fatal:!1,buffer:e.len,bufferInfo:e})}else{const c=new Error(`Playhead still not moving while enough data buffered @${o} after ${r.nudgeMaxRetry} nudges`);this.error(c.message),t.trigger(w.ERROR,{type:Ke.MEDIA_ERROR,details:se.BUFFER_STALLED_ERROR,error:c,fatal:!0,buffer:e.len,bufferInfo:e})}}}function rE(i,e){const t=aE(i.main);if(t&&t.start<=e)return t;const s=aE(i.audio);return s&&s.start<=e?s:null}function aE(i){if(!i)return null;switch(i.state){case pe.IDLE:case pe.STOPPED:case pe.ENDED:case pe.ERROR:return null}return i.frag}const WU=.25;function Wp(){if(!(typeof self>"u"))return self.VTTCue||self.TextTrackCue}function oE(i,e,t,s,n){let r=new i(e,t,"");try{r.value=s,n&&(r.type=n)}catch{r=new i(e,t,es(n?_t({type:n},s):s))}return r}const Qd=(()=>{const i=Wp();try{i&&new i(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();function ZU(i){return Uint8Array.from(i.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}class JU{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.removeCues=!0,this.onEventCueEnter=()=>{this.hls&&this.hls.trigger(w.EVENT_CUE_ENTER,{})},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=this.onEventCueEnter=null}_registerListeners(){const{hls:e}=this;e.on(w.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(w.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(w.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(w.MANIFEST_LOADING,this.onManifestLoading,this),e.on(w.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(w.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(w.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(w.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this)}_unregisterListeners(){const{hls:e}=this;e.off(w.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(w.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(w.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(w.MANIFEST_LOADING,this.onManifestLoading,this),e.off(w.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(w.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(w.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(w.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this)}onMediaAttaching(e,t){var s;this.media=t.media,((s=t.overrides)==null?void 0:s.cueRemoval)===!1&&(this.removeCues=!1)}onMediaAttached(){const e=this.hls.latestLevelDetails;e&&this.updateDateRangeCues(e)}onMediaDetaching(e,t){this.media=null,!t.transferMedia&&(this.id3Track&&(this.removeCues&&Jo(this.id3Track,this.onEventCueEnter),this.id3Track=null),this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){const t=this.getID3Track(e.textTracks);return t.mode="hidden",t}getID3Track(e){if(this.media){for(let t=0;t<e.length;t++){const s=e[t];if(s.kind==="metadata"&&s.label==="id3")return wI(s,this.media),s}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,t){if(!this.media)return;const{hls:{config:{enableEmsgMetadataCues:s,enableID3MetadataCues:n}}}=this;if(!s&&!n)return;const{samples:r}=t;this.id3Track||(this.id3Track=this.createTrack(this.media));const o=Wp();if(o)for(let c=0;c<r.length;c++){const d=r[c].type;if(d===Ii.emsg&&!s||!n)continue;const u=oI(r[c].data);if(u){const f=r[c].pts;let m=f+r[c].duration;m>Qd&&(m=Qd),m-f<=0&&(m=f+WU);for(let v=0;v<u.length;v++){const S=u[v];if(!lI(S)){this.updateId3CueEnds(f,d);const y=oE(o,f,m,S,d);y&&this.id3Track.addCue(y)}}}}}updateId3CueEnds(e,t){var s;const n=(s=this.id3Track)==null?void 0:s.cues;if(n)for(let r=n.length;r--;){const o=n[r];o.type===t&&o.startTime<e&&o.endTime===Qd&&(o.endTime=e)}}onBufferFlushing(e,{startOffset:t,endOffset:s,type:n}){const{id3Track:r,hls:o}=this;if(!o)return;const{config:{enableEmsgMetadataCues:c,enableID3MetadataCues:d}}=o;if(r&&(c||d)){let u;n==="audio"?u=f=>f.type===Ii.audioId3&&d:n==="video"?u=f=>f.type===Ii.emsg&&c:u=f=>f.type===Ii.audioId3&&d||f.type===Ii.emsg&&c,qp(r,t,s,u)}}onLevelUpdated(e,{details:t}){this.updateDateRangeCues(t,!0)}onLevelPtsUpdated(e,t){Math.abs(t.drift)>.01&&this.updateDateRangeCues(t.details)}updateDateRangeCues(e,t){if(!this.media||!e.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)return;const{id3Track:s}=this,{dateRanges:n}=e,r=Object.keys(n);let o=this.dateRangeCuesAppended;if(s&&t){var c;if((c=s.cues)!=null&&c.length){const f=Object.keys(o).filter(m=>!r.includes(m));for(let m=f.length;m--;){const p=f[m],v=o[p].cues;delete o[p],Object.keys(v).forEach(S=>{try{const y=v[S];y.removeEventListener("enter",this.onEventCueEnter),s.removeCue(y)}catch{}})}}else o=this.dateRangeCuesAppended={}}const d=e.fragments[e.fragments.length-1];if(r.length===0||!Fe(d==null?void 0:d.programDateTime))return;this.id3Track||(this.id3Track=this.createTrack(this.media));const u=Wp();for(let f=0;f<r.length;f++){const m=r[f],p=n[m],v=p.startTime,S=o[m],y=(S==null?void 0:S.cues)||{};let E=(S==null?void 0:S.durationKnown)||!1,A=Qd;const{duration:R,endDate:I}=p;if(I&&R!==null)A=v+R,E=!0;else if(p.endOnNext&&!E){const L=r.reduce((D,_)=>{if(_!==p.id){const M=n[_];if(M.class===p.class&&M.startDate>p.startDate&&(!D||p.startDate<D.startDate))return M}return D},null);L&&(A=L.startTime,E=!0)}const C=Object.keys(p.attr);for(let L=0;L<C.length;L++){const D=C[L];if(!Ok(D))continue;const _=y[D];if(_)E&&!S.durationKnown?_.endTime=A:Math.abs(_.startTime-v)>.01&&(_.startTime=v,_.endTime=A);else if(u){let M=p.attr[D];Dk(D)&&(M=ZU(M));const F=oE(u,v,A,{key:D,data:M},Ii.dateRange);F&&(F.id=m,this.id3Track.addCue(F),y[D]=F,this.hls.config.interstitialsController&&(D==="X-ASSET-LIST"||D==="X-ASSET-URL")&&F.addEventListener("enter",this.onEventCueEnter))}}o[m]={cues:y,dateRange:p,durationKnown:E}}}}class e3{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.currentTime=0,this.stallCount=0,this._latency=null,this._targetLatencyUpdated=!1,this.onTimeupdate=()=>{const{media:t}=this,s=this.levelDetails;if(!t||!s)return;this.currentTime=t.currentTime;const n=this.computeLatency();if(n===null)return;this._latency=n;const{lowLatencyMode:r,maxLiveSyncPlaybackRate:o}=this.config;if(!r||o===1||!s.live)return;const c=this.targetLatency;if(c===null)return;const d=n-c,u=Math.min(this.maxLatency,c+s.targetduration);if(d<u&&d>.05&&this.forwardBufferLength>1){const m=Math.min(2,Math.max(1,o)),p=Math.round(2/(1+Math.exp(-.75*d-this.edgeStalled))*20)/20,v=Math.min(m,Math.max(1,p));this.changeMediaPlaybackRate(t,v)}else t.playbackRate!==1&&t.playbackRate!==0&&this.changeMediaPlaybackRate(t,1)},this.hls=e,this.config=e.config,this.registerListeners()}get levelDetails(){var e;return((e=this.hls)==null?void 0:e.latestLevelDetails)||null}get latency(){return this._latency||0}get maxLatency(){const{config:e}=this;if(e.liveMaxLatencyDuration!==void 0)return e.liveMaxLatencyDuration;const t=this.levelDetails;return t?e.liveMaxLatencyDurationCount*t.targetduration:0}get targetLatency(){const e=this.levelDetails;if(e===null||this.hls===null)return null;const{holdBack:t,partHoldBack:s,targetduration:n}=e,{liveSyncDuration:r,liveSyncDurationCount:o,lowLatencyMode:c}=this.config,d=this.hls.userConfig;let u=c&&s||t;(this._targetLatencyUpdated||d.liveSyncDuration||d.liveSyncDurationCount||u===0)&&(u=r!==void 0?r:o*n);const f=n;return u+Math.min(this.stallCount*this.config.liveSyncOnStallIncrease,f)}set targetLatency(e){this.stallCount=0,this.config.liveSyncDuration=e,this._targetLatencyUpdated=!0}get liveSyncPosition(){const e=this.estimateLiveEdge(),t=this.targetLatency;if(e===null||t===null)return null;const s=this.levelDetails;if(s===null)return null;const n=s.edge,r=e-t-this.edgeStalled,o=n-s.totalduration,c=n-(this.config.lowLatencyMode&&s.partTarget||s.targetduration);return Math.min(Math.max(o,r),c)}get drift(){const e=this.levelDetails;return e===null?1:e.drift}get edgeStalled(){const e=this.levelDetails;if(e===null)return 0;const t=(this.config.lowLatencyMode&&e.partTarget||e.targetduration)*3;return Math.max(e.age-t,0)}get forwardBufferLength(){const{media:e}=this,t=this.levelDetails;if(!e||!t)return 0;const s=e.buffered.length;return(s?e.buffered.end(s-1):t.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.hls=null}registerListeners(){const{hls:e}=this;e&&(e.on(w.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(w.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(w.MANIFEST_LOADING,this.onManifestLoading,this),e.on(w.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(w.ERROR,this.onError,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(w.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(w.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(w.MANIFEST_LOADING,this.onManifestLoading,this),e.off(w.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(w.ERROR,this.onError,this))}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.onTimeupdate)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.onTimeupdate),this.media=null)}onManifestLoading(){this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:t}){t.advanced&&this.onTimeupdate(),!t.live&&this.media&&this.media.removeEventListener("timeupdate",this.onTimeupdate)}onError(e,t){var s;t.details===se.BUFFER_STALLED_ERROR&&(this.stallCount++,this.hls&&(s=this.levelDetails)!=null&&s.live&&this.hls.logger.warn("[latency-controller]: Stall detected, adjusting target latency"))}changeMediaPlaybackRate(e,t){var s,n;e.playbackRate!==t&&((s=this.hls)==null||s.logger.debug(`[latency-controller]: latency=${this.latency.toFixed(3)}, targetLatency=${(n=this.targetLatency)==null?void 0:n.toFixed(3)}, forwardBufferLength=${this.forwardBufferLength.toFixed(3)}: adjusting playback rate from ${e.playbackRate} to ${t}`),e.playbackRate=t)}estimateLiveEdge(){const e=this.levelDetails;return e===null?null:e.edge+e.age}computeLatency(){const e=this.estimateLiveEdge();return e===null?null:e-this.currentTime}}class t3 extends K0{constructor(e,t){super(e,"level-controller"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=t,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(w.MANIFEST_LOADING,this.onManifestLoading,this),e.on(w.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(w.LEVEL_LOADED,this.onLevelLoaded,this),e.on(w.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(w.FRAG_BUFFERED,this.onFragBuffered,this),e.on(w.ERROR,this.onError,this)}_unregisterListeners(){const{hls:e}=this;e.off(w.MANIFEST_LOADING,this.onManifestLoading,this),e.off(w.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(w.LEVEL_LOADED,this.onLevelLoaded,this),e.off(w.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(w.FRAG_BUFFERED,this.onFragBuffered,this),e.off(w.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach(t=>{t.loadError=0,t.fragmentError=0}),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(e,t){this.resetLevels()}onManifestLoaded(e,t){const s=this.hls.config.preferManagedMediaSource,n=[],r={},o={};let c=!1,d=!1,u=!1;t.levels.forEach(f=>{const m=f.attrs;let{audioCodec:p,videoCodec:v}=f;p&&(f.audioCodec=p=Ah(p,s)||void 0),v&&(v=f.videoCodec=Z2(v));const{width:S,height:y,unknownCodecs:E}=f;let A=E?E.length:0;if(E)for(let F=A;F--;){const z=E[F];this.isAudioSupported(z)?(f.audioCodec=p=p?`${p},${z}`:z,A--,vl.audio[p.substring(0,4)]=2):this.isVideoSupported(z)&&(f.videoCodec=v=v?`${v},${z}`:z,A--,vl.video[v.substring(0,4)]=2)}if(c||(c=!!(S&&y)),d||(d=!!v),u||(u=!!p),A||p&&!this.isAudioSupported(p)||v&&!this.isVideoSupported(v)){this.log(`Some or all CODECS not supported "${m.CODECS}"`);return}const{CODECS:R,"FRAME-RATE":I,"HDCP-LEVEL":C,"PATHWAY-ID":L,RESOLUTION:D,"VIDEO-RANGE":_}=m,U=`${`${L||"."}-`}${f.bitrate}-${D}-${I}-${R}-${_}-${C}`;if(r[U])if(r[U].uri!==f.url&&!f.attrs["PATHWAY-ID"]){const F=o[U]+=1;f.attrs["PATHWAY-ID"]=new Array(F+1).join(".");const z=this.createLevel(f);r[U]=z,n.push(z)}else r[U].addGroupId("audio",m.AUDIO),r[U].addGroupId("text",m.SUBTITLES);else{const F=this.createLevel(f);r[U]=F,o[U]=1,n.push(F)}}),this.filterAndSortMediaOptions(n,t,c,d,u)}createLevel(e){const t=new qc(e),s=e.supplemental;if(s!=null&&s.videoCodec&&!this.isVideoSupported(s.videoCodec)){const n=new Error(`SUPPLEMENTAL-CODECS not supported "${s.videoCodec}"`);this.log(n.message),t.supportedResult=NA(n,[])}return t}isAudioSupported(e){return Up(e,"audio",this.hls.config.preferManagedMediaSource)}isVideoSupported(e){return Up(e,"video",this.hls.config.preferManagedMediaSource)}filterAndSortMediaOptions(e,t,s,n,r){let o=[],c=[],d=e;if((s||n)&&r&&(d=d.filter(({videoCodec:E,videoRange:A,width:R,height:I})=>(!!E||!!(R&&I))&&ik(A))),d.length===0){Promise.resolve().then(()=>{if(this.hls){let E="no level with compatible codecs found in manifest",A=E;t.levels.length&&(A=`one or more CODECS in variant not supported: ${es(t.levels.map(I=>I.attrs.CODECS).filter((I,C,L)=>L.indexOf(I)===C))}`,this.warn(A),E+=` (${A})`);const R=new Error(E);this.hls.trigger(w.ERROR,{type:Ke.MEDIA_ERROR,details:se.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:R,reason:A})}});return}t.audioTracks&&(o=t.audioTracks.filter(E=>!E.audioCodec||this.isAudioSupported(E.audioCodec)),lE(o)),t.subtitles&&(c=t.subtitles,lE(c));const u=d.slice(0);d.sort((E,A)=>{if(E.attrs["HDCP-LEVEL"]!==A.attrs["HDCP-LEVEL"])return(E.attrs["HDCP-LEVEL"]||"")>(A.attrs["HDCP-LEVEL"]||"")?1:-1;if(s&&E.height!==A.height)return E.height-A.height;if(E.frameRate!==A.frameRate)return E.frameRate-A.frameRate;if(E.videoRange!==A.videoRange)return Ih.indexOf(E.videoRange)-Ih.indexOf(A.videoRange);if(E.videoCodec!==A.videoCodec){const R=t1(E.videoCodec),I=t1(A.videoCodec);if(R!==I)return I-R}if(E.uri===A.uri&&E.codecSet!==A.codecSet){const R=bh(E.codecSet),I=bh(A.codecSet);if(R!==I)return I-R}return E.averageBitrate!==A.averageBitrate?E.averageBitrate-A.averageBitrate:0});let f=u[0];if(this.steering&&(d=this.steering.filterParsedLevels(d),d.length!==u.length)){for(let E=0;E<u.length;E++)if(u[E].pathwayId===d[0].pathwayId){f=u[E];break}}this._levels=d;for(let E=0;E<d.length;E++)if(d[E]===f){var m;this._firstLevel=E;const A=f.bitrate,R=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${d.length} level(s) found, first bitrate: ${A}`),((m=this.hls.userConfig)==null?void 0:m.abrEwmaDefaultEstimate)===void 0){const I=Math.min(A,this.hls.config.abrEwmaDefaultEstimateMax);I>R&&R===this.hls.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=I)}break}const p=r&&!n,v=this.hls.config,S=!!(v.audioStreamController&&v.audioTrackController),y={levels:d,audioTracks:o,subtitleTracks:c,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:r,video:n,altAudio:S&&!p&&o.some(E=>!!E.url)};this.hls.trigger(w.MANIFEST_PARSED,y)}get levels(){return this._levels.length===0?null:this._levels}get loadLevelObj(){return this.currentLevel}get level(){return this.currentLevelIndex}set level(e){const t=this._levels;if(t.length===0)return;if(e<0||e>=t.length){const f=new Error("invalid level idx"),m=e<0;if(this.hls.trigger(w.ERROR,{type:Ke.OTHER_ERROR,details:se.LEVEL_SWITCH_ERROR,level:e,fatal:m,error:f,reason:f.message}),m)return;e=Math.min(e,t.length-1)}const s=this.currentLevelIndex,n=this.currentLevel,r=n?n.attrs["PATHWAY-ID"]:void 0,o=t[e],c=o.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=o,s===e&&n&&r===c)return;this.log(`Switching to level ${e} (${o.height?o.height+"p ":""}${o.videoRange?o.videoRange+" ":""}${o.codecSet?o.codecSet+" ":""}@${o.bitrate})${c?" with Pathway "+c:""} from level ${s}${r?" with Pathway "+r:""}`);const d={level:e,attrs:o.attrs,details:o.details,bitrate:o.bitrate,averageBitrate:o.averageBitrate,maxBitrate:o.maxBitrate,realBitrate:o.realBitrate,width:o.width,height:o.height,codecSet:o.codecSet,audioCodec:o.audioCodec,videoCodec:o.videoCodec,audioGroups:o.audioGroups,subtitleGroups:o.subtitleGroups,loaded:o.loaded,loadError:o.loadError,fragmentError:o.fragmentError,name:o.name,id:o.id,uri:o.uri,url:o.url,urlId:0,audioGroupIds:o.audioGroupIds,textGroupIds:o.textGroupIds};this.hls.trigger(w.LEVEL_SWITCHING,d);const u=o.details;if(!u||u.live){const f=this.switchParams(o.uri,n==null?void 0:n.details,u);this.loadPlaylist(f)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,this._startLevel===void 0&&(this._startLevel=e),e!==-1&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(this._startLevel===void 0){const e=this.hls.config.startLevel;return e!==void 0?e:this.hls.firstAutoLevel}return this._startLevel}set startLevel(e){this._startLevel=e}get pathways(){return this.steering?this.steering.pathways():[]}get pathwayPriority(){return this.steering?this.steering.pathwayPriority:null}set pathwayPriority(e){if(this.steering){const t=this.steering.pathways(),s=e.filter(n=>t.indexOf(n)!==-1);if(e.length<1){this.warn(`pathwayPriority ${e} should contain at least one pathway from list: ${t}`);return}this.steering.pathwayPriority=s}}onError(e,t){t.fatal||!t.context||t.context.type===gt.LEVEL&&t.context.level===this.level&&this.checkRetry(t)}onFragBuffered(e,{frag:t}){if(t!==void 0&&t.type===ze.MAIN){const s=t.elementaryStreams;if(!Object.keys(s).some(r=>!!s[r]))return;const n=this._levels[t.level];n!=null&&n.loadError&&(this.log(`Resetting level error count of ${n.loadError} on frag buffered`),n.loadError=0)}}onLevelLoaded(e,t){var s;const{level:n,details:r}=t,o=t.levelInfo;if(!o){var c;this.warn(`Invalid level index ${n}`),(c=t.deliveryDirectives)!=null&&c.skip&&(r.deltaUpdateFailed=!0);return}if(o===this.currentLevel||t.withoutMultiVariant){o.fragmentError===0&&(o.loadError=0);let d=o.details;d===t.details&&d.advanced&&(d=void 0),this.playlistLoaded(n,t,d)}else(s=t.deliveryDirectives)!=null&&s.skip&&(r.deltaUpdateFailed=!0)}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentLevel)&&this.scheduleLoading(this.currentLevel,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const s=this.getUrlWithDirectives(e.uri,t),n=this.currentLevelIndex,r=e.attrs["PATHWAY-ID"],o=e.details,c=o==null?void 0:o.age;this.log(`Loading level index ${n}${(t==null?void 0:t.msn)!==void 0?" at sn "+t.msn+" part "+t.part:""}${r?" Pathway "+r:""}${c&&o.live?" age "+c.toFixed(1)+(o.type&&" "+o.type||""):""} ${s}`),this.hls.trigger(w.LEVEL_LOADING,{url:s,level:n,levelInfo:e,pathwayId:e.attrs["PATHWAY-ID"],id:0,deliveryDirectives:t||null})}get nextLoadLevel(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=e)}removeLevel(e){var t;if(this._levels.length===1)return;const s=this._levels.filter((r,o)=>o!==e?!0:(this.steering&&this.steering.removeLevel(r),r===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,r.details&&r.details.fragments.forEach(c=>c.level=-1)),!1));WA(s),this._levels=s,this.currentLevelIndex>-1&&(t=this.currentLevel)!=null&&t.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.manualLevelIndex>-1&&(this.manualLevelIndex=this.currentLevelIndex);const n=s.length-1;this._firstLevel=Math.min(this._firstLevel,n),this._startLevel&&(this._startLevel=Math.min(this._startLevel,n)),this.hls.trigger(w.LEVELS_UPDATED,{levels:s})}onLevelsUpdated(e,{levels:t}){this._levels=t}checkMaxAutoUpdated(){const{autoLevelCapping:e,maxAutoLevel:t,maxHdcpLevel:s}=this.hls;this._maxAutoLevel!==t&&(this._maxAutoLevel=t,this.hls.trigger(w.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:e,levels:this.levels,maxAutoLevel:t,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:s}))}}function lE(i){const e={};i.forEach(t=>{const s=t.groupId||"";t.id=e[s]=e[s]||0,e[s]++})}function VI(){return self.SourceBuffer||self.WebKitSourceBuffer}function $I(){if(!ca())return!1;const e=VI();return!e||e.prototype&&typeof e.prototype.appendBuffer=="function"&&typeof e.prototype.remove=="function"}function s3(){if(!$I())return!1;const i=ca();return typeof(i==null?void 0:i.isTypeSupported)=="function"&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some(e=>i.isTypeSupported(Yc(e,"video")))||["mp4a.40.2","fLaC"].some(e=>i.isTypeSupported(Yc(e,"audio"))))}function i3(){var i;const e=VI();return typeof(e==null||(i=e.prototype)==null?void 0:i.changeType)=="function"}const n3=100;class r3 extends F0{constructor(e,t,s){super(e,t,s,"stream-controller",ze.MAIN),this.audioCodecSwap=!1,this.level=-1,this._forceStartLoad=!1,this._hasEnoughToStart=!1,this.altAudio=0,this.audioOnly=!1,this.fragPlaying=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this.onMediaPlaying=()=>{this.tick()},this.onMediaSeeked=()=>{const n=this.media,r=n?n.currentTime:null;if(r===null||!Fe(r)||(this.log(`Media seeked to ${r.toFixed(3)}`),!this.getBufferedFrag(r)))return;const o=this.getFwdBufferInfoAtPos(n,r,ze.MAIN,0);if(o===null||o.len===0){this.warn(`Main forward buffer length at ${r} on "seeked" event ${o?o.len:"empty"})`);return}this.tick()},this.registerListeners()}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(w.MANIFEST_PARSED,this.onManifestParsed,this),e.on(w.LEVEL_LOADING,this.onLevelLoading,this),e.on(w.LEVEL_LOADED,this.onLevelLoaded,this),e.on(w.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(w.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(w.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(w.BUFFER_CREATED,this.onBufferCreated,this),e.on(w.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(w.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(w.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(w.MANIFEST_PARSED,this.onManifestParsed,this),e.off(w.LEVEL_LOADED,this.onLevelLoaded,this),e.off(w.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(w.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(w.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(w.BUFFER_CREATED,this.onBufferCreated,this),e.off(w.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(w.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(w.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this.onMediaPlaying=this.onMediaSeeked=null,this.unregisterListeners(),super.onHandlerDestroying()}startLoad(e,t){if(this.levels){const{lastCurrentTime:s,hls:n}=this;if(this.stopLoad(),this.setInterval(n3),this.level=-1,!this.startFragRequested){let r=n.startLevel;r===-1&&(n.config.testBandwidth&&this.levels.length>1?(r=0,this.bitrateTest=!0):r=n.firstAutoLevel),n.nextLoadLevel=r,this.level=n.loadLevel,this._hasEnoughToStart=!!t}s>0&&e===-1&&!t&&(this.log(`Override startPosition with lastCurrentTime @${s.toFixed(3)}`),e=s),this.state=pe.IDLE,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}else this._forceStartLoad=!0,this.state=pe.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case pe.WAITING_LEVEL:{const{levels:t,level:s}=this,n=t==null?void 0:t[s],r=n==null?void 0:n.details;if(r&&(!r.live||this.levelLastLoaded===n&&!this.waitForLive(n))){if(this.waitForCdnTuneIn(r))break;this.state=pe.IDLE;break}else if(this.hls.nextLoadLevel!==this.level){this.state=pe.IDLE;break}break}case pe.FRAG_LOADING_WAITING_RETRY:{var e;const t=self.performance.now(),s=this.retryDate;if(!s||t>=s||(e=this.media)!=null&&e.seeking){const{levels:n,level:r}=this,o=n==null?void 0:n[r];this.resetStartWhenNotLoaded(o||null),this.state=pe.IDLE}}break}this.state===pe.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){var e;super.onTickEnd(),(e=this.media)!=null&&e.readyState&&this.media.seeking===!1&&(this.lastCurrentTime=this.media.currentTime),this.checkFragmentChanged()}doTickIdle(){const{hls:e,levelLastLoaded:t,levels:s,media:n}=this;if(t===null||!n&&!this.primaryPrefetch&&(this.startFragRequested||!e.config.startFragPrefetch)||this.altAudio&&this.audioOnly)return;const r=this.buffering?e.nextLoadLevel:e.loadLevel;if(!(s!=null&&s[r]))return;const o=s[r],c=this.getMainFwdBufferInfo();if(c===null)return;const d=this.getLevelDetails();if(d&&this._streamEnded(c,d)){const y={};this.altAudio===2&&(y.type="video"),this.hls.trigger(w.BUFFER_EOS,y),this.state=pe.ENDED;return}if(!this.buffering)return;e.loadLevel!==r&&e.manualLevel===-1&&this.log(`Adapting to level ${r} from level ${this.level}`),this.level=e.nextLoadLevel=r;const u=o.details;if(!u||this.state===pe.WAITING_LEVEL||this.waitForLive(o)){this.level=r,this.state=pe.WAITING_LEVEL,this.startFragRequested=!1;return}const f=c.len,m=this.getMaxBufferLength(o.maxBitrate);if(f>=m)return;this.backtrackFragment&&this.backtrackFragment.start>c.end&&(this.backtrackFragment=null);const p=this.backtrackFragment?this.backtrackFragment.start:c.end;let v=this.getNextFragment(p,u);if(this.couldBacktrack&&!this.fragPrevious&&v&&Ds(v)&&this.fragmentTracker.getState(v)!==Es.OK){var S;const E=((S=this.backtrackFragment)!=null?S:v).sn-u.startSN,A=u.fragments[E-1];A&&v.cc===A.cc&&(v=A,this.fragmentTracker.removeFragment(A))}else this.backtrackFragment&&c.len&&(this.backtrackFragment=null);if(v&&this.isLoopLoading(v,p)){if(!v.gap){const E=this.audioOnly&&!this.altAudio?zt.AUDIO:zt.VIDEO,A=(E===zt.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;A&&this.afterBufferFlushed(A,E,ze.MAIN)}v=this.getNextFragmentLoopLoading(v,u,c,ze.MAIN,m)}v&&(v.initSegment&&!v.initSegment.data&&!this.bitrateTest&&(v=v.initSegment),this.loadFragment(v,o,p))}loadFragment(e,t,s){const n=this.fragmentTracker.getState(e);n===Es.NOT_LOADED||n===Es.PARTIAL?Ds(e)?this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,t)):super.loadFragment(e,t,s):this._loadInitSegment(e,t):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,ze.MAIN)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:e,media:t}=this;if(t!=null&&t.readyState){let s;const n=this.getAppendedFrag(t.currentTime);n&&n.start>1&&this.flushMainBuffer(0,n.start-1);const r=this.getLevelDetails();if(r!=null&&r.live){const c=this.getMainFwdBufferInfo();if(!c||c.len<r.targetduration*2)return}if(!t.paused&&e){const c=this.hls.nextLoadLevel,d=e[c],u=this.fragLastKbps;u&&this.fragCurrent?s=this.fragCurrent.duration*d.maxBitrate/(1e3*u)+1:s=0}else s=0;const o=this.getBufferedFrag(t.currentTime+s);if(o){const c=this.followingBufferedFrag(o);if(c){this.abortCurrentFrag();const d=c.maxStartPTS?c.maxStartPTS:c.start,u=c.duration,f=Math.max(o.end,d+Math.min(Math.max(u-this.config.maxFragLookUpTolerance,u*(this.couldBacktrack?.5:.125)),u*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(f,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case pe.KEY_LOADING:case pe.FRAG_LOADING:case pe.FRAG_LOADING_WAITING_RETRY:case pe.PARSING:case pe.PARSED:this.state=pe.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,t){super.flushMainBuffer(e,t,this.altAudio===2?"video":null)}onMediaAttached(e,t){super.onMediaAttached(e,t);const s=t.media;wi(s,"playing",this.onMediaPlaying),wi(s,"seeked",this.onMediaSeeked)}onMediaDetaching(e,t){const{media:s}=this;s&&(zi(s,"playing",this.onMediaPlaying),zi(s,"seeked",this.onMediaSeeked)),this.videoBuffer=null,this.fragPlaying=null,super.onMediaDetaching(e,t),!t.transferMedia&&(this._hasEnoughToStart=!1)}onManifestLoading(){super.onManifestLoading(),this.log("Trigger BUFFER_RESET"),this.hls.trigger(w.BUFFER_RESET,void 0),this.couldBacktrack=!1,this.fragLastKbps=0,this.fragPlaying=this.backtrackFragment=null,this.altAudio=0,this.audioOnly=!1}onManifestParsed(e,t){let s=!1,n=!1;t.levels.forEach(r=>{const o=r.audioCodec;o&&(s=s||o.indexOf("mp4a.40.2")!==-1,n=n||o.indexOf("mp4a.40.5")!==-1)}),this.audioCodecSwitch=s&&n&&!i3(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}onLevelLoading(e,t){const{levels:s}=this;if(!s||this.state!==pe.IDLE)return;const n=t.levelInfo;(!n.details||n.details.live&&(this.levelLastLoaded!==n||n.details.expired)||this.waitForCdnTuneIn(n.details))&&(this.state=pe.WAITING_LEVEL)}onLevelLoaded(e,t){var s;const{levels:n,startFragRequested:r}=this,o=t.level,c=t.details,d=c.totalduration;if(!n){this.warn(`Levels were reset while loading level ${o}`);return}this.log(`Level ${o} loaded [${c.startSN},${c.endSN}]${c.lastPartSn?`[part-${c.lastPartSn}-${c.lastPartIndex}]`:""}, cc [${c.startCC}, ${c.endCC}] duration:${d}`);const u=t.levelInfo,f=this.fragCurrent;f&&(this.state===pe.FRAG_LOADING||this.state===pe.FRAG_LOADING_WAITING_RETRY)&&f.level!==t.level&&f.loader&&this.abortCurrentFrag();let m=0;if(c.live||(s=u.details)!=null&&s.live){var p;if(this.checkLiveUpdate(c),c.deltaUpdateFailed)return;m=this.alignPlaylists(c,u.details,(p=this.levelLastLoaded)==null?void 0:p.details)}if(u.details=c,this.levelLastLoaded=u,r||this.setStartPosition(c,m),this.hls.trigger(w.LEVEL_UPDATED,{details:c,level:o}),this.state===pe.WAITING_LEVEL){if(this.waitForCdnTuneIn(c))return;this.state=pe.IDLE}r&&c.live&&this.synchronizeToLiveEdge(c),this.tick()}synchronizeToLiveEdge(e){const{config:t,media:s}=this;if(!s)return;const n=this.hls.liveSyncPosition,r=this.getLoadPosition(),o=e.fragmentStart,c=e.edge,d=r>=o-t.maxFragLookUpTolerance&&r<=c;if(n!==null&&s.duration>n&&(r<n||!d)){const f=t.liveMaxLatencyDuration!==void 0?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;if((!d&&s.readyState<4||r<c-f)&&(this._hasEnoughToStart||(this.nextLoadPosition=n),s.readyState))if(this.warn(`Playback: ${r.toFixed(3)} is located too far from the end of live sliding playlist: ${c}, reset currentTime to : ${n.toFixed(3)}`),this.config.liveSyncMode==="buffered"){var u;const m=at.bufferInfo(s,n,0);if(!(m!=null&&(u=m.buffered)!=null&&u.length)){s.currentTime=n;return}if(m.start<=r){s.currentTime=n;return}const{nextStart:v}=at.bufferedInfo(m.buffered,r,0);v&&(s.currentTime=v)}else s.currentTime=n}}_handleFragmentLoadProgress(e){var t;const s=e.frag,{part:n,payload:r}=e,{levels:o}=this;if(!o){this.warn(`Levels were reset while fragment load was in progress. Fragment ${s.sn} of level ${s.level} will not be buffered`);return}const c=o[s.level];if(!c){this.warn(`Level ${s.level} not found on progress`);return}const d=c.details;if(!d){this.warn(`Dropping fragment ${s.sn} of level ${s.level} after level details were reset`),this.fragmentTracker.removeFragment(s);return}const u=c.videoCodec,f=d.PTSKnown||!d.live,m=(t=s.initSegment)==null?void 0:t.data,p=this._getAudioCodec(c),v=this.transmuxer=this.transmuxer||new SI(this.hls,ze.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),S=n?n.index:-1,y=S!==-1,E=new N0(s.level,s.sn,s.stats.chunkCount,r.byteLength,S,y),A=this.initPTS[s.cc];v.push(r,m,p,u,s,n,d.totalduration,f,E,A)}onAudioTrackSwitching(e,t){const s=this.hls,n=this.altAudio===2;if(Rh(t.url,s))this.altAudio=1;else{if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const o=this.fragCurrent;o&&(this.log("Switching to main audio track, cancel main fragment load"),o.abortRequests(),this.fragmentTracker.removeFragment(o)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();if(n){this.fragmentTracker.removeAllFragments(),s.once(w.BUFFER_FLUSHED,()=>{var o;(o=this.hls)==null||o.trigger(w.AUDIO_TRACK_SWITCHED,t)}),s.trigger(w.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null});return}s.trigger(w.AUDIO_TRACK_SWITCHED,t)}}onAudioTrackSwitched(e,t){const s=Rh(t.url,this.hls);if(s){const n=this.videoBuffer;n&&this.mediaBuffer!==n&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=n)}this.altAudio=s?2:0,this.tick()}onBufferCreated(e,t){const s=t.tracks;let n,r,o=!1;for(const c in s){const d=s[c];if(d.id==="main"){if(r=c,n=d,c==="video"){const u=s[c];u&&(this.videoBuffer=u.buffer)}}else o=!0}o&&n?(this.log(`Alternate track found, use ${r}.buffered to schedule main fragment loading`),this.mediaBuffer=n.buffer):this.mediaBuffer=this.media}onFragBuffered(e,t){const{frag:s,part:n}=t,r=s.type===ze.MAIN;if(r){if(this.fragContextChanged(s)){this.warn(`Fragment ${s.sn}${n?" p: "+n.index:""} of level ${s.level} finished buffering, but was aborted. state: ${this.state}`),this.state===pe.PARSED&&(this.state=pe.IDLE);return}const c=n?n.stats:s.stats;this.fragLastKbps=Math.round(8*c.total/(c.buffering.end-c.loading.first)),Ds(s)&&(this.fragPrevious=s),this.fragBufferedComplete(s,n)}const o=this.media;o&&(!this._hasEnoughToStart&&at.getBuffered(o).length&&(this._hasEnoughToStart=!0,this.seekToStartPos()),r&&this.tick())}get hasEnoughToStart(){return this._hasEnoughToStart}onError(e,t){var s;if(t.fatal){this.state=pe.ERROR;return}switch(t.details){case se.FRAG_GAP:case se.FRAG_PARSING_ERROR:case se.FRAG_DECRYPT_ERROR:case se.FRAG_LOAD_ERROR:case se.FRAG_LOAD_TIMEOUT:case se.KEY_LOAD_ERROR:case se.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(ze.MAIN,t);break;case se.LEVEL_LOAD_ERROR:case se.LEVEL_LOAD_TIMEOUT:case se.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===pe.WAITING_LEVEL&&((s=t.context)==null?void 0:s.type)===gt.LEVEL&&(this.state=pe.IDLE);break;case se.BUFFER_ADD_CODEC_ERROR:case se.BUFFER_APPEND_ERROR:if(t.parent!=="main")return;this.resetLoadingState();break;case se.BUFFER_FULL_ERROR:if(t.parent!=="main")return;this.reduceLengthAndFlushBuffer(t)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case se.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onFragLoadEmergencyAborted(){this.state=pe.IDLE,this._hasEnoughToStart||(this.startFragRequested=!1,this.nextLoadPosition=this.lastCurrentTime),this.tickImmediate()}onBufferFlushed(e,{type:t}){if(t!==zt.AUDIO||!this.altAudio){const s=(t===zt.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;s&&(this.afterBufferFlushed(s,t,ze.MAIN),this.tick())}}onLevelsUpdated(e,t){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level,this.level===-1&&this.resetWhenMissingContext(this.fragCurrent)),this.levels=t.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:e}=this;if(!e)return;const t=e.currentTime;let s=this.startPosition;if(s>=0&&t<s){if(e.seeking){this.log(`could not seek to ${s}, already seeking at ${t}`);return}const n=this.timelineOffset;n&&s&&(s+=n);const r=this.getLevelDetails(),o=at.getBuffered(e),c=o.length?o.start(0):0,d=c-s,u=Math.max(this.config.maxBufferHole,this.config.maxFragLookUpTolerance);(this.config.startOnSegmentBoundary||d>0&&(d<u||this.loadingParts&&d<2*((r==null?void 0:r.partTarget)||0)))&&(this.log(`adjusting start position by ${d} to match buffer start`),s+=d,this.startPosition=s),t<s&&(this.log(`seek to target start position ${s} from current time ${t} buffer start ${c}`),e.currentTime=s)}}_getAudioCodec(e){let t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t.indexOf("mp4a.40.5")!==-1?t="mp4a.40.2":t="mp4a.40.5"),t}_loadBitrateTestFrag(e,t){e.bitrateTest=!0,this._doFragLoad(e,t).then(s=>{const{hls:n}=this,r=s==null?void 0:s.frag;if(!r||this.fragContextChanged(r))return;t.fragmentError=0,this.state=pe.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const o=r.stats;o.parsing.start=o.parsing.end=o.buffering.start=o.buffering.end=self.performance.now(),n.trigger(w.FRAG_LOADED,s),r.bitrateTest=!1})}_handleTransmuxComplete(e){var t;const s=this.playlistType,{hls:n}=this,{remuxResult:r,chunkMeta:o}=e,c=this.getCurrentContext(o);if(!c){this.resetWhenMissingContext(o);return}const{frag:d,part:u,level:f}=c,{video:m,text:p,id3:v,initSegment:S}=r,{details:y}=f,E=this.altAudio?void 0:r.audio;if(this.fragContextChanged(d)){this.fragmentTracker.removeFragment(d);return}if(this.state=pe.PARSING,S){if(S!=null&&S.tracks){const I=d.initSegment||d;this._bufferInitSegment(f,S.tracks,I,o),n.trigger(w.FRAG_PARSING_INIT_SEGMENT,{frag:I,id:s,tracks:S.tracks})}const A=S.initPTS,R=S.timescale;Fe(A)&&(this.initPTS[d.cc]={baseTime:A,timescale:R},n.trigger(w.INIT_PTS_FOUND,{frag:d,id:s,initPTS:A,timescale:R}))}if(m&&y){E&&m.type==="audiovideo"&&this.logMuxedErr(d);const A=y.fragments[d.sn-1-y.startSN],R=d.sn===y.startSN,I=!A||d.cc>A.cc;if(r.independent!==!1){const{startPTS:C,endPTS:L,startDTS:D,endDTS:_}=m;if(u)u.elementaryStreams[m.type]={startPTS:C,endPTS:L,startDTS:D,endDTS:_};else if(m.firstKeyFrame&&m.independent&&o.id===1&&!I&&(this.couldBacktrack=!0),m.dropped&&m.independent){const M=this.getMainFwdBufferInfo(),U=(M?M.end:this.getLoadPosition())+this.config.maxBufferHole,F=m.firstKeyFramePTS?m.firstKeyFramePTS:C;if(!R&&U<F-this.config.maxBufferHole&&!I){this.backtrack(d);return}else I&&(d.gap=!0);d.setElementaryStreamInfo(m.type,d.start,L,d.start,_,!0)}else R&&C-(y.appliedTimelineOffset||0)>dh&&(d.gap=!0);d.setElementaryStreamInfo(m.type,C,L,D,_),this.backtrackFragment&&(this.backtrackFragment=d),this.bufferFragmentData(m,d,u,o,R||I)}else if(R||I)d.gap=!0;else{this.backtrack(d);return}}if(E){const{startPTS:A,endPTS:R,startDTS:I,endDTS:C}=E;u&&(u.elementaryStreams[zt.AUDIO]={startPTS:A,endPTS:R,startDTS:I,endDTS:C}),d.setElementaryStreamInfo(zt.AUDIO,A,R,I,C),this.bufferFragmentData(E,d,u,o)}if(y&&v!=null&&(t=v.samples)!=null&&t.length){const A={id:s,frag:d,details:y,samples:v.samples};n.trigger(w.FRAG_PARSING_METADATA,A)}if(y&&p){const A={id:s,frag:d,details:y,samples:p.samples};n.trigger(w.FRAG_PARSING_USERDATA,A)}}logMuxedErr(e){this.warn(`${Ds(e)?"Media":"Init"} segment with muxed audiovideo where only video expected: ${e.url}`)}_bufferInitSegment(e,t,s,n){if(this.state!==pe.PARSING)return;this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&(delete t.audio,t.audiovideo&&this.logMuxedErr(s));const{audio:r,video:o,audiovideo:c}=t;if(r){let u=nh(r.codec,e.audioCodec);u==="mp4a"&&(u="mp4a.40.5");const f=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){u&&(u.indexOf("mp4a.40.5")!==-1?u="mp4a.40.2":u="mp4a.40.5");const m=r.metadata;m&&"channelCount"in m&&(m.channelCount||1)!==1&&f.indexOf("firefox")===-1&&(u="mp4a.40.5")}u&&u.indexOf("mp4a.40.5")!==-1&&f.indexOf("android")!==-1&&r.container!=="audio/mpeg"&&(u="mp4a.40.2",this.log(`Android: force audio codec to ${u}`)),e.audioCodec&&e.audioCodec!==u&&this.log(`Swapping manifest audio codec "${e.audioCodec}" for "${u}"`),r.levelCodec=u,r.id=ze.MAIN,this.log(`Init audio buffer, container:${r.container}, codecs[selected/level/parsed]=[${u||""}/${e.audioCodec||""}/${r.codec}]`),delete t.audiovideo}if(o){o.levelCodec=e.videoCodec,o.id=ze.MAIN;const u=o.codec;if((u==null?void 0:u.length)===4)switch(u){case"hvc1":case"hev1":o.codec="hvc1.1.6.L120.90";break;case"av01":o.codec="av01.0.04M.08";break;case"avc1":o.codec="avc1.42e01e";break}this.log(`Init video buffer, container:${o.container}, codecs[level/parsed]=[${e.videoCodec||""}/${u}]${o.codec!==u?" parsed-corrected="+o.codec:""}${o.supplemental?" supplemental="+o.supplemental:""}`),delete t.audiovideo}c&&(this.log(`Init audiovideo buffer, container:${c.container}, codecs[level/parsed]=[${e.codecs}/${c.codec}]`),delete t.video,delete t.audio);const d=Object.keys(t);if(d.length){if(this.hls.trigger(w.BUFFER_CODECS,t),!this.hls)return;d.forEach(u=>{const m=t[u].initSegment;m!=null&&m.byteLength&&this.hls.trigger(w.BUFFER_APPENDING,{type:u,data:m,frag:s,part:null,chunkMeta:n,parent:s.type})})}this.tickImmediate()}getMainFwdBufferInfo(){const e=this.mediaBuffer&&this.altAudio===2?this.mediaBuffer:this.media;return this.getFwdBufferInfo(e,ze.MAIN)}get maxBufferLength(){const{levels:e,level:t}=this,s=e==null?void 0:e[t];return s?this.getMaxBufferLength(s.maxBitrate):this.config.maxBufferLength}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=pe.IDLE}checkFragmentChanged(){const e=this.media;let t=null;if(e&&e.readyState>1&&e.seeking===!1){const s=e.currentTime;if(at.isBuffered(e,s)?t=this.getAppendedFrag(s):at.isBuffered(e,s+.1)&&(t=this.getAppendedFrag(s+.1)),t){this.backtrackFragment=null;const n=this.fragPlaying,r=t.level;(!n||t.sn!==n.sn||n.level!==r)&&(this.fragPlaying=t,this.hls.trigger(w.FRAG_CHANGED,{frag:t}),(!n||n.level!==r)&&this.hls.trigger(w.LEVEL_SWITCHED,{level:r}))}}}get nextLevel(){const e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){var e;if(this.fragPlaying)return this.fragPlaying;const t=((e=this.media)==null?void 0:e.currentTime)||this.lastCurrentTime;return Fe(t)?this.getAppendedFrag(t):null}get currentProgramDateTime(){var e;const t=((e=this.media)==null?void 0:e.currentTime)||this.lastCurrentTime;if(Fe(t)){const s=this.getLevelDetails(),n=this.currentFrag||(s?so(null,s.fragments,t):null);if(n){const r=n.programDateTime;if(r!==null){const o=r+(t-n.start)*1e3;return new Date(o)}}}return null}get currentLevel(){const e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){const e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class a3{constructor(e){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(const s in this.keyUriToKeyInfo){const n=this.keyUriToKeyInfo[s].loader;if(n){var t;if(e&&e!==((t=n.context)==null?void 0:t.frag.type))return;n.abort()}}}detach(){for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e].loader;t&&t.destroy()}this.keyUriToKeyInfo={}}createKeyLoadError(e,t=se.KEY_LOAD_ERROR,s,n,r){return new ar({type:Ke.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:r,error:s,networkDetails:n})}loadClear(e,t){if(this.emeController&&this.config.emeEnabled&&!this.emeController.getSelectedKeySystemFormats().length){if(t.length){const{sn:s,cc:n}=e;for(let r=0;r<t.length;r++){const o=t[r];if(n<=o.cc&&(s==="initSegment"||o.sn==="initSegment"||s<o.sn))return this.emeController.selectKeySystemFormat(o).then(c=>{if(o.setKeyFormat(c),this.emeController&&this.config.requireKeySystemAccessOnStart){const d=ah(c);if(d)return this.emeController.getKeySystemAccess([d])}})}}else if(this.config.requireKeySystemAccessOnStart){const s=Nc(this.config);if(s.length)return this.emeController.getKeySystemAccess(s)}}return null}load(e){return!e.decryptdata&&e.encrypted&&this.emeController&&this.config.emeEnabled?this.emeController.selectKeySystemFormat(e).then(t=>this.loadInternal(e,t)):this.loadInternal(e)}loadInternal(e,t){var s,n;t&&e.setKeyFormat(t);const r=e.decryptdata;if(!r){const u=new Error(t?`Expected frag.decryptdata to be defined after setting format ${t}`:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(e,se.KEY_LOAD_ERROR,u))}const o=r.uri;if(!o)return Promise.reject(this.createKeyLoadError(e,se.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${o}"`)));let c=this.keyUriToKeyInfo[o];if((s=c)!=null&&s.decryptdata.key)return r.key=c.decryptdata.key,Promise.resolve({frag:e,keyInfo:c});if((n=c)!=null&&n.keyLoadPromise){var d;switch((d=c.mediaKeySessionContext)==null?void 0:d.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return c.keyLoadPromise.then(u=>(r.key=u.keyInfo.decryptdata.key,{frag:e,keyInfo:c}))}}switch(c=this.keyUriToKeyInfo[o]={decryptdata:r,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},r.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return r.keyFormat==="identity"?this.loadKeyHTTP(c,e):this.loadKeyEME(c,e);case"AES-128":case"AES-256":case"AES-256-CTR":return this.loadKeyHTTP(c,e);default:return Promise.reject(this.createKeyLoadError(e,se.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${r.method}"`)))}}loadKeyEME(e,t){const s={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){const n=this.emeController.loadKey(s);if(n)return(e.keyLoadPromise=n.then(r=>(e.mediaKeySessionContext=r,s))).catch(r=>{throw e.keyLoadPromise=null,r})}return Promise.resolve(s)}loadKeyHTTP(e,t){const s=this.config,n=s.loader,r=new n(s);return t.keyLoader=e.loader=r,e.keyLoadPromise=new Promise((o,c)=>{const d={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},u=s.keyLoadPolicy.default,f={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},m={onSuccess:(p,v,S,y)=>{const{frag:E,keyInfo:A,url:R}=S;if(!E.decryptdata||A!==this.keyUriToKeyInfo[R])return c(this.createKeyLoadError(E,se.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),y));A.decryptdata.key=E.decryptdata.key=new Uint8Array(p.data),E.keyLoader=null,A.loader=null,o({frag:E,keyInfo:A})},onError:(p,v,S,y)=>{this.resetLoader(v),c(this.createKeyLoadError(t,se.KEY_LOAD_ERROR,new Error(`HTTP Error ${p.code} loading key ${p.text}`),S,_t({url:d.url,data:void 0},p)))},onTimeout:(p,v,S)=>{this.resetLoader(v),c(this.createKeyLoadError(t,se.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),S))},onAbort:(p,v,S)=>{this.resetLoader(v),c(this.createKeyLoadError(t,se.INTERNAL_ABORTED,new Error("key loading aborted"),S))}};r.load(d,f,m)})}resetLoader(e){const{frag:t,keyInfo:s,url:n}=e,r=s.loader;t.keyLoader===r&&(t.keyLoader=null,s.loader=null),delete this.keyUriToKeyInfo[n],r&&r.destroy()}}function cE(i){const{type:e}=i;switch(e){case gt.AUDIO_TRACK:return ze.AUDIO;case gt.SUBTITLE_TRACK:return ze.SUBTITLE;default:return ze.MAIN}}function Zg(i,e){let t=i.url;return(t===void 0||t.indexOf("data:")===0)&&(t=e.url),t}class o3{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.onManifestLoaded=this.checkAutostartLoad,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:e}=this;e.on(w.MANIFEST_LOADING,this.onManifestLoading,this),e.on(w.LEVEL_LOADING,this.onLevelLoading,this),e.on(w.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(w.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.on(w.LEVELS_UPDATED,this.onLevelsUpdated,this)}unregisterListeners(){const{hls:e}=this;e.off(w.MANIFEST_LOADING,this.onManifestLoading,this),e.off(w.LEVEL_LOADING,this.onLevelLoading,this),e.off(w.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(w.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.off(w.LEVELS_UPDATED,this.onLevelsUpdated,this)}createInternalLoader(e){const t=this.hls.config,s=t.pLoader,n=t.loader,r=s||n,o=new r(t);return this.loaders[e.type]=o,o}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(const e in this.loaders){const t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,t){const{url:s}=t;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:gt.MANIFEST,url:s,deliveryDirectives:null,levelOrTrack:null})}onLevelLoading(e,t){const{id:s,level:n,pathwayId:r,url:o,deliveryDirectives:c,levelInfo:d}=t;this.load({id:s,level:n,pathwayId:r,responseType:"text",type:gt.LEVEL,url:o,deliveryDirectives:c,levelOrTrack:d})}onAudioTrackLoading(e,t){const{id:s,groupId:n,url:r,deliveryDirectives:o,track:c}=t;this.load({id:s,groupId:n,level:null,responseType:"text",type:gt.AUDIO_TRACK,url:r,deliveryDirectives:o,levelOrTrack:c})}onSubtitleTrackLoading(e,t){const{id:s,groupId:n,url:r,deliveryDirectives:o,track:c}=t;this.load({id:s,groupId:n,level:null,responseType:"text",type:gt.SUBTITLE_TRACK,url:r,deliveryDirectives:o,levelOrTrack:c})}onLevelsUpdated(e,t){const s=this.loaders[gt.LEVEL];if(s){const n=s.context;n&&!t.levels.some(r=>r===n.levelOrTrack)&&(s.abort(),delete this.loaders[gt.LEVEL])}}load(e){var t;const s=this.hls.config;let n=this.getInternalLoader(e);if(n){const u=this.hls.logger,f=n.context;if(f&&f.levelOrTrack===e.levelOrTrack&&(f.url===e.url||f.deliveryDirectives&&!e.deliveryDirectives)){f.url===e.url?u.log(`[playlist-loader]: ignore ${e.url} ongoing request`):u.log(`[playlist-loader]: ignore ${e.url} in favor of ${f.url}`);return}u.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),n.abort()}let r;if(e.type===gt.MANIFEST?r=s.manifestLoadPolicy.default:r=Ft({},s.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),n=this.createInternalLoader(e),Fe((t=e.deliveryDirectives)==null?void 0:t.part)){let u;if(e.type===gt.LEVEL&&e.level!==null?u=this.hls.levels[e.level].details:e.type===gt.AUDIO_TRACK&&e.id!==null?u=this.hls.audioTracks[e.id].details:e.type===gt.SUBTITLE_TRACK&&e.id!==null&&(u=this.hls.subtitleTracks[e.id].details),u){const f=u.partTarget,m=u.targetduration;if(f&&m){const p=Math.max(f*3,m*.8)*1e3;r=Ft({},r,{maxTimeToFirstByteMs:Math.min(p,r.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(p,r.maxTimeToFirstByteMs)})}}}const o=r.errorRetry||r.timeoutRetry||{},c={loadPolicy:r,timeout:r.maxLoadTimeMs,maxRetry:o.maxNumRetry||0,retryDelay:o.retryDelayMs||0,maxRetryDelay:o.maxRetryDelayMs||0},d={onSuccess:(u,f,m,p)=>{const v=this.getInternalLoader(m);this.resetInternalLoader(m.type);const S=u.data;if(S.indexOf("#EXTM3U")!==0){this.handleManifestParsingError(u,m,new Error("no EXTM3U delimiter"),p||null,f);return}f.parsing.start=performance.now(),Dn.isMediaPlaylist(S)||m.type!==gt.MANIFEST?this.handleTrackOrLevelPlaylist(u,f,m,p||null,v):this.handleMasterPlaylist(u,f,m,p)},onError:(u,f,m,p)=>{this.handleNetworkError(f,m,!1,u,p)},onTimeout:(u,f,m)=>{this.handleNetworkError(f,m,!0,void 0,u)}};n.load(e,c,d)}checkAutostartLoad(){if(!this.hls)return;const{config:{autoStartLoad:e,startPosition:t},forceStartLoad:s}=this.hls;(e||s)&&(this.hls.logger.log(`${e?"auto":"force"} startLoad with configured startPosition ${t}`),this.hls.startLoad(t))}handleMasterPlaylist(e,t,s,n){const r=this.hls,o=e.data,c=Zg(e,s),d=Dn.parseMasterPlaylist(o,c);if(d.playlistParsingError){this.handleManifestParsingError(e,s,d.playlistParsingError,n,t);return}const{contentSteering:u,levels:f,sessionData:m,sessionKeys:p,startTimeOffset:v,variableList:S}=d;this.variableList=S;const{AUDIO:y=[],SUBTITLES:E,"CLOSED-CAPTIONS":A}=Dn.parseMasterPlaylistMedia(o,c,d);y.length&&!y.some(I=>!I.url)&&f[0].audioCodec&&!f[0].attrs.AUDIO&&(this.hls.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),y.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new is({}),bitrate:0,url:""})),r.trigger(w.MANIFEST_LOADED,{levels:f,audioTracks:y,subtitles:E,captions:A,contentSteering:u,url:c,stats:t,networkDetails:n,sessionData:m,sessionKeys:p,startTimeOffset:v,variableList:S})}handleTrackOrLevelPlaylist(e,t,s,n,r){const o=this.hls,{id:c,level:d,type:u}=s,f=Zg(e,s),m=Fe(d)?d:Fe(c)?c:0,p=cE(s),v=Dn.parseLevelPlaylist(e.data,f,m,p,0,this.variableList);if(u===gt.MANIFEST){const S={attrs:new is({}),bitrate:0,details:v,name:"",url:f};v.requestScheduled=t.loading.start+qA(v,0),o.trigger(w.MANIFEST_LOADED,{levels:[S],audioTracks:[],url:f,stats:t,networkDetails:n,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),s.levelDetails=v,this.handlePlaylistLoaded(v,e,t,s,n,r)}handleManifestParsingError(e,t,s,n,r){this.hls.trigger(w.ERROR,{type:Ke.NETWORK_ERROR,details:se.MANIFEST_PARSING_ERROR,fatal:t.type===gt.MANIFEST,url:e.url,err:s,error:s,reason:s.message,response:e,context:t,networkDetails:n,stats:r})}handleNetworkError(e,t,s=!1,n,r){let o=`A network ${s?"timeout":"error"+(n?" (status "+n.code+")":"")} occurred while loading ${e.type}`;e.type===gt.LEVEL?o+=`: ${e.level} id: ${e.id}`:(e.type===gt.AUDIO_TRACK||e.type===gt.SUBTITLE_TRACK)&&(o+=` id: ${e.id} group-id: "${e.groupId}"`);const c=new Error(o);this.hls.logger.warn(`[playlist-loader]: ${o}`);let d=se.UNKNOWN,u=!1;const f=this.getInternalLoader(e);switch(e.type){case gt.MANIFEST:d=s?se.MANIFEST_LOAD_TIMEOUT:se.MANIFEST_LOAD_ERROR,u=!0;break;case gt.LEVEL:d=s?se.LEVEL_LOAD_TIMEOUT:se.LEVEL_LOAD_ERROR,u=!1;break;case gt.AUDIO_TRACK:d=s?se.AUDIO_TRACK_LOAD_TIMEOUT:se.AUDIO_TRACK_LOAD_ERROR,u=!1;break;case gt.SUBTITLE_TRACK:d=s?se.SUBTITLE_TRACK_LOAD_TIMEOUT:se.SUBTITLE_LOAD_ERROR,u=!1;break}f&&this.resetInternalLoader(e.type);const m={type:Ke.NETWORK_ERROR,details:d,fatal:u,url:e.url,loader:f,context:e,error:c,networkDetails:t,stats:r};if(n){const p=(t==null?void 0:t.url)||e.url;m.response=_t({url:p,data:void 0},n)}this.hls.trigger(w.ERROR,m)}handlePlaylistLoaded(e,t,s,n,r,o){const c=this.hls,{type:d,level:u,id:f,groupId:m,deliveryDirectives:p}=n,v=Zg(t,n),S=cE(n),y=typeof n.level=="number"&&S===ze.MAIN?u:void 0;if(!e.fragments.length){const A=e.playlistParsingError=new Error("No Segments found in Playlist");c.trigger(w.ERROR,{type:Ke.NETWORK_ERROR,details:se.LEVEL_EMPTY_ERROR,fatal:!1,url:v,error:A,reason:A.message,response:t,context:n,level:y,parent:S,networkDetails:r,stats:s});return}e.targetduration||(e.playlistParsingError=new Error("Missing Target Duration"));const E=e.playlistParsingError;if(E){if(this.hls.logger.warn(E),!c.config.ignorePlaylistParsingErrors){c.trigger(w.ERROR,{type:Ke.NETWORK_ERROR,details:se.LEVEL_PARSING_ERROR,fatal:!1,url:v,error:E,reason:E.message,response:t,context:n,level:y,parent:S,networkDetails:r,stats:s});return}e.playlistParsingError=null}switch(e.live&&o&&(o.getCacheAge&&(e.ageHeader=o.getCacheAge()||0),(!o.getCacheAge||isNaN(e.ageHeader))&&(e.ageHeader=0)),d){case gt.MANIFEST:case gt.LEVEL:c.trigger(w.LEVEL_LOADED,{details:e,levelInfo:n.levelOrTrack||c.levels[0],level:y||0,id:f||0,stats:s,networkDetails:r,deliveryDirectives:p,withoutMultiVariant:d===gt.MANIFEST});break;case gt.AUDIO_TRACK:c.trigger(w.AUDIO_TRACK_LOADED,{details:e,track:n.levelOrTrack,id:f||0,groupId:m||"",stats:s,networkDetails:r,deliveryDirectives:p});break;case gt.SUBTITLE_TRACK:c.trigger(w.SUBTITLE_TRACK_LOADED,{details:e,track:n.levelOrTrack,id:f||0,groupId:m||"",stats:s,networkDetails:r,deliveryDirectives:p});break}}}class Ri{static get version(){return Wc}static isMSESupported(){return $I()}static isSupported(){return s3()}static getMediaSource(){return ca()}static get Events(){return w}static get MetadataSchema(){return Ii}static get ErrorTypes(){return Ke}static get ErrorDetails(){return se}static get DefaultConfig(){return Ri.defaultConfig?Ri.defaultConfig:GU}static set DefaultConfig(e){Ri.defaultConfig=e}constructor(e={}){this.config=void 0,this.userConfig=void 0,this.logger=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new B0,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioStreamController=void 0,this.subtititleStreamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.interstitialsController=void 0,this.gapController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this._url=null,this._sessionId=void 0,this.triggeringException=void 0,this.started=!1;const t=this.logger=w2(e.debug||!1,"Hls instance",e.assetPlayerId),s=this.config=zU(Ri.DefaultConfig,e,t);this.userConfig=e,s.progressive&&KU(s,t);const{abrController:n,bufferController:r,capLevelController:o,errorController:c,fpsController:d}=s,u=new c(this),f=this.abrController=new n(this),m=new vk(this),p=s.interstitialsController,v=p?this.interstitialsController=new p(this,Ri):null,S=this.bufferController=new r(this,m),y=this.capLevelController=new o(this),E=new d(this),A=new o3(this),R=s.contentSteeringController,I=R?new R(this):null,C=this.levelController=new t3(this,I),L=new JU(this),D=new a3(this.config),_=this.streamController=new r3(this,m,D),M=this.gapController=new XU(this,m);y.setStreamController(_),E.setStreamController(_);const U=[A,C,_];v&&U.splice(1,0,v),I&&U.splice(1,0,I),this.networkControllers=U;const F=[f,S,M,y,E,L,m];this.audioTrackController=this.createController(s.audioTrackController,U);const z=s.audioStreamController;z&&U.push(this.audioStreamController=new z(this,m,D)),this.subtitleTrackController=this.createController(s.subtitleTrackController,U);const V=s.subtitleStreamController;V&&U.push(this.subtititleStreamController=new V(this,m,D)),this.createController(s.timelineController,F),D.emeController=this.emeController=this.createController(s.emeController,F),this.cmcdController=this.createController(s.cmcdController,F),this.latencyController=this.createController(e3,F),this.coreComponents=F,U.push(u);const ae=u.onErrorOut;typeof ae=="function"&&this.on(w.ERROR,ae,u),this.on(w.MANIFEST_LOADED,A.onManifestLoaded,A)}createController(e,t){if(e){const s=new e(this);return t&&t.push(s),s}return null}on(e,t,s=this){this._emitter.on(e,t,s)}once(e,t,s=this){this._emitter.once(e,t,s)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,t,s=this,n){this._emitter.off(e,t,s,n)}listeners(e){return this._emitter.listeners(e)}emit(e,t,s){return this._emitter.emit(e,t,s)}trigger(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(s){if(this.logger.error("An internal error happened while handling event "+e+'. Error message: "'+s.message+'". Here is a stacktrace:',s),!this.triggeringException){this.triggeringException=!0;const n=e===w.ERROR;this.trigger(w.ERROR,{type:Ke.OTHER_ERROR,details:se.INTERNAL_EXCEPTION,fatal:n,event:e,error:s}),this.triggeringException=!1}}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){this.logger.log("destroy"),this.trigger(w.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this._url=null,this.networkControllers.forEach(t=>t.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(t=>t.destroy()),this.coreComponents.length=0;const e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){if(!e||"media"in e&&!e.media){const r=new Error(`attachMedia failed: invalid argument (${e})`);this.trigger(w.ERROR,{type:Ke.OTHER_ERROR,details:se.ATTACH_MEDIA_ERROR,fatal:!0,error:r});return}this.logger.log("attachMedia"),this._media&&(this.logger.warn("media must be detached before attaching"),this.detachMedia());const t="media"in e,s=t?e.media:e,n=t?e:{media:s};this._media=s,this.trigger(w.MEDIA_ATTACHING,n)}detachMedia(){this.logger.log("detachMedia"),this.trigger(w.MEDIA_DETACHING,{}),this._media=null}transferMedia(){this._media=null;const e=this.bufferController.transferMedia();return this.trigger(w.MEDIA_DETACHING,{transferMedia:e}),e}loadSource(e){this.stopLoad();const t=this.media,s=this._url,n=this._url=O0.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.logger.log(`loadSource:${n}`),t&&s&&(s!==n||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger(w.MANIFEST_LOADING,{url:e})}get url(){return this._url}get hasEnoughToStart(){return this.streamController.hasEnoughToStart}get startPosition(){return this.streamController.startPositionValue}startLoad(e=-1,t){this.logger.log(`startLoad(${e+(t?", <skip seek to start>":"")})`),this.started=!0,this.resumeBuffering();for(let s=0;s<this.networkControllers.length&&(this.networkControllers[s].startLoad(e,t),!(!this.started||!this.networkControllers));s++);}stopLoad(){this.logger.log("stopLoad"),this.started=!1;for(let e=0;e<this.networkControllers.length&&(this.networkControllers[e].stopLoad(),!(this.started||!this.networkControllers));e++);}get loadingEnabled(){return this.started}get bufferingEnabled(){return this.streamController.bufferingEnabled}resumeBuffering(){this.bufferingEnabled||(this.logger.log("resume buffering"),this.networkControllers.forEach(e=>{e.resumeBuffering&&e.resumeBuffering()}))}pauseBuffering(){this.bufferingEnabled&&(this.logger.log("pause buffering"),this.networkControllers.forEach(e=>{e.pauseBuffering&&e.pauseBuffering()}))}get inFlightFragments(){const e={[ze.MAIN]:this.streamController.inFlightFrag};return this.audioStreamController&&(e[ze.AUDIO]=this.audioStreamController.inFlightFrag),this.subtititleStreamController&&(e[ze.SUBTITLE]=this.subtititleStreamController.inFlightFrag),e}swapAudioCodec(){this.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){this.logger.log("recoverMediaError");const e=this._media,t=e==null?void 0:e.currentTime;this.detachMedia(),e&&(this.attachMedia(e),t&&this.startLoad(t))}removeLevel(e){this.levelController.removeLevel(e)}get sessionId(){let e=this._sessionId;return e||(e=this._sessionId=XM()),e}get levels(){const e=this.levelController.levels;return e||[]}get latestLevelDetails(){return this.streamController.getLevelDetails()||null}get loadLevelObj(){return this.levelController.loadLevelObj}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){this.logger.log(`set currentLevel:${e}`),this.levelController.manualLevel=e,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){this.logger.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){this.logger.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){this.logger.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){const e=this.levelController.startLevel;return e===-1&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:e}set startLevel(e){this.logger.log(`set startLevel:${e}`),e!==-1&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){const t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}set bandwidthEstimate(e){this.abrController.resetEstimator(e)}get abrEwmaDefaultEstimate(){const{bwEstimator:e}=this.abrController;return e?e.defaultEstimate:NaN}get ttfbEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(this.logger.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){sk(e)&&this._maxHdcpLevel!==e&&(this._maxHdcpLevel=e,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return this.levelController.manualLevel===-1}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:e,config:{minAutoBitrate:t}}=this;if(!e)return 0;const s=e.length;for(let n=0;n<s;n++)if(e[n].maxBitrate>=t)return n;return 0}get maxAutoLevel(){const{levels:e,autoLevelCapping:t,maxHdcpLevel:s}=this;let n;if(t===-1&&e!=null&&e.length?n=e.length-1:n=t,s)for(let r=n;r--;){const o=e[r].attrs["HDCP-LEVEL"];if(o&&o<=s)return r}return n}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(e){this.abrController.nextAutoLevel=e}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get maxBufferLength(){return this.streamController.maxBufferLength}setAudioOption(e){var t;return((t=this.audioTrackController)==null?void 0:t.setAudioOption(e))||null}setSubtitleOption(e){var t;return((t=this.subtitleTrackController)==null?void 0:t.setSubtitleOption(e))||null}get allAudioTracks(){const e=this.audioTrackController;return e?e.allAudioTracks:[]}get audioTracks(){const e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){const e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){const t=this.audioTrackController;t&&(t.audioTrack=e)}get allSubtitleTracks(){const e=this.subtitleTrackController;return e?e.allSubtitleTracks:[]}get subtitleTracks(){const e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){const e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){const t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}get subtitleDisplay(){const e=this.subtitleTrackController;return e?e.subtitleDisplay:!1}set subtitleDisplay(e){const t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}set targetLatency(e){this.latencyController.targetLatency=e}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}get pathways(){return this.levelController.pathways}get pathwayPriority(){return this.levelController.pathwayPriority}set pathwayPriority(e){this.levelController.pathwayPriority=e}get bufferedToEnd(){var e;return!!((e=this.bufferController)!=null&&e.bufferedToEnd)}get interstitialsManager(){var e;return((e=this.interstitialsController)==null?void 0:e.interstitialsManager)||null}getMediaDecodingInfo(e,t=this.allAudioTracks){const s=UA(t);return MA(e,s,navigator.mediaCapabilities)}}Ri.defaultConfig=void 0;const uE=(i,e=!1)=>{if(!i)return[];const t=i.pages.map((n,r)=>n.map(o=>({...o,pageIndex:r}))).flat();if(e)return t;const s=new Set;return t.filter(n=>s.has(n.Id)?!1:(s.add(n.Id),!0))},Mn=({queryKey:i,queryFn:e,initialPageParam:t=0,queryFnReviver:s,allowDuplicates:n=!1})=>{const{data:o,isFetching:c,isPending:d,error:u,fetchNextPage:f,hasNextPage:m,isFetchingNextPage:p}=ob({queryKey:i,queryFn:e,getNextPageParam:(y,E)=>y.length>=40?E.length:void 0,initialPageParam:t,staleTime:1/0});P.useEffect(()=>{var y;u instanceof gu&&((y=u.response)==null?void 0:y.status)===401&&(localStorage.removeItem("auth"),window.location.href="/login")},[u]);const v=P.useMemo(()=>uE(o,n),[o,n]),S=P.useCallback(async()=>{if(m&&!p)return uE((await f()).data)},[m,p,f]);return{items:v,isLoading:c||d,error:u?u.message:null,hasNextPage:m,loadMore:S,reviver:{queryKey:i,queryFn:s}}},Un="___PAGE_PARAM_INDEX___",l3=({initialVolume:i,clearOnLogout:e})=>{const t=ns(),[s,n]=P.useState(()=>{const j=localStorage.getItem("sessionPlayCount");return j?Number(j):0}),[r,o]=P.useState({index:localStorage.getItem("currentTrackIndex")?Number(localStorage.getItem("currentTrackIndex")):-1}),[c,d]=P.useState(!1),[u,f]=P.useState(()=>{const j=localStorage.getItem("volume");return j?parseFloat(j):i}),[m,p]=P.useState(!1),[v,S]=P.useState(()=>{const j=localStorage.getItem("repeatMode");return j==="all"||j==="one"?j:"off"}),y=P.useRef(new Audio),E=P.useRef(null),A=P.useRef([]),[R,I]=P.useState({index:-1}),C=P.useRef(new Set),L=P.useRef(!1),D=El(),[_,M]=P.useState(localStorage.getItem("playlistTitle")||""),[U,F]=P.useState(JSON.parse(localStorage.getItem("reviver")||"{}")||{}),[z,V]=P.useState(Number(localStorage.getItem("bitrate"))),ae=P.useRef(!1),G=Yh();P.useEffect(()=>{localStorage.setItem("bitrate",z.toString())},[z]);const Z=P.useMemo(()=>{var Ue,Ve;const j=((Ue=U.queryFn)==null?void 0:Ue.fn)||"",ne=((Ve=U.queryFn)==null?void 0:Ve.params)||[],ge=ne.findIndex(it=>it===Un),Ie=ne[ge+1];return{queryKey:["reviver",...U.queryKey||[]],queryFn:async({pageParam:it=0})=>{var Rt;const xt=it*Ie;return ne[ge]=xt,await((Rt=t[j])==null?void 0:Rt.call(t,...ne))||[]},queryFnReviver:void 0,initialPageParam:Number(localStorage.getItem("reviverPageIndex"))||0,allowDuplicates:!0}},[t,U.queryFn,U.queryKey]),{items:B,hasNextPage:Q,loadMore:re,isLoading:J}=Mn(Z),N=P.useCallback(j=>{var ne;m&&p(!1),j.reviver!=="persist"&&(localStorage.setItem("reviver",JSON.stringify(j.reviver||{})),D.setQueryData(["reviver",...((ne=j.reviver)==null?void 0:ne.queryKey)||[]],{pageParams:[1],pages:[j.playlist]}),F(j.reviver||{})),localStorage.setItem("playlistTitle",j.title),M(j.title)},[D,m]),K=P.useRef(null),[le,H]=P.useState(!1),ue=P.useMemo(()=>B[m?A.current.indexOf(R.index):r.index]||null,[R.index,r.index,B,m]),xe=P.useCallback(j=>{var ne;if("mediaSession"in navigator){const ge=t.getImageUrl(j,"Primary",{width:512,height:512});navigator.mediaSession.metadata=new MediaMetadata({title:j.Name||"Unknown Track",artist:((ne=j.Artists)==null?void 0:ne.join(", "))||j.AlbumArtist||"Unknown Artist",album:j.Album||"Unknown Album",artwork:ge?[{src:ge,sizes:"512x512",type:"image/webp"}]:[]})}},[t]);P.useEffect(()=>{if(!c||!ue)return;const j=setInterval(()=>{t.reportPlaybackProgress(ue.Id,y.current.currentTime,!1)},1e4);return()=>clearInterval(j)},[t,ue,c]),P.useEffect(()=>{e||!t.auth.token?(n(0),localStorage.removeItem("sessionPlayCount")):t.auth.token&&localStorage.setItem("sessionPlayCount",s.toString())},[t.auth.token,e,s]);const fe=()=>{n(0),localStorage.removeItem("sessionPlayCount")},We=P.useCallback(async(j,ne,ge)=>{const Ie={enableWorker:!1,maxBufferLength:10,maxMaxBufferLength:20};if(j){const Ve=await G.getTrack(ge);if((Ve==null?void 0:Ve.type)==="m3u8"){const it=await Ve.playlist.text(),xt=await Promise.all(Ve.ts.map($t=>$t.arrayBuffer())),Rt=it.match(/#EXT-X-MEDIA-SEQUENCE:(\d+)/),Dt=Rt?parseInt(Rt[1],10):1;class bt extends Ri.DefaultConfig.loader{load(St,_s,hs){if(St.frag){const Ps=St.frag.sn-Dt,ps=xt[Ps];ps&&hs.onSuccess({data:ps,url:St.url},{aborted:!1,loaded:ps.byteLength,total:ps.byteLength,retry:0,chunkCount:0,bwEstimate:0,loading:{start:0,first:0,end:0},parsing:{start:0,end:0},buffering:{start:0,first:0,end:0}},St,null)}}}Ie.fLoader=bt}}const Ue=new Ri(Ie);E.current=Ue,Ue.loadSource(j||ne),Ue.attachMedia(y.current),Ue.on(Ri.Events.ERROR,(Ve,it)=>{if(console.error("HLS error:",it.type,it.details,it),it.fatal)switch(it.type){case Ri.ErrorTypes.NETWORK_ERROR:ae.current=!0,y.current.pause();break;case Ri.ErrorTypes.MEDIA_ERROR:Ue.recoverMediaError();break;default:ae.current=!0,y.current.pause()}})},[G]),de=P.useCallback(async j=>{var Ue;if(!y.current)return;y.current.pause(),y.current.currentTime=0,(Ue=E.current)==null||Ue.destroy(),E.current=null;const ne=await G.getPlayableUrl(j.Id),ge=t.getStreamUrl(j.Id,z);(ne?ne.type==="m3u8":[128e3,192e3,256e3,32e4].includes(z))&&Ri.isSupported()?await We(ne==null?void 0:ne.url,ge,j.Id):(y.current.src=(ne==null?void 0:ne.url)||ge,y.current.load())},[t,G,z,We]),Be=P.useCallback((j,ne)=>{const ge=[...Array(ne).keys()].filter(Ie=>Ie!==j).sort(()=>Math.random()-.5);return j!==-1&&ge.unshift(j),ge},[]),lt=P.useCallback(async j=>{var Ie;const ne=B[j];if(!ne)return;ne.pageIndex?localStorage.setItem("reviverPageIndex",ne.pageIndex.toString()):localStorage.removeItem("reviverPageIndex"),(Ie=K.current)==null||Ie.abort("abort"),K.current=new AbortController;const ge=K.current.signal;if(y.current){const Ue=y.current;ue&&c&&t.reportPlaybackStopped(ue.Id,Ue.currentTime,ge);try{await de(ne),await new Promise((Ve,it)=>{const xt=async()=>{Ue.removeEventListener("loadedmetadata",xt),ge.removeEventListener("abort",Rt);try{le&&await Ue.play()}catch(Dt){it(Dt)}Ve()},Rt=()=>{Ue.removeEventListener("loadedmetadata",xt),Ve()};ge.addEventListener("abort",Rt),Ue.addEventListener("loadedmetadata",xt)}),n(Ve=>Ve+1),C.current.add(j),xe(ne),t.reportPlaybackStart(ne.Id,ge)}catch(Ve){console.error("Error playing track:",Ve)}}},[de,t,ue,c,B,xe,le]),Ee=P.useCallback(async()=>{var j;if(H(!0),y.current&&ue){const ne=y.current;if(c)ne.pause(),t.reportPlaybackProgress(ue.Id,ne.currentTime,!0);else{if(ae.current||!ne.src&&!E.current&&ue){const ge=ae.current?ne.currentTime:0;ae.current=!1,await de(ue),ge&&(ne.currentTime=ge)}try{await ne.play(),t.reportPlaybackProgress(ue.Id,ne.currentTime,!1),xe(ue)}catch(ge){console.error("Error resuming playback:",ge),(j=y.current)==null||j.pause()}}}},[de,t,ue,c,xe]);P.useEffect(()=>{r.index>=0&&r.index<B.length&&B[r.index]?lt(r.index):y.current&&y.current.pause()},[r]),P.useEffect(()=>{m&&(R.index>=0&&R.index<B.length&&B[R.index]?lt(A.current.indexOf(R.index)):y.current&&y.current.pause())},[R]);const Ne=P.useCallback(async()=>{if(H(!0),!B||B.length===0||r.index===-1||!ue){y.current&&y.current.pause();return}if(v==="one")o({index:r.index});else if(m){const j=R.index+1;if(j>=A.current.length)if(A.current.length){I({index:j});return}else if(v==="all")C.current.clear(),A.current=Be(r.index,B.length),I({index:0});else{y.current&&y.current.pause();return}else I({index:j})}else{const j=r.index+1;if(j>=B.length)if(await re())o({index:j});else if(v==="all")o({index:0});else{y.current&&y.current.pause();return}else o({index:j})}},[Be,R.index,ue,r.index,B,re,v,m]),Me=P.useCallback(async()=>{if(H(!0),!B||B.length===0||r.index===-1||!ue){y.current&&y.current.pause();return}if(v!=="one")if(m){const j=R.index-1;if(j<0)if(v==="all")C.current.clear(),A.current=Be(r.index,B.length),I({index:A.current.length-1});else{y.current&&y.current.pause();return}else I({index:j})}else{const j=r.index-1;if(j<0)if(v==="all")o({index:B.length-1});else{y.current&&y.current.pause();return}else o({index:j})}},[Be,R.index,ue,r.index,B,v,m]),Qe=P.useCallback(()=>{p(j=>{const ne=!j;return ne?(C.current.clear(),A.current=Be(r.index,B.length),I({index:0}),ue&&r.index!==-1&&o({index:r.index})):(A.current=[],I({index:-1}),C.current.clear()),ne})},[Be,ue,r.index,B.length]),st=()=>{S(j=>j==="off"?"all":j==="all"?"one":"off")},W=j=>{if(isNaN(j)||j===0)return"0:00";const ne=Math.floor(j/3600),ge=Math.floor(j%3600/60),Ie=Math.floor(j%60);return ne>0?`${ne}:${ge<10?"0":""}${ge}:${Ie<10?"0":""}${Ie}`:`${ge}:${Ie<10?"0":""}${Ie}`};return P.useEffect(()=>{y.current.volume=u},[]),P.useEffect(()=>{const j=y.current,ne=()=>{d(!0)},ge=()=>{d(!1)};return j.addEventListener("play",ne),j.addEventListener("pause",ge),()=>{j.removeEventListener("play",ne),j.removeEventListener("pause",ge)}},[]),P.useEffect(()=>{const j=y.current,ne=ge=>{var Ie;console.error("Audio error during playback:",ge),ae.current=!0,(Ie=y.current)==null||Ie.pause()};return j.addEventListener("error",ne),()=>{j.removeEventListener("error",ne)}},[]),P.useEffect(()=>{if("mediaSession"in navigator)return navigator.mediaSession.setActionHandler("nexttrack",Ne),navigator.mediaSession.setActionHandler("previoustrack",Me),navigator.mediaSession.setActionHandler("play",Ee),navigator.mediaSession.setActionHandler("pause",Ee),()=>{navigator.mediaSession.setActionHandler("nexttrack",null),navigator.mediaSession.setActionHandler("previoustrack",null),navigator.mediaSession.setActionHandler("play",null),navigator.mediaSession.setActionHandler("pause",null)}},[Ne,Me,Ee]),P.useEffect(()=>{localStorage.setItem("volume",u.toString()),y.current&&(y.current.volume=u)},[u]),P.useEffect(()=>{localStorage.setItem("repeatMode",v)},[v]),P.useEffect(()=>{localStorage.setItem("currentTrackIndex",r.index.toString())},[r]),P.useEffect(()=>{if(L.current)return;L.current=!0,(async()=>{const ne=localStorage.getItem("currentTrackIndex");if(t.auth.token){const ge=Number(ne);o(ge!==-1?{index:r.index}:ne?{index:Number(ne)}:{index:-1});const Ie=B[r.index];Ie&&(y.current&&await de(Ie),xe(Ie))}else t.auth.token||o({index:-1})})()},[de,t.auth.token,r.index,B,xe]),P.useEffect(()=>{const ne=m?R.index:r.index,ge=m?A.current.length:B.length;Q&&ne>=ge-5&&re()},[R.index,r.index,Q,B.length,re,m]),P.useEffect(()=>{if(!y.current)return;const j=y.current,ne=async()=>{if(!ue||r.index===-1||!B||B.length===0){ue&&t.reportPlaybackStopped(ue.Id,j.currentTime);return}t.reportPlaybackStopped(ue.Id,j.currentTime),v==="one"?o({index:r.index}):Ne()};return j.addEventListener("ended",ne),()=>{j.removeEventListener("ended",ne)}},[t,ue,r.index,B,Ne,v]),P.useEffect(()=>{e&&ue&&(t.reportPlaybackStopped(ue.Id,y.current.currentTime),o({index:-1}),y.current&&y.current.pause())},[t,e,ue]),{currentTrack:ue,currentTrackIndex:m?A.current.indexOf(R.index):r.index,isPlaying:c,togglePlayPause:Ee,formatTime:W,volume:u,setVolume:f,playTrack:j=>{H(!0),o({index:j})},nextTrack:Ne,previousTrack:Me,shuffle:m,toggleShuffle:Qe,repeat:v,toggleRepeat:st,currentPlaylist:B,setCurrentPlaylist:N,loadMore:re,sessionPlayCount:s,resetSessionCount:fe,playlistTitle:_,audioRef:y,bitrate:z,setBitrate:V,isLoading:J}},c3=i=>l3(i),u3=i=>{const{children:e,...t}=i,s=c3(t);return T.jsx(sA.Provider,{value:s,children:e})},d3=()=>{const[i,e]=P.useState(!1);return P.useEffect(()=>{const t=document.getElementsByTagName("body")[0];return i?t.classList.add("lockscroll"):t.classList.remove("lockscroll"),()=>{t.classList.remove("lockscroll")}},[i]),{disabled:i,setDisabled:e}},h3=({children:i})=>{const e=d3();return T.jsx(fA.Provider,{value:e,children:i})},f3=()=>{const[i,e]=P.useState(!1),t=Xs();return P.useEffect(()=>{t!=null&&t.pathname&&e(!1)},[t==null?void 0:t.pathname]),P.useEffect(()=>(i?document.body.classList.add("lockscroll"):document.body.classList.remove("lockscroll"),()=>{document.body.classList.remove("lockscroll")}),[i]),{showSidenav:i,toggleSidenav:()=>{e(r=>!r)},closeSidenav:()=>{e(!1)}}},m3=({children:i})=>{const e=f3();return T.jsx(iA.Provider,{value:e,children:i})},GI=P.createContext({}),g3=()=>P.useContext(GI),p3=()=>{const[i,e]=P.useState(()=>localStorage.getItem("theme")||"light");return P.useEffect(()=>{const s=document.documentElement,n=window.matchMedia("(prefers-color-scheme: dark)");(c=>{const d=s.classList.contains("dark")?"dark":"light",u=c==="system"?n.matches?"dark":"light":c;if(d!==u)if(s.classList.remove("light","dark"),c==="system"){const f=n.matches;s.classList.add(f?"dark":"light")}else s.classList.add(c)})(i);const o=c=>{i==="system"&&(s.classList.remove("light","dark"),s.classList.add(c.matches?"dark":"light"))};return n.addEventListener("change",o),()=>n.removeEventListener("change",o)},[]),{theme:i,toggleTheme:s=>{e(s);const n=document.documentElement;setTimeout(()=>{if(n.classList.remove("light","dark"),s==="system"){const r=window.matchMedia("(prefers-color-scheme: dark)").matches;n.classList.add(r?"dark":"light")}else n.classList.add(s);localStorage.setItem("theme",s)},200)}}},y3=({children:i})=>{const e=p3();return T.jsx(GI.Provider,{value:e,children:i})},v3=()=>{const{currentTrack:i,isPlaying:e}=Qs(),{pageTitle:t}=mr(),s=Xs();P.useEffect(()=>{var n;if(i&&e){const r=i.AlbumArtist||((n=i.Artists)==null?void 0:n[0])||"Unknown Artist";document.title=`${i.Name} - ${r}`}else document.title=`${Op(t,s)} - Jelly Music App`},[i,e,t,s.pathname,s])},ra=({item:i,type:e,width:t,height:s,imageProps:n})=>{const r=ns();return T.jsx("img",{...n,src:r.getImageUrl(i,e,{width:t,height:s}),alt:i.Name,className:"thumbnail",loading:"lazy",onError:o=>{o.target.src="/jelly-app/default-thumbnail.png"}})},dr=()=>T.jsx("div",{className:"loading_container",children:T.jsxs("svg",{className:"loading",children:[T.jsx("circle",{cx:"14",cy:"14",r:"14"}),T.jsx("circle",{cx:"14",cy:"14",r:"14"})]})}),HI=i=>{if(!i)return"0:00";const e=Math.floor(i/1e7),t=Math.floor(e/3600),s=Math.floor(e%3600/60),n=e%60;return t>0?`${t}:${s.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}`:`${s}:${n.toString().padStart(2,"0")}`},W0=({tracks:i,playlist:e,showAlbum:t=!1,title:s,reviver:n,hidden:r={}})=>{const o=Qs(),c=5,d=i.map(f=>{var m;return{...f,playCount:((m=f.UserData)==null?void 0:m.PlayCount)||0}}).filter(f=>f.playCount>=c).sort((f,m)=>m.playCount-f.playCount).slice(0,3).map(f=>f.Id),u=hr();return T.jsx("ul",{className:"tracklist noSelect",children:i.map((f,m)=>{var E,A,R;const p=((E=o.currentTrack)==null?void 0:E.Id)===f.Id,v=d.includes(f.Id),S=((A=u.selectedItem)==null?void 0:A.Id)===f.Id&&u.isOpen,y=[p?o.isPlaying?"playing":"paused":"",v?"most-played":"",S?"active":""].filter(Boolean).join(" ");return T.jsxs("li",{className:`track-item ${y}`,onClick:()=>{if(p)o.togglePlayPause();else{const I=e||i;o.setCurrentPlaylist({playlist:I,title:s,reviver:n});const C=e?e.findIndex(L=>L.Id===f.Id):m;o.playTrack(C)}},onContextMenu:I=>u.onContextMenu(I,{item:f},!1,r),onTouchStart:I=>u.onTouchStart(I,{item:f},!1,r),onTouchMove:u.onTouchClear,onTouchEnd:u.onTouchClear,children:[T.jsxs("div",{className:"track-indicator",children:[T.jsx("div",{className:"track-number",children:m+1}),T.jsxs("div",{className:"track-state",children:[T.jsx("div",{className:"play",children:T.jsx("div",{className:"play-icon"})}),T.jsx("div",{className:"pause",children:T.jsx("div",{className:"pause-icon"})}),T.jsx("div",{className:"play-state-animation",children:T.jsx(R0,{width:18,height:18,className:"sound-bars"})})]})]}),T.jsxs("div",{className:"track-details",children:[T.jsxs("div",{className:"container",children:[T.jsx("div",{className:"name",children:T.jsx("div",{className:"text",children:f.Name})}),t?T.jsx("div",{className:"album",children:T.jsx("div",{className:"text",children:f.Album||"Unknown Album"})}):T.jsx("div",{className:"artist",children:f.Artists&&f.Artists.length>0?f.Artists.join(", "):"Unknown Artist"})]}),T.jsxs("div",{className:"track-indicators",children:[f.offlineState&&T.jsxs("div",{className:"download-state",children:[f.offlineState==="downloading"&&T.jsx("div",{className:"icon downloading",title:"Syncing...",children:T.jsx(na,{width:12,height:12})}),f.offlineState==="downloaded"&&T.jsx("div",{className:"icon downloaded",title:"Synced",children:T.jsx(Va,{width:12,height:12})}),f.offlineState==="deleting"&&T.jsx("div",{className:"icon deleting",title:"Unsyncing...",children:T.jsx($a,{width:12,height:12})})]}),((R=f.UserData)==null?void 0:R.IsFavorite)&&T.jsx("div",{className:"favorited",title:"Favorited",children:T.jsx(on,{size:12})})]}),T.jsx("div",{className:"duration",children:HI(f.RunTimeTicks)})]})]},f.Id)})})},S3=i=>{const e=ns(),{data:t,isFetching:s,isPending:n,error:r}=la({queryKey:["albumData",i],queryFn:async()=>{const{album:o,tracks:c}=await e.getAlbumDetails(i),u=new Set(c.map(f=>f.ParentIndexNumber||1)).size;return{album:o,tracks:c,discCount:u,loading:!1,error:null}}});return{...t,loading:s||n,error:r?r.message:null,tracks:(t==null?void 0:t.tracks)||[],discCount:(t==null?void 0:t.discCount)||1}},zI=i=>i?new Date(i).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Unknown Date",dE=i=>i?new Date(i).toLocaleDateString("en-US",{year:"numeric"}):"Unknown Date",Z0=i=>{if(!i||i<=0)return"0m";const e=Math.floor(i/1e7),t=Math.floor(e/3600),s=Math.floor(e%3600/60),n=e%60,r=[];return t>0&&r.push(`${t}h`),(s>0||t>0)&&r.push(`${s}m`),t===0&&s===0&&n>0&&r.push(`${n}s`),r.join(" ")||"0m"},x3=()=>{var I,C;const i=Qs(),{albumId:e}=Rl(),{album:t,tracks:s,discCount:n,loading:r,error:o}=S3(e),{setPageTitle:c}=mr(),{isOpen:d,selectedItem:u,onContextMenu:f}=hr(),{addToFavorites:m,removeFromFavorites:p}=qh();P.useEffect(()=>(t&&c(t.Name),()=>{c("")}),[t,c]);const v=s.reduce((L,D)=>L+(D.RunTimeTicks||0),0);if(r)return T.jsx(dr,{});if(o||!t)return T.jsx("div",{className:"error",children:o||"Album not found"});const S=s.reduce((L,D)=>{var _;return L+(((_=D.UserData)==null?void 0:_.PlayCount)||0)},0),y=t.ChildCount||s.length,E=s.reduce((L,D)=>{const _=D.ParentIndexNumber||1;return L[_]||(L[_]=[]),L[_].push(D),L},{}),A=Object.keys(E).sort((L,D)=>Number(L)-Number(D)).flatMap(L=>E[Number(L)].sort((D,_)=>(D.IndexNumber||0)-(_.IndexNumber||0))),R=L=>{L.stopPropagation(),f(L,{item:t},!0,{add_to_favorite:!0,remove_from_favorite:!0})};return T.jsxs("div",{className:"album-page",children:[T.jsxs("div",{className:"album-header",children:[T.jsx(ra,{item:t,type:"Primary",width:100,height:100}),T.jsxs("div",{className:"album-details",children:[T.jsx("div",{className:"artist",children:t.AlbumArtists&&t.AlbumArtists.length>0?T.jsx(qi,{to:`/artist/${t.AlbumArtists[0].Id}`,children:t.AlbumArtist||"Unknown Artist"}):t.AlbumArtist||"Unknown Artist"}),T.jsx("div",{className:"date",children:zI(t.PremiereDate)}),T.jsxs("div",{className:"stats",children:[T.jsxs("div",{className:"track-amount",children:[T.jsx("span",{className:"number",children:y})," ",T.jsx("span",{children:y===1?"Track":"Tracks"})]}),T.jsx("div",{className:"divider"}),T.jsxs("div",{className:"length",children:[T.jsx("span",{className:"number",children:Z0(v)})," ",T.jsx("span",{children:"Total"})]}),S>0&&T.jsxs(T.Fragment,{children:[T.jsx("div",{className:"divider"}),T.jsxs("div",{className:"plays",children:[T.jsx("span",{className:"number",children:S})," ",S===1?"Play":"Plays"]})]})]}),T.jsxs("div",{className:"actions noSelect",children:[T.jsxs("div",{className:"primary",children:[T.jsxs("div",{className:"play-album",onClick:()=>{i.setCurrentPlaylist({playlist:A,title:t.Name}),i.playTrack(0)},children:[T.jsx("div",{className:"play-icon"}),T.jsx("div",{className:"text",children:"Play"})]}),T.jsx("div",{className:"favorite-state",title:(I=t.UserData)!=null&&I.IsFavorite?"Remove from favorites":"Add to favorites",onClick:async()=>{var L;if(t!=null&&t.Id)try{(L=t.UserData)!=null&&L.IsFavorite?await p(t):await m(t)}catch(D){console.error("Failed to update favorite status:",D)}},children:(C=t.UserData)!=null&&C.IsFavorite?T.jsx(on,{size:16}):T.jsx(y0,{size:16})})]}),T.jsx("div",{className:`more ${d&&(u==null?void 0:u.Id)===(t==null?void 0:t.Id)?"active":""}`,onClick:R,title:"More",children:T.jsx(Kh,{width:14,height:14})})]})]})]}),Object.keys(E).sort((L,D)=>Number(L)-Number(D)).map((L,D)=>T.jsxs("div",{className:"album-content",children:[n>1&&T.jsxs("div",{className:`disc ${D===0?"first":""}`,children:["Disc ",L]}),T.jsx(W0,{tracks:E[Number(L)],playlist:A,title:t.Name,hidden:{view_album:!0}})]},L))]})},Wh=0,fa=1,Ol=2,KI=4;function hE(i){return()=>i}function T3(i){i()}function YI(i,e){return t=>i(e(t))}function fE(i,e){return()=>i(e)}function E3(i,e){return t=>i(e,t)}function J0(i){return i!==void 0}function b3(...i){return()=>{i.map(T3)}}function Dl(){}function Zh(i,e){return e(i),i}function A3(i,e){return e(i)}function Qt(...i){return i}function Ut(i,e){return i(fa,e)}function ft(i,e){i(Wh,e)}function ey(i){i(Ol)}function Ys(i){return i(KI)}function qe(i,e){return Ut(i,E3(e,Wh))}function kn(i,e){const t=i(fa,s=>{t(),e(s)});return t}function mE(i){let e,t;return s=>n=>{e=n,t&&clearTimeout(t),t=setTimeout(()=>{s(e)},i)}}function qI(i,e){return i===e}function qt(i=qI){let e;return t=>s=>{i(e,s)||(e=s,t(s))}}function nt(i){return e=>t=>{i(t)&&e(t)}}function $e(i){return e=>YI(e,i)}function Cn(i){return e=>()=>{e(i)}}function Te(i,...e){const t=I3(...e);return(s,n)=>{switch(s){case Ol:ey(i);return;case fa:return Ut(i,t(n))}}}function _n(i,e){return t=>s=>{t(e=i(e,s))}}function Tl(i){return e=>t=>{i>0?i--:e(t)}}function aa(i){let e=null,t;return s=>n=>{e=n,!t&&(t=setTimeout(()=>{t=void 0,s(e)},i))}}function pt(...i){const e=new Array(i.length);let t=0,s=null;const n=Math.pow(2,i.length)-1;return i.forEach((r,o)=>{const c=Math.pow(2,o);Ut(r,d=>{const u=t;t=t|c,e[o]=d,u!==n&&t===n&&s&&(s(),s=null)})}),r=>o=>{const c=()=>{r([o].concat(e))};t===n?c():s=c}}function I3(...i){return e=>i.reduceRight(A3,e)}function R3(i){let e,t;const s=()=>e==null?void 0:e();return function(n,r){switch(n){case fa:return r?t===r?void 0:(s(),t=r,e=Ut(i,r),e):(s(),Dl);case Ol:s(),t=null;return}}}function De(i){let e=i;const t=It();return(s,n)=>{switch(s){case Wh:e=n;break;case fa:{n(e);break}case KI:return e}return t(s,n)}}function qs(i,e){return Zh(De(e),t=>qe(i,t))}function It(){const i=[];return(e,t)=>{switch(e){case Wh:i.slice().forEach(s=>{s(t)});return;case Ol:i.splice(0,i.length);return;case fa:return i.push(t),()=>{const s=i.indexOf(t);s>-1&&i.splice(s,1)}}}}function Oi(i){return Zh(It(),e=>qe(i,e))}function Ot(i,e=[],{singleton:t}={singleton:!0}){return{constructor:i,dependencies:e,id:L3(),singleton:t}}const L3=()=>Symbol();function w3(i){const e=new Map,t=({constructor:s,dependencies:n,id:r,singleton:o})=>{if(o&&e.has(r))return e.get(r);const c=s(n.map(d=>t(d)));return o&&e.set(r,c),c};return t(i)}function bs(...i){const e=It(),t=new Array(i.length);let s=0;const n=Math.pow(2,i.length)-1;return i.forEach((r,o)=>{const c=Math.pow(2,o);Ut(r,d=>{t[o]=d,s=s|c,s===n&&ft(e,t)})}),function(r,o){switch(r){case Ol:{ey(e);return}case fa:return s===n&&o(t),Ut(e,o)}}}function rt(i,e=qI){return Te(i,qt(e))}function gE(...i){return function(e,t){switch(e){case Ol:return;case fa:return b3(...i.map(s=>Ut(s,t)))}}}var Di=(i=>(i[i.DEBUG=0]="DEBUG",i[i.INFO=1]="INFO",i[i.WARN=2]="WARN",i[i.ERROR=3]="ERROR",i))(Di||{});const C3={0:"debug",3:"error",1:"log",2:"warn"},O3=()=>typeof globalThis>"u"?window:globalThis,ma=Ot(()=>{const i=De(3);return{log:De((e,t,s=1)=>{var n;const r=(n=O3().VIRTUOSO_LOG_LEVEL)!=null?n:Ys(i);s>=r&&console[C3[s]]("%creact-virtuoso: %c%s %o","color: #0253b3; font-weight: bold","color: initial",e,t)}),logLevel:i}},[],{singleton:!0});function no(i,e,t){return ty(i,e,t).callbackRef}function ty(i,e,t){const s=_e.useRef(null);let n=o=>{};const r=_e.useMemo(()=>typeof ResizeObserver<"u"?new ResizeObserver(o=>{const c=()=>{const d=o[0].target;d.offsetParent!==null&&i(d)};t?c():requestAnimationFrame(c)}):null,[i,t]);return n=o=>{o&&e?(r==null||r.observe(o),s.current=o):(s.current&&(r==null||r.unobserve(s.current)),s.current=null)},{callbackRef:n,ref:s}}function D3(i,e,t,s,n,r,o,c,d){const u=_e.useCallback(f=>{const m=_3(f.children,e,c?"offsetWidth":"offsetHeight",n);let p=f.parentElement;for(;!p.dataset.virtuosoScroller;)p=p.parentElement;const v=p.lastElementChild.dataset.viewportType==="window";let S;v&&(S=p.ownerDocument.defaultView);const y=o?c?o.scrollLeft:o.scrollTop:v?c?S.scrollX||S.document.documentElement.scrollLeft:S.scrollY||S.document.documentElement.scrollTop:c?p.scrollLeft:p.scrollTop,E=o?c?o.scrollWidth:o.scrollHeight:v?c?S.document.documentElement.scrollWidth:S.document.documentElement.scrollHeight:c?p.scrollWidth:p.scrollHeight,A=o?c?o.offsetWidth:o.offsetHeight:v?c?S.innerWidth:S.innerHeight:c?p.offsetWidth:p.offsetHeight;s({scrollHeight:E,scrollTop:Math.max(y,0),viewportHeight:A}),r==null||r(c?pE("column-gap",getComputedStyle(f).columnGap,n):pE("row-gap",getComputedStyle(f).rowGap,n)),m!==null&&i(m)},[i,e,n,r,o,s,c]);return ty(u,t,d)}function _3(i,e,t,s){const n=i.length;if(n===0)return null;const r=[];for(let o=0;o<n;o++){const c=i.item(o);if(c.dataset.index===void 0)continue;const d=parseInt(c.dataset.index),u=parseFloat(c.dataset.knownSize),f=e(c,t);if(f===0&&s("Zero-sized element, this should not happen",{child:c},Di.ERROR),f===u)continue;const m=r[r.length-1];r.length===0||m.size!==f||m.endIndex!==d-1?r.push({endIndex:d,size:f,startIndex:d}):r[r.length-1].endIndex++}return r}function pE(i,e,t){return e!=="normal"&&!(e!=null&&e.endsWith("px"))&&t(`${i} was not resolved to pixel value correctly`,e,Di.WARN),e==="normal"?0:parseInt(e??"0",10)}function QI(i,e,t){const s=_e.useRef(null),n=_e.useCallback(d=>{if(!(d!=null&&d.offsetParent))return;const u=d.getBoundingClientRect(),f=u.width;let m,p;if(e){const v=e.getBoundingClientRect(),S=u.top-v.top;p=v.height-Math.max(0,S),m=S+e.scrollTop}else{const v=o.current.ownerDocument.defaultView;p=v.innerHeight-Math.max(0,u.top),m=u.top+v.scrollY}s.current={offsetTop:m,visibleHeight:p,visibleWidth:f},i(s.current)},[i,e]),{callbackRef:r,ref:o}=ty(n,!0,t),c=_e.useCallback(()=>{n(o.current)},[n,o]);return _e.useEffect(()=>{var d;if(e){e.addEventListener("scroll",c);const u=new ResizeObserver(()=>{requestAnimationFrame(c)});return u.observe(e),()=>{e.removeEventListener("scroll",c),u.unobserve(e)}}else{const u=(d=o.current)==null?void 0:d.ownerDocument.defaultView;return u==null||u.addEventListener("scroll",c),u==null||u.addEventListener("resize",c),()=>{u==null||u.removeEventListener("scroll",c),u==null||u.removeEventListener("resize",c)}}},[c,e,o]),r}const ii=Ot(()=>{const i=It(),e=It(),t=De(0),s=It(),n=De(0),r=It(),o=It(),c=De(0),d=De(0),u=De(0),f=De(0),m=It(),p=It(),v=De(!1),S=De(!1),y=De(!1);return qe(Te(i,$e(({scrollTop:E})=>E)),e),qe(Te(i,$e(({scrollHeight:E})=>E)),o),qe(e,n),{deviation:t,fixedFooterHeight:u,fixedHeaderHeight:d,footerHeight:f,headerHeight:c,horizontalDirection:S,scrollBy:p,scrollContainerState:i,scrollHeight:o,scrollingInProgress:v,scrollTo:m,scrollTop:e,skipAnimationFrameInResizeObserver:y,smoothScrollTargetReached:s,statefulScrollTop:n,viewportHeight:r}},[],{singleton:!0}),tu={lvl:0};function XI(i,e){const t=i.length;if(t===0)return[];let{index:s,value:n}=e(i[0]);const r=[];for(let o=1;o<t;o++){const{index:c,value:d}=e(i[o]);r.push({end:c-1,start:s,value:n}),s=c,n=d}return r.push({end:1/0,start:s,value:n}),r}function Kt(i){return i===tu}function su(i,e){if(!Kt(i))return e===i.k?i.v:e<i.k?su(i.l,e):su(i.r,e)}function ln(i,e,t="k"){if(Kt(i))return[-1/0,void 0];if(Number(i[t])===e)return[i.k,i.v];if(Number(i[t])<e){const s=ln(i.r,e,t);return s[0]===-1/0?[i.k,i.v]:s}return ln(i.l,e,t)}function Li(i,e,t){return Kt(i)?JI(e,t,1):e===i.k?Ts(i,{k:e,v:t}):e<i.k?yE(Ts(i,{l:Li(i.l,e,t)})):yE(Ts(i,{r:Li(i.r,e,t)}))}function nl(){return tu}function Jh(i,e,t){if(Kt(i))return[];const s=ln(i,e)[0];return P3(Jp(i,s,t))}function Zp(i,e){if(Kt(i))return tu;const{k:t,l:s,r:n}=i;if(e===t){if(Kt(s))return n;if(Kt(n))return s;{const[r,o]=ZI(s);return hh(Ts(i,{k:r,l:WI(s),v:o}))}}else return e<t?hh(Ts(i,{l:Zp(s,e)})):hh(Ts(i,{r:Zp(n,e)}))}function Ga(i){return Kt(i)?[]:[...Ga(i.l),{k:i.k,v:i.v},...Ga(i.r)]}function Jp(i,e,t){if(Kt(i))return[];const{k:s,l:n,r,v:o}=i;let c=[];return s>e&&(c=c.concat(Jp(n,e,t))),s>=e&&s<=t&&c.push({k:s,v:o}),s<=t&&(c=c.concat(Jp(r,e,t))),c}function hh(i){const{l:e,lvl:t,r:s}=i;if(s.lvl>=t-1&&e.lvl>=t-1)return i;if(t>s.lvl+1){if(Jg(e))return eR(Ts(i,{lvl:t-1}));if(!Kt(e)&&!Kt(e.r))return Ts(e.r,{l:Ts(e,{r:e.r.l}),lvl:t,r:Ts(i,{l:e.r.r,lvl:t-1})});throw new Error("Unexpected empty nodes")}else{if(Jg(i))return e0(Ts(i,{lvl:t-1}));if(!Kt(s)&&!Kt(s.l)){const n=s.l,r=Jg(n)?s.lvl-1:s.lvl;return Ts(n,{l:Ts(i,{lvl:t-1,r:n.l}),lvl:n.lvl+1,r:e0(Ts(s,{l:n.r,lvl:r}))})}else throw new Error("Unexpected empty nodes")}}function Ts(i,e){return JI(e.k!==void 0?e.k:i.k,e.v!==void 0?e.v:i.v,e.lvl!==void 0?e.lvl:i.lvl,e.l!==void 0?e.l:i.l,e.r!==void 0?e.r:i.r)}function WI(i){return Kt(i.r)?i.l:hh(Ts(i,{r:WI(i.r)}))}function Jg(i){return Kt(i)||i.lvl>i.r.lvl}function ZI(i){return Kt(i.r)?[i.k,i.v]:ZI(i.r)}function JI(i,e,t,s=tu,n=tu){return{k:i,l:s,lvl:t,r:n,v:e}}function yE(i){return e0(eR(i))}function eR(i){const{l:e}=i;return!Kt(e)&&e.lvl===i.lvl?Ts(e,{r:Ts(i,{l:e.r})}):i}function e0(i){const{lvl:e,r:t}=i;return!Kt(t)&&!Kt(t.r)&&t.lvl===e&&t.r.lvl===e?Ts(t,{l:Ts(i,{r:t.l}),lvl:e+1}):i}function P3(i){return XI(i,({k:e,v:t})=>({index:e,value:t}))}function tR(i,e){return!!(i&&i.startIndex===e.startIndex&&i.endIndex===e.endIndex)}function iu(i,e){return!!(i&&i[0]===e[0]&&i[1]===e[1])}const sy=Ot(()=>({recalcInProgress:De(!1)}),[],{singleton:!0});function sR(i,e,t){return i[Ph(i,e,t)]}function Ph(i,e,t,s=0){let n=i.length-1;for(;s<=n;){const r=Math.floor((s+n)/2),o=i[r],c=t(o,e);if(c===0)return r;if(c===-1){if(n-s<2)return r-1;n=r-1}else{if(n===s)return r;s=r+1}}throw new Error(`Failed binary finding record in array - ${i.join(",")}, searched for ${e}`)}function k3(i,e,t,s){const n=Ph(i,e,s),r=Ph(i,t,s,n);return i.slice(n,r+1)}function da(i,e){return Math.round(i.getBoundingClientRect()[e])}function ef(i){return!Kt(i.groupOffsetTree)}function iy({index:i},e){return e===i?0:e<i?-1:1}function N3(){return{groupIndices:[],groupOffsetTree:nl(),lastIndex:0,lastOffset:0,lastSize:0,offsetTree:[],sizeTree:nl()}}function M3(i,e){let t=Kt(i)?0:1/0;for(const s of e){const{endIndex:n,size:r,startIndex:o}=s;if(t=Math.min(t,o),Kt(i)){i=Li(i,0,r);continue}const c=Jh(i,o-1,n+1);if(c.some(G3(s)))continue;let d=!1,u=!1;for(const{end:f,start:m,value:p}of c)d?(n>=m||r===p)&&(i=Zp(i,m)):(u=p!==r,d=!0),f>n&&n>=m&&p!==r&&(i=Li(i,n+1,p));u&&(i=Li(i,o,r))}return[i,t]}function U3(i){return typeof i.groupIndex<"u"}function F3({offset:i},e){return e===i?0:e<i?-1:1}function nu(i,e,t){if(e.length===0)return 0;const{index:s,offset:n,size:r}=sR(e,i,iy),o=i-s,c=r*o+(o-1)*t+n;return c>0?c+t:c}function iR(i,e){if(!ef(e))return i;let t=0;for(;e.groupIndices[t]<=i+t;)t++;return i+t}function nR(i,e,t){if(U3(i))return e.groupIndices[i.groupIndex]+1;{const s=i.index==="LAST"?t:i.index;let n=iR(s,e);return n=Math.max(0,n,Math.min(t,n)),n}}function B3(i,e,t,s=0){return s>0&&(e=Math.max(e,sR(i,s,iy).offset)),XI(k3(i,e,t,F3),$3)}function j3(i,[e,t,s,n]){e.length>0&&s("received item sizes",e,Di.DEBUG);const r=i.sizeTree;let o=r,c=0;if(t.length>0&&Kt(r)&&e.length===2){const p=e[0].size,v=e[1].size;o=t.reduce((S,y)=>Li(Li(S,y,p),y+1,v),o)}else[o,c]=M3(o,e);if(o===r)return i;const{lastIndex:d,lastOffset:u,lastSize:f,offsetTree:m}=t0(i.offsetTree,c,o,n);return{groupIndices:t,groupOffsetTree:t.reduce((p,v)=>Li(p,v,nu(v,m,n)),nl()),lastIndex:d,lastOffset:u,lastSize:f,offsetTree:m,sizeTree:o}}function V3(i){return Ga(i).map(({k:e,v:t},s,n)=>{const r=n[s+1];return{endIndex:r?r.k-1:1/0,size:t,startIndex:e}})}function vE(i,e){let t=0,s=0;for(;t<i;)t+=e[s+1]-e[s]-1,s++;return s-(t===i?0:1)}function t0(i,e,t,s){let n=i,r=0,o=0,c=0,d=0;if(e!==0){d=Ph(n,e-1,iy),c=n[d].offset;const u=ln(t,e-1);r=u[0],o=u[1],n.length&&n[d].size===ln(t,e)[1]&&(d-=1),n=n.slice(0,d+1)}else n=[];for(const{start:u,value:f}of Jh(t,e,1/0)){const m=u-r,p=m*o+c+m*s;n.push({index:u,offset:p,size:f}),r=u,c=p,o=f}return{lastIndex:r,lastOffset:c,lastSize:o,offsetTree:n}}function $3(i){return{index:i.index,value:i}}function G3(i){const{endIndex:e,size:t,startIndex:s}=i;return n=>n.start===s&&(n.end===e||n.end===1/0)&&n.value===t}const H3={offsetHeight:"height",offsetWidth:"width"},Fn=Ot(([{log:i},{recalcInProgress:e}])=>{const t=It(),s=It(),n=qs(s,0),r=It(),o=It(),c=De(0),d=De([]),u=De(void 0),f=De(void 0),m=De((L,D)=>da(L,H3[D])),p=De(void 0),v=De(0),S=N3(),y=qs(Te(t,pt(d,i,v),_n(j3,S),qt()),S),E=qs(Te(d,qt(),_n((L,D)=>({current:D,prev:L.current}),{current:[],prev:[]}),$e(({prev:L})=>L)),[]);qe(Te(d,nt(L=>L.length>0),pt(y,v),$e(([L,D,_])=>{const M=L.reduce((U,F,z)=>Li(U,F,nu(F,D.offsetTree,_)||z),nl());return{...D,groupIndices:L,groupOffsetTree:M}})),y),qe(Te(s,pt(y),nt(([L,{lastIndex:D}])=>L<D),$e(([L,{lastIndex:D,lastSize:_}])=>[{endIndex:D,size:_,startIndex:L}])),t),qe(u,f);const A=qs(Te(u,$e(L=>L===void 0)),!0);qe(Te(f,nt(L=>L!==void 0&&Kt(Ys(y).sizeTree)),$e(L=>[{endIndex:0,size:L,startIndex:0}])),t);const R=Oi(Te(t,pt(y),_n(({sizes:L},[D,_])=>({changed:_!==L,sizes:_}),{changed:!1,sizes:S}),$e(L=>L.changed)));Ut(Te(c,_n((L,D)=>({diff:L.prev-D,prev:D}),{diff:0,prev:0}),$e(L=>L.diff)),L=>{const{groupIndices:D}=Ys(y);if(L>0)ft(e,!0),ft(r,L+vE(L,D));else if(L<0){const _=Ys(E);_.length>0&&(L-=vE(-L,_)),ft(o,L)}}),Ut(Te(c,pt(i)),([L,D])=>{L<0&&D("`firstItemIndex` prop should not be set to less than zero. If you don't know the total count, just use a very high value",{firstItemIndex:c},Di.ERROR)});const I=Oi(r);qe(Te(r,pt(y),$e(([L,D])=>{const _=D.groupIndices.length>0,M=[],U=D.lastSize;if(_){const F=su(D.sizeTree,0);let z=0,V=0;for(;z<L;){const G=D.groupIndices[V],Z=D.groupIndices.length===V+1?1/0:D.groupIndices[V+1]-G-1;M.push({endIndex:G,size:F,startIndex:G}),M.push({endIndex:G+1+Z-1,size:U,startIndex:G+1}),V++,z+=Z+1}const ae=Ga(D.sizeTree);return z!==L&&ae.shift(),ae.reduce((G,{k:Z,v:B})=>{let Q=G.ranges;return G.prevSize!==0&&(Q=[...G.ranges,{endIndex:Z+L-1,size:G.prevSize,startIndex:G.prevIndex}]),{prevIndex:Z+L,prevSize:B,ranges:Q}},{prevIndex:L,prevSize:0,ranges:M}).ranges}return Ga(D.sizeTree).reduce((F,{k:z,v:V})=>({prevIndex:z+L,prevSize:V,ranges:[...F.ranges,{endIndex:z+L-1,size:F.prevSize,startIndex:F.prevIndex}]}),{prevIndex:0,prevSize:U,ranges:[]}).ranges})),t);const C=Oi(Te(o,pt(y,v),$e(([L,{offsetTree:D},_])=>{const M=-L;return nu(M,D,_)})));return qe(Te(o,pt(y,v),$e(([L,D,_])=>{if(D.groupIndices.length>0){if(Kt(D.sizeTree))return D;let M=nl();const U=Ys(E);let F=0,z=0,V=0;for(;F<-L;){V=U[z];const ae=U[z+1]-V-1;z++,F+=ae+1}if(M=Ga(D.sizeTree).reduce((ae,{k:G,v:Z})=>Li(ae,Math.max(0,G+L),Z),M),F!==-L){const ae=su(D.sizeTree,V);M=Li(M,0,ae);const G=ln(D.sizeTree,-L+1)[1];M=Li(M,1,G)}return{...D,sizeTree:M,...t0(D.offsetTree,0,M,_)}}else{const M=Ga(D.sizeTree).reduce((U,{k:F,v:z})=>Li(U,Math.max(0,F+L),z),nl());return{...D,sizeTree:M,...t0(D.offsetTree,0,M,_)}}})),y),{beforeUnshiftWith:I,data:p,defaultItemSize:f,firstItemIndex:c,fixedItemSize:u,gap:v,groupIndices:d,itemSize:m,listRefresh:R,shiftWith:o,shiftWithOffset:C,sizeRanges:t,sizes:y,statefulTotalCount:n,totalCount:s,trackItemSizes:A,unshiftWith:r}},Qt(ma,sy),{singleton:!0});function z3(i){return i.reduce((e,t)=>(e.groupIndices.push(e.totalCount),e.totalCount+=t+1,e),{groupIndices:[],totalCount:0})}const rR=Ot(([{groupIndices:i,sizes:e,totalCount:t},{headerHeight:s,scrollTop:n}])=>{const r=It(),o=It(),c=Oi(Te(r,$e(z3)));return qe(Te(c,$e(d=>d.totalCount)),t),qe(Te(c,$e(d=>d.groupIndices)),i),qe(Te(bs(n,e,s),nt(([d,u])=>ef(u)),$e(([d,u,f])=>ln(u.groupOffsetTree,Math.max(d-f,0),"v")[0]),qt(),$e(d=>[d])),o),{groupCounts:r,topItemsIndexes:o}},Qt(Fn,ii)),ga=Ot(([{log:i}])=>{const e=De(!1),t=Oi(Te(e,nt(s=>s),qt()));return Ut(e,s=>{s&&Ys(i)("props updated",{},Di.DEBUG)}),{didMount:t,propsReady:e}},Qt(ma),{singleton:!0}),K3=typeof document<"u"&&"scrollBehavior"in document.documentElement.style;function aR(i){const e=typeof i=="number"?{index:i}:i;return e.align||(e.align="start"),(!e.behavior||!K3)&&(e.behavior="auto"),e.offset||(e.offset=0),e}const pu=Ot(([{gap:i,listRefresh:e,sizes:t,totalCount:s},{fixedFooterHeight:n,fixedHeaderHeight:r,footerHeight:o,headerHeight:c,scrollingInProgress:d,scrollTo:u,smoothScrollTargetReached:f,viewportHeight:m},{log:p}])=>{const v=It(),S=It(),y=De(0);let E=null,A=null,R=null;function I(){E&&(E(),E=null),R&&(R(),R=null),A&&(clearTimeout(A),A=null),ft(d,!1)}return qe(Te(v,pt(t,m,s,y,c,o,p),pt(i,r,n),$e(([[C,L,D,_,M,U,F,z],V,ae,G])=>{const Z=aR(C),{align:B,behavior:Q,offset:re}=Z,J=_-1,N=nR(Z,L,J);let K=nu(N,L.offsetTree,V)+U;B==="end"?(K+=ae+ln(L.sizeTree,N)[1]-D+G,N===J&&(K+=F)):B==="center"?K+=(ae+ln(L.sizeTree,N)[1]-D+G)/2:K-=M,re&&(K+=re);const le=H=>{I(),H?(z("retrying to scroll to",{location:C},Di.DEBUG),ft(v,C)):(ft(S,!0),z("list did not change, scroll successful",{},Di.DEBUG))};if(I(),Q==="smooth"){let H=!1;R=Ut(e,ue=>{H=H||ue}),E=kn(f,()=>{le(H)})}else E=kn(Te(e,Y3(150)),le);return A=setTimeout(()=>{I()},1200),ft(d,!0),z("scrolling from index to",{behavior:Q,index:N,top:K},Di.DEBUG),{behavior:Q,top:K}})),u),{scrollTargetReached:S,scrollToIndex:v,topListHeight:y}},Qt(Fn,ii,ma),{singleton:!0});function Y3(i){return e=>{const t=setTimeout(()=>{e(!1)},i);return s=>{s&&(e(!0),clearTimeout(t))}}}function ny(i,e){i==0?e():requestAnimationFrame(()=>{ny(i-1,e)})}function ry(i,e){const t=e-1;return typeof i=="number"?i:i.index==="LAST"?t:i.index}const yu=Ot(([{defaultItemSize:i,listRefresh:e,sizes:t},{scrollTop:s},{scrollTargetReached:n,scrollToIndex:r},{didMount:o}])=>{const c=De(!0),d=De(0),u=De(!0);return qe(Te(o,pt(d),nt(([f,m])=>!!m),Cn(!1)),c),qe(Te(o,pt(d),nt(([f,m])=>!!m),Cn(!1)),u),Ut(Te(bs(e,o),pt(c,t,i,u),nt(([[,f],m,{sizeTree:p},v,S])=>f&&(!Kt(p)||J0(v))&&!m&&!S),pt(d)),([,f])=>{kn(n,()=>{ft(u,!0)}),ny(4,()=>{kn(s,()=>{ft(c,!0)}),ft(r,f)})}),{initialItemFinalLocationReached:u,initialTopMostItemIndex:d,scrolledToInitialItem:c}},Qt(Fn,ii,pu,ga),{singleton:!0});function oR(i,e){return Math.abs(i-e)<1.01}const ru="up",Vc="down",q3="none",Q3={atBottom:!1,notAtBottomBecause:"NOT_SHOWING_LAST_ITEM",state:{offsetBottom:0,scrollHeight:0,scrollTop:0,viewportHeight:0}},X3=0,vu=Ot(([{footerHeight:i,headerHeight:e,scrollBy:t,scrollContainerState:s,scrollTop:n,viewportHeight:r}])=>{const o=De(!1),c=De(!0),d=It(),u=It(),f=De(4),m=De(X3),p=qs(Te(gE(Te(rt(n),Tl(1),Cn(!0)),Te(rt(n),Tl(1),Cn(!1),mE(100))),qt()),!1),v=qs(Te(gE(Te(t,Cn(!0)),Te(t,Cn(!1),mE(200))),qt()),!1);qe(Te(bs(rt(n),rt(m)),$e(([R,I])=>R<=I),qt()),c),qe(Te(c,aa(50)),u);const S=Oi(Te(bs(s,rt(r),rt(e),rt(i),rt(f)),_n((R,[{scrollHeight:I,scrollTop:C},L,D,_,M])=>{const U=C+L-I>-M,F={scrollHeight:I,scrollTop:C,viewportHeight:L};if(U){let V,ae;return C>R.state.scrollTop?(V="SCROLLED_DOWN",ae=R.state.scrollTop-C):(V="SIZE_DECREASED",ae=R.state.scrollTop-C||R.scrollTopDelta),{atBottom:!0,atBottomBecause:V,scrollTopDelta:ae,state:F}}let z;return F.scrollHeight>R.state.scrollHeight?z="SIZE_INCREASED":L<R.state.viewportHeight?z="VIEWPORT_HEIGHT_DECREASING":C<R.state.scrollTop?z="SCROLLING_UPWARDS":z="NOT_FULLY_SCROLLED_TO_LAST_ITEM_BOTTOM",{atBottom:!1,notAtBottomBecause:z,state:F}},Q3),qt((R,I)=>R&&R.atBottom===I.atBottom))),y=qs(Te(s,_n((R,{scrollHeight:I,scrollTop:C,viewportHeight:L})=>{if(oR(R.scrollHeight,I))return{changed:!1,jump:0,scrollHeight:I,scrollTop:C};{const D=I-(C+L)<1;return R.scrollTop!==C&&D?{changed:!0,jump:R.scrollTop-C,scrollHeight:I,scrollTop:C}:{changed:!0,jump:0,scrollHeight:I,scrollTop:C}}},{changed:!1,jump:0,scrollHeight:0,scrollTop:0}),nt(R=>R.changed),$e(R=>R.jump)),0);qe(Te(S,$e(R=>R.atBottom)),o),qe(Te(o,aa(50)),d);const E=De(Vc);qe(Te(s,$e(({scrollTop:R})=>R),qt(),_n((R,I)=>Ys(v)?{direction:R.direction,prevScrollTop:I}:{direction:I<R.prevScrollTop?ru:Vc,prevScrollTop:I},{direction:Vc,prevScrollTop:0}),$e(R=>R.direction)),E),qe(Te(s,aa(50),Cn(q3)),E);const A=De(0);return qe(Te(p,nt(R=>!R),Cn(0)),A),qe(Te(n,aa(100),pt(p),nt(([R,I])=>!!I),_n(([R,I],[C])=>[I,C],[0,0]),$e(([R,I])=>I-R)),A),{atBottomState:S,atBottomStateChange:d,atBottomThreshold:f,atTopStateChange:u,atTopThreshold:m,isAtBottom:o,isAtTop:c,isScrolling:p,lastJumpDueToItemResize:y,scrollDirection:E,scrollVelocity:A}},Qt(ii)),kh="top",Nh="bottom",SE="none";function xE(i,e,t){return typeof i=="number"?t===ru&&e===kh||t===Vc&&e===Nh?i:0:t===ru?e===kh?i.main:i.reverse:e===Nh?i.main:i.reverse}function TE(i,e){var t;return typeof i=="number"?i:(t=i[e])!=null?t:0}const ay=Ot(([{deviation:i,fixedHeaderHeight:e,headerHeight:t,scrollTop:s,viewportHeight:n}])=>{const r=It(),o=De(0),c=De(0),d=De(0),u=qs(Te(bs(rt(s),rt(n),rt(t),rt(r,iu),rt(d),rt(o),rt(e),rt(i),rt(c)),$e(([f,m,p,[v,S],y,E,A,R,I])=>{const C=f-R,L=E+A,D=Math.max(p-C,0);let _=SE;const M=TE(I,kh),U=TE(I,Nh);return v-=R,v+=p+A,S+=p+A,S-=R,v>f+L-M&&(_=ru),S<f-D+m+U&&(_=Vc),_!==SE?[Math.max(C-p-xE(y,kh,_)-M,0),C-D-A+m+xE(y,Nh,_)+U]:null}),nt(f=>f!=null),qt(iu)),[0,0]);return{increaseViewportBy:c,listBoundary:r,overscan:d,topListHeight:o,visibleRange:u}},Qt(ii),{singleton:!0});function W3(i,e,t){if(ef(e)){const s=iR(i,e);return[{index:ln(e.groupOffsetTree,s)[0],offset:0,size:0},{data:t==null?void 0:t[0],index:s,offset:0,size:0}]}return[{data:t==null?void 0:t[0],index:i,offset:0,size:0}]}const ep={bottom:0,firstItemIndex:0,items:[],offsetBottom:0,offsetTop:0,top:0,topItems:[],topListHeight:0,totalCount:0};function fh(i,e,t,s,n,r){const{lastIndex:o,lastOffset:c,lastSize:d}=n;let u=0,f=0;if(i.length>0){u=i[0].offset;const y=i[i.length-1];f=y.offset+y.size}const m=t-o,p=c+m*d+(m-1)*s,v=u,S=p-f;return{bottom:f,firstItemIndex:r,items:EE(i,n,r),offsetBottom:S,offsetTop:u,top:v,topItems:EE(e,n,r),topListHeight:e.reduce((y,E)=>E.size+y,0),totalCount:t}}function lR(i,e,t,s,n,r){let o=0;if(t.groupIndices.length>0)for(const f of t.groupIndices){if(f-o>=i)break;o++}const c=i+o,d=ry(e,c),u=Array.from({length:c}).map((f,m)=>({data:r[m+d],index:m+d,offset:0,size:0}));return fh(u,[],c,n,t,s)}function EE(i,e,t){if(i.length===0)return[];if(!ef(e))return i.map(u=>({...u,index:u.index+t,originalIndex:u.index}));const s=i[0].index,n=i[i.length-1].index,r=[],o=Jh(e.groupOffsetTree,s,n);let c,d=0;for(const u of i){(!c||c.end<u.index)&&(c=o.shift(),d=e.groupIndices.indexOf(c.start));let f;u.index===c.start?f={index:d,type:"group"}:f={groupIndex:d,index:u.index-(d+1)+t},r.push({...f,data:u.data,offset:u.offset,originalIndex:u.index,size:u.size})}return r}const ro=Ot(([{data:i,firstItemIndex:e,gap:t,sizes:s,totalCount:n},r,{listBoundary:o,topListHeight:c,visibleRange:d},{initialTopMostItemIndex:u,scrolledToInitialItem:f},{topListHeight:m},p,{didMount:v},{recalcInProgress:S}])=>{const y=De([]),E=De(0),A=It();qe(r.topItemsIndexes,y);const R=qs(Te(bs(v,S,rt(d,iu),rt(n),rt(s),rt(u),f,rt(y),rt(e),rt(t),i),nt(([D,_,,M,,,,,,,U])=>{const F=U&&U.length!==M;return D&&!_&&!F}),$e(([,,[D,_],M,U,F,z,V,ae,G,Z])=>{const B=U,{offsetTree:Q,sizeTree:re}=B,J=Ys(E);if(M===0)return{...ep,totalCount:M};if(D===0&&_===0)return J===0?{...ep,totalCount:M}:lR(J,F,U,ae,G,Z||[]);if(Kt(re))return J>0?null:fh(W3(ry(F,M),B,Z),[],M,G,B,ae);const N=[];if(V.length>0){const xe=V[0],fe=V[V.length-1];let We=0;for(const de of Jh(re,xe,fe)){const Be=de.value,lt=Math.max(de.start,xe),Ee=Math.min(de.end,fe);for(let Ne=lt;Ne<=Ee;Ne++)N.push({data:Z==null?void 0:Z[Ne],index:Ne,offset:We,size:Be}),We+=Be}}if(!z)return fh([],N,M,G,B,ae);const K=V.length>0?V[V.length-1]+1:0,le=B3(Q,D,_,K);if(le.length===0)return null;const H=M-1,ue=Zh([],xe=>{for(const fe of le){const We=fe.value;let de=We.offset,Be=fe.start;const lt=We.size;if(We.offset<D){Be+=Math.floor((D-We.offset+G)/(lt+G));const Ne=Be-fe.start;de+=Ne*lt+Ne*G}Be<K&&(de+=(K-Be)*lt,Be=K);const Ee=Math.min(fe.end,H);for(let Ne=Be;Ne<=Ee&&!(de>=_);Ne++)xe.push({data:Z==null?void 0:Z[Ne],index:Ne,offset:de,size:lt}),de+=lt+G}});return fh(ue,N,M,G,B,ae)}),nt(D=>D!==null),qt()),ep);qe(Te(i,nt(J0),$e(D=>D==null?void 0:D.length)),n),qe(Te(R,$e(D=>D.topListHeight)),m),qe(m,c),qe(Te(R,$e(D=>[D.top,D.bottom])),o),qe(Te(R,$e(D=>D.items)),A);const I=Oi(Te(R,nt(({items:D})=>D.length>0),pt(n,i),nt(([{items:D},_])=>D[D.length-1].originalIndex===_-1),$e(([,D,_])=>[D-1,_]),qt(iu),$e(([D])=>D))),C=Oi(Te(R,aa(200),nt(({items:D,topItems:_})=>D.length>0&&D[0].originalIndex===_.length),$e(({items:D})=>D[0].index),qt())),L=Oi(Te(R,nt(({items:D})=>D.length>0),$e(({items:D})=>{let _=0,M=D.length-1;for(;D[_].type==="group"&&_<M;)_++;for(;D[M].type==="group"&&M>_;)M--;return{endIndex:D[M].index,startIndex:D[_].index}}),qt(tR)));return{endReached:I,initialItemCount:E,itemsRendered:A,listState:R,rangeChanged:L,startReached:C,topItemsIndexes:y,...p}},Qt(Fn,rR,ay,yu,pu,vu,ga,sy),{singleton:!0}),cR=Ot(([{fixedFooterHeight:i,fixedHeaderHeight:e,footerHeight:t,headerHeight:s},{listState:n}])=>{const r=It(),o=qs(Te(bs(t,i,s,e,n),$e(([c,d,u,f,m])=>c+d+u+f+m.offsetBottom+m.bottom)),0);return qe(rt(o),r),{totalListHeight:o,totalListHeightChanged:r}},Qt(ii,ro),{singleton:!0}),Z3=Ot(([{viewportHeight:i},{totalListHeight:e}])=>{const t=De(!1),s=qs(Te(bs(t,i,e),nt(([n])=>n),$e(([,n,r])=>Math.max(0,n-r)),aa(0),qt()),0);return{alignToBottom:t,paddingTopAddition:s}},Qt(ii,cR),{singleton:!0});function bE(i){return i?i==="smooth"?"smooth":"auto":!1}const J3=(i,e)=>typeof i=="function"?bE(i(e)):e&&bE(i),eF=Ot(([{listRefresh:i,totalCount:e},{atBottomState:t,isAtBottom:s},{scrollToIndex:n},{scrolledToInitialItem:r},{didMount:o,propsReady:c},{log:d},{scrollingInProgress:u}])=>{const f=De(!1),m=It();let p=null;function v(y){ft(n,{align:"end",behavior:y,index:"LAST"})}Ut(Te(bs(Te(rt(e),Tl(1)),o),pt(rt(f),s,r,u),$e(([[y,E],A,R,I,C])=>{let L=E&&I,D="auto";return L&&(D=J3(A,R||C),L=L&&!!D),{followOutputBehavior:D,shouldFollow:L,totalCount:y}}),nt(({shouldFollow:y})=>y)),({followOutputBehavior:y,totalCount:E})=>{p&&(p(),p=null),p=kn(i,()=>{Ys(d)("following output to ",{totalCount:E},Di.DEBUG),v(y),p=null})});function S(y){const E=kn(t,A=>{y&&!A.atBottom&&A.notAtBottomBecause==="SIZE_INCREASED"&&!p&&(Ys(d)("scrolling to bottom due to increased size",{},Di.DEBUG),v("auto"))});setTimeout(E,100)}return Ut(Te(bs(rt(f),e,c),nt(([y,,E])=>y&&E),_n(({value:y},[,E])=>({refreshed:y===E,value:E}),{refreshed:!1,value:0}),nt(({refreshed:y})=>y),pt(f,e)),([,y])=>{Ys(r)&&S(y!==!1)}),Ut(m,()=>{S(Ys(f)!==!1)}),Ut(bs(rt(f),t),([y,E])=>{y&&!E.atBottom&&E.notAtBottomBecause==="VIEWPORT_HEIGHT_DECREASING"&&v("auto")}),{autoscrollToBottom:m,followOutput:f}},Qt(Fn,vu,pu,yu,ga,ma,ii)),tF=Ot(([{data:i,firstItemIndex:e,gap:t,sizes:s},{initialTopMostItemIndex:n},{initialItemCount:r,listState:o},{didMount:c}])=>(qe(Te(c,pt(r),nt(([,d])=>d!==0),pt(n,s,e,t,i),$e(([[,d],u,f,m,p,v=[]])=>lR(d,u,f,m,p,v))),o),{}),Qt(Fn,yu,ro,ga),{singleton:!0}),sF=Ot(([{didMount:i},{scrollTo:e},{listState:t}])=>{const s=De(0);return Ut(Te(i,pt(s),nt(([,n])=>n!==0),$e(([,n])=>({top:n}))),n=>{kn(Te(t,Tl(1),nt(r=>r.items.length>1)),()=>{requestAnimationFrame(()=>{ft(e,n)})})}),{initialScrollTop:s}},Qt(ga,ii,ro),{singleton:!0}),iF=({itemBottom:i,itemTop:e,locationParams:{align:t,behavior:s,...n},viewportBottom:r,viewportTop:o})=>e<o?{...n,align:t??"start",behavior:s}:i>r?{...n,align:t??"end",behavior:s}:null,nF=Ot(([{gap:i,sizes:e,totalCount:t},{fixedFooterHeight:s,fixedHeaderHeight:n,headerHeight:r,scrollingInProgress:o,scrollTop:c,viewportHeight:d},{scrollToIndex:u}])=>{const f=It();return qe(Te(f,pt(e,d,t,r,n,s,c),pt(i),$e(([[m,p,v,S,y,E,A,R],I])=>{const{align:C,behavior:L,calculateViewLocation:D=iF,done:_,...M}=m,U=nR(m,p,S-1),F=nu(U,p.offsetTree,I)+y+E,z=F+ln(p.sizeTree,U)[1],V=R+E,ae=R+v-A,G=D({itemBottom:z,itemTop:F,locationParams:{align:C,behavior:L,...M},viewportBottom:ae,viewportTop:V});return G?_&&kn(Te(o,nt(Z=>!Z),Tl(Ys(o)?1:2)),_):_&&_(),G}),nt(m=>m!==null)),u),{scrollIntoView:f}},Qt(Fn,ii,pu,ro,ma),{singleton:!0}),uR=Ot(([{scrollVelocity:i}])=>{const e=De(!1),t=It(),s=De(!1);return qe(Te(i,pt(s,e,t),nt(([n,r])=>!!r),$e(([n,r,o,c])=>{const{enter:d,exit:u}=r;if(o){if(u(n,c))return!1}else if(d(n,c))return!0;return o}),qt()),e),Ut(Te(bs(e,i,t),pt(s)),([[n,r,o],c])=>{n&&c&&c.change&&c.change(r,o)}),{isSeeking:e,scrollSeekConfiguration:s,scrollSeekRangeChanged:t,scrollVelocity:i}},Qt(vu),{singleton:!0}),oy=Ot(([{scrollContainerState:i,scrollTo:e}])=>{const t=It(),s=It(),n=It(),r=De(!1),o=De(void 0);return qe(Te(bs(t,s),$e(([{scrollHeight:c,scrollTop:d,viewportHeight:u},{offsetTop:f}])=>({scrollHeight:c,scrollTop:Math.max(0,d-f),viewportHeight:u}))),i),qe(Te(e,pt(s),$e(([c,{offsetTop:d}])=>({...c,top:c.top+d}))),n),{customScrollParent:o,useWindowScroll:r,windowScrollContainerState:t,windowScrollTo:n,windowViewportRect:s}},Qt(ii)),rF=Ot(([{sizeRanges:i,sizes:e},{headerHeight:t,scrollTop:s},{initialTopMostItemIndex:n},{didMount:r},{useWindowScroll:o,windowScrollContainerState:c,windowViewportRect:d}])=>{const u=It(),f=De(void 0),m=De(null),p=De(null);return qe(c,m),qe(d,p),Ut(Te(u,pt(e,s,o,m,p,t)),([v,S,y,E,A,R,I])=>{const C=V3(S.sizeTree);E&&A!==null&&R!==null&&(y=A.scrollTop-R.offsetTop),y-=I,v({ranges:C,scrollTop:y})}),qe(Te(f,nt(J0),$e(aF)),n),qe(Te(r,pt(f),nt(([,v])=>v!==void 0),qt(),$e(([,v])=>v.ranges)),i),{getState:u,restoreStateFrom:f}},Qt(Fn,ii,yu,ga,oy));function aF(i){return{align:"start",index:0,offset:i.scrollTop}}const oF=Ot(([{topItemsIndexes:i}])=>{const e=De(0);return qe(Te(e,nt(t=>t>=0),$e(t=>Array.from({length:t}).map((s,n)=>n))),i),{topItemCount:e}},Qt(ro));function dR(i){let e=!1,t;return()=>(e||(e=!0,t=i()),t)}const lF=dR(()=>/iP(ad|od|hone)/i.test(navigator.userAgent)&&/WebKit/i.test(navigator.userAgent)),cF=Ot(([{deviation:i,scrollBy:e,scrollingInProgress:t,scrollTop:s},{isAtBottom:n,isScrolling:r,lastJumpDueToItemResize:o,scrollDirection:c},{listState:d},{beforeUnshiftWith:u,gap:f,shiftWithOffset:m,sizes:p},{log:v},{recalcInProgress:S}])=>{const y=Oi(Te(d,pt(o),_n(([,A,R,I],[{bottom:C,items:L,offsetBottom:D,totalCount:_},M])=>{const U=C+D;let F=0;return R===_&&A.length>0&&L.length>0&&(L[0].originalIndex===0&&A[0].originalIndex===0||(F=U-I,F!==0&&(F+=M))),[F,L,_,U]},[0,[],0,0]),nt(([A])=>A!==0),pt(s,c,t,n,v,S),nt(([,A,R,I,,,C])=>!C&&!I&&A!==0&&R===ru),$e(([[A],,,,,R])=>(R("Upward scrolling compensation",{amount:A},Di.DEBUG),A))));function E(A){A>0?(ft(e,{behavior:"auto",top:-A}),ft(i,0)):(ft(i,0),ft(e,{behavior:"auto",top:-A}))}return Ut(Te(y,pt(i,r)),([A,R,I])=>{I&&lF()?ft(i,R-A):E(-A)}),Ut(Te(bs(qs(r,!1),i,S),nt(([A,R,I])=>!A&&!I&&R!==0),$e(([A,R])=>R),aa(1)),E),qe(Te(m,$e(A=>({top:-A}))),e),Ut(Te(u,pt(p,f),$e(([A,{groupIndices:R,lastSize:I,sizeTree:C},L])=>{function D(_){return _*(I+L)}if(R.length===0)return D(A);{let _=0;const M=su(C,0);let U=0,F=0;for(;U<A;){U++,_+=M;let z=R.length===F+1?1/0:R[F+1]-R[F]-1;U+z>A&&(_-=M,z=A-U+1),U+=z,_+=D(z),F++}return _}})),A=>{ft(i,A),requestAnimationFrame(()=>{ft(e,{top:A}),requestAnimationFrame(()=>{ft(i,0),ft(S,!1)})})}),{deviation:i}},Qt(ii,vu,ro,Fn,ma,sy)),uF=Ot(([i,e,t,s,n,r,o,c,d,u])=>({...i,...e,...t,...s,...n,...r,...o,...c,...d,...u}),Qt(ay,tF,ga,uR,cR,sF,Z3,oy,nF,ma)),hR=Ot(([{data:i,defaultItemSize:e,firstItemIndex:t,fixedItemSize:s,gap:n,groupIndices:r,itemSize:o,sizeRanges:c,sizes:d,statefulTotalCount:u,totalCount:f,trackItemSizes:m},{initialItemFinalLocationReached:p,initialTopMostItemIndex:v,scrolledToInitialItem:S},y,E,A,{listState:R,topItemsIndexes:I,...C},{scrollToIndex:L},D,{topItemCount:_},{groupCounts:M},U])=>(qe(C.rangeChanged,U.scrollSeekRangeChanged),qe(Te(U.windowViewportRect,$e(F=>F.visibleHeight)),y.viewportHeight),{data:i,defaultItemHeight:e,firstItemIndex:t,fixedItemHeight:s,gap:n,groupCounts:M,initialItemFinalLocationReached:p,initialTopMostItemIndex:v,scrolledToInitialItem:S,sizeRanges:c,topItemCount:_,topItemsIndexes:I,totalCount:f,...A,groupIndices:r,itemSize:o,listState:R,scrollToIndex:L,statefulTotalCount:u,trackItemSizes:m,...C,...U,...y,sizes:d,...E}),Qt(Fn,yu,ii,rF,eF,ro,pu,cF,oF,rR,uF));function dF(i,e){const t={},s={};let n=0;const r=i.length;for(;n<r;)s[i[n]]=1,n+=1;for(const o in e)Object.hasOwn(s,o)||(t[o]=e[o]);return t}const Xd=typeof document<"u"?_e.useLayoutEffect:_e.useEffect;function fR(i,e,t){const s=Object.keys(e.required||{}),n=Object.keys(e.optional||{}),r=Object.keys(e.methods||{}),o=Object.keys(e.events||{}),c=_e.createContext({});function d(E,A){E.propsReady&&ft(E.propsReady,!1);for(const R of s){const I=E[e.required[R]];ft(I,A[R])}for(const R of n)if(R in A){const I=E[e.optional[R]];ft(I,A[R])}E.propsReady&&ft(E.propsReady,!0)}function u(E){return r.reduce((A,R)=>(A[R]=I=>{const C=E[e.methods[R]];ft(C,I)},A),{})}function f(E){return o.reduce((A,R)=>(A[R]=R3(E[e.events[R]]),A),{})}const m=_e.forwardRef((E,A)=>{const{children:R,...I}=E,[C]=_e.useState(()=>Zh(w3(i),_=>{d(_,I)})),[L]=_e.useState(fE(f,C));Xd(()=>{for(const _ of o)_ in I&&Ut(L[_],I[_]);return()=>{Object.values(L).map(ey)}},[I,L,C]),Xd(()=>{d(C,I)}),_e.useImperativeHandle(A,hE(u(C)));const D=t;return T.jsx(c.Provider,{value:C,children:t?T.jsx(D,{...dF([...s,...n,...o],I),children:R}):R})}),p=E=>{const A=_e.useContext(c);return _e.useCallback(R=>{ft(A[E],R)},[A,E])},v=E=>{const A=_e.useContext(c)[E],R=_e.useCallback(I=>Ut(A,I),[A]);return _e.useSyncExternalStore(R,()=>Ys(A),()=>Ys(A))},S=E=>{const A=_e.useContext(c)[E],[R,I]=_e.useState(fE(Ys,A));return Xd(()=>Ut(A,C=>{C!==R&&I(hE(C))}),[A,R]),R},y=_e.version.startsWith("18")?v:S;return{Component:m,useEmitter:(E,A)=>{const R=_e.useContext(c)[E];Xd(()=>Ut(R,A),[A,R])},useEmitterValue:y,usePublisher:p}}const mR=_e.createContext(void 0),gR=_e.createContext(void 0),pR=typeof document<"u"?_e.useLayoutEffect:_e.useEffect;function tp(i){return"self"in i}function hF(i){return"body"in i}function yR(i,e,t,s=Dl,n,r){const o=_e.useRef(null),c=_e.useRef(null),d=_e.useRef(null),u=_e.useCallback(p=>{let v,S,y;const E=p.target;if(hF(E)||tp(E)){const R=tp(E)?E:E.defaultView;y=r?R.scrollX:R.scrollY,v=r?R.document.documentElement.scrollWidth:R.document.documentElement.scrollHeight,S=r?R.innerWidth:R.innerHeight}else y=r?E.scrollLeft:E.scrollTop,v=r?E.scrollWidth:E.scrollHeight,S=r?E.offsetWidth:E.offsetHeight;const A=()=>{i({scrollHeight:v,scrollTop:Math.max(y,0),viewportHeight:S})};p.suppressFlushSync?A():dD.flushSync(A),c.current!==null&&(y===c.current||y<=0||y===v-S)&&(c.current=null,e(!0),d.current&&(clearTimeout(d.current),d.current=null))},[i,e,r]);_e.useEffect(()=>{const p=n||o.current;return s(n||o.current),u({suppressFlushSync:!0,target:p}),p.addEventListener("scroll",u,{passive:!0}),()=>{s(null),p.removeEventListener("scroll",u)}},[o,u,t,s,n]);function f(p){const v=o.current;if(!v||(r?"offsetWidth"in v&&v.offsetWidth===0:"offsetHeight"in v&&v.offsetHeight===0))return;const S=p.behavior==="smooth";let y,E,A;tp(v)?(E=Math.max(da(v.document.documentElement,r?"width":"height"),r?v.document.documentElement.scrollWidth:v.document.documentElement.scrollHeight),y=r?v.innerWidth:v.innerHeight,A=r?window.scrollX:window.scrollY):(E=v[r?"scrollWidth":"scrollHeight"],y=da(v,r?"width":"height"),A=v[r?"scrollLeft":"scrollTop"]);const R=E-y;if(p.top=Math.ceil(Math.max(Math.min(R,p.top),0)),oR(y,E)||p.top===A){i({scrollHeight:E,scrollTop:A,viewportHeight:y}),S&&e(!0);return}S?(c.current=p.top,d.current&&clearTimeout(d.current),d.current=setTimeout(()=>{d.current=null,c.current=null,e(!0)},1e3)):c.current=null,r&&(p={behavior:p.behavior,left:p.top}),v.scrollTo(p)}function m(p){r&&(p={behavior:p.behavior,left:p.top}),o.current.scrollBy(p)}return{scrollByCallback:m,scrollerRef:o,scrollToCallback:f}}const sp="-webkit-sticky",AE="sticky",vR=dR(()=>{if(typeof document>"u")return AE;const i=document.createElement("div");return i.style.position=sp,i.style.position===sp?sp:AE});function ly(i){return i}const fF=Ot(()=>{const i=De(d=>`Item ${d}`),e=De(null),t=De(d=>`Group ${d}`),s=De({}),n=De(ly),r=De("div"),o=De(Dl),c=(d,u=null)=>qs(Te(s,$e(f=>f[d]),qt()),u);return{components:s,computeItemKey:n,context:e,EmptyPlaceholder:c("EmptyPlaceholder"),FooterComponent:c("Footer"),GroupComponent:c("Group","div"),groupContent:t,HeaderComponent:c("Header"),HeaderFooterTag:r,ItemComponent:c("Item","div"),itemContent:i,ListComponent:c("List","div"),ScrollerComponent:c("Scroller","div"),scrollerRef:o,ScrollSeekPlaceholder:c("ScrollSeekPlaceholder"),TopItemListComponent:c("TopItemList")}}),mF=Ot(([i,e])=>({...i,...e}),Qt(hR,fF)),gF=({height:i})=>T.jsx("div",{style:{height:i}}),pF={overflowAnchor:"none",position:vR(),zIndex:1},SR={overflowAnchor:"none"},yF={...SR,display:"inline-block",height:"100%"},IE=_e.memo(function({showTopList:i=!1}){const e=ot("listState"),t=Ki("sizeRanges"),s=ot("useWindowScroll"),n=ot("customScrollParent"),r=Ki("windowScrollContainerState"),o=Ki("scrollContainerState"),c=n||s?r:o,d=ot("itemContent"),u=ot("context"),f=ot("groupContent"),m=ot("trackItemSizes"),p=ot("itemSize"),v=ot("log"),S=Ki("gap"),y=ot("horizontalDirection"),{callbackRef:E}=D3(t,p,m,i?Dl:c,v,S,n,y,ot("skipAnimationFrameInResizeObserver")),[A,R]=_e.useState(0);cy("deviation",G=>{A!==G&&R(G)});const I=ot("EmptyPlaceholder"),C=ot("ScrollSeekPlaceholder")||gF,L=ot("ListComponent"),D=ot("ItemComponent"),_=ot("GroupComponent"),M=ot("computeItemKey"),U=ot("isSeeking"),F=ot("groupIndices").length>0,z=ot("alignToBottom"),V=ot("initialItemFinalLocationReached"),ae=i?{}:{boxSizing:"border-box",...y?{display:"inline-block",height:"100%",marginLeft:A!==0?A:z?"auto":0,paddingLeft:e.offsetTop,paddingRight:e.offsetBottom,whiteSpace:"nowrap"}:{marginTop:A!==0?A:z?"auto":0,paddingBottom:e.offsetBottom,paddingTop:e.offsetTop},...V?{}:{visibility:"hidden"}};return!i&&e.totalCount===0&&I?T.jsx(I,{...Fs(I,u)}):T.jsx(L,{...Fs(L,u),"data-testid":i?"virtuoso-top-item-list":"virtuoso-item-list",ref:E,style:ae,children:(i?e.topItems:e.items).map(G=>{const Z=G.originalIndex,B=M(Z+e.firstItemIndex,G.data,u);return U?P.createElement(C,{...Fs(C,u),height:G.size,index:G.index,key:B,type:G.type||"item",...G.type==="group"?{}:{groupIndex:G.groupIndex}}):G.type==="group"?P.createElement(_,{...Fs(_,u),"data-index":Z,"data-item-index":G.index,"data-known-size":G.size,key:B,style:pF},f(G.index,u)):P.createElement(D,{...Fs(D,u),...TF(D,G.data),"data-index":Z,"data-item-group-index":G.groupIndex,"data-item-index":G.index,"data-known-size":G.size,key:B,style:y?yF:SR},F?d(G.index,G.groupIndex,G.data,u):d(G.index,G.data,u))})})}),vF={height:"100%",outline:"none",overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},SF={outline:"none",overflowX:"auto",position:"relative"},tf=i=>({height:"100%",position:"absolute",top:0,width:"100%",...i?{display:"flex",flexDirection:"column"}:{}}),xF={position:vR(),top:0,width:"100%",zIndex:1};function Fs(i,e){if(typeof i!="string")return{context:e}}function TF(i,e){return{item:typeof i=="string"?void 0:e}}const EF=_e.memo(function(){const i=ot("HeaderComponent"),e=Ki("headerHeight"),t=ot("HeaderFooterTag"),s=no(_e.useMemo(()=>r=>{e(da(r,"height"))},[e]),!0,ot("skipAnimationFrameInResizeObserver")),n=ot("context");return i?T.jsx(t,{ref:s,children:T.jsx(i,{...Fs(i,n)})}):null}),bF=_e.memo(function(){const i=ot("FooterComponent"),e=Ki("footerHeight"),t=ot("HeaderFooterTag"),s=no(_e.useMemo(()=>r=>{e(da(r,"height"))},[e]),!0,ot("skipAnimationFrameInResizeObserver")),n=ot("context");return i?T.jsx(t,{ref:s,children:T.jsx(i,{...Fs(i,n)})}):null});function xR({useEmitter:i,useEmitterValue:e,usePublisher:t}){return _e.memo(function({children:s,style:n,...r}){const o=t("scrollContainerState"),c=e("ScrollerComponent"),d=t("smoothScrollTargetReached"),u=e("scrollerRef"),f=e("context"),m=e("horizontalDirection")||!1,{scrollByCallback:p,scrollerRef:v,scrollToCallback:S}=yR(o,d,c,u,void 0,m);return i("scrollTo",S),i("scrollBy",p),T.jsx(c,{"data-testid":"virtuoso-scroller","data-virtuoso-scroller":!0,ref:v,style:{...m?SF:vF,...n},tabIndex:0,...r,...Fs(c,f),children:s})})}function TR({useEmitter:i,useEmitterValue:e,usePublisher:t}){return _e.memo(function({children:s,style:n,...r}){const o=t("windowScrollContainerState"),c=e("ScrollerComponent"),d=t("smoothScrollTargetReached"),u=e("totalListHeight"),f=e("deviation"),m=e("customScrollParent"),p=e("context"),v=_e.useRef(null),S=e("scrollerRef"),{scrollByCallback:y,scrollerRef:E,scrollToCallback:A}=yR(o,d,c,S,m);return pR(()=>{var R;return E.current=m||((R=v.current)==null?void 0:R.ownerDocument.defaultView),()=>{E.current=null}},[E,m]),i("windowScrollTo",A),i("scrollBy",y),T.jsx(c,{ref:v,"data-virtuoso-scroller":!0,style:{position:"relative",...n,...u!==0?{height:u+f}:{}},...r,...Fs(c,p),children:s})})}const AF=({children:i})=>{const e=_e.useContext(mR),t=Ki("viewportHeight"),s=Ki("fixedItemHeight"),n=ot("alignToBottom"),r=ot("horizontalDirection"),o=_e.useMemo(()=>YI(t,d=>da(d,r?"width":"height")),[t,r]),c=no(o,!0,ot("skipAnimationFrameInResizeObserver"));return _e.useEffect(()=>{e&&(t(e.viewportHeight),s(e.itemHeight))},[e,t,s]),T.jsx("div",{"data-viewport-type":"element",ref:c,style:tf(n),children:i})},IF=({children:i})=>{const e=_e.useContext(mR),t=Ki("windowViewportRect"),s=Ki("fixedItemHeight"),n=ot("customScrollParent"),r=QI(t,n,ot("skipAnimationFrameInResizeObserver")),o=ot("alignToBottom");return _e.useEffect(()=>{e&&(s(e.itemHeight),t({offsetTop:0,visibleHeight:e.viewportHeight,visibleWidth:100}))},[e,t,s]),T.jsx("div",{"data-viewport-type":"window",ref:r,style:tf(o),children:i})},RF=({children:i})=>{const e=ot("TopItemListComponent")||"div",t=ot("headerHeight"),s={...xF,marginTop:`${t}px`},n=ot("context");return T.jsx(e,{style:s,...Fs(e,n),children:i})},LF=_e.memo(function(i){const e=ot("useWindowScroll"),t=ot("topItemsIndexes").length>0,s=ot("customScrollParent"),n=ot("context"),r=s||e?OF:CF,o=s||e?IF:AF;return T.jsxs(r,{...i,...Fs(r,n),children:[t&&T.jsx(RF,{children:T.jsx(IE,{showTopList:!0})}),T.jsxs(o,{children:[T.jsx(EF,{}),T.jsx(IE,{}),T.jsx(bF,{})]})]})}),{Component:wF,useEmitter:cy,useEmitterValue:ot,usePublisher:Ki}=fR(mF,{required:{},optional:{restoreStateFrom:"restoreStateFrom",context:"context",followOutput:"followOutput",itemContent:"itemContent",groupContent:"groupContent",overscan:"overscan",increaseViewportBy:"increaseViewportBy",totalCount:"totalCount",groupCounts:"groupCounts",topItemCount:"topItemCount",firstItemIndex:"firstItemIndex",initialTopMostItemIndex:"initialTopMostItemIndex",components:"components",atBottomThreshold:"atBottomThreshold",atTopThreshold:"atTopThreshold",computeItemKey:"computeItemKey",defaultItemHeight:"defaultItemHeight",fixedItemHeight:"fixedItemHeight",itemSize:"itemSize",scrollSeekConfiguration:"scrollSeekConfiguration",headerFooterTag:"HeaderFooterTag",data:"data",initialItemCount:"initialItemCount",initialScrollTop:"initialScrollTop",alignToBottom:"alignToBottom",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel",horizontalDirection:"horizontalDirection",skipAnimationFrameInResizeObserver:"skipAnimationFrameInResizeObserver"},methods:{scrollToIndex:"scrollToIndex",scrollIntoView:"scrollIntoView",scrollTo:"scrollTo",scrollBy:"scrollBy",autoscrollToBottom:"autoscrollToBottom",getState:"getState"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",totalListHeightChanged:"totalListHeightChanged",itemsRendered:"itemsRendered",groupIndices:"groupIndices"}},LF),CF=xR({useEmitter:cy,useEmitterValue:ot,usePublisher:Ki}),OF=TR({useEmitter:cy,useEmitterValue:ot,usePublisher:Ki}),ER=wF,DF=Ot(()=>{const i=De(d=>T.jsxs("td",{children:["Item $",d]})),e=De(null),t=De(null),s=De(null),n=De({}),r=De(ly),o=De(Dl),c=(d,u=null)=>qs(Te(n,$e(f=>f[d]),qt()),u);return{components:n,computeItemKey:r,context:e,EmptyPlaceholder:c("EmptyPlaceholder"),FillerRow:c("FillerRow"),fixedFooterContent:s,fixedHeaderContent:t,itemContent:i,ScrollerComponent:c("Scroller","div"),scrollerRef:o,ScrollSeekPlaceholder:c("ScrollSeekPlaceholder"),TableBodyComponent:c("TableBody","tbody"),TableComponent:c("Table","table"),TableFooterComponent:c("TableFoot","tfoot"),TableHeadComponent:c("TableHead","thead"),TableRowComponent:c("TableRow","tr")}});Qt(hR,DF);const RE={bottom:0,itemHeight:0,items:[],itemWidth:0,offsetBottom:0,offsetTop:0,top:0},_F={bottom:0,itemHeight:0,items:[{index:0}],itemWidth:0,offsetBottom:0,offsetTop:0,top:0},{ceil:LE,floor:Mh,max:$c,min:ip,round:wE}=Math;function CE(i,e,t){return Array.from({length:e-i+1}).map((s,n)=>({data:t===null?null:t[n+i],index:n+i}))}function PF(i){return{..._F,items:i}}function Wd(i,e){return i&&i.width===e.width&&i.height===e.height}function kF(i,e){return i&&i.column===e.column&&i.row===e.row}const NF=Ot(([{increaseViewportBy:i,listBoundary:e,overscan:t,visibleRange:s},{footerHeight:n,headerHeight:r,scrollBy:o,scrollContainerState:c,scrollTo:d,scrollTop:u,smoothScrollTargetReached:f,viewportHeight:m},p,v,{didMount:S,propsReady:y},{customScrollParent:E,useWindowScroll:A,windowScrollContainerState:R,windowScrollTo:I,windowViewportRect:C},L])=>{const D=De(0),_=De(0),M=De(RE),U=De({height:0,width:0}),F=De({height:0,width:0}),z=It(),V=It(),ae=De(0),G=De(null),Z=De({column:0,row:0}),B=It(),Q=It(),re=De(!1),J=De(0),N=De(!0),K=De(!1),le=De(!1);Ut(Te(S,pt(J),nt(([de,Be])=>!!Be)),()=>{ft(N,!1)}),Ut(Te(bs(S,N,F,U,J,K),nt(([de,Be,lt,Ee,,Ne])=>de&&!Be&&lt.height!==0&&Ee.height!==0&&!Ne)),([,,,,de])=>{ft(K,!0),ny(1,()=>{ft(z,de)}),kn(Te(u),()=>{ft(e,[0,0]),ft(N,!0)})}),qe(Te(Q,nt(de=>de!=null&&de.scrollTop>0),Cn(0)),_),Ut(Te(S,pt(Q),nt(([,de])=>de!=null)),([,de])=>{de&&(ft(U,de.viewport),ft(F,de.item),ft(Z,de.gap),de.scrollTop>0&&(ft(re,!0),kn(Te(u,Tl(1)),Be=>{ft(re,!1)}),ft(d,{top:de.scrollTop})))}),qe(Te(U,$e(({height:de})=>de)),m),qe(Te(bs(rt(U,Wd),rt(F,Wd),rt(Z,(de,Be)=>de&&de.column===Be.column&&de.row===Be.row),rt(u)),$e(([de,Be,lt,Ee])=>({gap:lt,item:Be,scrollTop:Ee,viewport:de}))),B),qe(Te(bs(rt(D),s,rt(Z,kF),rt(F,Wd),rt(U,Wd),rt(G),rt(_),rt(re),rt(N),rt(J)),nt(([,,,,,,,de])=>!de),$e(([de,[Be,lt],Ee,Ne,Me,Qe,st,,W,j])=>{const{column:ne,row:ge}=Ee,{height:Ie,width:Ue}=Ne,{width:Ve}=Me;if(st===0&&(de===0||Ve===0))return RE;if(Ue===0){const hs=ry(j,de),Xt=hs+Math.max(st-1,0);return PF(CE(hs,Xt,Qe))}const it=bR(Ve,Ue,ne);let xt,Rt;W?Be===0&&lt===0&&st>0?(xt=0,Rt=st-1):(xt=it*Mh((Be+ge)/(Ie+ge)),Rt=it*LE((lt+ge)/(Ie+ge))-1,Rt=ip(de-1,$c(Rt,it-1)),xt=ip(Rt,$c(0,xt))):(xt=0,Rt=-1);const Dt=CE(xt,Rt,Qe),{bottom:bt,top:$t}=OE(Me,Ee,Ne,Dt),St=LE(de/it),_s=St*Ie+(St-1)*ge-bt;return{bottom:bt,itemHeight:Ie,items:Dt,itemWidth:Ue,offsetBottom:_s,offsetTop:$t,top:$t}})),M),qe(Te(G,nt(de=>de!==null),$e(de=>de.length)),D),qe(Te(bs(U,F,M,Z),nt(([de,Be,{items:lt}])=>lt.length>0&&Be.height!==0&&de.height!==0),$e(([de,Be,{items:lt},Ee])=>{const{bottom:Ne,top:Me}=OE(de,Ee,Be,lt);return[Me,Ne]}),qt(iu)),e);const H=De(!1);qe(Te(u,pt(H),$e(([de,Be])=>Be||de!==0)),H);const ue=Oi(Te(bs(M,D),nt(([{items:de}])=>de.length>0),pt(H),nt(([[de,Be],lt])=>{const Ee=de.items[de.items.length-1].index===Be-1;return(lt||de.bottom>0&&de.itemHeight>0&&de.offsetBottom===0&&de.items.length===Be)&&Ee}),$e(([[,de]])=>de-1),qt())),xe=Oi(Te(rt(M),nt(({items:de})=>de.length>0&&de[0].index===0),Cn(0),qt())),fe=Oi(Te(rt(M),pt(re),nt(([{items:de},Be])=>de.length>0&&!Be),$e(([{items:de}])=>({endIndex:de[de.length-1].index,startIndex:de[0].index})),qt(tR),aa(0)));qe(fe,v.scrollSeekRangeChanged),qe(Te(z,pt(U,F,D,Z),$e(([de,Be,lt,Ee,Ne])=>{const Me=aR(de),{align:Qe,behavior:st,offset:W}=Me;let j=Me.index;j==="LAST"&&(j=Ee-1),j=$c(0,j,ip(Ee-1,j));let ne=s0(Be,Ne,lt,j);return Qe==="end"?ne=wE(ne-Be.height+lt.height):Qe==="center"&&(ne=wE(ne-Be.height/2+lt.height/2)),W&&(ne+=W),{behavior:st,top:ne}})),d);const We=qs(Te(M,$e(de=>de.offsetBottom+de.bottom)),0);return qe(Te(C,$e(de=>({height:de.visibleHeight,width:de.visibleWidth}))),U),{customScrollParent:E,data:G,deviation:ae,footerHeight:n,gap:Z,headerHeight:r,increaseViewportBy:i,initialItemCount:_,itemDimensions:F,overscan:t,restoreStateFrom:Q,scrollBy:o,scrollContainerState:c,scrollHeight:V,scrollTo:d,scrollToIndex:z,scrollTop:u,smoothScrollTargetReached:f,totalCount:D,useWindowScroll:A,viewportDimensions:U,windowScrollContainerState:R,windowScrollTo:I,windowViewportRect:C,...v,gridState:M,horizontalDirection:le,initialTopMostItemIndex:J,totalListHeight:We,...p,endReached:ue,propsReady:y,rangeChanged:fe,startReached:xe,stateChanged:B,stateRestoreInProgress:re,...L}},Qt(ay,ii,vu,uR,ga,oy,ma));function bR(i,e,t){return $c(1,Mh((i+t)/(Mh(e)+t)))}function OE(i,e,t,s){const{height:n}=t;if(n===void 0||s.length===0)return{bottom:0,top:0};const r=s0(i,e,t,s[0].index);return{bottom:s0(i,e,t,s[s.length-1].index)+n,top:r}}function s0(i,e,t,s){const n=bR(i.width,t.width,e.column),r=Mh(s/n),o=r*t.height+$c(0,r-1)*e.row;return o>0?o+e.row:o}const MF=Ot(()=>{const i=De(m=>`Item ${m}`),e=De({}),t=De(null),s=De("virtuoso-grid-item"),n=De("virtuoso-grid-list"),r=De(ly),o=De("div"),c=De(Dl),d=(m,p=null)=>qs(Te(e,$e(v=>v[m]),qt()),p),u=De(!1),f=De(!1);return qe(rt(f),u),{components:e,computeItemKey:r,context:t,FooterComponent:d("Footer"),HeaderComponent:d("Header"),headerFooterTag:o,itemClassName:s,ItemComponent:d("Item","div"),itemContent:i,listClassName:n,ListComponent:d("List","div"),readyStateChanged:u,reportReadyState:f,ScrollerComponent:d("Scroller","div"),scrollerRef:c,ScrollSeekPlaceholder:d("ScrollSeekPlaceholder","div")}}),UF=Ot(([i,e])=>({...i,...e}),Qt(NF,MF)),FF=_e.memo(function(){const i=Jt("gridState"),e=Jt("listClassName"),t=Jt("itemClassName"),s=Jt("itemContent"),n=Jt("computeItemKey"),r=Jt("isSeeking"),o=Yi("scrollHeight"),c=Jt("ItemComponent"),d=Jt("ListComponent"),u=Jt("ScrollSeekPlaceholder"),f=Jt("context"),m=Yi("itemDimensions"),p=Yi("gap"),v=Jt("log"),S=Jt("stateRestoreInProgress"),y=Yi("reportReadyState"),E=no(_e.useMemo(()=>A=>{const R=A.parentElement.parentElement.scrollHeight;o(R);const I=A.firstChild;if(I){const{height:C,width:L}=I.getBoundingClientRect();m({height:C,width:L})}p({column:DE("column-gap",getComputedStyle(A).columnGap,v),row:DE("row-gap",getComputedStyle(A).rowGap,v)})},[o,m,p,v]),!0,!1);return pR(()=>{i.itemHeight>0&&i.itemWidth>0&&y(!0)},[i]),S?null:T.jsx(d,{className:e,ref:E,...Fs(d,f),"data-testid":"virtuoso-item-list",style:{paddingBottom:i.offsetBottom,paddingTop:i.offsetTop},children:i.items.map(A=>{const R=n(A.index,A.data,f);return r?T.jsx(u,{...Fs(u,f),height:i.itemHeight,index:A.index,width:i.itemWidth},R):P.createElement(c,{...Fs(c,f),className:t,"data-index":A.index,key:R},s(A.index,A.data,f))})})}),BF=_e.memo(function(){const i=Jt("HeaderComponent"),e=Yi("headerHeight"),t=Jt("headerFooterTag"),s=no(_e.useMemo(()=>r=>{e(da(r,"height"))},[e]),!0,!1),n=Jt("context");return i?T.jsx(t,{ref:s,children:T.jsx(i,{...Fs(i,n)})}):null}),jF=_e.memo(function(){const i=Jt("FooterComponent"),e=Yi("footerHeight"),t=Jt("headerFooterTag"),s=no(_e.useMemo(()=>r=>{e(da(r,"height"))},[e]),!0,!1),n=Jt("context");return i?T.jsx(t,{ref:s,children:T.jsx(i,{...Fs(i,n)})}):null}),VF=({children:i})=>{const e=_e.useContext(gR),t=Yi("itemDimensions"),s=Yi("viewportDimensions"),n=no(_e.useMemo(()=>r=>{s(r.getBoundingClientRect())},[s]),!0,!1);return _e.useEffect(()=>{e&&(s({height:e.viewportHeight,width:e.viewportWidth}),t({height:e.itemHeight,width:e.itemWidth}))},[e,s,t]),T.jsx("div",{ref:n,style:tf(!1),children:i})},$F=({children:i})=>{const e=_e.useContext(gR),t=Yi("windowViewportRect"),s=Yi("itemDimensions"),n=Jt("customScrollParent"),r=QI(t,n,!1);return _e.useEffect(()=>{e&&(s({height:e.itemHeight,width:e.itemWidth}),t({offsetTop:0,visibleHeight:e.viewportHeight,visibleWidth:e.viewportWidth}))},[e,t,s]),T.jsx("div",{ref:r,style:tf(!1),children:i})},GF=_e.memo(function({...i}){const e=Jt("useWindowScroll"),t=Jt("customScrollParent"),s=t||e?zF:HF,n=t||e?$F:VF,r=Jt("context");return T.jsx(s,{...i,...Fs(s,r),children:T.jsxs(n,{children:[T.jsx(BF,{}),T.jsx(FF,{}),T.jsx(jF,{})]})})}),{useEmitter:AR,useEmitterValue:Jt,usePublisher:Yi}=fR(UF,{optional:{context:"context",totalCount:"totalCount",overscan:"overscan",itemContent:"itemContent",components:"components",computeItemKey:"computeItemKey",data:"data",initialItemCount:"initialItemCount",scrollSeekConfiguration:"scrollSeekConfiguration",headerFooterTag:"headerFooterTag",listClassName:"listClassName",itemClassName:"itemClassName",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel",restoreStateFrom:"restoreStateFrom",initialTopMostItemIndex:"initialTopMostItemIndex",increaseViewportBy:"increaseViewportBy"},methods:{scrollTo:"scrollTo",scrollBy:"scrollBy",scrollToIndex:"scrollToIndex"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",stateChanged:"stateChanged",readyStateChanged:"readyStateChanged"}},GF),HF=xR({useEmitter:AR,useEmitterValue:Jt,usePublisher:Yi}),zF=TR({useEmitter:AR,useEmitterValue:Jt,usePublisher:Yi});function DE(i,e,t){return e!=="normal"&&!(e!=null&&e.endsWith("px"))&&t(`${i} was not resolved to pixel value correctly`,e,Di.WARN),e==="normal"?0:parseInt(e??"0",10)}const IR=(i,e)=>{const[t,s]=P.useState(i),n=P.useRef({}),r=P.useRef([]),o=P.useRef([]);P.useEffect(()=>{s(e?[...i,...Array(4).fill({isPlaceholder:!0})]:i)},[i,e]);const c=(d,u)=>{n.current={...n.current,[d]:u}};return P.useEffect(()=>{const d=()=>{m()},u=()=>{o.current=r.current.map((p,v)=>{const S=new ResizeObserver(()=>{if(p){const y=p.style.height;p.style.height="auto";const E=p.getBoundingClientRect().height;p.style.height=y||`${E}px`,E!==n.current[v]&&c(v,E)}});return p&&S.observe(p),S})},f=()=>{o.current.forEach(p=>p.disconnect()),o.current=[]},m=()=>{r.current.forEach((p,v)=>{if(p){const S=p.style.height;p.style.height="auto";const y=p.getBoundingClientRect().height;p.style.height=S||`${y}px`,y!==n.current[v]&&c(v,y)}})};return r.current=t.map(()=>null),f(),m(),u(),document.body.style.overflowY="auto",window.addEventListener("resize",d),()=>{f(),window.removeEventListener("resize",d)}},[t]),{displayItems:t,setDisplayItems:s,setRowRefs:(d,u)=>{r.current[d]=u}}},Uc=({type:i="album"})=>T.jsxs("div",{className:"skeleton-loading",children:[T.jsx("div",{className:`skeleton-effect thumbnail ${i==="playlist"?"playlist":i==="artist"?"artist":""}`}),T.jsxs("div",{className:"skeleton-details",children:[i==="album"&&T.jsxs(T.Fragment,{children:[T.jsx("div",{className:"skeleton-effect album title"}),T.jsx("div",{className:"skeleton-effect album artist"})]}),i==="artist"&&T.jsx(T.Fragment,{children:T.jsx("div",{className:"skeleton-effect artist title"})}),i==="song"&&T.jsxs(T.Fragment,{children:[T.jsx("div",{className:"skeleton-effect track title"}),T.jsx("div",{className:"skeleton-effect track artist"})]}),i==="playlist"&&T.jsxs(T.Fragment,{children:[T.jsx("div",{className:"skeleton-effect playlist title"}),T.jsx("div",{className:"skeleton-effect playlist artist"})]})]}),i==="playlist"&&T.jsx("div",{className:"skeleton-indicators",children:T.jsx("div",{className:"skeleton-effect duration"})})]}),As=({items:i=[],playlistItems:e,indexOffset:t=0,isLoading:s,type:n,title:r,reviver:o,loadMore:c,hidden:d={},disableActions:u=!1,albumDisplayMode:f="artist"})=>{const m=Qs(),p=io(),v=Xs(),{displayItems:S,setRowRefs:y}=IR(i,s),E=u?{...d,add_to_favorite:!0,remove_from_favorite:!0,add_to_playlist:!0,remove_from_playlist:!0}:d,A=hr(),R=(C,L)=>{var D;n==="song"&&(((D=m.currentTrack)==null?void 0:D.Id)===C.Id?m.togglePlayPause():(m.setCurrentPlaylist({playlist:e||i,title:r,reviver:o}),m.playTrack(t+L)))},I=(C,L)=>{var M,U,F,z,V,ae;if("isPlaceholder"in L)return n==="album"?T.jsx("div",{className:"media-item album-item",ref:G=>y(C,G),children:T.jsx(Uc,{type:"album"})}):n==="artist"?T.jsx("div",{className:"media-item artist-item",ref:G=>y(C,G),children:T.jsx(Uc,{type:"artist"})}):n==="playlist"?T.jsx("div",{className:"media-item album-item",ref:G=>y(C,G),children:T.jsx(Uc,{type:"album"})}):T.jsx("li",{className:"media-item song-item",ref:G=>y(C,G),children:T.jsx(Uc,{type:"song"})});const D=((M=A.selectedItem)==null?void 0:M.Id)===L.Id&&A.isOpen,_=[n==="song"&&((U=m.currentTrack)==null?void 0:U.Id)===L.Id?m.isPlaying?"playing":"paused":"",D?"active":""].filter(Boolean).join(" ");return n==="album"?T.jsxs("div",{className:`media-item album-item ${_}`,onClick:()=>p(`/album/${L.Id}`),ref:G=>y(C,G),onContextMenu:G=>A.onContextMenu(G,{item:L},!1,E),onTouchStart:G=>A.onTouchStart(G,{item:L},!1,E),onTouchMove:A.onTouchClear,onTouchEnd:A.onTouchClear,children:[T.jsx("div",{className:"media-state",children:T.jsx(ra,{item:L,type:"Primary",width:46,height:46})}),T.jsxs("div",{className:"media-details",children:[T.jsx("span",{className:"song-name",children:L.Name}),T.jsxs("div",{className:"container",children:[f==="year"&&T.jsx("div",{className:"year",children:dE(L.PremiereDate)}),f==="artist"&&T.jsx("div",{className:"artist",children:L.AlbumArtist||"Unknown Artist"}),f==="both"&&T.jsxs(T.Fragment,{children:[T.jsx("div",{className:"year",children:dE(L.PremiereDate)}),T.jsx("div",{className:"divider"}),T.jsx("div",{className:"artist",children:L.AlbumArtist||"Unknown Artist"})]})]})]}),T.jsxs("div",{className:"media-indicators",children:[L.offlineState&&T.jsxs("div",{className:"download-state",children:[L.offlineState==="downloading"&&T.jsx("div",{className:"icon downloading",title:"Syncing...",children:T.jsx(na,{width:16,height:16})}),L.offlineState==="downloaded"&&T.jsx("div",{className:"icon downloaded",title:"Synced",children:T.jsx(Va,{width:16,height:16})}),L.offlineState==="deleting"&&T.jsx("div",{className:"icon deleting",title:"Unsyncing...",children:T.jsx($a,{width:16,height:16})})]}),!u&&((F=L.UserData)==null?void 0:F.IsFavorite)&&v.pathname!=="/favorites"&&T.jsx("div",{className:"favorited",title:"Favorited",children:T.jsx(on,{size:16})})]})]},L.Id):n==="artist"?T.jsxs("div",{className:`media-item artist-item ${_}`,onClick:()=>p(`/artist/${L.Id}`),ref:G=>y(C,G),onContextMenu:G=>A.onContextMenu(G,{item:L},!1,E),onTouchStart:G=>A.onTouchStart(G,{item:L},!1,E),onTouchMove:A.onTouchClear,onTouchEnd:A.onTouchClear,children:[T.jsx("div",{className:"media-state",children:T.jsx(ra,{item:L,type:"Primary",width:36,height:36})}),T.jsx("div",{className:"media-details",children:T.jsx("div",{className:"song-name",children:L.Name||"Unknown Artist"})}),T.jsxs("div",{className:"media-indicators",children:[L.offlineState&&T.jsxs("div",{className:"download-state",children:[L.offlineState==="downloading"&&T.jsx("div",{className:"icon downloading",title:"Syncing...",children:T.jsx(na,{width:16,height:16})}),L.offlineState==="downloaded"&&T.jsx("div",{className:"icon downloaded",title:"Synced",children:T.jsx(Va,{width:16,height:16})}),L.offlineState==="deleting"&&T.jsx("div",{className:"icon deleting",title:"Unsyncing...",children:T.jsx($a,{width:16,height:16})})]}),!u&&((z=L.UserData)==null?void 0:z.IsFavorite)&&v.pathname!=="/favorites"&&T.jsx("div",{className:"favorited",title:"Favorited",children:T.jsx(on,{size:16})})]})]},L.Id):n==="playlist"?T.jsxs("div",{className:`media-item playlist-item ${_}`,onClick:()=>p(`/playlist/${L.Id}`),ref:G=>y(C,G),onContextMenu:G=>A.onContextMenu(G,{item:L},!1,E),onTouchStart:G=>A.onTouchStart(G,{item:L},!1,E),onTouchMove:A.onTouchClear,onTouchEnd:A.onTouchClear,children:[T.jsx("div",{className:"media-state",children:T.jsx(ra,{item:L,type:"Primary",width:46,height:46})}),T.jsxs("div",{className:"media-details",children:[T.jsx("span",{className:"song-name",children:L.Name}),T.jsx("div",{className:"container",children:T.jsxs("div",{className:"track-amount",children:[T.jsx("span",{className:"number",children:L.ChildCount||0})," ",T.jsx("span",{children:(L.ChildCount||0)===1?"Track":"Tracks"})]})})]}),T.jsxs("div",{className:"media-indicators",children:[L.offlineState&&T.jsxs("div",{className:"download-state",children:[L.offlineState==="downloading"&&T.jsx("div",{className:"icon downloading",title:"Syncing...",children:T.jsx(na,{width:16,height:16})}),L.offlineState==="downloaded"&&T.jsx("div",{className:"icon downloaded",title:"Synced",children:T.jsx(Va,{width:16,height:16})}),L.offlineState==="deleting"&&T.jsx("div",{className:"icon deleting",title:"Unsyncing...",children:T.jsx($a,{width:16,height:16})})]}),!u&&((V=L.UserData)==null?void 0:V.IsFavorite)&&v.pathname!=="/favorites"&&T.jsx("div",{className:"favorited",title:"Favorited",children:T.jsx(on,{size:16})})]})]},L.Id):T.jsxs("li",{className:`media-item song-item ${_}`,onClick:()=>R(L,C),ref:G=>y(C,G),onContextMenu:G=>A.onContextMenu(G,{item:L},!1,E),onTouchStart:G=>A.onTouchStart(G,{item:L},!1,E),onTouchMove:A.onTouchClear,onTouchEnd:A.onTouchClear,children:[T.jsxs("div",{className:"media-state",children:[T.jsx(ra,{item:L,type:"Primary",width:46,height:46}),T.jsxs("div",{className:"overlay",children:[T.jsxs("div",{className:"container",children:[T.jsx("div",{className:"play",children:T.jsx("div",{className:"play-icon"})}),T.jsx("div",{className:"pause",children:T.jsx("div",{className:"pause-icon"})})]}),T.jsx("div",{className:"play-state-animation",children:T.jsx(lA,{width:28,height:20,className:"sound-bars"})})]})]}),T.jsxs("div",{className:"media-details",children:[T.jsx("span",{className:"song-name",children:L.Name}),T.jsxs("div",{className:"container",children:[T.jsx("div",{className:"artist",children:L.Artists&&L.Artists.length>0?L.Artists.join(", "):"Unknown Artist"}),T.jsxs(T.Fragment,{children:[T.jsx("div",{className:"divider"}),T.jsx("div",{className:"album",children:L.Album||"Unknown Album"})]})]})]}),T.jsxs("div",{className:"media-indicators",children:[L.offlineState&&T.jsxs("div",{className:"download-state",children:[L.offlineState==="downloading"&&T.jsx("div",{className:"icon downloading",title:"Syncing...",children:T.jsx(na,{width:16,height:16})}),L.offlineState==="downloaded"&&T.jsx("div",{className:"icon downloaded",title:"Synced",children:T.jsx(Va,{width:16,height:16})}),L.offlineState==="deleting"&&T.jsx("div",{className:"icon deleting",title:"Unsyncing...",children:T.jsx($a,{width:16,height:16})})]}),!u&&((ae=L.UserData)==null?void 0:ae.IsFavorite)&&v.pathname!=="/favorites"&&T.jsx("div",{className:"favorited",title:"Favorited",children:T.jsx(on,{size:16})})]})]},L.Id)};return s&&i.length===0?T.jsx(dr,{}):i.length===0&&!s?T.jsx("div",{className:"empty",children:n==="song"?"No tracks were found":n==="album"?"No albums were found":n==="artist"?"No artists were found":"No playlists were found"}):T.jsx("ul",{className:"media-list noSelect",children:T.jsx(ER,{data:S,useWindowScroll:!0,itemContent:I,endReached:c,overscan:800})})},KF=()=>{const i=ns(),e=40,{jellySort:t}=fr();return Mn({queryKey:["albums",t.sortBy,t.sortOrder],queryFn:async({pageParam:s=0})=>{const n=s*e;return await i.getAllAlbums(n,e,t.sortBy,t.sortOrder)},queryFnReviver:{fn:"getAllAlbums",params:[Un,e,t.sortBy,t.sortOrder]}})},YF=()=>{const{items:i,isLoading:e,error:t,reviver:s,loadMore:n}=KF();return T.jsxs("div",{className:"albums-page",children:[T.jsx(As,{items:i,isLoading:e,type:"album",title:"Albums",reviver:s,loadMore:n,hidden:{view_album:!0}}),t&&T.jsx("div",{className:"error",children:t})]})},RR=(i,e=5)=>{const t=ns(),{data:s,isFetching:n,isPending:r,error:o}=la({queryKey:["artistDetails",i,e],queryFn:()=>t.getArtistDetails(i,e)}),{data:c,error:d}=la({queryKey:["artistStats",i],queryFn:async()=>{const u=await t.getArtistStats(i,(s==null?void 0:s.artist.Name)||""),m=(await t.fetchAllTracks(i)).reduce((v,S)=>{var y;return v+(((y=S.UserData)==null?void 0:y.PlayCount)||0)},0),p=u.albums.length;return{...u,totalPlays:m,totalAlbumCount:p}},enabled:!!(s!=null&&s.artist)});return{artist:(s==null?void 0:s.artist)||null,tracks:(s==null?void 0:s.tracks)||[],albums:(c==null?void 0:c.albums)||[],appearsInAlbums:(c==null?void 0:c.appearsInAlbums)||[],totalTrackCount:(c==null?void 0:c.totalTrackCount)||0,totalPlaytime:(c==null?void 0:c.totalPlaytime)||0,totalPlays:(c==null?void 0:c.totalPlays)||0,totalAlbumCount:(c==null?void 0:c.totalAlbumCount)||0,loading:n||r,error:(o==null?void 0:o.message)||(d==null?void 0:d.message)||null}},qF=i=>{const e=ns(),{data:t,isFetching:s,isPending:n,error:r}=la({queryKey:["playlistsFeaturingArtist",i],queryFn:async()=>await e.getPlaylistsFeaturingArtist(i)});return{playlists:t||[],loading:s||n,error:r?r.message:null}},QF=()=>{var M,U;const i=Qs(),{artistId:e}=Rl(),{artist:t,tracks:s,albums:n,appearsInAlbums:r,totalTrackCount:o,totalPlaytime:c,totalPlays:d,totalAlbumCount:u,loading:f,error:m}=RR(e),{playlists:p,loading:v,error:S}=qF(e),{setPageTitle:y}=mr(),{isOpen:E,selectedItem:A,onContextMenu:R}=hr(),{addToFavorites:I,removeFromFavorites:C}=qh();if(P.useEffect(()=>(t&&y(t.Name),()=>{y("")}),[t,y]),f)return T.jsx(dr,{});if(m||!t)return T.jsx("div",{className:"error",children:m||"Artist not found"});const L=s.slice(0,5),D=t.Genres||[],_=F=>{F.stopPropagation(),R(F,{item:t},!0,{add_to_favorite:!0,remove_from_favorite:!0})};return T.jsxs("div",{className:"artist-page",children:[T.jsxs("div",{className:"artist-header",children:[T.jsx(ra,{item:t,type:"Primary",width:100,height:100}),T.jsxs("div",{className:"artist-details",children:[T.jsx("div",{className:"artist",children:t.Name}),D.length>0&&T.jsx(T.Fragment,{children:T.jsx("div",{className:"genres",children:D.slice(0,6).map((F,z)=>T.jsxs("span",{children:[T.jsx(qi,{to:`/genre/${encodeURIComponent(F)}`,children:F}),z<D.slice(0,6).length-1&&", "]},F))})}),T.jsxs("div",{className:"stats",children:[T.jsxs("div",{className:"track-amount",children:[T.jsx("span",{className:"number",children:o})," ",T.jsx("span",{children:o===1?"Track":"Tracks"})]}),T.jsx("div",{className:"divider"}),T.jsxs("div",{className:"album-amount",children:[T.jsx("span",{className:"number",children:u})," ",T.jsx("span",{children:u===1?"Album":"Albums"})]}),T.jsx("div",{className:"divider"}),T.jsxs("div",{className:"length",children:[T.jsx("span",{className:"number",children:Z0(c)})," ",T.jsx("span",{children:"Total"})]}),d>0&&T.jsxs(T.Fragment,{children:[T.jsx("div",{className:"divider"}),T.jsxs("div",{className:"plays",children:[T.jsx("span",{className:"number",children:d})," ",d===1?"Play":"Plays"]})]})]}),T.jsxs("div",{className:"actions noSelect",children:[T.jsxs("div",{className:"primary",children:[T.jsxs("div",{className:"play-artist",onClick:()=>{i.setCurrentPlaylist({playlist:s,title:t.Name}),i.playTrack(0)},children:[T.jsx("div",{className:"play-icon"}),T.jsx("div",{className:"text",children:"Play"})]}),T.jsx("div",{className:"favorite-state",title:(M=t.UserData)!=null&&M.IsFavorite?"Remove from favorites":"Add to favorites",onClick:async()=>{var F;if(t!=null&&t.Id)try{(F=t.UserData)!=null&&F.IsFavorite?await C(t):await I(t)}catch(z){console.error("Failed to update favorite status:",z)}},children:(U=t.UserData)!=null&&U.IsFavorite?T.jsx(on,{size:16}):T.jsx(y0,{size:16})})]}),T.jsx("div",{className:`more ${E&&(A==null?void 0:A.Id)===(t==null?void 0:t.Id)?"active":""}`,onClick:_,title:"More",children:T.jsx(Kh,{width:14,height:14})})]})]})]}),T.jsxs("div",{className:"artist-content",children:[L.length>0&&T.jsxs("div",{className:"section top-songs",children:[T.jsx(W0,{tracks:L,showAlbum:!0,title:t.Name,hidden:{view_artist:!0,view_artists:!0}}),(o||0)>5&&T.jsx("div",{className:"all-tracks",children:T.jsx(qi,{to:`/artist/${e}/tracks`,className:"textlink",children:"View all tracks"})})]}),n.length>0&&T.jsxs("div",{className:"section albums",children:[T.jsx("div",{className:"title",children:"Albums"}),T.jsx("div",{className:"desc",children:"Complete discography"}),T.jsx(As,{items:n,isLoading:f,type:"album",albumDisplayMode:"year",title:t.Name?`${t.Name} Albums`:"Albums",hidden:{view_album:!0,view_artist:!0}})]}),r.length>0&&T.jsxs("div",{className:"section appears-in",children:[T.jsx("div",{className:"title",children:"Appears In"}),T.jsx("div",{className:"desc",children:"Additional recordings"}),T.jsx(As,{items:r,isLoading:f,type:"album",albumDisplayMode:"both",title:t.Name?`${t.Name} Albums`:"Albums",hidden:{view_album:!0}})]}),p.length>0&&T.jsxs("div",{className:"section playlists",children:[v?T.jsx(dr,{}):T.jsxs(T.Fragment,{children:[T.jsx("div",{className:"title",children:"Playlists"}),T.jsx("div",{className:"desc",children:"Included in curated collections"}),T.jsx(As,{items:p,isLoading:v,type:"playlist",title:t.Name?`${t.Name} Playlists`:"Playlists"})]}),S&&!v&&T.jsx("div",{className:"error",children:S})]})]})]})},XF=()=>{const i=ns(),e=40,{jellySort:t}=fr();return Mn({queryKey:["artists",t.sortBy,t.sortOrder],queryFn:async({pageParam:s=0})=>{const n=s*e;return await i.getAllArtists(n,e,t.sortBy,t.sortOrder)},queryFnReviver:{fn:"getAllArtists",params:[Un,e,t.sortBy,t.sortOrder]}})},WF=()=>{const{items:i,isLoading:e,error:t,reviver:s,loadMore:n}=XF();return T.jsxs("div",{className:"artists-page",children:[T.jsx(As,{items:i,isLoading:e,type:"artist",title:"Artists",reviver:s,loadMore:n,hidden:{view_artist:!0}}),t&&T.jsx("div",{className:"error",children:t})]})},LR=({tracks:i,isLoading:e,playlistId:t,showType:s,title:n,reviver:r,loadMore:o})=>{const c=Qs(),d=Xs(),{displayItems:u,setRowRefs:f}=IR(i,e),m=hr(),p=P.useCallback((S,y)=>{var E;((E=c.currentTrack)==null?void 0:E.Id)===S.Id?c.togglePlayPause():(c.setCurrentPlaylist({playlist:i,title:n,reviver:r}),c.playTrack(y))},[c,r,n,i]),v=(S,y)=>{var C,L,D;if("isPlaceholder"in y)return T.jsx("li",{className:"track-item",ref:_=>f(S,_),children:T.jsx(Uc,{type:"playlist"})});const E=y,A=((C=m.selectedItem)==null?void 0:C.Id)===y.Id&&m.isOpen,R=[((L=c.currentTrack)==null?void 0:L.Id)===E.Id?c.isPlaying?"playing":"paused":"",A?"active":""].filter(Boolean).join(" "),I=((D=E.UserData)==null?void 0:D.IsFavorite)&&d.pathname!=="/favorites";return T.jsxs("li",{className:`track-item ${R}`,onClick:()=>p(E,S),ref:_=>f(S,_),onContextMenu:_=>m.onContextMenu(_,{item:y,playlistId:t}),onTouchStart:_=>m.onTouchStart(_,{item:y,playlistId:t}),onTouchMove:m.onTouchClear,onTouchEnd:m.onTouchClear,children:[T.jsxs("div",{className:"track-state",children:[T.jsx(ra,{item:E,type:"Primary",width:40,height:40}),T.jsxs("div",{className:"overlay",children:[T.jsxs("div",{className:"container",children:[T.jsx("div",{className:"play",children:T.jsx("div",{className:"play-icon"})}),T.jsx("div",{className:"pause",children:T.jsx("div",{className:"pause-icon"})})]}),T.jsx("div",{className:"play-state-animation",children:T.jsx(R0,{width:18,height:18,className:"sound-bars"})})]})]}),T.jsxs("div",{className:"track-details",children:[T.jsxs("span",{className:"track-name",children:[T.jsxs("span",{className:"track-number",children:[S+1,"."]}),E.Name]}),T.jsx("div",{className:"container",children:s==="artist"?T.jsx("div",{className:"artist",children:E.Artists&&E.Artists.length>0?E.Artists.join(", "):"Unknown Artist"}):s==="album"?T.jsx("div",{className:"album",children:E.Album||"Unknown Album"}):T.jsxs(T.Fragment,{children:[T.jsx("div",{className:"artist",children:E.Artists&&E.Artists.length>0?E.Artists.join(", "):"Unknown Artist"}),T.jsx("div",{className:"divider"}),T.jsx("div",{className:"album",children:E.Album||"Unknown Album"})]})})]}),T.jsxs("div",{className:"track-indicators",children:[E.offlineState&&T.jsxs("div",{className:"download-state",children:[E.offlineState==="downloading"&&T.jsx("div",{className:"icon downloading",title:"Syncing...",children:T.jsx(na,{width:12,height:12})}),E.offlineState==="downloaded"&&T.jsx("div",{className:"icon downloaded",title:"Synced",children:T.jsx(Va,{width:12,height:12})}),E.offlineState==="deleting"&&T.jsx("div",{className:"icon deleting",title:"Unsyncing...",children:T.jsx($a,{width:12,height:12})})]}),I&&T.jsx("div",{className:"favorited",title:"Favorited",children:T.jsx(on,{size:12})}),T.jsx("div",{className:"track-duration",children:HI(E.RunTimeTicks||0)})]})]},E.Id)};return e&&i.length===0?T.jsx(dr,{}):!e&&i.length===0?T.jsx("div",{className:"empty",children:"No tracks were found"}):T.jsx("ul",{className:"playlist-tracklist noSelect",children:T.jsx(ER,{data:u,useWindowScroll:!0,itemContent:v,endReached:o,overscan:800},t)})},ZF=i=>{const e=ns(),t=40;return Mn({queryKey:["artistTracks",i],queryFn:async({pageParam:s=0})=>{const n=s*t,{Items:r}=await e.getArtistTracks(i,n,t);return r},queryFnReviver:{fn:"getArtistTracks",params:[i,Un,t]}})},JF=()=>{const{artistId:i}=Rl(),{artist:e}=RR(i),{items:t,isLoading:s,error:n,reviver:r,loadMore:o}=ZF(i),{setPageTitle:c}=mr();return P.useEffect(()=>(e&&c(`${e.Name}'s Tracks`),()=>{c("")}),[e,c]),s&&t.length===0?T.jsx(dr,{}):T.jsxs("div",{className:"artist-tracks-page",children:[n&&T.jsx("div",{className:"error",children:n}),T.jsx(LR,{tracks:t,isLoading:s,showType:"album",title:e?`${e.Name}'s Tracks`:"Artist Tracks",reviver:r,loadMore:o})]})},e6=()=>{const i=Yh(),{jellyItemKind:e}=fr(),t=40,{data:s,isFetching:n,isPending:r,error:o,fetchNextPage:c,hasNextPage:d,isFetchingNextPage:u}=ob({queryKey:["downloads",e],queryFn:async({pageParam:p=0})=>await i.getPageFromIndexedDb(p,e,t),getNextPageParam:(p,v)=>p.length===t?v.length:void 0,initialPageParam:0,staleTime:0,retry:!1}),f=s?s.pages.flat():[],m=async()=>{d&&!u&&await c()};return{items:f,isLoading:n||r,error:o?o.message:null,hasNextPage:d,loadMore:m}},t6=()=>{const{items:i,isLoading:e,error:t,loadMore:s}=e6(),{jellyItemKind:n}=fr();return T.jsxs("div",{className:"favorites-page",children:[t&&T.jsx("div",{className:"error",children:t}),T.jsx(As,{items:i,isLoading:e,type:n==="Audio"?"song":n==="MusicAlbum"?"album":"artist",loadMore:s,title:"Favorites",disableActions:!0})]})},s6=()=>{const i=ns(),e=40,{jellySort:t,jellyItemKind:s}=fr();return Mn({queryKey:["favorites",s],queryFn:async({pageParam:n=0})=>{const r=n*e;return await i.getFavoriteTracks(r,e,t.sortBy,t.sortOrder,s)},queryFnReviver:{fn:"getFavoriteTracks",params:[Un,e,s]}})},i6=()=>{const{items:i,isLoading:e,error:t,reviver:s,loadMore:n}=s6(),{jellyItemKind:r}=fr();return T.jsxs("div",{className:"favorites-page",children:[t&&T.jsx("div",{className:"error",children:t}),T.jsx(As,{items:i,isLoading:e,type:r==="Audio"?"song":r==="MusicAlbum"?"album":"artist",reviver:s,loadMore:n,title:"Favorites"})]})},n6=()=>{const i=ns(),e=40;return Mn({queryKey:["frequentlyPlayed"],queryFn:async({pageParam:t=0})=>{const s=t*e;return await i.fetchFrequentlyPlayed(s,e)},queryFnReviver:{fn:"fetchFrequentlyPlayed",params:[Un,e]}})},r6=()=>{const{items:i,isLoading:e,error:t,reviver:s,loadMore:n}=n6();return T.jsxs("div",{className:"frequently-page",children:[t&&T.jsx("div",{className:"error",children:t}),T.jsx(As,{items:i,isLoading:e,type:"song",title:"Frequently Played",reviver:s,loadMore:n})]})},a6=i=>{const e=ns(),t=40,{jellySort:s}=fr();return Mn({queryKey:["genreTracks",i,s.sortBy,s.sortOrder],queryFn:async({pageParam:n=0})=>{const r=n*t;return await e.getGenreTracks(i,r,t,s.sortBy,s.sortOrder)},queryFnReviver:{fn:"getGenreTracks",params:[i,Un,t,s.sortBy,s.sortOrder]}})},o6=()=>{const{genre:i}=Rl(),{items:e,isLoading:t,error:s,reviver:n,loadMore:r}=a6(i),{setPageTitle:o}=mr();return P.useEffect(()=>(i&&o(decodeURIComponent(i)),()=>{o("")}),[i,o]),T.jsxs("div",{className:"genre-page",children:[s&&T.jsx("div",{className:"error",children:s}),T.jsx(As,{items:e,isLoading:t,type:"song",title:i?`Genre: ${decodeURIComponent(i)}`:"Genres",reviver:n,loadMore:r})]})},l6=()=>{const i=ns(),{data:e,isLoading:t,error:s}=la({queryKey:["homeData"],queryFn:async()=>{const[n,r,o]=await Promise.all([i.getRecentlyPlayed(),i.getFrequentlyPlayed(),i.getRecentlyAdded()]);return{recentlyPlayed:n.filter(c=>c.Type==="Audio"),frequentlyPlayed:r.filter(c=>c.Type==="Audio"),recentlyAdded:o.filter(c=>c.Type==="MusicAlbum"),loading:!1,error:null}}});return{...e,isLoading:t,error:s?s.message:null}},c6=()=>{const{recentlyPlayed:i,frequentlyPlayed:e,recentlyAdded:t,isLoading:s,error:n}=l6();return s?T.jsx(dr,{}):n?T.jsx("div",{className:"error",children:n}):T.jsxs("div",{className:"home-page",children:[T.jsxs("div",{className:"section",children:[T.jsxs("div",{className:"section-header",children:[T.jsxs("div",{className:"container",children:[T.jsx("div",{className:"section_title",children:"Recently Played"}),T.jsx("div",{className:"section_desc",children:"Songs you queued up lately"})]}),T.jsx(qi,{to:"/recently",className:"see-more noSelect",children:"See more"})]}),T.jsx(As,{items:i,isLoading:s,type:"song",title:"Home - Recently Played"})]}),T.jsxs("div",{className:"section",children:[T.jsxs("div",{className:"section-header",children:[T.jsxs("div",{className:"container",children:[T.jsx("div",{className:"section_title",children:"Frequently Played"}),T.jsx("div",{className:"section_desc",children:"Songs you listen to often"})]}),T.jsx(qi,{to:"/frequently",className:"see-more noSelect",children:"See more"})]}),T.jsx(As,{items:e,isLoading:s,type:"song",title:"Home - Frequently Played"})]}),T.jsxs("div",{className:"section",children:[T.jsx("div",{className:"section-header",children:T.jsxs("div",{className:"container",children:[T.jsx("div",{className:"section_title",children:"Recently Added"}),T.jsx("div",{className:"section_desc",children:"Albums recently added to the Library"})]})}),T.jsx(As,{items:t,isLoading:s,type:"album",title:"Home - Recently Added"})]})]})},u6=({onLogin:i})=>{const t=new URLSearchParams(window.location.search).get("demo")==="1";let s;s=t?"https://demo.jellyfin.org/stable":localStorage.getItem("lastServerUrl")||void 0||"";const[n,r]=P.useState(s),[o,c]=P.useState(t?"demo":""),[d,u]=P.useState(""),[f,m]=P.useState(!1),[p,v]=P.useState(""),S=async y=>{if(y.preventDefault(),m(!0),v(""),!n){v("Please enter a server URL."),m(!1);return}let E=n.toLowerCase().replace(new RegExp("/+$"),"");if(!/^https?:\/\/.+/.test(E)){v("Invalid URL format. Use http:// or https:// followed by a valid address."),m(!1);return}try{let R;try{R=await kp(E,o,d)}catch(D){const _=E.split("/").slice(0,3).join("/");if(E!==_)E=_,R=await kp(E,o,d);else throw D}const{token:I,userId:C,username:L}=R;localStorage.setItem("lastServerUrl",E),i({serverUrl:E,token:I,userId:C,username:L})}catch(R){R instanceof gu?R.response?R.response.status===401?v("Invalid credentials entered."):R.response.status===404?v("Server not found. Please check the URL."):R.response.status===400?v("Invalid request. Please check your input."):v(`Login failed: Server returned status ${R.response.status}.`):v("Login failed: Request setup error."):v("An unexpected error occurred. Please try again.")}finally{m(!1)}};return T.jsxs("form",{className:"login_form",onSubmit:S,children:[T.jsx("div",{className:"error_placeholder",children:p&&T.jsx("div",{className:"error",children:p})}),T.jsx("div",{className:"title",children:"Welcome back"}),T.jsx("div",{className:"input_container",children:T.jsx("input",{type:"text",placeholder:"Server URL (http://localhost:8096)",value:n,onChange:y=>r(y.target.value),disabled:f})}),T.jsx("div",{className:"input_container",children:T.jsx("input",{type:"text",placeholder:"Username",value:o,onChange:y=>c(y.target.value),disabled:f})}),T.jsx("div",{className:"input_container",children:T.jsx("input",{type:"password",placeholder:"Password",value:d,onChange:y=>u(y.target.value),disabled:f})}),T.jsx("button",{className:"submit_button noSelect",type:"submit",disabled:f,children:f?"Logging in...":"Login with Jellyfin"})]})},d6=({onLogin:i})=>T.jsxs("div",{className:"login",children:[T.jsx("div",{className:"login_header",children:T.jsx("div",{className:"logo"})}),T.jsx(u6,{onLogin:i}),T.jsxs("div",{className:"disclaimer",children:["Jelly Music App - Version ","0.2"]})]}),h6=i=>{const e=ns(),t=40,{data:s,error:n}=la({queryKey:["playlist",i],queryFn:()=>e.getPlaylist(i)}),{data:r,error:o}=la({queryKey:["playlistTotals",i],queryFn:()=>e.getPlaylistTotals(i)});P.useEffect(()=>{var m,p;(n||o)instanceof gu&&((p=(m=n||o)==null?void 0:m.response)==null?void 0:p.status)===401&&(localStorage.removeItem("auth"),window.location.href="/login")},[n,o]);const c=Mn({queryKey:["playlistTracks",i],queryFn:async({pageParam:m=0})=>{const p=m*t;return await e.getPlaylistTracks(i,p,t)},queryFnReviver:{fn:"getPlaylistTracks",params:[i,Un,t]}}),d=(r==null?void 0:r.totalPlaytime)||0,u=(r==null?void 0:r.totalTrackCount)||0,f=c.items.reduce((m,p)=>{var v;return m+(((v=p.UserData)==null?void 0:v.PlayCount)||0)},0);return{...c,playlist:s,totalPlaytime:d,totalTrackCount:u,totalPlays:f}},f6=()=>{var R,I;const i=Qs(),{addToFavorites:e,removeFromFavorites:t}=qh(),{playlistId:s}=Rl(),{playlist:n,items:r,isLoading:o,error:c,totalPlaytime:d,totalTrackCount:u,totalPlays:f,reviver:m,loadMore:p}=h6(s),{setPageTitle:v}=mr(),{isOpen:S,selectedItem:y,onContextMenu:E}=hr();if(P.useEffect(()=>(n&&v(n.Name),()=>{v("")}),[n,v]),o&&r.length===0)return T.jsx(dr,{});if(c||!n)return T.jsx("div",{className:"error",children:c||"Playlist not found"});const A=C=>{C.stopPropagation(),E(C,{item:n},!0,{add_to_favorite:!0,remove_from_favorite:!0})};return T.jsxs("div",{className:"playlist-page",children:[T.jsxs("div",{className:"playlist-header",children:[T.jsx(ra,{item:n,type:"Primary",width:100,height:100}),T.jsxs("div",{className:"playlist-details",children:[T.jsx("div",{className:"title",children:n.Name}),T.jsx("div",{className:"date",children:zI(n.DateCreated)}),T.jsxs("div",{className:"stats",children:[T.jsxs("div",{className:"track-amount",children:[T.jsx("span",{className:"number",children:u})," ",T.jsx("span",{children:u===1?"Track":"Tracks"})]}),T.jsx("div",{className:"divider"}),T.jsxs("div",{className:"length",children:[T.jsx("span",{className:"number",children:Z0(d)})," ",T.jsx("span",{children:"Total"})]}),f>0&&T.jsxs(T.Fragment,{children:[T.jsx("div",{className:"divider"}),T.jsxs("div",{className:"plays",children:[T.jsx("span",{className:"number",children:f})," ",f===1?"Play":"Plays"]})]})]}),T.jsxs("div",{className:"actions noSelect",children:[T.jsxs("div",{className:"primary",children:[T.jsxs("div",{className:"play-playlist",onClick:()=>{i.setCurrentPlaylist({playlist:r,title:n.Name}),i.playTrack(0)},children:[T.jsx("div",{className:"play-icon"}),T.jsx("div",{className:"text",children:"Play"})]}),T.jsx("div",{className:"favorite-state",title:(R=n.UserData)!=null&&R.IsFavorite?"Remove from favorites":"Add to favorites",onClick:async()=>{var C;if(n!=null&&n.Id)try{(C=n.UserData)!=null&&C.IsFavorite?await t(n):await e(n)}catch(L){console.error("Failed to update favorite status:",L)}},children:(I=n.UserData)!=null&&I.IsFavorite?T.jsx(on,{size:16}):T.jsx(y0,{size:16})})]}),T.jsx("div",{className:`more ${S&&(y==null?void 0:y.Id)===(n==null?void 0:n.Id)?"active":""}`,onClick:A,title:"More",children:T.jsx(Kh,{width:14,height:14})})]})]})]}),T.jsx(LR,{tracks:r,isLoading:o,showType:"artist",playlistId:s,title:n?n.Name:"Playlist",reviver:m,loadMore:p})]})},m6=()=>{const{setPageTitle:i}=mr(),{currentTrack:e,currentPlaylist:t,currentTrackIndex:s,playlistTitle:n,isLoading:r,loadMore:o}=Qs();if(P.useEffect(()=>(i("Queue"),()=>i("")),[i]),!e||t.length===0)return T.jsx("div",{className:"empty-queue",children:"Queue is currently empty"});const c=t.slice(s+1);return T.jsxs("div",{className:"queue-page",children:[T.jsx("div",{className:"queue-header",children:T.jsx(As,{items:[e],isLoading:!1,type:"song",title:"Current Track - Queue",hidden:{add_to_queue:!0,remove_from_queue:!0}})}),c.length>0&&T.jsxs(T.Fragment,{children:[T.jsx("div",{className:"queue-title",children:"Playing Next"}),T.jsx("div",{className:"queue-desc",children:T.jsxs("span",{className:"text",children:["From ",T.jsx("span",{className:"highlight",children:n})]})}),T.jsx(As,{items:c,playlistItems:t,indexOffset:s+1,isLoading:r,type:"song",loadMore:o,title:"Next Up - Queue",hidden:{add_to_queue:!0},reviver:"persist"})]})]})},g6=()=>{const i=ns(),e=40;return Mn({queryKey:["recentlyPlayed"],queryFn:async({pageParam:t=0})=>{const s=t*e;return await i.fetchRecentlyPlayed(s,e)},queryFnReviver:{fn:"fetchRecentlyPlayed",params:[Un,e]}})},p6=()=>{const{items:i,isLoading:e,error:t,reviver:s,loadMore:n}=g6();return T.jsxs("div",{className:"recently-page",children:[t&&T.jsx("div",{className:"error",children:t}),T.jsx(As,{items:i,isLoading:e,type:"song",title:"Recently Played",reviver:s,loadMore:n})]})},y6=()=>{const i=ns(),{query:e}=Rl(),{setPageTitle:t}=mr(),[s,n]=P.useState({artists:[],albums:[],playlists:[],songs:[],genres:[]}),[r,o]=P.useState(!1),[c,d]=P.useState(null);return P.useEffect(()=>(e&&t(`Search results for '${e}'`),(async()=>{if(e){o(!0),d(null);try{const[f,m,p,v,S]=await Promise.all([i.searchArtists(e,10),i.searchAlbumsDetailed(e,10),i.searchPlaylistsDetailed(e,10),i.fetchSongs(e),i.searchGenres(e,10)]),y=f.map(I=>{var C;return{type:"Artist",id:I.Id,name:I.Name,thumbnailUrl:i.getImageUrl(I,"Primary",{width:36,height:36}),isFavorite:((C=I.UserData)==null?void 0:C.IsFavorite)||!1,_mediaItem:I}}),E=m.map(I=>{var C,L,D;return{type:"Album",id:I.Id,name:I.Name,thumbnailUrl:i.getImageUrl(I,"Primary",{width:46,height:46}),artists:[((L=(C=I.AlbumArtists)==null?void 0:C[0])==null?void 0:L.Name)||I.AlbumArtist||"Unknown Artist"],isFavorite:((D=I.UserData)==null?void 0:D.IsFavorite)||!1,_mediaItem:I}}),A=p.map(I=>{var C;return{type:"Playlist",id:I.Id,name:I.Name,thumbnailUrl:i.getImageUrl(I,"Primary",{width:46,height:46}),totalTracks:I.ChildCount||0,isFavorite:((C=I.UserData)==null?void 0:C.IsFavorite)||!1,_mediaItem:I}}),R=S.map(I=>({type:"Genre",id:I.Name,name:I.Name,_mediaItem:I}));n({artists:y,albums:E,playlists:A,songs:v,genres:R})}catch(f){console.error("Search Error:",f),d("Failed to load search results")}finally{o(!1)}}})(),()=>t("")),[e,t,i]),r?T.jsx(dr,{}):c?T.jsx("div",{children:c}):e?T.jsx("div",{className:"search-results-page",children:T.jsxs("div",{className:"search-content",children:[s.songs.length>0&&T.jsx("div",{className:"section songs",children:T.jsx(W0,{tracks:s.songs,title:`Search results for '${e}'`})}),s.artists.length>0&&T.jsxs("div",{className:"section artists",children:[T.jsx("div",{className:"title",children:"Artists"}),T.jsx(As,{items:s.artists.map(u=>u._mediaItem),isLoading:r,type:"artist",title:`Artists for '${e}'`,hidden:{view_artist:!0}})]}),s.albums.length>0&&T.jsxs("div",{className:"section albums",children:[T.jsx("div",{className:"title",children:"Albums"}),T.jsx(As,{items:s.albums.map(u=>u._mediaItem),isLoading:r,type:"album",title:`Albums for '${e}'`,albumDisplayMode:"artist",hidden:{view_album:!0}})]}),s.playlists.length>0&&T.jsxs("div",{className:"section playlists",children:[T.jsx("div",{className:"title",children:"Playlists"}),T.jsx(As,{items:s.playlists.map(u=>u._mediaItem),isLoading:r,type:"playlist",title:`Playlists for '${e}'`})]}),s.genres.length>0&&T.jsxs("div",{className:"section genres",children:[T.jsx("div",{className:"title",children:"Genres"}),T.jsx("div",{className:"section-list noSelect",children:s.genres.map(u=>T.jsxs(qi,{to:`/genre/${u.id}`,className:"section-item",children:[T.jsx("div",{className:"icon",children:T.jsx(p0,{size:16})}),T.jsx("div",{className:"section-info",children:T.jsx("div",{className:"name",children:u.name})}),u.isFavorite&&T.jsx("div",{className:"favorited",title:"Favorited",children:T.jsx(on,{size:16})})]},u.id))})]}),s.artists.length===0&&s.albums.length===0&&s.playlists.length===0&&s.songs.length===0&&s.genres.length===0&&T.jsxs("div",{children:["No results found for '",e,"'."]})]})}):T.jsx("div",{children:"Enter a search query to see results."})},v6=i=>{if(i===0)return"0 B";const e=["B","KB","MB","GB","TB"],t=Math.floor(Math.log(i)/Math.log(1024));return`${(i/Math.pow(1024,t)).toFixed(t===0?0:1)} ${e[t]}`},S6=({onLogout:i})=>{const e=io(),t=ns(),s=Yh(),{theme:n,toggleTheme:r}=g3(),[o,c]=P.useState(null),[d,u]=P.useState(null),[f,m]=P.useState(null),{sessionPlayCount:p,resetSessionCount:v,bitrate:S,setBitrate:y}=Qs(),E=Qs(),A=El(),{storageStats:R,refreshStorageStats:I,queueCount:C,clearQueue:L}=L0(),[D,_]=P.useState(!1);P.useEffect(()=>{(async()=>{try{const[z,V,ae]=await Promise.all([t.fetchUserInfo(),t.fetchClientIp(),t.measureLatency()]);if(z.LastLoginDate){const Z=new Date(z.LastLoginDate).toLocaleString("en-US",{weekday:"short",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",year:"numeric",hour12:!0}).replace(/,/,"");c(Z)}else c(null);u(V),m(ae)}catch(z){console.error("Error fetching data:",z)}})()},[t]);const M=()=>{var F;(F=E.audioRef.current)==null||F.pause(),v(),i(),e("/login")},U=P.useCallback(async()=>{if(confirm("Are you sure you want to clear all downloads? This cannot be undone."))try{_(!0),await s.clearAllDownloads(),A.clear(),L(),await I()}catch(F){console.error("Failed to clear downloads:",F)}finally{_(!1)}},[s,L,A,I]);return T.jsxs("div",{className:"settings-page",children:[T.jsxs("div",{className:"section appearance",children:[T.jsx("div",{className:"title",children:"Appearance"}),T.jsxs("div",{className:"options noSelect",children:[T.jsxs("div",{className:`option light ${n==="light"?"active":""}`,onClick:()=>r("light"),children:[T.jsx("div",{className:"visual"}),T.jsx("div",{className:"desc",children:"Light"})]}),T.jsxs("div",{className:`option dark ${n==="dark"?"active":""}`,onClick:()=>r("dark"),children:[T.jsx("div",{className:"visual"}),T.jsx("div",{className:"desc",children:"Dark"})]}),T.jsxs("div",{className:`option system ${n==="system"?"active":""}`,onClick:()=>r("system"),children:[T.jsx("div",{className:"visual"}),T.jsx("div",{className:"desc",children:"System"})]})]})]}),T.jsxs("div",{className:"section playback",children:[T.jsx("div",{className:"title",children:"Playback"}),T.jsx("div",{className:"inner",children:T.jsxs("div",{className:"container",children:[T.jsxs("div",{className:"info",children:[T.jsx("div",{className:"subtitle",children:"Streaming & Offline Sync"}),T.jsx("div",{className:"subdesc",children:"Adjusting audio quality enables server-side transcoding, converting to a compatible format with a lower bitrate for smoother streaming or efficient offline syncing with reduced bandwidth and storage"})]}),T.jsxs("div",{className:"options noSelect",children:[T.jsxs("div",{className:"option source"+(S?"":" active"),onClick:()=>y(0),children:[T.jsx("div",{className:"status",children:T.jsx(Oc,{size:16})}),T.jsxs("div",{className:"details",children:[T.jsx("div",{className:"title",children:"Source"}),T.jsx("div",{className:"desc",children:"Direct playback of the original audio source without modifications"})]})]}),T.jsxs("div",{className:"option high"+(S===32e4?" active":""),onClick:()=>y(32e4),children:[T.jsx("div",{className:"status",children:T.jsx(Oc,{size:16})}),T.jsxs("div",{className:"details",children:[T.jsxs("div",{className:"title",children:["High ",T.jsx("span",{className:"bitrate",children:"320 kbps"})]}),T.jsx("div",{className:"desc",children:"Superior sound quality, perfect for immersive listening with moderate data usage"})]})]}),T.jsxs("div",{className:"option medium"+(S===256e3?" active":""),onClick:()=>y(256e3),children:[T.jsx("div",{className:"status",children:T.jsx(Oc,{size:16})}),T.jsxs("div",{className:"details",children:[T.jsxs("div",{className:"title",children:["Medium ",T.jsx("span",{className:"bitrate",children:"256 kbps"})]}),T.jsx("div",{className:"desc",children:"Crisp audio with a balanced blend of quality and data efficiency"})]})]}),T.jsxs("div",{className:"option low"+(S===192e3?" active":""),onClick:()=>y(192e3),children:[T.jsx("div",{className:"status",children:T.jsx(Oc,{size:16})}),T.jsxs("div",{className:"details",children:[T.jsxs("div",{className:"title",children:["Low ",T.jsx("span",{className:"bitrate",children:"192 kbps"})]}),T.jsx("div",{className:"desc",children:"Solid quality tailored for streaming with reduced bandwidth"})]})]}),T.jsxs("div",{className:"option minimal"+(S===128e3?" active":""),onClick:()=>y(128e3),children:[T.jsx("div",{className:"status",children:T.jsx(Oc,{size:16})}),T.jsxs("div",{className:"details",children:[T.jsxs("div",{className:"title",children:["Minimal ",T.jsx("span",{className:"bitrate",children:"128 kbps"})]}),T.jsx("div",{className:"desc",children:"Essential audio quality optimized for the lowest data consumption"})]})]})]})]})})]}),T.jsxs("div",{className:"section offline-sync",children:[T.jsxs("div",{className:"container",children:[T.jsx("div",{className:"title",children:"Offline Sync"}),T.jsxs("div",{className:"desc",children:["Synced Music - ",R.trackCount," Track",R.trackCount===1?"":"s",C>0?T.jsxs(T.Fragment,{children:[" ","(",C," track",C===1?"":"s"," in queue)"]}):""," ","/ ",v6(R.trackCount===0?0:(R==null?void 0:R.indexedDB)||0)," Used"]})]}),T.jsx("div",{className:"options noSelect",children:T.jsx("div",{className:"option",children:(R.trackCount>0||C>0)&&T.jsx("button",{className:"btn clear",onClick:U,disabled:D,children:D?"Clearing...":"Clear All"})})}),T.jsx("div",{className:"desc",children:T.jsxs("p",{children:["Cache your music library for seamless offline playback, with new tracks auto-syncing to saved playlists, albums, or artists. Browse your"," ",T.jsx(qi,{to:"/synced",className:"textlink",children:"synced music library"})," ","with ease"]})})]}),T.jsxs("div",{className:"section about",children:[T.jsx("div",{className:"title",children:"About"}),T.jsxs("div",{className:"desc",children:[T.jsxs("p",{className:"subtitle",children:["Jelly Music App - Version ","0.2"]}),T.jsx("p",{children:"An open source music player for Jellyfin"}),T.jsxs("p",{children:["Carefully crafted with great attention to detail, aiming to reduce noise and distractions with a minimalistic & lightweight interface:",T.jsx("span",{className:"mantra",children:' "the quieter you become, the more you are able to hear"'})]}),T.jsxs("p",{className:"subfooter",children:[T.jsx("span",{children:"Source code is freely available on "}),T.jsx("a",{target:"_blank",rel:"noopener noreferrer",className:"textlink",href:"https://github.com/Stannnnn/jelly-app",children:"GitHub"}),T.jsx("span",{children:" and is licensed under the MIT license"})]})]})]}),T.jsxs("div",{className:"section session",children:[T.jsx("div",{className:"title",children:"Session"}),T.jsxs("div",{className:"desc",children:[T.jsxs("p",{children:["Currently connected to"," ",T.jsx("a",{target:"_blank",rel:"noopener noreferrer",className:"textlink",href:t.auth.serverUrl,children:t.auth.serverUrl})," ",f!==null&&T.jsx("span",{children:T.jsxs("span",{children:["with ",f,"ms latency"]})})]}),T.jsxs("p",{children:["Last login: ",o," ",d?` from ${d}`:""]}),T.jsxs("p",{children:["Played"," ",p!==null&&T.jsxs("span",{children:[p," ",p===1?"track":"tracks"]})," ","since login"]})]}),T.jsx("div",{className:"actions noSelect",children:T.jsx("button",{onClick:M,className:"btn logout",children:"Logout"})})]})]})},x6=()=>{const i=ns(),e=40,{jellySort:t}=fr();return Mn({queryKey:["jellyfinTracks",t.sortBy,t.sortOrder],queryFn:async({pageParam:s=0})=>{const n=s*e;return await i.getAllTracks(n,e,t.sortBy,t.sortOrder)},queryFnReviver:{fn:"getAllTracks",params:[Un,e,t.sortBy,t.sortOrder]}})},T6=()=>{const{items:i,isLoading:e,error:t,reviver:s,loadMore:n}=x6();return T.jsxs("div",{className:"tracks-page",children:[t&&T.jsx("div",{className:"error",children:t}),T.jsx(As,{items:i,isLoading:e,reviver:s,type:"song",loadMore:n,title:"Tracks"})]})},_E=new mC({defaultOptions:{queries:{staleTime:1e3*60*5}}}),E6=Yw({storage:window.localStorage}),b6=()=>T.jsx(T.Fragment,{children:window.__NPM_LIFECYCLE_EVENT__==="dev:nocache"?T.jsx(nb,{client:_E,children:T.jsx(PE,{})}):T.jsx(BC,{client:_E,persistOptions:{persister:E6},children:T.jsx(PE,{})})}),PE=()=>{const[i,e]=P.useState(()=>{const d=localStorage.getItem("auth");return d?JSON.parse(d):null}),[t,s]=P.useState(!1),n=El(),r=d=>{e(d),localStorage.setItem("auth",JSON.stringify(d))},o=()=>{s(!0),localStorage.removeItem("repeatMode"),e(null),localStorage.removeItem("auth"),s(!1),n.clear()};P.useEffect(()=>{i||localStorage.removeItem("auth")},[i]),P.useEffect(()=>{const d=/Win/.test(navigator.userAgent),u=/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor),f=/Edg/.test(navigator.userAgent)&&/Microsoft Corporation/.test(navigator.vendor),m=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;d&&(u||f)?document.getElementsByTagName("html")[0].classList.add("winOS"):document.getElementsByTagName("html")[0].classList.add("otherOS"),m&&document.getElementsByTagName("html")[0].classList.add("iOS")},[]);const c=T.jsx("div",{className:"music-app",children:T.jsxs(yb,{children:[T.jsx(gs,{path:"/login",element:i?T.jsx(Sp,{to:"/"}):T.jsx(d6,{onLogin:r})}),T.jsx(gs,{path:"/*",element:i?T.jsx(y2,{auth:i,children:T.jsx(TP,{children:T.jsx(m3,{children:T.jsx(u3,{initialVolume:.5,clearOnLogout:t,children:T.jsx(NP,{children:T.jsxs(FP,{children:[T.jsx(A6,{auth:i,handleLogout:o}),T.jsx(hD,{})]})})})})})}):T.jsx(Sp,{to:"/login"})})]})});return T.jsx(eD,{basename:"/jelly-app/",children:T.jsx(jP,{children:T.jsx(S2,{children:T.jsx(h3,{children:T.jsx(y3,{children:c})})})})})},A6=({auth:i,handleLogout:e})=>{v3();const{showSidenav:t,toggleSidenav:s}=b0(),n=hr(),r=(n==null?void 0:n.isOpen)||!1,o=(n==null?void 0:n.isTouchDevice)||!1,c=P.useCallback(()=>T.jsx(S6,{onLogout:e}),[e]);return T.jsxs("div",{className:"interface",children:[T.jsx("div",{className:t||r&&o?"dimmer active noSelect":"dimmer noSelect",onClick:t?s:n==null?void 0:n.closeDropdown}),T.jsx(SP,{username:i.username}),T.jsxs(yb,{children:[T.jsx(gs,{path:"/",element:T.jsx(Gs,{content:c6})}),T.jsx(gs,{path:"/tracks",element:T.jsx(Gs,{content:T6,filterType:"mediaItems"})}),T.jsx(gs,{path:"/albums",element:T.jsx(Gs,{content:YF,filterType:"mediaItems"})}),T.jsx(gs,{path:"/album/:albumId",element:T.jsx(Gs,{content:x3})}),T.jsx(gs,{path:"/artists",element:T.jsx(Gs,{content:WF,filterType:"mediaItems"})}),T.jsx(gs,{path:"/artist/:artistId",element:T.jsx(Gs,{content:QF})}),T.jsx(gs,{path:"/artist/:artistId/tracks",element:T.jsx(Gs,{content:JF})}),T.jsx(gs,{path:"/genre/:genre",element:T.jsx(Gs,{content:o6,filterType:"mediaItems"})}),T.jsx(gs,{path:"/playlist/:playlistId",element:T.jsx(Gs,{content:f6})}),T.jsx(gs,{path:"/queue",element:T.jsx(Gs,{content:m6})}),T.jsx(gs,{path:"/favorites",element:T.jsx(Gs,{content:i6,filterType:"favorites"})}),T.jsx(gs,{path:"/recently",element:T.jsx(Gs,{content:p6})}),T.jsx(gs,{path:"/frequently",element:T.jsx(Gs,{content:r6})}),T.jsx(gs,{path:"/synced",element:T.jsx(Gs,{content:t6,filterType:"favorites"})}),T.jsx(gs,{path:"/settings",element:T.jsx(Gs,{content:c})}),T.jsx(gs,{path:"/search/:query",element:T.jsx(Gs,{content:y6})}),T.jsx(gs,{path:"*",element:T.jsx(Sp,{to:"/"})})]})]})},kE=localStorage.getItem("theme")||"light",I6=window.matchMedia("(prefers-color-scheme: dark)").matches,R6=kE==="system"?I6?"dark":"light":kE;document.documentElement.classList.add(R6);Kw.createRoot(document.getElementById("root")).render(T.jsx(P.StrictMode,{children:T.jsx(b6,{})}));
